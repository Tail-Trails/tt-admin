var rw=e=>{throw TypeError(e)};var ny=(e,n,o)=>n.has(e)||rw("Cannot "+o);var ze=(e,n,o)=>(ny(e,n,"read from private field"),o?o.call(e):n.get(e)),Xt=(e,n,o)=>n.has(e)?rw("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,o),Rt=(e,n,o,u)=>(ny(e,n,"write to private field"),u?u.call(e,o):n.set(e,o),o),Bn=(e,n,o)=>(ny(e,n,"access private method"),o);var Wf=(e,n,o,u)=>({set _(p){Rt(e,n,p,o)},get _(){return ze(e,n,u)}});function sk(e,n){for(var o=0;o<n.length;o++){const u=n[o];if(typeof u!="string"&&!Array.isArray(u)){for(const p in u)if(p!=="default"&&!(p in e)){const x=Object.getOwnPropertyDescriptor(u,p);x&&Object.defineProperty(e,p,x.get?x:{enumerable:!0,get:()=>u[p]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))u(p);new MutationObserver(p=>{for(const x of p)if(x.type==="childList")for(const v of x.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&u(v)}).observe(document,{childList:!0,subtree:!0});function o(p){const x={};return p.integrity&&(x.integrity=p.integrity),p.referrerPolicy&&(x.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?x.credentials="include":p.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function u(p){if(p.ep)return;p.ep=!0;const x=o(p);fetch(p.href,x)}})();var ok=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Q_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var c1={exports:{}},hm={},h1={exports:{}},Zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rd=Symbol.for("react.element"),ak=Symbol.for("react.portal"),lk=Symbol.for("react.fragment"),uk=Symbol.for("react.strict_mode"),ck=Symbol.for("react.profiler"),hk=Symbol.for("react.provider"),dk=Symbol.for("react.context"),fk=Symbol.for("react.forward_ref"),pk=Symbol.for("react.suspense"),mk=Symbol.for("react.memo"),gk=Symbol.for("react.lazy"),nw=Symbol.iterator;function yk(e){return e===null||typeof e!="object"?null:(e=nw&&e[nw]||e["@@iterator"],typeof e=="function"?e:null)}var d1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f1=Object.assign,p1={};function Sc(e,n,o){this.props=e,this.context=n,this.refs=p1,this.updater=o||d1}Sc.prototype.isReactComponent={};Sc.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Sc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function m1(){}m1.prototype=Sc.prototype;function ev(e,n,o){this.props=e,this.context=n,this.refs=p1,this.updater=o||d1}var tv=ev.prototype=new m1;tv.constructor=ev;f1(tv,Sc.prototype);tv.isPureReactComponent=!0;var iw=Array.isArray,g1=Object.prototype.hasOwnProperty,rv={current:null},y1={key:!0,ref:!0,__self:!0,__source:!0};function _1(e,n,o){var u,p={},x=null,v=null;if(n!=null)for(u in n.ref!==void 0&&(v=n.ref),n.key!==void 0&&(x=""+n.key),n)g1.call(n,u)&&!y1.hasOwnProperty(u)&&(p[u]=n[u]);var c=arguments.length-2;if(c===1)p.children=o;else if(1<c){for(var k=Array(c),A=0;A<c;A++)k[A]=arguments[A+2];p.children=k}if(e&&e.defaultProps)for(u in c=e.defaultProps,c)p[u]===void 0&&(p[u]=c[u]);return{$$typeof:Rd,type:e,key:x,ref:v,props:p,_owner:rv.current}}function _k(e,n){return{$$typeof:Rd,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function nv(e){return typeof e=="object"&&e!==null&&e.$$typeof===Rd}function vk(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return n[o]})}var sw=/\/+/g;function iy(e,n){return typeof e=="object"&&e!==null&&e.key!=null?vk(""+e.key):n.toString(36)}function _p(e,n,o,u,p){var x=typeof e;(x==="undefined"||x==="boolean")&&(e=null);var v=!1;if(e===null)v=!0;else switch(x){case"string":case"number":v=!0;break;case"object":switch(e.$$typeof){case Rd:case ak:v=!0}}if(v)return v=e,p=p(v),e=u===""?"."+iy(v,0):u,iw(p)?(o="",e!=null&&(o=e.replace(sw,"$&/")+"/"),_p(p,n,o,"",function(A){return A})):p!=null&&(nv(p)&&(p=_k(p,o+(!p.key||v&&v.key===p.key?"":(""+p.key).replace(sw,"$&/")+"/")+e)),n.push(p)),1;if(v=0,u=u===""?".":u+":",iw(e))for(var c=0;c<e.length;c++){x=e[c];var k=u+iy(x,c);v+=_p(x,n,o,k,p)}else if(k=yk(e),typeof k=="function")for(e=k.call(e),c=0;!(x=e.next()).done;)x=x.value,k=u+iy(x,c++),v+=_p(x,n,o,k,p);else if(x==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return v}function Xf(e,n,o){if(e==null)return e;var u=[],p=0;return _p(e,u,"","",function(x){return n.call(o,x,p++)}),u}function xk(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var ii={current:null},vp={transition:null},wk={ReactCurrentDispatcher:ii,ReactCurrentBatchConfig:vp,ReactCurrentOwner:rv};function v1(){throw Error("act(...) is not supported in production builds of React.")}Zt.Children={map:Xf,forEach:function(e,n,o){Xf(e,function(){n.apply(this,arguments)},o)},count:function(e){var n=0;return Xf(e,function(){n++}),n},toArray:function(e){return Xf(e,function(n){return n})||[]},only:function(e){if(!nv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Zt.Component=Sc;Zt.Fragment=lk;Zt.Profiler=ck;Zt.PureComponent=ev;Zt.StrictMode=uk;Zt.Suspense=pk;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wk;Zt.act=v1;Zt.cloneElement=function(e,n,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var u=f1({},e.props),p=e.key,x=e.ref,v=e._owner;if(n!=null){if(n.ref!==void 0&&(x=n.ref,v=rv.current),n.key!==void 0&&(p=""+n.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(k in n)g1.call(n,k)&&!y1.hasOwnProperty(k)&&(u[k]=n[k]===void 0&&c!==void 0?c[k]:n[k])}var k=arguments.length-2;if(k===1)u.children=o;else if(1<k){c=Array(k);for(var A=0;A<k;A++)c[A]=arguments[A+2];u.children=c}return{$$typeof:Rd,type:e.type,key:p,ref:x,props:u,_owner:v}};Zt.createContext=function(e){return e={$$typeof:dk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:hk,_context:e},e.Consumer=e};Zt.createElement=_1;Zt.createFactory=function(e){var n=_1.bind(null,e);return n.type=e,n};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(e){return{$$typeof:fk,render:e}};Zt.isValidElement=nv;Zt.lazy=function(e){return{$$typeof:gk,_payload:{_status:-1,_result:e},_init:xk}};Zt.memo=function(e,n){return{$$typeof:mk,type:e,compare:n===void 0?null:n}};Zt.startTransition=function(e){var n=vp.transition;vp.transition={};try{e()}finally{vp.transition=n}};Zt.unstable_act=v1;Zt.useCallback=function(e,n){return ii.current.useCallback(e,n)};Zt.useContext=function(e){return ii.current.useContext(e)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(e){return ii.current.useDeferredValue(e)};Zt.useEffect=function(e,n){return ii.current.useEffect(e,n)};Zt.useId=function(){return ii.current.useId()};Zt.useImperativeHandle=function(e,n,o){return ii.current.useImperativeHandle(e,n,o)};Zt.useInsertionEffect=function(e,n){return ii.current.useInsertionEffect(e,n)};Zt.useLayoutEffect=function(e,n){return ii.current.useLayoutEffect(e,n)};Zt.useMemo=function(e,n){return ii.current.useMemo(e,n)};Zt.useReducer=function(e,n,o){return ii.current.useReducer(e,n,o)};Zt.useRef=function(e){return ii.current.useRef(e)};Zt.useState=function(e){return ii.current.useState(e)};Zt.useSyncExternalStore=function(e,n,o){return ii.current.useSyncExternalStore(e,n,o)};Zt.useTransition=function(){return ii.current.useTransition()};Zt.version="18.3.1";h1.exports=Zt;var X=h1.exports;const Ye=Q_(X),iv=sk({__proto__:null,default:Ye},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bk=X,Sk=Symbol.for("react.element"),Tk=Symbol.for("react.fragment"),Ek=Object.prototype.hasOwnProperty,Ck=bk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kk={key:!0,ref:!0,__self:!0,__source:!0};function x1(e,n,o){var u,p={},x=null,v=null;o!==void 0&&(x=""+o),n.key!==void 0&&(x=""+n.key),n.ref!==void 0&&(v=n.ref);for(u in n)Ek.call(n,u)&&!kk.hasOwnProperty(u)&&(p[u]=n[u]);if(e&&e.defaultProps)for(u in n=e.defaultProps,n)p[u]===void 0&&(p[u]=n[u]);return{$$typeof:Sk,type:e,key:x,ref:v,props:p,_owner:Ck.current}}hm.Fragment=Tk;hm.jsx=x1;hm.jsxs=x1;c1.exports=hm;var ee=c1.exports,w1={exports:{}},Xi={},b1={exports:{}},S1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(De,Re){var et=De.length;De.push(Re);e:for(;0<et;){var yt=et-1>>>1,dt=De[yt];if(0<p(dt,Re))De[yt]=Re,De[et]=dt,et=yt;else break e}}function o(De){return De.length===0?null:De[0]}function u(De){if(De.length===0)return null;var Re=De[0],et=De.pop();if(et!==Re){De[0]=et;e:for(var yt=0,dt=De.length,Mt=dt>>>1;yt<Mt;){var At=2*(yt+1)-1,Yt=De[At],gr=At+1,zt=De[gr];if(0>p(Yt,et))gr<dt&&0>p(zt,Yt)?(De[yt]=zt,De[gr]=et,yt=gr):(De[yt]=Yt,De[At]=et,yt=At);else if(gr<dt&&0>p(zt,et))De[yt]=zt,De[gr]=et,yt=gr;else break e}}return Re}function p(De,Re){var et=De.sortIndex-Re.sortIndex;return et!==0?et:De.id-Re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;e.unstable_now=function(){return x.now()}}else{var v=Date,c=v.now();e.unstable_now=function(){return v.now()-c}}var k=[],A=[],B=1,R=null,L=3,$=!1,le=!1,Q=!1,se=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function K(De){for(var Re=o(A);Re!==null;){if(Re.callback===null)u(A);else if(Re.startTime<=De)u(A),Re.sortIndex=Re.expirationTime,n(k,Re);else break;Re=o(A)}}function he(De){if(Q=!1,K(De),!le)if(o(k)!==null)le=!0,bt(be);else{var Re=o(A);Re!==null&&wt(he,Re.startTime-De)}}function be(De,Re){le=!1,Q&&(Q=!1,W(Fe),Fe=-1),$=!0;var et=L;try{for(K(Re),R=o(k);R!==null&&(!(R.expirationTime>Re)||De&&!qe());){var yt=R.callback;if(typeof yt=="function"){R.callback=null,L=R.priorityLevel;var dt=yt(R.expirationTime<=Re);Re=e.unstable_now(),typeof dt=="function"?R.callback=dt:R===o(k)&&u(k),K(Re)}else u(k);R=o(k)}if(R!==null)var Mt=!0;else{var At=o(A);At!==null&&wt(he,At.startTime-Re),Mt=!1}return Mt}finally{R=null,L=et,$=!1}}var ke=!1,Pe=null,Fe=-1,st=5,Be=-1;function qe(){return!(e.unstable_now()-Be<st)}function ot(){if(Pe!==null){var De=e.unstable_now();Be=De;var Re=!0;try{Re=Pe(!0,De)}finally{Re?xt():(ke=!1,Pe=null)}}else ke=!1}var xt;if(typeof G=="function")xt=function(){G(ot)};else if(typeof MessageChannel<"u"){var He=new MessageChannel,It=He.port2;He.port1.onmessage=ot,xt=function(){It.postMessage(null)}}else xt=function(){se(ot,0)};function bt(De){Pe=De,ke||(ke=!0,xt())}function wt(De,Re){Fe=se(function(){De(e.unstable_now())},Re)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(De){De.callback=null},e.unstable_continueExecution=function(){le||$||(le=!0,bt(be))},e.unstable_forceFrameRate=function(De){0>De||125<De?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):st=0<De?Math.floor(1e3/De):5},e.unstable_getCurrentPriorityLevel=function(){return L},e.unstable_getFirstCallbackNode=function(){return o(k)},e.unstable_next=function(De){switch(L){case 1:case 2:case 3:var Re=3;break;default:Re=L}var et=L;L=Re;try{return De()}finally{L=et}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(De,Re){switch(De){case 1:case 2:case 3:case 4:case 5:break;default:De=3}var et=L;L=De;try{return Re()}finally{L=et}},e.unstable_scheduleCallback=function(De,Re,et){var yt=e.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?yt+et:yt):et=yt,De){case 1:var dt=-1;break;case 2:dt=250;break;case 5:dt=1073741823;break;case 4:dt=1e4;break;default:dt=5e3}return dt=et+dt,De={id:B++,callback:Re,priorityLevel:De,startTime:et,expirationTime:dt,sortIndex:-1},et>yt?(De.sortIndex=et,n(A,De),o(k)===null&&De===o(A)&&(Q?(W(Fe),Fe=-1):Q=!0,wt(he,et-yt))):(De.sortIndex=dt,n(k,De),le||$||(le=!0,bt(be))),De},e.unstable_shouldYield=qe,e.unstable_wrapCallback=function(De){var Re=L;return function(){var et=L;L=Re;try{return De.apply(this,arguments)}finally{L=et}}}})(S1);b1.exports=S1;var Pk=b1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ik=X,Wi=Pk;function Ve(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var T1=new Set,ld={};function Vl(e,n){pc(e,n),pc(e+"Capture",n)}function pc(e,n){for(ld[e]=n,e=0;e<n.length;e++)T1.add(n[e])}var Eo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oy=Object.prototype.hasOwnProperty,Ak=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ow={},aw={};function Mk(e){return Oy.call(aw,e)?!0:Oy.call(ow,e)?!1:Ak.test(e)?aw[e]=!0:(ow[e]=!0,!1)}function zk(e,n,o,u){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return u?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Dk(e,n,o,u){if(n===null||typeof n>"u"||zk(e,n,o,u))return!0;if(u)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function si(e,n,o,u,p,x,v){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=u,this.attributeNamespace=p,this.mustUseProperty=o,this.propertyName=e,this.type=n,this.sanitizeURL=x,this.removeEmptyString=v}var Cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Cn[e]=new si(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Cn[n]=new si(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Cn[e]=new si(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Cn[e]=new si(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Cn[e]=new si(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Cn[e]=new si(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Cn[e]=new si(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Cn[e]=new si(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Cn[e]=new si(e,5,!1,e.toLowerCase(),null,!1,!1)});var sv=/[\-:]([a-z])/g;function ov(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(sv,ov);Cn[n]=new si(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(sv,ov);Cn[n]=new si(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(sv,ov);Cn[n]=new si(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Cn[e]=new si(e,1,!1,e.toLowerCase(),null,!1,!1)});Cn.xlinkHref=new si("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Cn[e]=new si(e,1,!1,e.toLowerCase(),null,!0,!0)});function av(e,n,o,u){var p=Cn.hasOwnProperty(n)?Cn[n]:null;(p!==null?p.type!==0:u||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(Dk(n,o,p,u)&&(o=null),u||p===null?Mk(n)&&(o===null?e.removeAttribute(n):e.setAttribute(n,""+o)):p.mustUseProperty?e[p.propertyName]=o===null?p.type===3?!1:"":o:(n=p.attributeName,u=p.attributeNamespace,o===null?e.removeAttribute(n):(p=p.type,o=p===3||p===4&&o===!0?"":""+o,u?e.setAttributeNS(u,n,o):e.setAttribute(n,o))))}var Mo=Ik.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Kf=Symbol.for("react.element"),ju=Symbol.for("react.portal"),Vu=Symbol.for("react.fragment"),lv=Symbol.for("react.strict_mode"),By=Symbol.for("react.profiler"),E1=Symbol.for("react.provider"),C1=Symbol.for("react.context"),uv=Symbol.for("react.forward_ref"),Ny=Symbol.for("react.suspense"),jy=Symbol.for("react.suspense_list"),cv=Symbol.for("react.memo"),ma=Symbol.for("react.lazy"),k1=Symbol.for("react.offscreen"),lw=Symbol.iterator;function Bh(e){return e===null||typeof e!="object"?null:(e=lw&&e[lw]||e["@@iterator"],typeof e=="function"?e:null)}var Mr=Object.assign,sy;function Wh(e){if(sy===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);sy=n&&n[1]||""}return`
`+sy+e}var oy=!1;function ay(e,n){if(!e||oy)return"";oy=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(A){var u=A}Reflect.construct(e,[],n)}else{try{n.call()}catch(A){u=A}e.call(n.prototype)}else{try{throw Error()}catch(A){u=A}e()}}catch(A){if(A&&u&&typeof A.stack=="string"){for(var p=A.stack.split(`
`),x=u.stack.split(`
`),v=p.length-1,c=x.length-1;1<=v&&0<=c&&p[v]!==x[c];)c--;for(;1<=v&&0<=c;v--,c--)if(p[v]!==x[c]){if(v!==1||c!==1)do if(v--,c--,0>c||p[v]!==x[c]){var k=`
`+p[v].replace(" at new "," at ");return e.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",e.displayName)),k}while(1<=v&&0<=c);break}}}finally{oy=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?Wh(e):""}function Rk(e){switch(e.tag){case 5:return Wh(e.type);case 16:return Wh("Lazy");case 13:return Wh("Suspense");case 19:return Wh("SuspenseList");case 0:case 2:case 15:return e=ay(e.type,!1),e;case 11:return e=ay(e.type.render,!1),e;case 1:return e=ay(e.type,!0),e;default:return""}}function Vy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vu:return"Fragment";case ju:return"Portal";case By:return"Profiler";case lv:return"StrictMode";case Ny:return"Suspense";case jy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case C1:return(e.displayName||"Context")+".Consumer";case E1:return(e._context.displayName||"Context")+".Provider";case uv:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case cv:return n=e.displayName||null,n!==null?n:Vy(e.type)||"Memo";case ma:n=e._payload,e=e._init;try{return Vy(e(n))}catch{}}return null}function Lk(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vy(n);case 8:return n===lv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Fa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function P1(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Fk(e){var n=P1(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),u=""+e[n];if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var p=o.get,x=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return p.call(this)},set:function(v){u=""+v,x.call(this,v)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(v){u=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Yf(e){e._valueTracker||(e._valueTracker=Fk(e))}function I1(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var o=n.getValue(),u="";return e&&(u=P1(e)?e.checked?"true":"false":e.value),e=u,e!==o?(n.setValue(e),!0):!1}function Rp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $y(e,n){var o=n.checked;return Mr({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function uw(e,n){var o=n.defaultValue==null?"":n.defaultValue,u=n.checked!=null?n.checked:n.defaultChecked;o=Fa(n.value!=null?n.value:o),e._wrapperState={initialChecked:u,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function A1(e,n){n=n.checked,n!=null&&av(e,"checked",n,!1)}function Uy(e,n){A1(e,n);var o=Fa(n.value),u=n.type;if(o!=null)u==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?qy(e,n.type,o):n.hasOwnProperty("defaultValue")&&qy(e,n.type,Fa(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function cw(e,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var u=n.type;if(!(u!=="submit"&&u!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,o||n===e.value||(e.value=n),e.defaultValue=n}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function qy(e,n,o){(n!=="number"||Rp(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var Xh=Array.isArray;function Ju(e,n,o,u){if(e=e.options,n){n={};for(var p=0;p<o.length;p++)n["$"+o[p]]=!0;for(o=0;o<e.length;o++)p=n.hasOwnProperty("$"+e[o].value),e[o].selected!==p&&(e[o].selected=p),p&&u&&(e[o].defaultSelected=!0)}else{for(o=""+Fa(o),n=null,p=0;p<e.length;p++){if(e[p].value===o){e[p].selected=!0,u&&(e[p].defaultSelected=!0);return}n!==null||e[p].disabled||(n=e[p])}n!==null&&(n.selected=!0)}}function Zy(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(Ve(91));return Mr({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hw(e,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(Ve(92));if(Xh(o)){if(1<o.length)throw Error(Ve(93));o=o[0]}n=o}n==null&&(n=""),o=n}e._wrapperState={initialValue:Fa(o)}}function M1(e,n){var o=Fa(n.value),u=Fa(n.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),n.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),u!=null&&(e.defaultValue=""+u)}function dw(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function z1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hy(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?z1(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Jf,D1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,u,p){MSApp.execUnsafeLocalFunction(function(){return e(n,o,u,p)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(Jf=Jf||document.createElement("div"),Jf.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Jf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function ud(e,n){if(n){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=n;return}}e.textContent=n}var Jh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ok=["Webkit","ms","Moz","O"];Object.keys(Jh).forEach(function(e){Ok.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Jh[n]=Jh[e]})});function R1(e,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||Jh.hasOwnProperty(e)&&Jh[e]?(""+n).trim():n+"px"}function L1(e,n){e=e.style;for(var o in n)if(n.hasOwnProperty(o)){var u=o.indexOf("--")===0,p=R1(o,n[o],u);o==="float"&&(o="cssFloat"),u?e.setProperty(o,p):e[o]=p}}var Bk=Mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gy(e,n){if(n){if(Bk[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(Ve(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(Ve(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(Ve(61))}if(n.style!=null&&typeof n.style!="object")throw Error(Ve(62))}}function Wy(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xy=null;function hv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ky=null,Qu=null,ec=null;function fw(e){if(e=Od(e)){if(typeof Ky!="function")throw Error(Ve(280));var n=e.stateNode;n&&(n=gm(n),Ky(e.stateNode,e.type,n))}}function F1(e){Qu?ec?ec.push(e):ec=[e]:Qu=e}function O1(){if(Qu){var e=Qu,n=ec;if(ec=Qu=null,fw(e),n)for(e=0;e<n.length;e++)fw(n[e])}}function B1(e,n){return e(n)}function N1(){}var ly=!1;function j1(e,n,o){if(ly)return e(n,o);ly=!0;try{return B1(e,n,o)}finally{ly=!1,(Qu!==null||ec!==null)&&(N1(),O1())}}function cd(e,n){var o=e.stateNode;if(o===null)return null;var u=gm(o);if(u===null)return null;o=u[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(Ve(231,n,typeof o));return o}var Yy=!1;if(Eo)try{var Nh={};Object.defineProperty(Nh,"passive",{get:function(){Yy=!0}}),window.addEventListener("test",Nh,Nh),window.removeEventListener("test",Nh,Nh)}catch{Yy=!1}function Nk(e,n,o,u,p,x,v,c,k){var A=Array.prototype.slice.call(arguments,3);try{n.apply(o,A)}catch(B){this.onError(B)}}var Qh=!1,Lp=null,Fp=!1,Jy=null,jk={onError:function(e){Qh=!0,Lp=e}};function Vk(e,n,o,u,p,x,v,c,k){Qh=!1,Lp=null,Nk.apply(jk,arguments)}function $k(e,n,o,u,p,x,v,c,k){if(Vk.apply(this,arguments),Qh){if(Qh){var A=Lp;Qh=!1,Lp=null}else throw Error(Ve(198));Fp||(Fp=!0,Jy=A)}}function $l(e){var n=e,o=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(o=n.return),e=n.return;while(e)}return n.tag===3?o:null}function V1(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function pw(e){if($l(e)!==e)throw Error(Ve(188))}function Uk(e){var n=e.alternate;if(!n){if(n=$l(e),n===null)throw Error(Ve(188));return n!==e?null:e}for(var o=e,u=n;;){var p=o.return;if(p===null)break;var x=p.alternate;if(x===null){if(u=p.return,u!==null){o=u;continue}break}if(p.child===x.child){for(x=p.child;x;){if(x===o)return pw(p),e;if(x===u)return pw(p),n;x=x.sibling}throw Error(Ve(188))}if(o.return!==u.return)o=p,u=x;else{for(var v=!1,c=p.child;c;){if(c===o){v=!0,o=p,u=x;break}if(c===u){v=!0,u=p,o=x;break}c=c.sibling}if(!v){for(c=x.child;c;){if(c===o){v=!0,o=x,u=p;break}if(c===u){v=!0,u=x,o=p;break}c=c.sibling}if(!v)throw Error(Ve(189))}}if(o.alternate!==u)throw Error(Ve(190))}if(o.tag!==3)throw Error(Ve(188));return o.stateNode.current===o?e:n}function $1(e){return e=Uk(e),e!==null?U1(e):null}function U1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=U1(e);if(n!==null)return n;e=e.sibling}return null}var q1=Wi.unstable_scheduleCallback,mw=Wi.unstable_cancelCallback,qk=Wi.unstable_shouldYield,Zk=Wi.unstable_requestPaint,jr=Wi.unstable_now,Hk=Wi.unstable_getCurrentPriorityLevel,dv=Wi.unstable_ImmediatePriority,Z1=Wi.unstable_UserBlockingPriority,Op=Wi.unstable_NormalPriority,Gk=Wi.unstable_LowPriority,H1=Wi.unstable_IdlePriority,dm=null,Ws=null;function Wk(e){if(Ws&&typeof Ws.onCommitFiberRoot=="function")try{Ws.onCommitFiberRoot(dm,e,void 0,(e.current.flags&128)===128)}catch{}}var Cs=Math.clz32?Math.clz32:Yk,Xk=Math.log,Kk=Math.LN2;function Yk(e){return e>>>=0,e===0?32:31-(Xk(e)/Kk|0)|0}var Qf=64,ep=4194304;function Kh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Bp(e,n){var o=e.pendingLanes;if(o===0)return 0;var u=0,p=e.suspendedLanes,x=e.pingedLanes,v=o&268435455;if(v!==0){var c=v&~p;c!==0?u=Kh(c):(x&=v,x!==0&&(u=Kh(x)))}else v=o&~p,v!==0?u=Kh(v):x!==0&&(u=Kh(x));if(u===0)return 0;if(n!==0&&n!==u&&!(n&p)&&(p=u&-u,x=n&-n,p>=x||p===16&&(x&4194240)!==0))return n;if(u&4&&(u|=o&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=u;0<n;)o=31-Cs(n),p=1<<o,u|=e[o],n&=~p;return u}function Jk(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qk(e,n){for(var o=e.suspendedLanes,u=e.pingedLanes,p=e.expirationTimes,x=e.pendingLanes;0<x;){var v=31-Cs(x),c=1<<v,k=p[v];k===-1?(!(c&o)||c&u)&&(p[v]=Jk(c,n)):k<=n&&(e.expiredLanes|=c),x&=~c}}function Qy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function G1(){var e=Qf;return Qf<<=1,!(Qf&4194240)&&(Qf=64),e}function uy(e){for(var n=[],o=0;31>o;o++)n.push(e);return n}function Ld(e,n,o){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-Cs(n),e[n]=o}function eP(e,n){var o=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<o;){var p=31-Cs(o),x=1<<p;n[p]=0,u[p]=-1,e[p]=-1,o&=~x}}function fv(e,n){var o=e.entangledLanes|=n;for(e=e.entanglements;o;){var u=31-Cs(o),p=1<<u;p&n|e[u]&n&&(e[u]|=n),o&=~p}}var ar=0;function W1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var X1,pv,K1,Y1,J1,e_=!1,tp=[],Pa=null,Ia=null,Aa=null,hd=new Map,dd=new Map,ya=[],tP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gw(e,n){switch(e){case"focusin":case"focusout":Pa=null;break;case"dragenter":case"dragleave":Ia=null;break;case"mouseover":case"mouseout":Aa=null;break;case"pointerover":case"pointerout":hd.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":dd.delete(n.pointerId)}}function jh(e,n,o,u,p,x){return e===null||e.nativeEvent!==x?(e={blockedOn:n,domEventName:o,eventSystemFlags:u,nativeEvent:x,targetContainers:[p]},n!==null&&(n=Od(n),n!==null&&pv(n)),e):(e.eventSystemFlags|=u,n=e.targetContainers,p!==null&&n.indexOf(p)===-1&&n.push(p),e)}function rP(e,n,o,u,p){switch(n){case"focusin":return Pa=jh(Pa,e,n,o,u,p),!0;case"dragenter":return Ia=jh(Ia,e,n,o,u,p),!0;case"mouseover":return Aa=jh(Aa,e,n,o,u,p),!0;case"pointerover":var x=p.pointerId;return hd.set(x,jh(hd.get(x)||null,e,n,o,u,p)),!0;case"gotpointercapture":return x=p.pointerId,dd.set(x,jh(dd.get(x)||null,e,n,o,u,p)),!0}return!1}function Q1(e){var n=wl(e.target);if(n!==null){var o=$l(n);if(o!==null){if(n=o.tag,n===13){if(n=V1(o),n!==null){e.blockedOn=n,J1(e.priority,function(){K1(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xp(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var o=t_(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var u=new o.constructor(o.type,o);Xy=u,o.target.dispatchEvent(u),Xy=null}else return n=Od(o),n!==null&&pv(n),e.blockedOn=o,!1;n.shift()}return!0}function yw(e,n,o){xp(e)&&o.delete(n)}function nP(){e_=!1,Pa!==null&&xp(Pa)&&(Pa=null),Ia!==null&&xp(Ia)&&(Ia=null),Aa!==null&&xp(Aa)&&(Aa=null),hd.forEach(yw),dd.forEach(yw)}function Vh(e,n){e.blockedOn===n&&(e.blockedOn=null,e_||(e_=!0,Wi.unstable_scheduleCallback(Wi.unstable_NormalPriority,nP)))}function fd(e){function n(p){return Vh(p,e)}if(0<tp.length){Vh(tp[0],e);for(var o=1;o<tp.length;o++){var u=tp[o];u.blockedOn===e&&(u.blockedOn=null)}}for(Pa!==null&&Vh(Pa,e),Ia!==null&&Vh(Ia,e),Aa!==null&&Vh(Aa,e),hd.forEach(n),dd.forEach(n),o=0;o<ya.length;o++)u=ya[o],u.blockedOn===e&&(u.blockedOn=null);for(;0<ya.length&&(o=ya[0],o.blockedOn===null);)Q1(o),o.blockedOn===null&&ya.shift()}var tc=Mo.ReactCurrentBatchConfig,Np=!0;function iP(e,n,o,u){var p=ar,x=tc.transition;tc.transition=null;try{ar=1,mv(e,n,o,u)}finally{ar=p,tc.transition=x}}function sP(e,n,o,u){var p=ar,x=tc.transition;tc.transition=null;try{ar=4,mv(e,n,o,u)}finally{ar=p,tc.transition=x}}function mv(e,n,o,u){if(Np){var p=t_(e,n,o,u);if(p===null)vy(e,n,u,jp,o),gw(e,u);else if(rP(p,e,n,o,u))u.stopPropagation();else if(gw(e,u),n&4&&-1<tP.indexOf(e)){for(;p!==null;){var x=Od(p);if(x!==null&&X1(x),x=t_(e,n,o,u),x===null&&vy(e,n,u,jp,o),x===p)break;p=x}p!==null&&u.stopPropagation()}else vy(e,n,u,null,o)}}var jp=null;function t_(e,n,o,u){if(jp=null,e=hv(u),e=wl(e),e!==null)if(n=$l(e),n===null)e=null;else if(o=n.tag,o===13){if(e=V1(n),e!==null)return e;e=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return jp=e,null}function e2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hk()){case dv:return 1;case Z1:return 4;case Op:case Gk:return 16;case H1:return 536870912;default:return 16}default:return 16}}var Ea=null,gv=null,wp=null;function t2(){if(wp)return wp;var e,n=gv,o=n.length,u,p="value"in Ea?Ea.value:Ea.textContent,x=p.length;for(e=0;e<o&&n[e]===p[e];e++);var v=o-e;for(u=1;u<=v&&n[o-u]===p[x-u];u++);return wp=p.slice(e,1<u?1-u:void 0)}function bp(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function rp(){return!0}function _w(){return!1}function Ki(e){function n(o,u,p,x,v){this._reactName=o,this._targetInst=p,this.type=u,this.nativeEvent=x,this.target=v,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(o=e[c],this[c]=o?o(x):x[c]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?rp:_w,this.isPropagationStopped=_w,this}return Mr(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=rp)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=rp)},persist:function(){},isPersistent:rp}),n}var Tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yv=Ki(Tc),Fd=Mr({},Tc,{view:0,detail:0}),oP=Ki(Fd),cy,hy,$h,fm=Mr({},Fd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_v,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$h&&($h&&e.type==="mousemove"?(cy=e.screenX-$h.screenX,hy=e.screenY-$h.screenY):hy=cy=0,$h=e),cy)},movementY:function(e){return"movementY"in e?e.movementY:hy}}),vw=Ki(fm),aP=Mr({},fm,{dataTransfer:0}),lP=Ki(aP),uP=Mr({},Fd,{relatedTarget:0}),dy=Ki(uP),cP=Mr({},Tc,{animationName:0,elapsedTime:0,pseudoElement:0}),hP=Ki(cP),dP=Mr({},Tc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fP=Ki(dP),pP=Mr({},Tc,{data:0}),xw=Ki(pP),mP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _P(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=yP[e])?!!n[e]:!1}function _v(){return _P}var vP=Mr({},Fd,{key:function(e){if(e.key){var n=mP[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=bp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gP[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_v,charCode:function(e){return e.type==="keypress"?bp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xP=Ki(vP),wP=Mr({},fm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ww=Ki(wP),bP=Mr({},Fd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_v}),SP=Ki(bP),TP=Mr({},Tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),EP=Ki(TP),CP=Mr({},fm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kP=Ki(CP),PP=[9,13,27,32],vv=Eo&&"CompositionEvent"in window,ed=null;Eo&&"documentMode"in document&&(ed=document.documentMode);var IP=Eo&&"TextEvent"in window&&!ed,r2=Eo&&(!vv||ed&&8<ed&&11>=ed),bw=" ",Sw=!1;function n2(e,n){switch(e){case"keyup":return PP.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $u=!1;function AP(e,n){switch(e){case"compositionend":return i2(n);case"keypress":return n.which!==32?null:(Sw=!0,bw);case"textInput":return e=n.data,e===bw&&Sw?null:e;default:return null}}function MP(e,n){if($u)return e==="compositionend"||!vv&&n2(e,n)?(e=t2(),wp=gv=Ea=null,$u=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return r2&&n.locale!=="ko"?null:n.data;default:return null}}var zP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tw(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!zP[e.type]:n==="textarea"}function s2(e,n,o,u){F1(u),n=Vp(n,"onChange"),0<n.length&&(o=new yv("onChange","change",null,o,u),e.push({event:o,listeners:n}))}var td=null,pd=null;function DP(e){g2(e,0)}function pm(e){var n=Zu(e);if(I1(n))return e}function RP(e,n){if(e==="change")return n}var o2=!1;if(Eo){var fy;if(Eo){var py="oninput"in document;if(!py){var Ew=document.createElement("div");Ew.setAttribute("oninput","return;"),py=typeof Ew.oninput=="function"}fy=py}else fy=!1;o2=fy&&(!document.documentMode||9<document.documentMode)}function Cw(){td&&(td.detachEvent("onpropertychange",a2),pd=td=null)}function a2(e){if(e.propertyName==="value"&&pm(pd)){var n=[];s2(n,pd,e,hv(e)),j1(DP,n)}}function LP(e,n,o){e==="focusin"?(Cw(),td=n,pd=o,td.attachEvent("onpropertychange",a2)):e==="focusout"&&Cw()}function FP(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pm(pd)}function OP(e,n){if(e==="click")return pm(n)}function BP(e,n){if(e==="input"||e==="change")return pm(n)}function NP(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Ps=typeof Object.is=="function"?Object.is:NP;function md(e,n){if(Ps(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var o=Object.keys(e),u=Object.keys(n);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var p=o[u];if(!Oy.call(n,p)||!Ps(e[p],n[p]))return!1}return!0}function kw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pw(e,n){var o=kw(e);e=0;for(var u;o;){if(o.nodeType===3){if(u=e+o.textContent.length,e<=n&&u>=n)return{node:o,offset:n-e};e=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=kw(o)}}function l2(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?l2(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function u2(){for(var e=window,n=Rp();n instanceof e.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)e=n.contentWindow;else break;n=Rp(e.document)}return n}function xv(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function jP(e){var n=u2(),o=e.focusedElem,u=e.selectionRange;if(n!==o&&o&&o.ownerDocument&&l2(o.ownerDocument.documentElement,o)){if(u!==null&&xv(o)){if(n=u.start,e=u.end,e===void 0&&(e=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(e,o.value.length);else if(e=(n=o.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var p=o.textContent.length,x=Math.min(u.start,p);u=u.end===void 0?x:Math.min(u.end,p),!e.extend&&x>u&&(p=u,u=x,x=p),p=Pw(o,x);var v=Pw(o,u);p&&v&&(e.rangeCount!==1||e.anchorNode!==p.node||e.anchorOffset!==p.offset||e.focusNode!==v.node||e.focusOffset!==v.offset)&&(n=n.createRange(),n.setStart(p.node,p.offset),e.removeAllRanges(),x>u?(e.addRange(n),e.extend(v.node,v.offset)):(n.setEnd(v.node,v.offset),e.addRange(n)))}}for(n=[],e=o;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)e=n[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var VP=Eo&&"documentMode"in document&&11>=document.documentMode,Uu=null,r_=null,rd=null,n_=!1;function Iw(e,n,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;n_||Uu==null||Uu!==Rp(u)||(u=Uu,"selectionStart"in u&&xv(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),rd&&md(rd,u)||(rd=u,u=Vp(r_,"onSelect"),0<u.length&&(n=new yv("onSelect","select",null,n,o),e.push({event:n,listeners:u}),n.target=Uu)))}function np(e,n){var o={};return o[e.toLowerCase()]=n.toLowerCase(),o["Webkit"+e]="webkit"+n,o["Moz"+e]="moz"+n,o}var qu={animationend:np("Animation","AnimationEnd"),animationiteration:np("Animation","AnimationIteration"),animationstart:np("Animation","AnimationStart"),transitionend:np("Transition","TransitionEnd")},my={},c2={};Eo&&(c2=document.createElement("div").style,"AnimationEvent"in window||(delete qu.animationend.animation,delete qu.animationiteration.animation,delete qu.animationstart.animation),"TransitionEvent"in window||delete qu.transitionend.transition);function mm(e){if(my[e])return my[e];if(!qu[e])return e;var n=qu[e],o;for(o in n)if(n.hasOwnProperty(o)&&o in c2)return my[e]=n[o];return e}var h2=mm("animationend"),d2=mm("animationiteration"),f2=mm("animationstart"),p2=mm("transitionend"),m2=new Map,Aw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $a(e,n){m2.set(e,n),Vl(n,[e])}for(var gy=0;gy<Aw.length;gy++){var yy=Aw[gy],$P=yy.toLowerCase(),UP=yy[0].toUpperCase()+yy.slice(1);$a($P,"on"+UP)}$a(h2,"onAnimationEnd");$a(d2,"onAnimationIteration");$a(f2,"onAnimationStart");$a("dblclick","onDoubleClick");$a("focusin","onFocus");$a("focusout","onBlur");$a(p2,"onTransitionEnd");pc("onMouseEnter",["mouseout","mouseover"]);pc("onMouseLeave",["mouseout","mouseover"]);pc("onPointerEnter",["pointerout","pointerover"]);pc("onPointerLeave",["pointerout","pointerover"]);Vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yh));function Mw(e,n,o){var u=e.type||"unknown-event";e.currentTarget=o,$k(u,n,void 0,e),e.currentTarget=null}function g2(e,n){n=(n&4)!==0;for(var o=0;o<e.length;o++){var u=e[o],p=u.event;u=u.listeners;e:{var x=void 0;if(n)for(var v=u.length-1;0<=v;v--){var c=u[v],k=c.instance,A=c.currentTarget;if(c=c.listener,k!==x&&p.isPropagationStopped())break e;Mw(p,c,A),x=k}else for(v=0;v<u.length;v++){if(c=u[v],k=c.instance,A=c.currentTarget,c=c.listener,k!==x&&p.isPropagationStopped())break e;Mw(p,c,A),x=k}}}if(Fp)throw e=Jy,Fp=!1,Jy=null,e}function xr(e,n){var o=n[l_];o===void 0&&(o=n[l_]=new Set);var u=e+"__bubble";o.has(u)||(y2(n,e,2,!1),o.add(u))}function _y(e,n,o){var u=0;n&&(u|=4),y2(o,e,u,n)}var ip="_reactListening"+Math.random().toString(36).slice(2);function gd(e){if(!e[ip]){e[ip]=!0,T1.forEach(function(o){o!=="selectionchange"&&(qP.has(o)||_y(o,!1,e),_y(o,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[ip]||(n[ip]=!0,_y("selectionchange",!1,n))}}function y2(e,n,o,u){switch(e2(n)){case 1:var p=iP;break;case 4:p=sP;break;default:p=mv}o=p.bind(null,n,o,e),p=void 0,!Yy||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(p=!0),u?p!==void 0?e.addEventListener(n,o,{capture:!0,passive:p}):e.addEventListener(n,o,!0):p!==void 0?e.addEventListener(n,o,{passive:p}):e.addEventListener(n,o,!1)}function vy(e,n,o,u,p){var x=u;if(!(n&1)&&!(n&2)&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var c=u.stateNode.containerInfo;if(c===p||c.nodeType===8&&c.parentNode===p)break;if(v===4)for(v=u.return;v!==null;){var k=v.tag;if((k===3||k===4)&&(k=v.stateNode.containerInfo,k===p||k.nodeType===8&&k.parentNode===p))return;v=v.return}for(;c!==null;){if(v=wl(c),v===null)return;if(k=v.tag,k===5||k===6){u=x=v;continue e}c=c.parentNode}}u=u.return}j1(function(){var A=x,B=hv(o),R=[];e:{var L=m2.get(e);if(L!==void 0){var $=yv,le=e;switch(e){case"keypress":if(bp(o)===0)break e;case"keydown":case"keyup":$=xP;break;case"focusin":le="focus",$=dy;break;case"focusout":le="blur",$=dy;break;case"beforeblur":case"afterblur":$=dy;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$=vw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$=lP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$=SP;break;case h2:case d2:case f2:$=hP;break;case p2:$=EP;break;case"scroll":$=oP;break;case"wheel":$=kP;break;case"copy":case"cut":case"paste":$=fP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$=ww}var Q=(n&4)!==0,se=!Q&&e==="scroll",W=Q?L!==null?L+"Capture":null:L;Q=[];for(var G=A,K;G!==null;){K=G;var he=K.stateNode;if(K.tag===5&&he!==null&&(K=he,W!==null&&(he=cd(G,W),he!=null&&Q.push(yd(G,he,K)))),se)break;G=G.return}0<Q.length&&(L=new $(L,le,null,o,B),R.push({event:L,listeners:Q}))}}if(!(n&7)){e:{if(L=e==="mouseover"||e==="pointerover",$=e==="mouseout"||e==="pointerout",L&&o!==Xy&&(le=o.relatedTarget||o.fromElement)&&(wl(le)||le[Co]))break e;if(($||L)&&(L=B.window===B?B:(L=B.ownerDocument)?L.defaultView||L.parentWindow:window,$?(le=o.relatedTarget||o.toElement,$=A,le=le?wl(le):null,le!==null&&(se=$l(le),le!==se||le.tag!==5&&le.tag!==6)&&(le=null)):($=null,le=A),$!==le)){if(Q=vw,he="onMouseLeave",W="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&(Q=ww,he="onPointerLeave",W="onPointerEnter",G="pointer"),se=$==null?L:Zu($),K=le==null?L:Zu(le),L=new Q(he,G+"leave",$,o,B),L.target=se,L.relatedTarget=K,he=null,wl(B)===A&&(Q=new Q(W,G+"enter",le,o,B),Q.target=K,Q.relatedTarget=se,he=Q),se=he,$&&le)t:{for(Q=$,W=le,G=0,K=Q;K;K=Bu(K))G++;for(K=0,he=W;he;he=Bu(he))K++;for(;0<G-K;)Q=Bu(Q),G--;for(;0<K-G;)W=Bu(W),K--;for(;G--;){if(Q===W||W!==null&&Q===W.alternate)break t;Q=Bu(Q),W=Bu(W)}Q=null}else Q=null;$!==null&&zw(R,L,$,Q,!1),le!==null&&se!==null&&zw(R,se,le,Q,!0)}}e:{if(L=A?Zu(A):window,$=L.nodeName&&L.nodeName.toLowerCase(),$==="select"||$==="input"&&L.type==="file")var be=RP;else if(Tw(L))if(o2)be=BP;else{be=FP;var ke=LP}else($=L.nodeName)&&$.toLowerCase()==="input"&&(L.type==="checkbox"||L.type==="radio")&&(be=OP);if(be&&(be=be(e,A))){s2(R,be,o,B);break e}ke&&ke(e,L,A),e==="focusout"&&(ke=L._wrapperState)&&ke.controlled&&L.type==="number"&&qy(L,"number",L.value)}switch(ke=A?Zu(A):window,e){case"focusin":(Tw(ke)||ke.contentEditable==="true")&&(Uu=ke,r_=A,rd=null);break;case"focusout":rd=r_=Uu=null;break;case"mousedown":n_=!0;break;case"contextmenu":case"mouseup":case"dragend":n_=!1,Iw(R,o,B);break;case"selectionchange":if(VP)break;case"keydown":case"keyup":Iw(R,o,B)}var Pe;if(vv)e:{switch(e){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else $u?n2(e,o)&&(Fe="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Fe="onCompositionStart");Fe&&(r2&&o.locale!=="ko"&&($u||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&$u&&(Pe=t2()):(Ea=B,gv="value"in Ea?Ea.value:Ea.textContent,$u=!0)),ke=Vp(A,Fe),0<ke.length&&(Fe=new xw(Fe,e,null,o,B),R.push({event:Fe,listeners:ke}),Pe?Fe.data=Pe:(Pe=i2(o),Pe!==null&&(Fe.data=Pe)))),(Pe=IP?AP(e,o):MP(e,o))&&(A=Vp(A,"onBeforeInput"),0<A.length&&(B=new xw("onBeforeInput","beforeinput",null,o,B),R.push({event:B,listeners:A}),B.data=Pe))}g2(R,n)})}function yd(e,n,o){return{instance:e,listener:n,currentTarget:o}}function Vp(e,n){for(var o=n+"Capture",u=[];e!==null;){var p=e,x=p.stateNode;p.tag===5&&x!==null&&(p=x,x=cd(e,o),x!=null&&u.unshift(yd(e,x,p)),x=cd(e,n),x!=null&&u.push(yd(e,x,p))),e=e.return}return u}function Bu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function zw(e,n,o,u,p){for(var x=n._reactName,v=[];o!==null&&o!==u;){var c=o,k=c.alternate,A=c.stateNode;if(k!==null&&k===u)break;c.tag===5&&A!==null&&(c=A,p?(k=cd(o,x),k!=null&&v.unshift(yd(o,k,c))):p||(k=cd(o,x),k!=null&&v.push(yd(o,k,c)))),o=o.return}v.length!==0&&e.push({event:n,listeners:v})}var ZP=/\r\n?/g,HP=/\u0000|\uFFFD/g;function Dw(e){return(typeof e=="string"?e:""+e).replace(ZP,`
`).replace(HP,"")}function sp(e,n,o){if(n=Dw(n),Dw(e)!==n&&o)throw Error(Ve(425))}function $p(){}var i_=null,s_=null;function o_(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var a_=typeof setTimeout=="function"?setTimeout:void 0,GP=typeof clearTimeout=="function"?clearTimeout:void 0,Rw=typeof Promise=="function"?Promise:void 0,WP=typeof queueMicrotask=="function"?queueMicrotask:typeof Rw<"u"?function(e){return Rw.resolve(null).then(e).catch(XP)}:a_;function XP(e){setTimeout(function(){throw e})}function xy(e,n){var o=n,u=0;do{var p=o.nextSibling;if(e.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(u===0){e.removeChild(p),fd(n);return}u--}else o!=="$"&&o!=="$?"&&o!=="$!"||u++;o=p}while(o);fd(n)}function Ma(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Lw(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return e;n--}else o==="/$"&&n++}e=e.previousSibling}return null}var Ec=Math.random().toString(36).slice(2),Hs="__reactFiber$"+Ec,_d="__reactProps$"+Ec,Co="__reactContainer$"+Ec,l_="__reactEvents$"+Ec,KP="__reactListeners$"+Ec,YP="__reactHandles$"+Ec;function wl(e){var n=e[Hs];if(n)return n;for(var o=e.parentNode;o;){if(n=o[Co]||o[Hs]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(e=Lw(e);e!==null;){if(o=e[Hs])return o;e=Lw(e)}return n}e=o,o=e.parentNode}return null}function Od(e){return e=e[Hs]||e[Co],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ve(33))}function gm(e){return e[_d]||null}var u_=[],Hu=-1;function Ua(e){return{current:e}}function wr(e){0>Hu||(e.current=u_[Hu],u_[Hu]=null,Hu--)}function mr(e,n){Hu++,u_[Hu]=e.current,e.current=n}var Oa={},$n=Ua(Oa),bi=Ua(!1),Rl=Oa;function mc(e,n){var o=e.type.contextTypes;if(!o)return Oa;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===n)return u.__reactInternalMemoizedMaskedChildContext;var p={},x;for(x in o)p[x]=n[x];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=p),p}function Si(e){return e=e.childContextTypes,e!=null}function Up(){wr(bi),wr($n)}function Fw(e,n,o){if($n.current!==Oa)throw Error(Ve(168));mr($n,n),mr(bi,o)}function _2(e,n,o){var u=e.stateNode;if(n=n.childContextTypes,typeof u.getChildContext!="function")return o;u=u.getChildContext();for(var p in u)if(!(p in n))throw Error(Ve(108,Lk(e)||"Unknown",p));return Mr({},o,u)}function qp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Oa,Rl=$n.current,mr($n,e),mr(bi,bi.current),!0}function Ow(e,n,o){var u=e.stateNode;if(!u)throw Error(Ve(169));o?(e=_2(e,n,Rl),u.__reactInternalMemoizedMergedChildContext=e,wr(bi),wr($n),mr($n,e)):wr(bi),mr(bi,o)}var xo=null,ym=!1,wy=!1;function v2(e){xo===null?xo=[e]:xo.push(e)}function JP(e){ym=!0,v2(e)}function qa(){if(!wy&&xo!==null){wy=!0;var e=0,n=ar;try{var o=xo;for(ar=1;e<o.length;e++){var u=o[e];do u=u(!0);while(u!==null)}xo=null,ym=!1}catch(p){throw xo!==null&&(xo=xo.slice(e+1)),q1(dv,qa),p}finally{ar=n,wy=!1}}return null}var Gu=[],Wu=0,Zp=null,Hp=0,os=[],as=0,Ll=null,bo=1,So="";function vl(e,n){Gu[Wu++]=Hp,Gu[Wu++]=Zp,Zp=e,Hp=n}function x2(e,n,o){os[as++]=bo,os[as++]=So,os[as++]=Ll,Ll=e;var u=bo;e=So;var p=32-Cs(u)-1;u&=~(1<<p),o+=1;var x=32-Cs(n)+p;if(30<x){var v=p-p%5;x=(u&(1<<v)-1).toString(32),u>>=v,p-=v,bo=1<<32-Cs(n)+p|o<<p|u,So=x+e}else bo=1<<x|o<<p|u,So=e}function wv(e){e.return!==null&&(vl(e,1),x2(e,1,0))}function bv(e){for(;e===Zp;)Zp=Gu[--Wu],Gu[Wu]=null,Hp=Gu[--Wu],Gu[Wu]=null;for(;e===Ll;)Ll=os[--as],os[as]=null,So=os[--as],os[as]=null,bo=os[--as],os[as]=null}var Hi=null,Zi=null,Er=!1,Ts=null;function w2(e,n){var o=ls(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=e,n=e.deletions,n===null?(e.deletions=[o],e.flags|=16):n.push(o)}function Bw(e,n){switch(e.tag){case 5:var o=e.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Hi=e,Zi=Ma(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Hi=e,Zi=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=Ll!==null?{id:bo,overflow:So}:null,e.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=ls(18,null,null,0),o.stateNode=n,o.return=e,e.child=o,Hi=e,Zi=null,!0):!1;default:return!1}}function c_(e){return(e.mode&1)!==0&&(e.flags&128)===0}function h_(e){if(Er){var n=Zi;if(n){var o=n;if(!Bw(e,n)){if(c_(e))throw Error(Ve(418));n=Ma(o.nextSibling);var u=Hi;n&&Bw(e,n)?w2(u,o):(e.flags=e.flags&-4097|2,Er=!1,Hi=e)}}else{if(c_(e))throw Error(Ve(418));e.flags=e.flags&-4097|2,Er=!1,Hi=e}}}function Nw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Hi=e}function op(e){if(e!==Hi)return!1;if(!Er)return Nw(e),Er=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!o_(e.type,e.memoizedProps)),n&&(n=Zi)){if(c_(e))throw b2(),Error(Ve(418));for(;n;)w2(e,n),n=Ma(n.nextSibling)}if(Nw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ve(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(n===0){Zi=Ma(e.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}e=e.nextSibling}Zi=null}}else Zi=Hi?Ma(e.stateNode.nextSibling):null;return!0}function b2(){for(var e=Zi;e;)e=Ma(e.nextSibling)}function gc(){Zi=Hi=null,Er=!1}function Sv(e){Ts===null?Ts=[e]:Ts.push(e)}var QP=Mo.ReactCurrentBatchConfig;function Uh(e,n,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(Ve(309));var u=o.stateNode}if(!u)throw Error(Ve(147,e));var p=u,x=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===x?n.ref:(n=function(v){var c=p.refs;v===null?delete c[x]:c[x]=v},n._stringRef=x,n)}if(typeof e!="string")throw Error(Ve(284));if(!o._owner)throw Error(Ve(290,e))}return e}function ap(e,n){throw e=Object.prototype.toString.call(n),Error(Ve(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function jw(e){var n=e._init;return n(e._payload)}function S2(e){function n(W,G){if(e){var K=W.deletions;K===null?(W.deletions=[G],W.flags|=16):K.push(G)}}function o(W,G){if(!e)return null;for(;G!==null;)n(W,G),G=G.sibling;return null}function u(W,G){for(W=new Map;G!==null;)G.key!==null?W.set(G.key,G):W.set(G.index,G),G=G.sibling;return W}function p(W,G){return W=La(W,G),W.index=0,W.sibling=null,W}function x(W,G,K){return W.index=K,e?(K=W.alternate,K!==null?(K=K.index,K<G?(W.flags|=2,G):K):(W.flags|=2,G)):(W.flags|=1048576,G)}function v(W){return e&&W.alternate===null&&(W.flags|=2),W}function c(W,G,K,he){return G===null||G.tag!==6?(G=Py(K,W.mode,he),G.return=W,G):(G=p(G,K),G.return=W,G)}function k(W,G,K,he){var be=K.type;return be===Vu?B(W,G,K.props.children,he,K.key):G!==null&&(G.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===ma&&jw(be)===G.type)?(he=p(G,K.props),he.ref=Uh(W,G,K),he.return=W,he):(he=Ip(K.type,K.key,K.props,null,W.mode,he),he.ref=Uh(W,G,K),he.return=W,he)}function A(W,G,K,he){return G===null||G.tag!==4||G.stateNode.containerInfo!==K.containerInfo||G.stateNode.implementation!==K.implementation?(G=Iy(K,W.mode,he),G.return=W,G):(G=p(G,K.children||[]),G.return=W,G)}function B(W,G,K,he,be){return G===null||G.tag!==7?(G=Ml(K,W.mode,he,be),G.return=W,G):(G=p(G,K),G.return=W,G)}function R(W,G,K){if(typeof G=="string"&&G!==""||typeof G=="number")return G=Py(""+G,W.mode,K),G.return=W,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Kf:return K=Ip(G.type,G.key,G.props,null,W.mode,K),K.ref=Uh(W,null,G),K.return=W,K;case ju:return G=Iy(G,W.mode,K),G.return=W,G;case ma:var he=G._init;return R(W,he(G._payload),K)}if(Xh(G)||Bh(G))return G=Ml(G,W.mode,K,null),G.return=W,G;ap(W,G)}return null}function L(W,G,K,he){var be=G!==null?G.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return be!==null?null:c(W,G,""+K,he);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case Kf:return K.key===be?k(W,G,K,he):null;case ju:return K.key===be?A(W,G,K,he):null;case ma:return be=K._init,L(W,G,be(K._payload),he)}if(Xh(K)||Bh(K))return be!==null?null:B(W,G,K,he,null);ap(W,K)}return null}function $(W,G,K,he,be){if(typeof he=="string"&&he!==""||typeof he=="number")return W=W.get(K)||null,c(G,W,""+he,be);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case Kf:return W=W.get(he.key===null?K:he.key)||null,k(G,W,he,be);case ju:return W=W.get(he.key===null?K:he.key)||null,A(G,W,he,be);case ma:var ke=he._init;return $(W,G,K,ke(he._payload),be)}if(Xh(he)||Bh(he))return W=W.get(K)||null,B(G,W,he,be,null);ap(G,he)}return null}function le(W,G,K,he){for(var be=null,ke=null,Pe=G,Fe=G=0,st=null;Pe!==null&&Fe<K.length;Fe++){Pe.index>Fe?(st=Pe,Pe=null):st=Pe.sibling;var Be=L(W,Pe,K[Fe],he);if(Be===null){Pe===null&&(Pe=st);break}e&&Pe&&Be.alternate===null&&n(W,Pe),G=x(Be,G,Fe),ke===null?be=Be:ke.sibling=Be,ke=Be,Pe=st}if(Fe===K.length)return o(W,Pe),Er&&vl(W,Fe),be;if(Pe===null){for(;Fe<K.length;Fe++)Pe=R(W,K[Fe],he),Pe!==null&&(G=x(Pe,G,Fe),ke===null?be=Pe:ke.sibling=Pe,ke=Pe);return Er&&vl(W,Fe),be}for(Pe=u(W,Pe);Fe<K.length;Fe++)st=$(Pe,W,Fe,K[Fe],he),st!==null&&(e&&st.alternate!==null&&Pe.delete(st.key===null?Fe:st.key),G=x(st,G,Fe),ke===null?be=st:ke.sibling=st,ke=st);return e&&Pe.forEach(function(qe){return n(W,qe)}),Er&&vl(W,Fe),be}function Q(W,G,K,he){var be=Bh(K);if(typeof be!="function")throw Error(Ve(150));if(K=be.call(K),K==null)throw Error(Ve(151));for(var ke=be=null,Pe=G,Fe=G=0,st=null,Be=K.next();Pe!==null&&!Be.done;Fe++,Be=K.next()){Pe.index>Fe?(st=Pe,Pe=null):st=Pe.sibling;var qe=L(W,Pe,Be.value,he);if(qe===null){Pe===null&&(Pe=st);break}e&&Pe&&qe.alternate===null&&n(W,Pe),G=x(qe,G,Fe),ke===null?be=qe:ke.sibling=qe,ke=qe,Pe=st}if(Be.done)return o(W,Pe),Er&&vl(W,Fe),be;if(Pe===null){for(;!Be.done;Fe++,Be=K.next())Be=R(W,Be.value,he),Be!==null&&(G=x(Be,G,Fe),ke===null?be=Be:ke.sibling=Be,ke=Be);return Er&&vl(W,Fe),be}for(Pe=u(W,Pe);!Be.done;Fe++,Be=K.next())Be=$(Pe,W,Fe,Be.value,he),Be!==null&&(e&&Be.alternate!==null&&Pe.delete(Be.key===null?Fe:Be.key),G=x(Be,G,Fe),ke===null?be=Be:ke.sibling=Be,ke=Be);return e&&Pe.forEach(function(ot){return n(W,ot)}),Er&&vl(W,Fe),be}function se(W,G,K,he){if(typeof K=="object"&&K!==null&&K.type===Vu&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case Kf:e:{for(var be=K.key,ke=G;ke!==null;){if(ke.key===be){if(be=K.type,be===Vu){if(ke.tag===7){o(W,ke.sibling),G=p(ke,K.props.children),G.return=W,W=G;break e}}else if(ke.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===ma&&jw(be)===ke.type){o(W,ke.sibling),G=p(ke,K.props),G.ref=Uh(W,ke,K),G.return=W,W=G;break e}o(W,ke);break}else n(W,ke);ke=ke.sibling}K.type===Vu?(G=Ml(K.props.children,W.mode,he,K.key),G.return=W,W=G):(he=Ip(K.type,K.key,K.props,null,W.mode,he),he.ref=Uh(W,G,K),he.return=W,W=he)}return v(W);case ju:e:{for(ke=K.key;G!==null;){if(G.key===ke)if(G.tag===4&&G.stateNode.containerInfo===K.containerInfo&&G.stateNode.implementation===K.implementation){o(W,G.sibling),G=p(G,K.children||[]),G.return=W,W=G;break e}else{o(W,G);break}else n(W,G);G=G.sibling}G=Iy(K,W.mode,he),G.return=W,W=G}return v(W);case ma:return ke=K._init,se(W,G,ke(K._payload),he)}if(Xh(K))return le(W,G,K,he);if(Bh(K))return Q(W,G,K,he);ap(W,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,G!==null&&G.tag===6?(o(W,G.sibling),G=p(G,K),G.return=W,W=G):(o(W,G),G=Py(K,W.mode,he),G.return=W,W=G),v(W)):o(W,G)}return se}var yc=S2(!0),T2=S2(!1),Gp=Ua(null),Wp=null,Xu=null,Tv=null;function Ev(){Tv=Xu=Wp=null}function Cv(e){var n=Gp.current;wr(Gp),e._currentValue=n}function d_(e,n,o){for(;e!==null;){var u=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,u!==null&&(u.childLanes|=n)):u!==null&&(u.childLanes&n)!==n&&(u.childLanes|=n),e===o)break;e=e.return}}function rc(e,n){Wp=e,Tv=Xu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(wi=!0),e.firstContext=null)}function cs(e){var n=e._currentValue;if(Tv!==e)if(e={context:e,memoizedValue:n,next:null},Xu===null){if(Wp===null)throw Error(Ve(308));Xu=e,Wp.dependencies={lanes:0,firstContext:e}}else Xu=Xu.next=e;return n}var bl=null;function kv(e){bl===null?bl=[e]:bl.push(e)}function E2(e,n,o,u){var p=n.interleaved;return p===null?(o.next=o,kv(n)):(o.next=p.next,p.next=o),n.interleaved=o,ko(e,u)}function ko(e,n){e.lanes|=n;var o=e.alternate;for(o!==null&&(o.lanes|=n),o=e,e=e.return;e!==null;)e.childLanes|=n,o=e.alternate,o!==null&&(o.childLanes|=n),o=e,e=e.return;return o.tag===3?o.stateNode:null}var ga=!1;function Pv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function C2(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function To(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function za(e,n,o){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,Jt&2){var p=u.pending;return p===null?n.next=n:(n.next=p.next,p.next=n),u.pending=n,ko(e,o)}return p=u.interleaved,p===null?(n.next=n,kv(u)):(n.next=p.next,p.next=n),u.interleaved=n,ko(e,o)}function Sp(e,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var u=n.lanes;u&=e.pendingLanes,o|=u,n.lanes=o,fv(e,o)}}function Vw(e,n){var o=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var p=null,x=null;if(o=o.firstBaseUpdate,o!==null){do{var v={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};x===null?p=x=v:x=x.next=v,o=o.next}while(o!==null);x===null?p=x=n:x=x.next=n}else p=x=n;o={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:x,shared:u.shared,effects:u.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=n:e.next=n,o.lastBaseUpdate=n}function Xp(e,n,o,u){var p=e.updateQueue;ga=!1;var x=p.firstBaseUpdate,v=p.lastBaseUpdate,c=p.shared.pending;if(c!==null){p.shared.pending=null;var k=c,A=k.next;k.next=null,v===null?x=A:v.next=A,v=k;var B=e.alternate;B!==null&&(B=B.updateQueue,c=B.lastBaseUpdate,c!==v&&(c===null?B.firstBaseUpdate=A:c.next=A,B.lastBaseUpdate=k))}if(x!==null){var R=p.baseState;v=0,B=A=k=null,c=x;do{var L=c.lane,$=c.eventTime;if((u&L)===L){B!==null&&(B=B.next={eventTime:$,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var le=e,Q=c;switch(L=n,$=o,Q.tag){case 1:if(le=Q.payload,typeof le=="function"){R=le.call($,R,L);break e}R=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=Q.payload,L=typeof le=="function"?le.call($,R,L):le,L==null)break e;R=Mr({},R,L);break e;case 2:ga=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,L=p.effects,L===null?p.effects=[c]:L.push(c))}else $={eventTime:$,lane:L,tag:c.tag,payload:c.payload,callback:c.callback,next:null},B===null?(A=B=$,k=R):B=B.next=$,v|=L;if(c=c.next,c===null){if(c=p.shared.pending,c===null)break;L=c,c=L.next,L.next=null,p.lastBaseUpdate=L,p.shared.pending=null}}while(!0);if(B===null&&(k=R),p.baseState=k,p.firstBaseUpdate=A,p.lastBaseUpdate=B,n=p.shared.interleaved,n!==null){p=n;do v|=p.lane,p=p.next;while(p!==n)}else x===null&&(p.shared.lanes=0);Ol|=v,e.lanes=v,e.memoizedState=R}}function $w(e,n,o){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var u=e[n],p=u.callback;if(p!==null){if(u.callback=null,u=o,typeof p!="function")throw Error(Ve(191,p));p.call(u)}}}var Bd={},Xs=Ua(Bd),vd=Ua(Bd),xd=Ua(Bd);function Sl(e){if(e===Bd)throw Error(Ve(174));return e}function Iv(e,n){switch(mr(xd,n),mr(vd,e),mr(Xs,Bd),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Hy(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Hy(n,e)}wr(Xs),mr(Xs,n)}function _c(){wr(Xs),wr(vd),wr(xd)}function k2(e){Sl(xd.current);var n=Sl(Xs.current),o=Hy(n,e.type);n!==o&&(mr(vd,e),mr(Xs,o))}function Av(e){vd.current===e&&(wr(Xs),wr(vd))}var Ir=Ua(0);function Kp(e){for(var n=e;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var by=[];function Mv(){for(var e=0;e<by.length;e++)by[e]._workInProgressVersionPrimary=null;by.length=0}var Tp=Mo.ReactCurrentDispatcher,Sy=Mo.ReactCurrentBatchConfig,Fl=0,Ar=null,en=null,gn=null,Yp=!1,nd=!1,wd=0,eI=0;function Nn(){throw Error(Ve(321))}function zv(e,n){if(n===null)return!1;for(var o=0;o<n.length&&o<e.length;o++)if(!Ps(e[o],n[o]))return!1;return!0}function Dv(e,n,o,u,p,x){if(Fl=x,Ar=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Tp.current=e===null||e.memoizedState===null?iI:sI,e=o(u,p),nd){x=0;do{if(nd=!1,wd=0,25<=x)throw Error(Ve(301));x+=1,gn=en=null,n.updateQueue=null,Tp.current=oI,e=o(u,p)}while(nd)}if(Tp.current=Jp,n=en!==null&&en.next!==null,Fl=0,gn=en=Ar=null,Yp=!1,n)throw Error(Ve(300));return e}function Rv(){var e=wd!==0;return wd=0,e}function $s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?Ar.memoizedState=gn=e:gn=gn.next=e,gn}function hs(){if(en===null){var e=Ar.alternate;e=e!==null?e.memoizedState:null}else e=en.next;var n=gn===null?Ar.memoizedState:gn.next;if(n!==null)gn=n,en=e;else{if(e===null)throw Error(Ve(310));en=e,e={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},gn===null?Ar.memoizedState=gn=e:gn=gn.next=e}return gn}function bd(e,n){return typeof n=="function"?n(e):n}function Ty(e){var n=hs(),o=n.queue;if(o===null)throw Error(Ve(311));o.lastRenderedReducer=e;var u=en,p=u.baseQueue,x=o.pending;if(x!==null){if(p!==null){var v=p.next;p.next=x.next,x.next=v}u.baseQueue=p=x,o.pending=null}if(p!==null){x=p.next,u=u.baseState;var c=v=null,k=null,A=x;do{var B=A.lane;if((Fl&B)===B)k!==null&&(k=k.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),u=A.hasEagerState?A.eagerState:e(u,A.action);else{var R={lane:B,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};k===null?(c=k=R,v=u):k=k.next=R,Ar.lanes|=B,Ol|=B}A=A.next}while(A!==null&&A!==x);k===null?v=u:k.next=c,Ps(u,n.memoizedState)||(wi=!0),n.memoizedState=u,n.baseState=v,n.baseQueue=k,o.lastRenderedState=u}if(e=o.interleaved,e!==null){p=e;do x=p.lane,Ar.lanes|=x,Ol|=x,p=p.next;while(p!==e)}else p===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function Ey(e){var n=hs(),o=n.queue;if(o===null)throw Error(Ve(311));o.lastRenderedReducer=e;var u=o.dispatch,p=o.pending,x=n.memoizedState;if(p!==null){o.pending=null;var v=p=p.next;do x=e(x,v.action),v=v.next;while(v!==p);Ps(x,n.memoizedState)||(wi=!0),n.memoizedState=x,n.baseQueue===null&&(n.baseState=x),o.lastRenderedState=x}return[x,u]}function P2(){}function I2(e,n){var o=Ar,u=hs(),p=n(),x=!Ps(u.memoizedState,p);if(x&&(u.memoizedState=p,wi=!0),u=u.queue,Lv(z2.bind(null,o,u,e),[e]),u.getSnapshot!==n||x||gn!==null&&gn.memoizedState.tag&1){if(o.flags|=2048,Sd(9,M2.bind(null,o,u,p,n),void 0,null),yn===null)throw Error(Ve(349));Fl&30||A2(o,n,p)}return p}function A2(e,n,o){e.flags|=16384,e={getSnapshot:n,value:o},n=Ar.updateQueue,n===null?(n={lastEffect:null,stores:null},Ar.updateQueue=n,n.stores=[e]):(o=n.stores,o===null?n.stores=[e]:o.push(e))}function M2(e,n,o,u){n.value=o,n.getSnapshot=u,D2(n)&&R2(e)}function z2(e,n,o){return o(function(){D2(n)&&R2(e)})}function D2(e){var n=e.getSnapshot;e=e.value;try{var o=n();return!Ps(e,o)}catch{return!0}}function R2(e){var n=ko(e,1);n!==null&&ks(n,e,1,-1)}function Uw(e){var n=$s();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bd,lastRenderedState:e},n.queue=e,e=e.dispatch=nI.bind(null,Ar,e),[n.memoizedState,e]}function Sd(e,n,o,u){return e={tag:e,create:n,destroy:o,deps:u,next:null},n=Ar.updateQueue,n===null?(n={lastEffect:null,stores:null},Ar.updateQueue=n,n.lastEffect=e.next=e):(o=n.lastEffect,o===null?n.lastEffect=e.next=e:(u=o.next,o.next=e,e.next=u,n.lastEffect=e)),e}function L2(){return hs().memoizedState}function Ep(e,n,o,u){var p=$s();Ar.flags|=e,p.memoizedState=Sd(1|n,o,void 0,u===void 0?null:u)}function _m(e,n,o,u){var p=hs();u=u===void 0?null:u;var x=void 0;if(en!==null){var v=en.memoizedState;if(x=v.destroy,u!==null&&zv(u,v.deps)){p.memoizedState=Sd(n,o,x,u);return}}Ar.flags|=e,p.memoizedState=Sd(1|n,o,x,u)}function qw(e,n){return Ep(8390656,8,e,n)}function Lv(e,n){return _m(2048,8,e,n)}function F2(e,n){return _m(4,2,e,n)}function O2(e,n){return _m(4,4,e,n)}function B2(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function N2(e,n,o){return o=o!=null?o.concat([e]):null,_m(4,4,B2.bind(null,n,e),o)}function Fv(){}function j2(e,n){var o=hs();n=n===void 0?null:n;var u=o.memoizedState;return u!==null&&n!==null&&zv(n,u[1])?u[0]:(o.memoizedState=[e,n],e)}function V2(e,n){var o=hs();n=n===void 0?null:n;var u=o.memoizedState;return u!==null&&n!==null&&zv(n,u[1])?u[0]:(e=e(),o.memoizedState=[e,n],e)}function $2(e,n,o){return Fl&21?(Ps(o,n)||(o=G1(),Ar.lanes|=o,Ol|=o,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,wi=!0),e.memoizedState=o)}function tI(e,n){var o=ar;ar=o!==0&&4>o?o:4,e(!0);var u=Sy.transition;Sy.transition={};try{e(!1),n()}finally{ar=o,Sy.transition=u}}function U2(){return hs().memoizedState}function rI(e,n,o){var u=Ra(e);if(o={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null},q2(e))Z2(n,o);else if(o=E2(e,n,o,u),o!==null){var p=ni();ks(o,e,u,p),H2(o,n,u)}}function nI(e,n,o){var u=Ra(e),p={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null};if(q2(e))Z2(n,p);else{var x=e.alternate;if(e.lanes===0&&(x===null||x.lanes===0)&&(x=n.lastRenderedReducer,x!==null))try{var v=n.lastRenderedState,c=x(v,o);if(p.hasEagerState=!0,p.eagerState=c,Ps(c,v)){var k=n.interleaved;k===null?(p.next=p,kv(n)):(p.next=k.next,k.next=p),n.interleaved=p;return}}catch{}finally{}o=E2(e,n,p,u),o!==null&&(p=ni(),ks(o,e,u,p),H2(o,n,u))}}function q2(e){var n=e.alternate;return e===Ar||n!==null&&n===Ar}function Z2(e,n){nd=Yp=!0;var o=e.pending;o===null?n.next=n:(n.next=o.next,o.next=n),e.pending=n}function H2(e,n,o){if(o&4194240){var u=n.lanes;u&=e.pendingLanes,o|=u,n.lanes=o,fv(e,o)}}var Jp={readContext:cs,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},iI={readContext:cs,useCallback:function(e,n){return $s().memoizedState=[e,n===void 0?null:n],e},useContext:cs,useEffect:qw,useImperativeHandle:function(e,n,o){return o=o!=null?o.concat([e]):null,Ep(4194308,4,B2.bind(null,n,e),o)},useLayoutEffect:function(e,n){return Ep(4194308,4,e,n)},useInsertionEffect:function(e,n){return Ep(4,2,e,n)},useMemo:function(e,n){var o=$s();return n=n===void 0?null:n,e=e(),o.memoizedState=[e,n],e},useReducer:function(e,n,o){var u=$s();return n=o!==void 0?o(n):n,u.memoizedState=u.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},u.queue=e,e=e.dispatch=rI.bind(null,Ar,e),[u.memoizedState,e]},useRef:function(e){var n=$s();return e={current:e},n.memoizedState=e},useState:Uw,useDebugValue:Fv,useDeferredValue:function(e){return $s().memoizedState=e},useTransition:function(){var e=Uw(!1),n=e[0];return e=tI.bind(null,e[1]),$s().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,o){var u=Ar,p=$s();if(Er){if(o===void 0)throw Error(Ve(407));o=o()}else{if(o=n(),yn===null)throw Error(Ve(349));Fl&30||A2(u,n,o)}p.memoizedState=o;var x={value:o,getSnapshot:n};return p.queue=x,qw(z2.bind(null,u,x,e),[e]),u.flags|=2048,Sd(9,M2.bind(null,u,x,o,n),void 0,null),o},useId:function(){var e=$s(),n=yn.identifierPrefix;if(Er){var o=So,u=bo;o=(u&~(1<<32-Cs(u)-1)).toString(32)+o,n=":"+n+"R"+o,o=wd++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=eI++,n=":"+n+"r"+o.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},sI={readContext:cs,useCallback:j2,useContext:cs,useEffect:Lv,useImperativeHandle:N2,useInsertionEffect:F2,useLayoutEffect:O2,useMemo:V2,useReducer:Ty,useRef:L2,useState:function(){return Ty(bd)},useDebugValue:Fv,useDeferredValue:function(e){var n=hs();return $2(n,en.memoizedState,e)},useTransition:function(){var e=Ty(bd)[0],n=hs().memoizedState;return[e,n]},useMutableSource:P2,useSyncExternalStore:I2,useId:U2,unstable_isNewReconciler:!1},oI={readContext:cs,useCallback:j2,useContext:cs,useEffect:Lv,useImperativeHandle:N2,useInsertionEffect:F2,useLayoutEffect:O2,useMemo:V2,useReducer:Ey,useRef:L2,useState:function(){return Ey(bd)},useDebugValue:Fv,useDeferredValue:function(e){var n=hs();return en===null?n.memoizedState=e:$2(n,en.memoizedState,e)},useTransition:function(){var e=Ey(bd)[0],n=hs().memoizedState;return[e,n]},useMutableSource:P2,useSyncExternalStore:I2,useId:U2,unstable_isNewReconciler:!1};function vs(e,n){if(e&&e.defaultProps){n=Mr({},n),e=e.defaultProps;for(var o in e)n[o]===void 0&&(n[o]=e[o]);return n}return n}function f_(e,n,o,u){n=e.memoizedState,o=o(u,n),o=o==null?n:Mr({},n,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var vm={isMounted:function(e){return(e=e._reactInternals)?$l(e)===e:!1},enqueueSetState:function(e,n,o){e=e._reactInternals;var u=ni(),p=Ra(e),x=To(u,p);x.payload=n,o!=null&&(x.callback=o),n=za(e,x,p),n!==null&&(ks(n,e,p,u),Sp(n,e,p))},enqueueReplaceState:function(e,n,o){e=e._reactInternals;var u=ni(),p=Ra(e),x=To(u,p);x.tag=1,x.payload=n,o!=null&&(x.callback=o),n=za(e,x,p),n!==null&&(ks(n,e,p,u),Sp(n,e,p))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var o=ni(),u=Ra(e),p=To(o,u);p.tag=2,n!=null&&(p.callback=n),n=za(e,p,u),n!==null&&(ks(n,e,u,o),Sp(n,e,u))}};function Zw(e,n,o,u,p,x,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,x,v):n.prototype&&n.prototype.isPureReactComponent?!md(o,u)||!md(p,x):!0}function G2(e,n,o){var u=!1,p=Oa,x=n.contextType;return typeof x=="object"&&x!==null?x=cs(x):(p=Si(n)?Rl:$n.current,u=n.contextTypes,x=(u=u!=null)?mc(e,p):Oa),n=new n(o,x),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=vm,e.stateNode=n,n._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=p,e.__reactInternalMemoizedMaskedChildContext=x),n}function Hw(e,n,o,u){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,u),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,u),n.state!==e&&vm.enqueueReplaceState(n,n.state,null)}function p_(e,n,o,u){var p=e.stateNode;p.props=o,p.state=e.memoizedState,p.refs={},Pv(e);var x=n.contextType;typeof x=="object"&&x!==null?p.context=cs(x):(x=Si(n)?Rl:$n.current,p.context=mc(e,x)),p.state=e.memoizedState,x=n.getDerivedStateFromProps,typeof x=="function"&&(f_(e,n,x,o),p.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(n=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),n!==p.state&&vm.enqueueReplaceState(p,p.state,null),Xp(e,o,p,u),p.state=e.memoizedState),typeof p.componentDidMount=="function"&&(e.flags|=4194308)}function vc(e,n){try{var o="",u=n;do o+=Rk(u),u=u.return;while(u);var p=o}catch(x){p=`
Error generating stack: `+x.message+`
`+x.stack}return{value:e,source:n,stack:p,digest:null}}function Cy(e,n,o){return{value:e,source:null,stack:o??null,digest:n??null}}function m_(e,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var aI=typeof WeakMap=="function"?WeakMap:Map;function W2(e,n,o){o=To(-1,o),o.tag=3,o.payload={element:null};var u=n.value;return o.callback=function(){em||(em=!0,E_=u),m_(e,n)},o}function X2(e,n,o){o=To(-1,o),o.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var p=n.value;o.payload=function(){return u(p)},o.callback=function(){m_(e,n)}}var x=e.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(o.callback=function(){m_(e,n),typeof u!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var v=n.stack;this.componentDidCatch(n.value,{componentStack:v!==null?v:""})}),o}function Gw(e,n,o){var u=e.pingCache;if(u===null){u=e.pingCache=new aI;var p=new Set;u.set(n,p)}else p=u.get(n),p===void 0&&(p=new Set,u.set(n,p));p.has(o)||(p.add(o),e=wI.bind(null,e,n,o),n.then(e,e))}function Ww(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function Xw(e,n,o,u,p){return e.mode&1?(e.flags|=65536,e.lanes=p,e):(e===n?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=To(-1,1),n.tag=2,za(o,n,1))),o.lanes|=1),e)}var lI=Mo.ReactCurrentOwner,wi=!1;function ti(e,n,o,u){n.child=e===null?T2(n,null,o,u):yc(n,e.child,o,u)}function Kw(e,n,o,u,p){o=o.render;var x=n.ref;return rc(n,p),u=Dv(e,n,o,u,x,p),o=Rv(),e!==null&&!wi?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~p,Po(e,n,p)):(Er&&o&&wv(n),n.flags|=1,ti(e,n,u,p),n.child)}function Yw(e,n,o,u,p){if(e===null){var x=o.type;return typeof x=="function"&&!qv(x)&&x.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=x,K2(e,n,x,u,p)):(e=Ip(o.type,null,u,n,n.mode,p),e.ref=n.ref,e.return=n,n.child=e)}if(x=e.child,!(e.lanes&p)){var v=x.memoizedProps;if(o=o.compare,o=o!==null?o:md,o(v,u)&&e.ref===n.ref)return Po(e,n,p)}return n.flags|=1,e=La(x,u),e.ref=n.ref,e.return=n,n.child=e}function K2(e,n,o,u,p){if(e!==null){var x=e.memoizedProps;if(md(x,u)&&e.ref===n.ref)if(wi=!1,n.pendingProps=u=x,(e.lanes&p)!==0)e.flags&131072&&(wi=!0);else return n.lanes=e.lanes,Po(e,n,p)}return g_(e,n,o,u,p)}function Y2(e,n,o){var u=n.pendingProps,p=u.children,x=e!==null?e.memoizedState:null;if(u.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},mr(Yu,Ui),Ui|=o;else{if(!(o&1073741824))return e=x!==null?x.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,mr(Yu,Ui),Ui|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=x!==null?x.baseLanes:o,mr(Yu,Ui),Ui|=u}else x!==null?(u=x.baseLanes|o,n.memoizedState=null):u=o,mr(Yu,Ui),Ui|=u;return ti(e,n,p,o),n.child}function J2(e,n){var o=n.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function g_(e,n,o,u,p){var x=Si(o)?Rl:$n.current;return x=mc(n,x),rc(n,p),o=Dv(e,n,o,u,x,p),u=Rv(),e!==null&&!wi?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~p,Po(e,n,p)):(Er&&u&&wv(n),n.flags|=1,ti(e,n,o,p),n.child)}function Jw(e,n,o,u,p){if(Si(o)){var x=!0;qp(n)}else x=!1;if(rc(n,p),n.stateNode===null)Cp(e,n),G2(n,o,u),p_(n,o,u,p),u=!0;else if(e===null){var v=n.stateNode,c=n.memoizedProps;v.props=c;var k=v.context,A=o.contextType;typeof A=="object"&&A!==null?A=cs(A):(A=Si(o)?Rl:$n.current,A=mc(n,A));var B=o.getDerivedStateFromProps,R=typeof B=="function"||typeof v.getSnapshotBeforeUpdate=="function";R||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==u||k!==A)&&Hw(n,v,u,A),ga=!1;var L=n.memoizedState;v.state=L,Xp(n,u,v,p),k=n.memoizedState,c!==u||L!==k||bi.current||ga?(typeof B=="function"&&(f_(n,o,B,u),k=n.memoizedState),(c=ga||Zw(n,o,c,u,L,k,A))?(R||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(n.flags|=4194308)):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=u,n.memoizedState=k),v.props=u,v.state=k,v.context=A,u=c):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),u=!1)}else{v=n.stateNode,C2(e,n),c=n.memoizedProps,A=n.type===n.elementType?c:vs(n.type,c),v.props=A,R=n.pendingProps,L=v.context,k=o.contextType,typeof k=="object"&&k!==null?k=cs(k):(k=Si(o)?Rl:$n.current,k=mc(n,k));var $=o.getDerivedStateFromProps;(B=typeof $=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(c!==R||L!==k)&&Hw(n,v,u,k),ga=!1,L=n.memoizedState,v.state=L,Xp(n,u,v,p);var le=n.memoizedState;c!==R||L!==le||bi.current||ga?(typeof $=="function"&&(f_(n,o,$,u),le=n.memoizedState),(A=ga||Zw(n,o,A,u,L,le,k)||!1)?(B||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,le,k),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,le,k)),typeof v.componentDidUpdate=="function"&&(n.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof v.componentDidUpdate!="function"||c===e.memoizedProps&&L===e.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&L===e.memoizedState||(n.flags|=1024),n.memoizedProps=u,n.memoizedState=le),v.props=u,v.state=le,v.context=k,u=A):(typeof v.componentDidUpdate!="function"||c===e.memoizedProps&&L===e.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&L===e.memoizedState||(n.flags|=1024),u=!1)}return y_(e,n,o,u,x,p)}function y_(e,n,o,u,p,x){J2(e,n);var v=(n.flags&128)!==0;if(!u&&!v)return p&&Ow(n,o,!1),Po(e,n,x);u=n.stateNode,lI.current=n;var c=v&&typeof o.getDerivedStateFromError!="function"?null:u.render();return n.flags|=1,e!==null&&v?(n.child=yc(n,e.child,null,x),n.child=yc(n,null,c,x)):ti(e,n,c,x),n.memoizedState=u.state,p&&Ow(n,o,!0),n.child}function Q2(e){var n=e.stateNode;n.pendingContext?Fw(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Fw(e,n.context,!1),Iv(e,n.containerInfo)}function Qw(e,n,o,u,p){return gc(),Sv(p),n.flags|=256,ti(e,n,o,u),n.child}var __={dehydrated:null,treeContext:null,retryLane:0};function v_(e){return{baseLanes:e,cachePool:null,transitions:null}}function eS(e,n,o){var u=n.pendingProps,p=Ir.current,x=!1,v=(n.flags&128)!==0,c;if((c=v)||(c=e!==null&&e.memoizedState===null?!1:(p&2)!==0),c?(x=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(p|=1),mr(Ir,p&1),e===null)return h_(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(v=u.children,e=u.fallback,x?(u=n.mode,x=n.child,v={mode:"hidden",children:v},!(u&1)&&x!==null?(x.childLanes=0,x.pendingProps=v):x=bm(v,u,0,null),e=Ml(e,u,o,null),x.return=n,e.return=n,x.sibling=e,n.child=x,n.child.memoizedState=v_(o),n.memoizedState=__,e):Ov(n,v));if(p=e.memoizedState,p!==null&&(c=p.dehydrated,c!==null))return uI(e,n,v,u,c,p,o);if(x){x=u.fallback,v=n.mode,p=e.child,c=p.sibling;var k={mode:"hidden",children:u.children};return!(v&1)&&n.child!==p?(u=n.child,u.childLanes=0,u.pendingProps=k,n.deletions=null):(u=La(p,k),u.subtreeFlags=p.subtreeFlags&14680064),c!==null?x=La(c,x):(x=Ml(x,v,o,null),x.flags|=2),x.return=n,u.return=n,u.sibling=x,n.child=u,u=x,x=n.child,v=e.child.memoizedState,v=v===null?v_(o):{baseLanes:v.baseLanes|o,cachePool:null,transitions:v.transitions},x.memoizedState=v,x.childLanes=e.childLanes&~o,n.memoizedState=__,u}return x=e.child,e=x.sibling,u=La(x,{mode:"visible",children:u.children}),!(n.mode&1)&&(u.lanes=o),u.return=n,u.sibling=null,e!==null&&(o=n.deletions,o===null?(n.deletions=[e],n.flags|=16):o.push(e)),n.child=u,n.memoizedState=null,u}function Ov(e,n){return n=bm({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function lp(e,n,o,u){return u!==null&&Sv(u),yc(n,e.child,null,o),e=Ov(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function uI(e,n,o,u,p,x,v){if(o)return n.flags&256?(n.flags&=-257,u=Cy(Error(Ve(422))),lp(e,n,v,u)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(x=u.fallback,p=n.mode,u=bm({mode:"visible",children:u.children},p,0,null),x=Ml(x,p,v,null),x.flags|=2,u.return=n,x.return=n,u.sibling=x,n.child=u,n.mode&1&&yc(n,e.child,null,v),n.child.memoizedState=v_(v),n.memoizedState=__,x);if(!(n.mode&1))return lp(e,n,v,null);if(p.data==="$!"){if(u=p.nextSibling&&p.nextSibling.dataset,u)var c=u.dgst;return u=c,x=Error(Ve(419)),u=Cy(x,u,void 0),lp(e,n,v,u)}if(c=(v&e.childLanes)!==0,wi||c){if(u=yn,u!==null){switch(v&-v){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=p&(u.suspendedLanes|v)?0:p,p!==0&&p!==x.retryLane&&(x.retryLane=p,ko(e,p),ks(u,e,p,-1))}return Uv(),u=Cy(Error(Ve(421))),lp(e,n,v,u)}return p.data==="$?"?(n.flags|=128,n.child=e.child,n=bI.bind(null,e),p._reactRetry=n,null):(e=x.treeContext,Zi=Ma(p.nextSibling),Hi=n,Er=!0,Ts=null,e!==null&&(os[as++]=bo,os[as++]=So,os[as++]=Ll,bo=e.id,So=e.overflow,Ll=n),n=Ov(n,u.children),n.flags|=4096,n)}function eb(e,n,o){e.lanes|=n;var u=e.alternate;u!==null&&(u.lanes|=n),d_(e.return,n,o)}function ky(e,n,o,u,p){var x=e.memoizedState;x===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:p}:(x.isBackwards=n,x.rendering=null,x.renderingStartTime=0,x.last=u,x.tail=o,x.tailMode=p)}function tS(e,n,o){var u=n.pendingProps,p=u.revealOrder,x=u.tail;if(ti(e,n,u.children,o),u=Ir.current,u&2)u=u&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&eb(e,o,n);else if(e.tag===19)eb(e,o,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(mr(Ir,u),!(n.mode&1))n.memoizedState=null;else switch(p){case"forwards":for(o=n.child,p=null;o!==null;)e=o.alternate,e!==null&&Kp(e)===null&&(p=o),o=o.sibling;o=p,o===null?(p=n.child,n.child=null):(p=o.sibling,o.sibling=null),ky(n,!1,p,o,x);break;case"backwards":for(o=null,p=n.child,n.child=null;p!==null;){if(e=p.alternate,e!==null&&Kp(e)===null){n.child=p;break}e=p.sibling,p.sibling=o,o=p,p=e}ky(n,!0,o,null,x);break;case"together":ky(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Cp(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Po(e,n,o){if(e!==null&&(n.dependencies=e.dependencies),Ol|=n.lanes,!(o&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(Ve(153));if(n.child!==null){for(e=n.child,o=La(e,e.pendingProps),n.child=o,o.return=n;e.sibling!==null;)e=e.sibling,o=o.sibling=La(e,e.pendingProps),o.return=n;o.sibling=null}return n.child}function cI(e,n,o){switch(n.tag){case 3:Q2(n),gc();break;case 5:k2(n);break;case 1:Si(n.type)&&qp(n);break;case 4:Iv(n,n.stateNode.containerInfo);break;case 10:var u=n.type._context,p=n.memoizedProps.value;mr(Gp,u._currentValue),u._currentValue=p;break;case 13:if(u=n.memoizedState,u!==null)return u.dehydrated!==null?(mr(Ir,Ir.current&1),n.flags|=128,null):o&n.child.childLanes?eS(e,n,o):(mr(Ir,Ir.current&1),e=Po(e,n,o),e!==null?e.sibling:null);mr(Ir,Ir.current&1);break;case 19:if(u=(o&n.childLanes)!==0,e.flags&128){if(u)return tS(e,n,o);n.flags|=128}if(p=n.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),mr(Ir,Ir.current),u)break;return null;case 22:case 23:return n.lanes=0,Y2(e,n,o)}return Po(e,n,o)}var rS,x_,nS,iS;rS=function(e,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};x_=function(){};nS=function(e,n,o,u){var p=e.memoizedProps;if(p!==u){e=n.stateNode,Sl(Xs.current);var x=null;switch(o){case"input":p=$y(e,p),u=$y(e,u),x=[];break;case"select":p=Mr({},p,{value:void 0}),u=Mr({},u,{value:void 0}),x=[];break;case"textarea":p=Zy(e,p),u=Zy(e,u),x=[];break;default:typeof p.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=$p)}Gy(o,u);var v;o=null;for(A in p)if(!u.hasOwnProperty(A)&&p.hasOwnProperty(A)&&p[A]!=null)if(A==="style"){var c=p[A];for(v in c)c.hasOwnProperty(v)&&(o||(o={}),o[v]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(ld.hasOwnProperty(A)?x||(x=[]):(x=x||[]).push(A,null));for(A in u){var k=u[A];if(c=p!=null?p[A]:void 0,u.hasOwnProperty(A)&&k!==c&&(k!=null||c!=null))if(A==="style")if(c){for(v in c)!c.hasOwnProperty(v)||k&&k.hasOwnProperty(v)||(o||(o={}),o[v]="");for(v in k)k.hasOwnProperty(v)&&c[v]!==k[v]&&(o||(o={}),o[v]=k[v])}else o||(x||(x=[]),x.push(A,o)),o=k;else A==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,c=c?c.__html:void 0,k!=null&&c!==k&&(x=x||[]).push(A,k)):A==="children"?typeof k!="string"&&typeof k!="number"||(x=x||[]).push(A,""+k):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(ld.hasOwnProperty(A)?(k!=null&&A==="onScroll"&&xr("scroll",e),x||c===k||(x=[])):(x=x||[]).push(A,k))}o&&(x=x||[]).push("style",o);var A=x;(n.updateQueue=A)&&(n.flags|=4)}};iS=function(e,n,o,u){o!==u&&(n.flags|=4)};function qh(e,n){if(!Er)switch(e.tailMode){case"hidden":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function jn(e){var n=e.alternate!==null&&e.alternate.child===e.child,o=0,u=0;if(n)for(var p=e.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags&14680064,u|=p.flags&14680064,p.return=e,p=p.sibling;else for(p=e.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=e,p=p.sibling;return e.subtreeFlags|=u,e.childLanes=o,n}function hI(e,n,o){var u=n.pendingProps;switch(bv(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(n),null;case 1:return Si(n.type)&&Up(),jn(n),null;case 3:return u=n.stateNode,_c(),wr(bi),wr($n),Mv(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(op(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Ts!==null&&(P_(Ts),Ts=null))),x_(e,n),jn(n),null;case 5:Av(n);var p=Sl(xd.current);if(o=n.type,e!==null&&n.stateNode!=null)nS(e,n,o,u,p),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!u){if(n.stateNode===null)throw Error(Ve(166));return jn(n),null}if(e=Sl(Xs.current),op(n)){u=n.stateNode,o=n.type;var x=n.memoizedProps;switch(u[Hs]=n,u[_d]=x,e=(n.mode&1)!==0,o){case"dialog":xr("cancel",u),xr("close",u);break;case"iframe":case"object":case"embed":xr("load",u);break;case"video":case"audio":for(p=0;p<Yh.length;p++)xr(Yh[p],u);break;case"source":xr("error",u);break;case"img":case"image":case"link":xr("error",u),xr("load",u);break;case"details":xr("toggle",u);break;case"input":uw(u,x),xr("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!x.multiple},xr("invalid",u);break;case"textarea":hw(u,x),xr("invalid",u)}Gy(o,x),p=null;for(var v in x)if(x.hasOwnProperty(v)){var c=x[v];v==="children"?typeof c=="string"?u.textContent!==c&&(x.suppressHydrationWarning!==!0&&sp(u.textContent,c,e),p=["children",c]):typeof c=="number"&&u.textContent!==""+c&&(x.suppressHydrationWarning!==!0&&sp(u.textContent,c,e),p=["children",""+c]):ld.hasOwnProperty(v)&&c!=null&&v==="onScroll"&&xr("scroll",u)}switch(o){case"input":Yf(u),cw(u,x,!0);break;case"textarea":Yf(u),dw(u);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(u.onclick=$p)}u=p,n.updateQueue=u,u!==null&&(n.flags|=4)}else{v=p.nodeType===9?p:p.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=z1(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=v.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=v.createElement(o,{is:u.is}):(e=v.createElement(o),o==="select"&&(v=e,u.multiple?v.multiple=!0:u.size&&(v.size=u.size))):e=v.createElementNS(e,o),e[Hs]=n,e[_d]=u,rS(e,n,!1,!1),n.stateNode=e;e:{switch(v=Wy(o,u),o){case"dialog":xr("cancel",e),xr("close",e),p=u;break;case"iframe":case"object":case"embed":xr("load",e),p=u;break;case"video":case"audio":for(p=0;p<Yh.length;p++)xr(Yh[p],e);p=u;break;case"source":xr("error",e),p=u;break;case"img":case"image":case"link":xr("error",e),xr("load",e),p=u;break;case"details":xr("toggle",e),p=u;break;case"input":uw(e,u),p=$y(e,u),xr("invalid",e);break;case"option":p=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},p=Mr({},u,{value:void 0}),xr("invalid",e);break;case"textarea":hw(e,u),p=Zy(e,u),xr("invalid",e);break;default:p=u}Gy(o,p),c=p;for(x in c)if(c.hasOwnProperty(x)){var k=c[x];x==="style"?L1(e,k):x==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,k!=null&&D1(e,k)):x==="children"?typeof k=="string"?(o!=="textarea"||k!=="")&&ud(e,k):typeof k=="number"&&ud(e,""+k):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(ld.hasOwnProperty(x)?k!=null&&x==="onScroll"&&xr("scroll",e):k!=null&&av(e,x,k,v))}switch(o){case"input":Yf(e),cw(e,u,!1);break;case"textarea":Yf(e),dw(e);break;case"option":u.value!=null&&e.setAttribute("value",""+Fa(u.value));break;case"select":e.multiple=!!u.multiple,x=u.value,x!=null?Ju(e,!!u.multiple,x,!1):u.defaultValue!=null&&Ju(e,!!u.multiple,u.defaultValue,!0);break;default:typeof p.onClick=="function"&&(e.onclick=$p)}switch(o){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return jn(n),null;case 6:if(e&&n.stateNode!=null)iS(e,n,e.memoizedProps,u);else{if(typeof u!="string"&&n.stateNode===null)throw Error(Ve(166));if(o=Sl(xd.current),Sl(Xs.current),op(n)){if(u=n.stateNode,o=n.memoizedProps,u[Hs]=n,(x=u.nodeValue!==o)&&(e=Hi,e!==null))switch(e.tag){case 3:sp(u.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&sp(u.nodeValue,o,(e.mode&1)!==0)}x&&(n.flags|=4)}else u=(o.nodeType===9?o:o.ownerDocument).createTextNode(u),u[Hs]=n,n.stateNode=u}return jn(n),null;case 13:if(wr(Ir),u=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Er&&Zi!==null&&n.mode&1&&!(n.flags&128))b2(),gc(),n.flags|=98560,x=!1;else if(x=op(n),u!==null&&u.dehydrated!==null){if(e===null){if(!x)throw Error(Ve(318));if(x=n.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(Ve(317));x[Hs]=n}else gc(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;jn(n),x=!1}else Ts!==null&&(P_(Ts),Ts=null),x=!0;if(!x)return n.flags&65536?n:null}return n.flags&128?(n.lanes=o,n):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(n.child.flags|=8192,n.mode&1&&(e===null||Ir.current&1?rn===0&&(rn=3):Uv())),n.updateQueue!==null&&(n.flags|=4),jn(n),null);case 4:return _c(),x_(e,n),e===null&&gd(n.stateNode.containerInfo),jn(n),null;case 10:return Cv(n.type._context),jn(n),null;case 17:return Si(n.type)&&Up(),jn(n),null;case 19:if(wr(Ir),x=n.memoizedState,x===null)return jn(n),null;if(u=(n.flags&128)!==0,v=x.rendering,v===null)if(u)qh(x,!1);else{if(rn!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(v=Kp(e),v!==null){for(n.flags|=128,qh(x,!1),u=v.updateQueue,u!==null&&(n.updateQueue=u,n.flags|=4),n.subtreeFlags=0,u=o,o=n.child;o!==null;)x=o,e=u,x.flags&=14680066,v=x.alternate,v===null?(x.childLanes=0,x.lanes=e,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=v.childLanes,x.lanes=v.lanes,x.child=v.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=v.memoizedProps,x.memoizedState=v.memoizedState,x.updateQueue=v.updateQueue,x.type=v.type,e=v.dependencies,x.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return mr(Ir,Ir.current&1|2),n.child}e=e.sibling}x.tail!==null&&jr()>xc&&(n.flags|=128,u=!0,qh(x,!1),n.lanes=4194304)}else{if(!u)if(e=Kp(v),e!==null){if(n.flags|=128,u=!0,o=e.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),qh(x,!0),x.tail===null&&x.tailMode==="hidden"&&!v.alternate&&!Er)return jn(n),null}else 2*jr()-x.renderingStartTime>xc&&o!==1073741824&&(n.flags|=128,u=!0,qh(x,!1),n.lanes=4194304);x.isBackwards?(v.sibling=n.child,n.child=v):(o=x.last,o!==null?o.sibling=v:n.child=v,x.last=v)}return x.tail!==null?(n=x.tail,x.rendering=n,x.tail=n.sibling,x.renderingStartTime=jr(),n.sibling=null,o=Ir.current,mr(Ir,u?o&1|2:o&1),n):(jn(n),null);case 22:case 23:return $v(),u=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(n.flags|=8192),u&&n.mode&1?Ui&1073741824&&(jn(n),n.subtreeFlags&6&&(n.flags|=8192)):jn(n),null;case 24:return null;case 25:return null}throw Error(Ve(156,n.tag))}function dI(e,n){switch(bv(n),n.tag){case 1:return Si(n.type)&&Up(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return _c(),wr(bi),wr($n),Mv(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return Av(n),null;case 13:if(wr(Ir),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(Ve(340));gc()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return wr(Ir),null;case 4:return _c(),null;case 10:return Cv(n.type._context),null;case 22:case 23:return $v(),null;case 24:return null;default:return null}}var up=!1,Vn=!1,fI=typeof WeakSet=="function"?WeakSet:Set,pt=null;function Ku(e,n){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(u){Or(e,n,u)}else o.current=null}function w_(e,n,o){try{o()}catch(u){Or(e,n,u)}}var tb=!1;function pI(e,n){if(i_=Np,e=u2(),xv(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var p=u.anchorOffset,x=u.focusNode;u=u.focusOffset;try{o.nodeType,x.nodeType}catch{o=null;break e}var v=0,c=-1,k=-1,A=0,B=0,R=e,L=null;t:for(;;){for(var $;R!==o||p!==0&&R.nodeType!==3||(c=v+p),R!==x||u!==0&&R.nodeType!==3||(k=v+u),R.nodeType===3&&(v+=R.nodeValue.length),($=R.firstChild)!==null;)L=R,R=$;for(;;){if(R===e)break t;if(L===o&&++A===p&&(c=v),L===x&&++B===u&&(k=v),($=R.nextSibling)!==null)break;R=L,L=R.parentNode}R=$}o=c===-1||k===-1?null:{start:c,end:k}}else o=null}o=o||{start:0,end:0}}else o=null;for(s_={focusedElem:e,selectionRange:o},Np=!1,pt=n;pt!==null;)if(n=pt,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,pt=e;else for(;pt!==null;){n=pt;try{var le=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(le!==null){var Q=le.memoizedProps,se=le.memoizedState,W=n.stateNode,G=W.getSnapshotBeforeUpdate(n.elementType===n.type?Q:vs(n.type,Q),se);W.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var K=n.stateNode.containerInfo;K.nodeType===1?K.textContent="":K.nodeType===9&&K.documentElement&&K.removeChild(K.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ve(163))}}catch(he){Or(n,n.return,he)}if(e=n.sibling,e!==null){e.return=n.return,pt=e;break}pt=n.return}return le=tb,tb=!1,le}function id(e,n,o){var u=n.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var p=u=u.next;do{if((p.tag&e)===e){var x=p.destroy;p.destroy=void 0,x!==void 0&&w_(n,o,x)}p=p.next}while(p!==u)}}function xm(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var u=o.create;o.destroy=u()}o=o.next}while(o!==n)}}function b_(e){var n=e.ref;if(n!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof n=="function"?n(e):n.current=e}}function sS(e){var n=e.alternate;n!==null&&(e.alternate=null,sS(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[Hs],delete n[_d],delete n[l_],delete n[KP],delete n[YP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function oS(e){return e.tag===5||e.tag===3||e.tag===4}function rb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||oS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function S_(e,n,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(e,n):o.insertBefore(e,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(e,o)):(n=o,n.appendChild(e)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=$p));else if(u!==4&&(e=e.child,e!==null))for(S_(e,n,o),e=e.sibling;e!==null;)S_(e,n,o),e=e.sibling}function T_(e,n,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?o.insertBefore(e,n):o.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(T_(e,n,o),e=e.sibling;e!==null;)T_(e,n,o),e=e.sibling}var Tn=null,Ss=!1;function ha(e,n,o){for(o=o.child;o!==null;)aS(e,n,o),o=o.sibling}function aS(e,n,o){if(Ws&&typeof Ws.onCommitFiberUnmount=="function")try{Ws.onCommitFiberUnmount(dm,o)}catch{}switch(o.tag){case 5:Vn||Ku(o,n);case 6:var u=Tn,p=Ss;Tn=null,ha(e,n,o),Tn=u,Ss=p,Tn!==null&&(Ss?(e=Tn,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):Tn.removeChild(o.stateNode));break;case 18:Tn!==null&&(Ss?(e=Tn,o=o.stateNode,e.nodeType===8?xy(e.parentNode,o):e.nodeType===1&&xy(e,o),fd(e)):xy(Tn,o.stateNode));break;case 4:u=Tn,p=Ss,Tn=o.stateNode.containerInfo,Ss=!0,ha(e,n,o),Tn=u,Ss=p;break;case 0:case 11:case 14:case 15:if(!Vn&&(u=o.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){p=u=u.next;do{var x=p,v=x.destroy;x=x.tag,v!==void 0&&(x&2||x&4)&&w_(o,n,v),p=p.next}while(p!==u)}ha(e,n,o);break;case 1:if(!Vn&&(Ku(o,n),u=o.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=o.memoizedProps,u.state=o.memoizedState,u.componentWillUnmount()}catch(c){Or(o,n,c)}ha(e,n,o);break;case 21:ha(e,n,o);break;case 22:o.mode&1?(Vn=(u=Vn)||o.memoizedState!==null,ha(e,n,o),Vn=u):ha(e,n,o);break;default:ha(e,n,o)}}function nb(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new fI),n.forEach(function(u){var p=SI.bind(null,e,u);o.has(u)||(o.add(u),u.then(p,p))})}}function ys(e,n){var o=n.deletions;if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];try{var x=e,v=n,c=v;e:for(;c!==null;){switch(c.tag){case 5:Tn=c.stateNode,Ss=!1;break e;case 3:Tn=c.stateNode.containerInfo,Ss=!0;break e;case 4:Tn=c.stateNode.containerInfo,Ss=!0;break e}c=c.return}if(Tn===null)throw Error(Ve(160));aS(x,v,p),Tn=null,Ss=!1;var k=p.alternate;k!==null&&(k.return=null),p.return=null}catch(A){Or(p,n,A)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)lS(n,e),n=n.sibling}function lS(e,n){var o=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ys(n,e),Vs(e),u&4){try{id(3,e,e.return),xm(3,e)}catch(Q){Or(e,e.return,Q)}try{id(5,e,e.return)}catch(Q){Or(e,e.return,Q)}}break;case 1:ys(n,e),Vs(e),u&512&&o!==null&&Ku(o,o.return);break;case 5:if(ys(n,e),Vs(e),u&512&&o!==null&&Ku(o,o.return),e.flags&32){var p=e.stateNode;try{ud(p,"")}catch(Q){Or(e,e.return,Q)}}if(u&4&&(p=e.stateNode,p!=null)){var x=e.memoizedProps,v=o!==null?o.memoizedProps:x,c=e.type,k=e.updateQueue;if(e.updateQueue=null,k!==null)try{c==="input"&&x.type==="radio"&&x.name!=null&&A1(p,x),Wy(c,v);var A=Wy(c,x);for(v=0;v<k.length;v+=2){var B=k[v],R=k[v+1];B==="style"?L1(p,R):B==="dangerouslySetInnerHTML"?D1(p,R):B==="children"?ud(p,R):av(p,B,R,A)}switch(c){case"input":Uy(p,x);break;case"textarea":M1(p,x);break;case"select":var L=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!x.multiple;var $=x.value;$!=null?Ju(p,!!x.multiple,$,!1):L!==!!x.multiple&&(x.defaultValue!=null?Ju(p,!!x.multiple,x.defaultValue,!0):Ju(p,!!x.multiple,x.multiple?[]:"",!1))}p[_d]=x}catch(Q){Or(e,e.return,Q)}}break;case 6:if(ys(n,e),Vs(e),u&4){if(e.stateNode===null)throw Error(Ve(162));p=e.stateNode,x=e.memoizedProps;try{p.nodeValue=x}catch(Q){Or(e,e.return,Q)}}break;case 3:if(ys(n,e),Vs(e),u&4&&o!==null&&o.memoizedState.isDehydrated)try{fd(n.containerInfo)}catch(Q){Or(e,e.return,Q)}break;case 4:ys(n,e),Vs(e);break;case 13:ys(n,e),Vs(e),p=e.child,p.flags&8192&&(x=p.memoizedState!==null,p.stateNode.isHidden=x,!x||p.alternate!==null&&p.alternate.memoizedState!==null||(jv=jr())),u&4&&nb(e);break;case 22:if(B=o!==null&&o.memoizedState!==null,e.mode&1?(Vn=(A=Vn)||B,ys(n,e),Vn=A):ys(n,e),Vs(e),u&8192){if(A=e.memoizedState!==null,(e.stateNode.isHidden=A)&&!B&&e.mode&1)for(pt=e,B=e.child;B!==null;){for(R=pt=B;pt!==null;){switch(L=pt,$=L.child,L.tag){case 0:case 11:case 14:case 15:id(4,L,L.return);break;case 1:Ku(L,L.return);var le=L.stateNode;if(typeof le.componentWillUnmount=="function"){u=L,o=L.return;try{n=u,le.props=n.memoizedProps,le.state=n.memoizedState,le.componentWillUnmount()}catch(Q){Or(u,o,Q)}}break;case 5:Ku(L,L.return);break;case 22:if(L.memoizedState!==null){sb(R);continue}}$!==null?($.return=L,pt=$):sb(R)}B=B.sibling}e:for(B=null,R=e;;){if(R.tag===5){if(B===null){B=R;try{p=R.stateNode,A?(x=p.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(c=R.stateNode,k=R.memoizedProps.style,v=k!=null&&k.hasOwnProperty("display")?k.display:null,c.style.display=R1("display",v))}catch(Q){Or(e,e.return,Q)}}}else if(R.tag===6){if(B===null)try{R.stateNode.nodeValue=A?"":R.memoizedProps}catch(Q){Or(e,e.return,Q)}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===e)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===e)break e;for(;R.sibling===null;){if(R.return===null||R.return===e)break e;B===R&&(B=null),R=R.return}B===R&&(B=null),R.sibling.return=R.return,R=R.sibling}}break;case 19:ys(n,e),Vs(e),u&4&&nb(e);break;case 21:break;default:ys(n,e),Vs(e)}}function Vs(e){var n=e.flags;if(n&2){try{e:{for(var o=e.return;o!==null;){if(oS(o)){var u=o;break e}o=o.return}throw Error(Ve(160))}switch(u.tag){case 5:var p=u.stateNode;u.flags&32&&(ud(p,""),u.flags&=-33);var x=rb(e);T_(e,x,p);break;case 3:case 4:var v=u.stateNode.containerInfo,c=rb(e);S_(e,c,v);break;default:throw Error(Ve(161))}}catch(k){Or(e,e.return,k)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function mI(e,n,o){pt=e,uS(e)}function uS(e,n,o){for(var u=(e.mode&1)!==0;pt!==null;){var p=pt,x=p.child;if(p.tag===22&&u){var v=p.memoizedState!==null||up;if(!v){var c=p.alternate,k=c!==null&&c.memoizedState!==null||Vn;c=up;var A=Vn;if(up=v,(Vn=k)&&!A)for(pt=p;pt!==null;)v=pt,k=v.child,v.tag===22&&v.memoizedState!==null?ob(p):k!==null?(k.return=v,pt=k):ob(p);for(;x!==null;)pt=x,uS(x),x=x.sibling;pt=p,up=c,Vn=A}ib(e)}else p.subtreeFlags&8772&&x!==null?(x.return=p,pt=x):ib(e)}}function ib(e){for(;pt!==null;){var n=pt;if(n.flags&8772){var o=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Vn||xm(5,n);break;case 1:var u=n.stateNode;if(n.flags&4&&!Vn)if(o===null)u.componentDidMount();else{var p=n.elementType===n.type?o.memoizedProps:vs(n.type,o.memoizedProps);u.componentDidUpdate(p,o.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var x=n.updateQueue;x!==null&&$w(n,x,u);break;case 3:var v=n.updateQueue;if(v!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}$w(n,v,o)}break;case 5:var c=n.stateNode;if(o===null&&n.flags&4){o=c;var k=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":k.autoFocus&&o.focus();break;case"img":k.src&&(o.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var A=n.alternate;if(A!==null){var B=A.memoizedState;if(B!==null){var R=B.dehydrated;R!==null&&fd(R)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ve(163))}Vn||n.flags&512&&b_(n)}catch(L){Or(n,n.return,L)}}if(n===e){pt=null;break}if(o=n.sibling,o!==null){o.return=n.return,pt=o;break}pt=n.return}}function sb(e){for(;pt!==null;){var n=pt;if(n===e){pt=null;break}var o=n.sibling;if(o!==null){o.return=n.return,pt=o;break}pt=n.return}}function ob(e){for(;pt!==null;){var n=pt;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{xm(4,n)}catch(k){Or(n,o,k)}break;case 1:var u=n.stateNode;if(typeof u.componentDidMount=="function"){var p=n.return;try{u.componentDidMount()}catch(k){Or(n,p,k)}}var x=n.return;try{b_(n)}catch(k){Or(n,x,k)}break;case 5:var v=n.return;try{b_(n)}catch(k){Or(n,v,k)}}}catch(k){Or(n,n.return,k)}if(n===e){pt=null;break}var c=n.sibling;if(c!==null){c.return=n.return,pt=c;break}pt=n.return}}var gI=Math.ceil,Qp=Mo.ReactCurrentDispatcher,Bv=Mo.ReactCurrentOwner,us=Mo.ReactCurrentBatchConfig,Jt=0,yn=null,Gr=null,En=0,Ui=0,Yu=Ua(0),rn=0,Td=null,Ol=0,wm=0,Nv=0,sd=null,xi=null,jv=0,xc=1/0,vo=null,em=!1,E_=null,Da=null,cp=!1,Ca=null,tm=0,od=0,C_=null,kp=-1,Pp=0;function ni(){return Jt&6?jr():kp!==-1?kp:kp=jr()}function Ra(e){return e.mode&1?Jt&2&&En!==0?En&-En:QP.transition!==null?(Pp===0&&(Pp=G1()),Pp):(e=ar,e!==0||(e=window.event,e=e===void 0?16:e2(e.type)),e):1}function ks(e,n,o,u){if(50<od)throw od=0,C_=null,Error(Ve(185));Ld(e,o,u),(!(Jt&2)||e!==yn)&&(e===yn&&(!(Jt&2)&&(wm|=o),rn===4&&_a(e,En)),Ti(e,u),o===1&&Jt===0&&!(n.mode&1)&&(xc=jr()+500,ym&&qa()))}function Ti(e,n){var o=e.callbackNode;Qk(e,n);var u=Bp(e,e===yn?En:0);if(u===0)o!==null&&mw(o),e.callbackNode=null,e.callbackPriority=0;else if(n=u&-u,e.callbackPriority!==n){if(o!=null&&mw(o),n===1)e.tag===0?JP(ab.bind(null,e)):v2(ab.bind(null,e)),WP(function(){!(Jt&6)&&qa()}),o=null;else{switch(W1(u)){case 1:o=dv;break;case 4:o=Z1;break;case 16:o=Op;break;case 536870912:o=H1;break;default:o=Op}o=yS(o,cS.bind(null,e))}e.callbackPriority=n,e.callbackNode=o}}function cS(e,n){if(kp=-1,Pp=0,Jt&6)throw Error(Ve(327));var o=e.callbackNode;if(nc()&&e.callbackNode!==o)return null;var u=Bp(e,e===yn?En:0);if(u===0)return null;if(u&30||u&e.expiredLanes||n)n=rm(e,u);else{n=u;var p=Jt;Jt|=2;var x=dS();(yn!==e||En!==n)&&(vo=null,xc=jr()+500,Al(e,n));do try{vI();break}catch(c){hS(e,c)}while(!0);Ev(),Qp.current=x,Jt=p,Gr!==null?n=0:(yn=null,En=0,n=rn)}if(n!==0){if(n===2&&(p=Qy(e),p!==0&&(u=p,n=k_(e,p))),n===1)throw o=Td,Al(e,0),_a(e,u),Ti(e,jr()),o;if(n===6)_a(e,u);else{if(p=e.current.alternate,!(u&30)&&!yI(p)&&(n=rm(e,u),n===2&&(x=Qy(e),x!==0&&(u=x,n=k_(e,x))),n===1))throw o=Td,Al(e,0),_a(e,u),Ti(e,jr()),o;switch(e.finishedWork=p,e.finishedLanes=u,n){case 0:case 1:throw Error(Ve(345));case 2:xl(e,xi,vo);break;case 3:if(_a(e,u),(u&130023424)===u&&(n=jv+500-jr(),10<n)){if(Bp(e,0)!==0)break;if(p=e.suspendedLanes,(p&u)!==u){ni(),e.pingedLanes|=e.suspendedLanes&p;break}e.timeoutHandle=a_(xl.bind(null,e,xi,vo),n);break}xl(e,xi,vo);break;case 4:if(_a(e,u),(u&4194240)===u)break;for(n=e.eventTimes,p=-1;0<u;){var v=31-Cs(u);x=1<<v,v=n[v],v>p&&(p=v),u&=~x}if(u=p,u=jr()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*gI(u/1960))-u,10<u){e.timeoutHandle=a_(xl.bind(null,e,xi,vo),u);break}xl(e,xi,vo);break;case 5:xl(e,xi,vo);break;default:throw Error(Ve(329))}}}return Ti(e,jr()),e.callbackNode===o?cS.bind(null,e):null}function k_(e,n){var o=sd;return e.current.memoizedState.isDehydrated&&(Al(e,n).flags|=256),e=rm(e,n),e!==2&&(n=xi,xi=o,n!==null&&P_(n)),e}function P_(e){xi===null?xi=e:xi.push.apply(xi,e)}function yI(e){for(var n=e;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var u=0;u<o.length;u++){var p=o[u],x=p.getSnapshot;p=p.value;try{if(!Ps(x(),p))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function _a(e,n){for(n&=~Nv,n&=~wm,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var o=31-Cs(n),u=1<<o;e[o]=-1,n&=~u}}function ab(e){if(Jt&6)throw Error(Ve(327));nc();var n=Bp(e,0);if(!(n&1))return Ti(e,jr()),null;var o=rm(e,n);if(e.tag!==0&&o===2){var u=Qy(e);u!==0&&(n=u,o=k_(e,u))}if(o===1)throw o=Td,Al(e,0),_a(e,n),Ti(e,jr()),o;if(o===6)throw Error(Ve(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,xl(e,xi,vo),Ti(e,jr()),null}function Vv(e,n){var o=Jt;Jt|=1;try{return e(n)}finally{Jt=o,Jt===0&&(xc=jr()+500,ym&&qa())}}function Bl(e){Ca!==null&&Ca.tag===0&&!(Jt&6)&&nc();var n=Jt;Jt|=1;var o=us.transition,u=ar;try{if(us.transition=null,ar=1,e)return e()}finally{ar=u,us.transition=o,Jt=n,!(Jt&6)&&qa()}}function $v(){Ui=Yu.current,wr(Yu)}function Al(e,n){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,GP(o)),Gr!==null)for(o=Gr.return;o!==null;){var u=o;switch(bv(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&Up();break;case 3:_c(),wr(bi),wr($n),Mv();break;case 5:Av(u);break;case 4:_c();break;case 13:wr(Ir);break;case 19:wr(Ir);break;case 10:Cv(u.type._context);break;case 22:case 23:$v()}o=o.return}if(yn=e,Gr=e=La(e.current,null),En=Ui=n,rn=0,Td=null,Nv=wm=Ol=0,xi=sd=null,bl!==null){for(n=0;n<bl.length;n++)if(o=bl[n],u=o.interleaved,u!==null){o.interleaved=null;var p=u.next,x=o.pending;if(x!==null){var v=x.next;x.next=p,u.next=v}o.pending=u}bl=null}return e}function hS(e,n){do{var o=Gr;try{if(Ev(),Tp.current=Jp,Yp){for(var u=Ar.memoizedState;u!==null;){var p=u.queue;p!==null&&(p.pending=null),u=u.next}Yp=!1}if(Fl=0,gn=en=Ar=null,nd=!1,wd=0,Bv.current=null,o===null||o.return===null){rn=1,Td=n,Gr=null;break}e:{var x=e,v=o.return,c=o,k=n;if(n=En,c.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){var A=k,B=c,R=B.tag;if(!(B.mode&1)&&(R===0||R===11||R===15)){var L=B.alternate;L?(B.updateQueue=L.updateQueue,B.memoizedState=L.memoizedState,B.lanes=L.lanes):(B.updateQueue=null,B.memoizedState=null)}var $=Ww(v);if($!==null){$.flags&=-257,Xw($,v,c,x,n),$.mode&1&&Gw(x,A,n),n=$,k=A;var le=n.updateQueue;if(le===null){var Q=new Set;Q.add(k),n.updateQueue=Q}else le.add(k);break e}else{if(!(n&1)){Gw(x,A,n),Uv();break e}k=Error(Ve(426))}}else if(Er&&c.mode&1){var se=Ww(v);if(se!==null){!(se.flags&65536)&&(se.flags|=256),Xw(se,v,c,x,n),Sv(vc(k,c));break e}}x=k=vc(k,c),rn!==4&&(rn=2),sd===null?sd=[x]:sd.push(x),x=v;do{switch(x.tag){case 3:x.flags|=65536,n&=-n,x.lanes|=n;var W=W2(x,k,n);Vw(x,W);break e;case 1:c=k;var G=x.type,K=x.stateNode;if(!(x.flags&128)&&(typeof G.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(Da===null||!Da.has(K)))){x.flags|=65536,n&=-n,x.lanes|=n;var he=X2(x,c,n);Vw(x,he);break e}}x=x.return}while(x!==null)}pS(o)}catch(be){n=be,Gr===o&&o!==null&&(Gr=o=o.return);continue}break}while(!0)}function dS(){var e=Qp.current;return Qp.current=Jp,e===null?Jp:e}function Uv(){(rn===0||rn===3||rn===2)&&(rn=4),yn===null||!(Ol&268435455)&&!(wm&268435455)||_a(yn,En)}function rm(e,n){var o=Jt;Jt|=2;var u=dS();(yn!==e||En!==n)&&(vo=null,Al(e,n));do try{_I();break}catch(p){hS(e,p)}while(!0);if(Ev(),Jt=o,Qp.current=u,Gr!==null)throw Error(Ve(261));return yn=null,En=0,rn}function _I(){for(;Gr!==null;)fS(Gr)}function vI(){for(;Gr!==null&&!qk();)fS(Gr)}function fS(e){var n=gS(e.alternate,e,Ui);e.memoizedProps=e.pendingProps,n===null?pS(e):Gr=n,Bv.current=null}function pS(e){var n=e;do{var o=n.alternate;if(e=n.return,n.flags&32768){if(o=dI(o,n),o!==null){o.flags&=32767,Gr=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{rn=6,Gr=null;return}}else if(o=hI(o,n,Ui),o!==null){Gr=o;return}if(n=n.sibling,n!==null){Gr=n;return}Gr=n=e}while(n!==null);rn===0&&(rn=5)}function xl(e,n,o){var u=ar,p=us.transition;try{us.transition=null,ar=1,xI(e,n,o,u)}finally{us.transition=p,ar=u}return null}function xI(e,n,o,u){do nc();while(Ca!==null);if(Jt&6)throw Error(Ve(327));o=e.finishedWork;var p=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(Ve(177));e.callbackNode=null,e.callbackPriority=0;var x=o.lanes|o.childLanes;if(eP(e,x),e===yn&&(Gr=yn=null,En=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||cp||(cp=!0,yS(Op,function(){return nc(),null})),x=(o.flags&15990)!==0,o.subtreeFlags&15990||x){x=us.transition,us.transition=null;var v=ar;ar=1;var c=Jt;Jt|=4,Bv.current=null,pI(e,o),lS(o,e),jP(s_),Np=!!i_,s_=i_=null,e.current=o,mI(o),Zk(),Jt=c,ar=v,us.transition=x}else e.current=o;if(cp&&(cp=!1,Ca=e,tm=p),x=e.pendingLanes,x===0&&(Da=null),Wk(o.stateNode),Ti(e,jr()),n!==null)for(u=e.onRecoverableError,o=0;o<n.length;o++)p=n[o],u(p.value,{componentStack:p.stack,digest:p.digest});if(em)throw em=!1,e=E_,E_=null,e;return tm&1&&e.tag!==0&&nc(),x=e.pendingLanes,x&1?e===C_?od++:(od=0,C_=e):od=0,qa(),null}function nc(){if(Ca!==null){var e=W1(tm),n=us.transition,o=ar;try{if(us.transition=null,ar=16>e?16:e,Ca===null)var u=!1;else{if(e=Ca,Ca=null,tm=0,Jt&6)throw Error(Ve(331));var p=Jt;for(Jt|=4,pt=e.current;pt!==null;){var x=pt,v=x.child;if(pt.flags&16){var c=x.deletions;if(c!==null){for(var k=0;k<c.length;k++){var A=c[k];for(pt=A;pt!==null;){var B=pt;switch(B.tag){case 0:case 11:case 15:id(8,B,x)}var R=B.child;if(R!==null)R.return=B,pt=R;else for(;pt!==null;){B=pt;var L=B.sibling,$=B.return;if(sS(B),B===A){pt=null;break}if(L!==null){L.return=$,pt=L;break}pt=$}}}var le=x.alternate;if(le!==null){var Q=le.child;if(Q!==null){le.child=null;do{var se=Q.sibling;Q.sibling=null,Q=se}while(Q!==null)}}pt=x}}if(x.subtreeFlags&2064&&v!==null)v.return=x,pt=v;else e:for(;pt!==null;){if(x=pt,x.flags&2048)switch(x.tag){case 0:case 11:case 15:id(9,x,x.return)}var W=x.sibling;if(W!==null){W.return=x.return,pt=W;break e}pt=x.return}}var G=e.current;for(pt=G;pt!==null;){v=pt;var K=v.child;if(v.subtreeFlags&2064&&K!==null)K.return=v,pt=K;else e:for(v=G;pt!==null;){if(c=pt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:xm(9,c)}}catch(be){Or(c,c.return,be)}if(c===v){pt=null;break e}var he=c.sibling;if(he!==null){he.return=c.return,pt=he;break e}pt=c.return}}if(Jt=p,qa(),Ws&&typeof Ws.onPostCommitFiberRoot=="function")try{Ws.onPostCommitFiberRoot(dm,e)}catch{}u=!0}return u}finally{ar=o,us.transition=n}}return!1}function lb(e,n,o){n=vc(o,n),n=W2(e,n,1),e=za(e,n,1),n=ni(),e!==null&&(Ld(e,1,n),Ti(e,n))}function Or(e,n,o){if(e.tag===3)lb(e,e,o);else for(;n!==null;){if(n.tag===3){lb(n,e,o);break}else if(n.tag===1){var u=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Da===null||!Da.has(u))){e=vc(o,e),e=X2(n,e,1),n=za(n,e,1),e=ni(),n!==null&&(Ld(n,1,e),Ti(n,e));break}}n=n.return}}function wI(e,n,o){var u=e.pingCache;u!==null&&u.delete(n),n=ni(),e.pingedLanes|=e.suspendedLanes&o,yn===e&&(En&o)===o&&(rn===4||rn===3&&(En&130023424)===En&&500>jr()-jv?Al(e,0):Nv|=o),Ti(e,n)}function mS(e,n){n===0&&(e.mode&1?(n=ep,ep<<=1,!(ep&130023424)&&(ep=4194304)):n=1);var o=ni();e=ko(e,n),e!==null&&(Ld(e,n,o),Ti(e,o))}function bI(e){var n=e.memoizedState,o=0;n!==null&&(o=n.retryLane),mS(e,o)}function SI(e,n){var o=0;switch(e.tag){case 13:var u=e.stateNode,p=e.memoizedState;p!==null&&(o=p.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(Ve(314))}u!==null&&u.delete(n),mS(e,o)}var gS;gS=function(e,n,o){if(e!==null)if(e.memoizedProps!==n.pendingProps||bi.current)wi=!0;else{if(!(e.lanes&o)&&!(n.flags&128))return wi=!1,cI(e,n,o);wi=!!(e.flags&131072)}else wi=!1,Er&&n.flags&1048576&&x2(n,Hp,n.index);switch(n.lanes=0,n.tag){case 2:var u=n.type;Cp(e,n),e=n.pendingProps;var p=mc(n,$n.current);rc(n,o),p=Dv(null,n,u,e,p,o);var x=Rv();return n.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Si(u)?(x=!0,qp(n)):x=!1,n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Pv(n),p.updater=vm,n.stateNode=p,p._reactInternals=n,p_(n,u,e,o),n=y_(null,n,u,!0,x,o)):(n.tag=0,Er&&x&&wv(n),ti(null,n,p,o),n=n.child),n;case 16:u=n.elementType;e:{switch(Cp(e,n),e=n.pendingProps,p=u._init,u=p(u._payload),n.type=u,p=n.tag=EI(u),e=vs(u,e),p){case 0:n=g_(null,n,u,e,o);break e;case 1:n=Jw(null,n,u,e,o);break e;case 11:n=Kw(null,n,u,e,o);break e;case 14:n=Yw(null,n,u,vs(u.type,e),o);break e}throw Error(Ve(306,u,""))}return n;case 0:return u=n.type,p=n.pendingProps,p=n.elementType===u?p:vs(u,p),g_(e,n,u,p,o);case 1:return u=n.type,p=n.pendingProps,p=n.elementType===u?p:vs(u,p),Jw(e,n,u,p,o);case 3:e:{if(Q2(n),e===null)throw Error(Ve(387));u=n.pendingProps,x=n.memoizedState,p=x.element,C2(e,n),Xp(n,u,null,o);var v=n.memoizedState;if(u=v.element,x.isDehydrated)if(x={element:u,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},n.updateQueue.baseState=x,n.memoizedState=x,n.flags&256){p=vc(Error(Ve(423)),n),n=Qw(e,n,u,o,p);break e}else if(u!==p){p=vc(Error(Ve(424)),n),n=Qw(e,n,u,o,p);break e}else for(Zi=Ma(n.stateNode.containerInfo.firstChild),Hi=n,Er=!0,Ts=null,o=T2(n,null,u,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(gc(),u===p){n=Po(e,n,o);break e}ti(e,n,u,o)}n=n.child}return n;case 5:return k2(n),e===null&&h_(n),u=n.type,p=n.pendingProps,x=e!==null?e.memoizedProps:null,v=p.children,o_(u,p)?v=null:x!==null&&o_(u,x)&&(n.flags|=32),J2(e,n),ti(e,n,v,o),n.child;case 6:return e===null&&h_(n),null;case 13:return eS(e,n,o);case 4:return Iv(n,n.stateNode.containerInfo),u=n.pendingProps,e===null?n.child=yc(n,null,u,o):ti(e,n,u,o),n.child;case 11:return u=n.type,p=n.pendingProps,p=n.elementType===u?p:vs(u,p),Kw(e,n,u,p,o);case 7:return ti(e,n,n.pendingProps,o),n.child;case 8:return ti(e,n,n.pendingProps.children,o),n.child;case 12:return ti(e,n,n.pendingProps.children,o),n.child;case 10:e:{if(u=n.type._context,p=n.pendingProps,x=n.memoizedProps,v=p.value,mr(Gp,u._currentValue),u._currentValue=v,x!==null)if(Ps(x.value,v)){if(x.children===p.children&&!bi.current){n=Po(e,n,o);break e}}else for(x=n.child,x!==null&&(x.return=n);x!==null;){var c=x.dependencies;if(c!==null){v=x.child;for(var k=c.firstContext;k!==null;){if(k.context===u){if(x.tag===1){k=To(-1,o&-o),k.tag=2;var A=x.updateQueue;if(A!==null){A=A.shared;var B=A.pending;B===null?k.next=k:(k.next=B.next,B.next=k),A.pending=k}}x.lanes|=o,k=x.alternate,k!==null&&(k.lanes|=o),d_(x.return,o,n),c.lanes|=o;break}k=k.next}}else if(x.tag===10)v=x.type===n.type?null:x.child;else if(x.tag===18){if(v=x.return,v===null)throw Error(Ve(341));v.lanes|=o,c=v.alternate,c!==null&&(c.lanes|=o),d_(v,o,n),v=x.sibling}else v=x.child;if(v!==null)v.return=x;else for(v=x;v!==null;){if(v===n){v=null;break}if(x=v.sibling,x!==null){x.return=v.return,v=x;break}v=v.return}x=v}ti(e,n,p.children,o),n=n.child}return n;case 9:return p=n.type,u=n.pendingProps.children,rc(n,o),p=cs(p),u=u(p),n.flags|=1,ti(e,n,u,o),n.child;case 14:return u=n.type,p=vs(u,n.pendingProps),p=vs(u.type,p),Yw(e,n,u,p,o);case 15:return K2(e,n,n.type,n.pendingProps,o);case 17:return u=n.type,p=n.pendingProps,p=n.elementType===u?p:vs(u,p),Cp(e,n),n.tag=1,Si(u)?(e=!0,qp(n)):e=!1,rc(n,o),G2(n,u,p),p_(n,u,p,o),y_(null,n,u,!0,e,o);case 19:return tS(e,n,o);case 22:return Y2(e,n,o)}throw Error(Ve(156,n.tag))};function yS(e,n){return q1(e,n)}function TI(e,n,o,u){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ls(e,n,o,u){return new TI(e,n,o,u)}function qv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function EI(e){if(typeof e=="function")return qv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===uv)return 11;if(e===cv)return 14}return 2}function La(e,n){var o=e.alternate;return o===null?(o=ls(e.tag,n,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=n,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,n=e.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Ip(e,n,o,u,p,x){var v=2;if(u=e,typeof e=="function")qv(e)&&(v=1);else if(typeof e=="string")v=5;else e:switch(e){case Vu:return Ml(o.children,p,x,n);case lv:v=8,p|=8;break;case By:return e=ls(12,o,n,p|2),e.elementType=By,e.lanes=x,e;case Ny:return e=ls(13,o,n,p),e.elementType=Ny,e.lanes=x,e;case jy:return e=ls(19,o,n,p),e.elementType=jy,e.lanes=x,e;case k1:return bm(o,p,x,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case E1:v=10;break e;case C1:v=9;break e;case uv:v=11;break e;case cv:v=14;break e;case ma:v=16,u=null;break e}throw Error(Ve(130,e==null?e:typeof e,""))}return n=ls(v,o,n,p),n.elementType=e,n.type=u,n.lanes=x,n}function Ml(e,n,o,u){return e=ls(7,e,u,n),e.lanes=o,e}function bm(e,n,o,u){return e=ls(22,e,u,n),e.elementType=k1,e.lanes=o,e.stateNode={isHidden:!1},e}function Py(e,n,o){return e=ls(6,e,null,n),e.lanes=o,e}function Iy(e,n,o){return n=ls(4,e.children!==null?e.children:[],e.key,n),n.lanes=o,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function CI(e,n,o,u,p){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uy(0),this.expirationTimes=uy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uy(0),this.identifierPrefix=u,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Zv(e,n,o,u,p,x,v,c,k){return e=new CI(e,n,o,c,k),n===1?(n=1,x===!0&&(n|=8)):n=0,x=ls(3,null,null,n),e.current=x,x.stateNode=e,x.memoizedState={element:u,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pv(x),e}function kI(e,n,o){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ju,key:u==null?null:""+u,children:e,containerInfo:n,implementation:o}}function _S(e){if(!e)return Oa;e=e._reactInternals;e:{if($l(e)!==e||e.tag!==1)throw Error(Ve(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Si(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(Ve(171))}if(e.tag===1){var o=e.type;if(Si(o))return _2(e,o,n)}return n}function vS(e,n,o,u,p,x,v,c,k){return e=Zv(o,u,!0,e,p,x,v,c,k),e.context=_S(null),o=e.current,u=ni(),p=Ra(o),x=To(u,p),x.callback=n??null,za(o,x,p),e.current.lanes=p,Ld(e,p,u),Ti(e,u),e}function Sm(e,n,o,u){var p=n.current,x=ni(),v=Ra(p);return o=_S(o),n.context===null?n.context=o:n.pendingContext=o,n=To(x,v),n.payload={element:e},u=u===void 0?null:u,u!==null&&(n.callback=u),e=za(p,n,v),e!==null&&(ks(e,p,v,x),Sp(e,p,v)),v}function nm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ub(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<n?o:n}}function Hv(e,n){ub(e,n),(e=e.alternate)&&ub(e,n)}function PI(){return null}var xS=typeof reportError=="function"?reportError:function(e){console.error(e)};function Gv(e){this._internalRoot=e}Tm.prototype.render=Gv.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(Ve(409));Sm(e,n,null,null)};Tm.prototype.unmount=Gv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Bl(function(){Sm(null,e,null,null)}),n[Co]=null}};function Tm(e){this._internalRoot=e}Tm.prototype.unstable_scheduleHydration=function(e){if(e){var n=Y1();e={blockedOn:null,target:e,priority:n};for(var o=0;o<ya.length&&n!==0&&n<ya[o].priority;o++);ya.splice(o,0,e),o===0&&Q1(e)}};function Wv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Em(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cb(){}function II(e,n,o,u,p){if(p){if(typeof u=="function"){var x=u;u=function(){var A=nm(v);x.call(A)}}var v=vS(n,u,e,0,null,!1,!1,"",cb);return e._reactRootContainer=v,e[Co]=v.current,gd(e.nodeType===8?e.parentNode:e),Bl(),v}for(;p=e.lastChild;)e.removeChild(p);if(typeof u=="function"){var c=u;u=function(){var A=nm(k);c.call(A)}}var k=Zv(e,0,!1,null,null,!1,!1,"",cb);return e._reactRootContainer=k,e[Co]=k.current,gd(e.nodeType===8?e.parentNode:e),Bl(function(){Sm(n,k,o,u)}),k}function Cm(e,n,o,u,p){var x=o._reactRootContainer;if(x){var v=x;if(typeof p=="function"){var c=p;p=function(){var k=nm(v);c.call(k)}}Sm(n,v,e,p)}else v=II(o,n,e,p,u);return nm(v)}X1=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var o=Kh(n.pendingLanes);o!==0&&(fv(n,o|1),Ti(n,jr()),!(Jt&6)&&(xc=jr()+500,qa()))}break;case 13:Bl(function(){var u=ko(e,1);if(u!==null){var p=ni();ks(u,e,1,p)}}),Hv(e,1)}};pv=function(e){if(e.tag===13){var n=ko(e,134217728);if(n!==null){var o=ni();ks(n,e,134217728,o)}Hv(e,134217728)}};K1=function(e){if(e.tag===13){var n=Ra(e),o=ko(e,n);if(o!==null){var u=ni();ks(o,e,n,u)}Hv(e,n)}};Y1=function(){return ar};J1=function(e,n){var o=ar;try{return ar=e,n()}finally{ar=o}};Ky=function(e,n,o){switch(n){case"input":if(Uy(e,o),n=o.name,o.type==="radio"&&n!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var u=o[n];if(u!==e&&u.form===e.form){var p=gm(u);if(!p)throw Error(Ve(90));I1(u),Uy(u,p)}}}break;case"textarea":M1(e,o);break;case"select":n=o.value,n!=null&&Ju(e,!!o.multiple,n,!1)}};B1=Vv;N1=Bl;var AI={usingClientEntryPoint:!1,Events:[Od,Zu,gm,F1,O1,Vv]},Zh={findFiberByHostInstance:wl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MI={bundleType:Zh.bundleType,version:Zh.version,rendererPackageName:Zh.rendererPackageName,rendererConfig:Zh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=$1(e),e===null?null:e.stateNode},findFiberByHostInstance:Zh.findFiberByHostInstance||PI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hp.isDisabled&&hp.supportsFiber)try{dm=hp.inject(MI),Ws=hp}catch{}}Xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AI;Xi.createPortal=function(e,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wv(n))throw Error(Ve(200));return kI(e,n,null,o)};Xi.createRoot=function(e,n){if(!Wv(e))throw Error(Ve(299));var o=!1,u="",p=xS;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),n=Zv(e,1,!1,null,null,o,!1,u,p),e[Co]=n.current,gd(e.nodeType===8?e.parentNode:e),new Gv(n)};Xi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(Ve(188)):(e=Object.keys(e).join(","),Error(Ve(268,e)));return e=$1(n),e=e===null?null:e.stateNode,e};Xi.flushSync=function(e){return Bl(e)};Xi.hydrate=function(e,n,o){if(!Em(n))throw Error(Ve(200));return Cm(null,e,n,!0,o)};Xi.hydrateRoot=function(e,n,o){if(!Wv(e))throw Error(Ve(405));var u=o!=null&&o.hydratedSources||null,p=!1,x="",v=xS;if(o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onRecoverableError!==void 0&&(v=o.onRecoverableError)),n=vS(n,null,e,1,o??null,p,!1,x,v),e[Co]=n.current,gd(e),u)for(e=0;e<u.length;e++)o=u[e],p=o._getVersion,p=p(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,p]:n.mutableSourceEagerHydrationData.push(o,p);return new Tm(n)};Xi.render=function(e,n,o){if(!Em(n))throw Error(Ve(200));return Cm(null,e,n,!1,o)};Xi.unmountComponentAtNode=function(e){if(!Em(e))throw Error(Ve(40));return e._reactRootContainer?(Bl(function(){Cm(null,null,e,!1,function(){e._reactRootContainer=null,e[Co]=null})}),!0):!1};Xi.unstable_batchedUpdates=Vv;Xi.unstable_renderSubtreeIntoContainer=function(e,n,o,u){if(!Em(o))throw Error(Ve(200));if(e==null||e._reactInternals===void 0)throw Error(Ve(38));return Cm(e,n,o,!1,u)};Xi.version="18.3.1-next-f1338f8080-20240426";function wS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wS)}catch(e){console.error(e)}}wS(),w1.exports=Xi;var Nd=w1.exports;const bS=Q_(Nd);var SS,hb=Nd;SS=hb.createRoot,hb.hydrateRoot;const zI=1,DI=1e6;let Ay=0;function RI(){return Ay=(Ay+1)%Number.MAX_SAFE_INTEGER,Ay.toString()}const My=new Map,db=e=>{if(My.has(e))return;const n=setTimeout(()=>{My.delete(e),ad({type:"REMOVE_TOAST",toastId:e})},DI);My.set(e,n)},LI=(e,n)=>{switch(n.type){case"ADD_TOAST":return{...e,toasts:[n.toast,...e.toasts].slice(0,zI)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case"DISMISS_TOAST":{const{toastId:o}=n;return o?db(o):e.toasts.forEach(u=>{db(u.id)}),{...e,toasts:e.toasts.map(u=>u.id===o||o===void 0?{...u,open:!1}:u)}}case"REMOVE_TOAST":return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)}}},Ap=[];let Mp={toasts:[]};function ad(e){Mp=LI(Mp,e),Ap.forEach(n=>{n(Mp)})}function FI({...e}){const n=RI(),o=p=>ad({type:"UPDATE_TOAST",toast:{...p,id:n}}),u=()=>ad({type:"DISMISS_TOAST",toastId:n});return ad({type:"ADD_TOAST",toast:{...e,id:n,open:!0,onOpenChange:p=>{p||u()}}}),{id:n,dismiss:u,update:o}}function OI(){const[e,n]=X.useState(Mp);return X.useEffect(()=>(Ap.push(n),()=>{const o=Ap.indexOf(n);o>-1&&Ap.splice(o,1)}),[e]),{...e,toast:FI,dismiss:o=>ad({type:"DISMISS_TOAST",toastId:o})}}function tn(e,n,{checkForDefaultPrevented:o=!0}={}){return function(p){if(e==null||e(p),o===!1||!p.defaultPrevented)return n==null?void 0:n(p)}}function fb(e,n){if(typeof e=="function")return e(n);e!=null&&(e.current=n)}function km(...e){return n=>{let o=!1;const u=e.map(p=>{const x=fb(p,n);return!o&&typeof x=="function"&&(o=!0),x});if(o)return()=>{for(let p=0;p<u.length;p++){const x=u[p];typeof x=="function"?x():fb(e[p],null)}}}}function Is(...e){return X.useCallback(km(...e),e)}function Pm(e,n=[]){let o=[];function u(x,v){const c=X.createContext(v),k=o.length;o=[...o,v];const A=R=>{var W;const{scope:L,children:$,...le}=R,Q=((W=L==null?void 0:L[e])==null?void 0:W[k])||c,se=X.useMemo(()=>le,Object.values(le));return ee.jsx(Q.Provider,{value:se,children:$})};A.displayName=x+"Provider";function B(R,L){var Q;const $=((Q=L==null?void 0:L[e])==null?void 0:Q[k])||c,le=X.useContext($);if(le)return le;if(v!==void 0)return v;throw new Error(`\`${R}\` must be used within \`${x}\``)}return[A,B]}const p=()=>{const x=o.map(v=>X.createContext(v));return function(c){const k=(c==null?void 0:c[e])||x;return X.useMemo(()=>({[`__scope${e}`]:{...c,[e]:k}}),[c,k])}};return p.scopeName=e,[u,BI(p,...n)]}function BI(...e){const n=e[0];if(e.length===1)return n;const o=()=>{const u=e.map(p=>({useScope:p(),scopeName:p.scopeName}));return function(x){const v=u.reduce((c,{useScope:k,scopeName:A})=>{const R=k(x)[`__scope${A}`];return{...c,...R}},{});return X.useMemo(()=>({[`__scope${n.scopeName}`]:v}),[v])}};return o.scopeName=n.scopeName,o}function pb(e){const n=NI(e),o=X.forwardRef((u,p)=>{const{children:x,...v}=u,c=X.Children.toArray(x),k=c.find(VI);if(k){const A=k.props.children,B=c.map(R=>R===k?X.Children.count(A)>1?X.Children.only(null):X.isValidElement(A)?A.props.children:null:R);return ee.jsx(n,{...v,ref:p,children:X.isValidElement(A)?X.cloneElement(A,void 0,B):null})}return ee.jsx(n,{...v,ref:p,children:x})});return o.displayName=`${e}.Slot`,o}function NI(e){const n=X.forwardRef((o,u)=>{const{children:p,...x}=o;if(X.isValidElement(p)){const v=UI(p),c=$I(x,p.props);return p.type!==X.Fragment&&(c.ref=u?km(u,v):v),X.cloneElement(p,c)}return X.Children.count(p)>1?X.Children.only(null):null});return n.displayName=`${e}.SlotClone`,n}var jI=Symbol("radix.slottable");function VI(e){return X.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===jI}function $I(e,n){const o={...n};for(const u in n){const p=e[u],x=n[u];/^on[A-Z]/.test(u)?p&&x?o[u]=(...c)=>{const k=x(...c);return p(...c),k}:p&&(o[u]=p):u==="style"?o[u]={...p,...x}:u==="className"&&(o[u]=[p,x].filter(Boolean).join(" "))}return{...e,...o}}function UI(e){var u,p;let n=(u=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:u.get,o=n&&"isReactWarning"in n&&n.isReactWarning;return o?e.ref:(n=(p=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:p.get,o=n&&"isReactWarning"in n&&n.isReactWarning,o?e.props.ref:e.props.ref||e.ref)}function qI(e){const n=e+"CollectionProvider",[o,u]=Pm(n),[p,x]=o(n,{collectionRef:{current:null},itemMap:new Map}),v=Q=>{const{scope:se,children:W}=Q,G=Ye.useRef(null),K=Ye.useRef(new Map).current;return ee.jsx(p,{scope:se,itemMap:K,collectionRef:G,children:W})};v.displayName=n;const c=e+"CollectionSlot",k=pb(c),A=Ye.forwardRef((Q,se)=>{const{scope:W,children:G}=Q,K=x(c,W),he=Is(se,K.collectionRef);return ee.jsx(k,{ref:he,children:G})});A.displayName=c;const B=e+"CollectionItemSlot",R="data-radix-collection-item",L=pb(B),$=Ye.forwardRef((Q,se)=>{const{scope:W,children:G,...K}=Q,he=Ye.useRef(null),be=Is(se,he),ke=x(B,W);return Ye.useEffect(()=>(ke.itemMap.set(he,{ref:he,...K}),()=>void ke.itemMap.delete(he))),ee.jsx(L,{[R]:"",ref:be,children:G})});$.displayName=B;function le(Q){const se=x(e+"CollectionConsumer",Q);return Ye.useCallback(()=>{const G=se.collectionRef.current;if(!G)return[];const K=Array.from(G.querySelectorAll(`[${R}]`));return Array.from(se.itemMap.values()).sort((ke,Pe)=>K.indexOf(ke.ref.current)-K.indexOf(Pe.ref.current))},[se.collectionRef,se.itemMap])}return[{Provider:v,Slot:A,ItemSlot:$},le,u]}function ZI(e){const n=HI(e),o=X.forwardRef((u,p)=>{const{children:x,...v}=u,c=X.Children.toArray(x),k=c.find(WI);if(k){const A=k.props.children,B=c.map(R=>R===k?X.Children.count(A)>1?X.Children.only(null):X.isValidElement(A)?A.props.children:null:R);return ee.jsx(n,{...v,ref:p,children:X.isValidElement(A)?X.cloneElement(A,void 0,B):null})}return ee.jsx(n,{...v,ref:p,children:x})});return o.displayName=`${e}.Slot`,o}function HI(e){const n=X.forwardRef((o,u)=>{const{children:p,...x}=o;if(X.isValidElement(p)){const v=KI(p),c=XI(x,p.props);return p.type!==X.Fragment&&(c.ref=u?km(u,v):v),X.cloneElement(p,c)}return X.Children.count(p)>1?X.Children.only(null):null});return n.displayName=`${e}.SlotClone`,n}var GI=Symbol("radix.slottable");function WI(e){return X.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===GI}function XI(e,n){const o={...n};for(const u in n){const p=e[u],x=n[u];/^on[A-Z]/.test(u)?p&&x?o[u]=(...c)=>{const k=x(...c);return p(...c),k}:p&&(o[u]=p):u==="style"?o[u]={...p,...x}:u==="className"&&(o[u]=[p,x].filter(Boolean).join(" "))}return{...e,...o}}function KI(e){var u,p;let n=(u=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:u.get,o=n&&"isReactWarning"in n&&n.isReactWarning;return o?e.ref:(n=(p=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:p.get,o=n&&"isReactWarning"in n&&n.isReactWarning,o?e.props.ref:e.props.ref||e.ref)}var YI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ei=YI.reduce((e,n)=>{const o=ZI(`Primitive.${n}`),u=X.forwardRef((p,x)=>{const{asChild:v,...c}=p,k=v?o:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),ee.jsx(k,{...c,ref:x})});return u.displayName=`Primitive.${n}`,{...e,[n]:u}},{});function TS(e,n){e&&Nd.flushSync(()=>e.dispatchEvent(n))}function Ba(e){const n=X.useRef(e);return X.useEffect(()=>{n.current=e}),X.useMemo(()=>(...o)=>{var u;return(u=n.current)==null?void 0:u.call(n,...o)},[])}function JI(e,n=globalThis==null?void 0:globalThis.document){const o=Ba(e);X.useEffect(()=>{const u=p=>{p.key==="Escape"&&o(p)};return n.addEventListener("keydown",u,{capture:!0}),()=>n.removeEventListener("keydown",u,{capture:!0})},[o,n])}var QI="DismissableLayer",I_="dismissableLayer.update",eA="dismissableLayer.pointerDownOutside",tA="dismissableLayer.focusOutside",mb,ES=X.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Xv=X.forwardRef((e,n)=>{const{disableOutsidePointerEvents:o=!1,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:x,onInteractOutside:v,onDismiss:c,...k}=e,A=X.useContext(ES),[B,R]=X.useState(null),L=(B==null?void 0:B.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,$]=X.useState({}),le=Is(n,Pe=>R(Pe)),Q=Array.from(A.layers),[se]=[...A.layersWithOutsidePointerEventsDisabled].slice(-1),W=Q.indexOf(se),G=B?Q.indexOf(B):-1,K=A.layersWithOutsidePointerEventsDisabled.size>0,he=G>=W,be=nA(Pe=>{const Fe=Pe.target,st=[...A.branches].some(Be=>Be.contains(Fe));!he||st||(p==null||p(Pe),v==null||v(Pe),Pe.defaultPrevented||c==null||c())},L),ke=iA(Pe=>{const Fe=Pe.target;[...A.branches].some(Be=>Be.contains(Fe))||(x==null||x(Pe),v==null||v(Pe),Pe.defaultPrevented||c==null||c())},L);return JI(Pe=>{G===A.layers.size-1&&(u==null||u(Pe),!Pe.defaultPrevented&&c&&(Pe.preventDefault(),c()))},L),X.useEffect(()=>{if(B)return o&&(A.layersWithOutsidePointerEventsDisabled.size===0&&(mb=L.body.style.pointerEvents,L.body.style.pointerEvents="none"),A.layersWithOutsidePointerEventsDisabled.add(B)),A.layers.add(B),gb(),()=>{o&&A.layersWithOutsidePointerEventsDisabled.size===1&&(L.body.style.pointerEvents=mb)}},[B,L,o,A]),X.useEffect(()=>()=>{B&&(A.layers.delete(B),A.layersWithOutsidePointerEventsDisabled.delete(B),gb())},[B,A]),X.useEffect(()=>{const Pe=()=>$({});return document.addEventListener(I_,Pe),()=>document.removeEventListener(I_,Pe)},[]),ee.jsx(Ei.div,{...k,ref:le,style:{pointerEvents:K?he?"auto":"none":void 0,...e.style},onFocusCapture:tn(e.onFocusCapture,ke.onFocusCapture),onBlurCapture:tn(e.onBlurCapture,ke.onBlurCapture),onPointerDownCapture:tn(e.onPointerDownCapture,be.onPointerDownCapture)})});Xv.displayName=QI;var rA="DismissableLayerBranch",CS=X.forwardRef((e,n)=>{const o=X.useContext(ES),u=X.useRef(null),p=Is(n,u);return X.useEffect(()=>{const x=u.current;if(x)return o.branches.add(x),()=>{o.branches.delete(x)}},[o.branches]),ee.jsx(Ei.div,{...e,ref:p})});CS.displayName=rA;function nA(e,n=globalThis==null?void 0:globalThis.document){const o=Ba(e),u=X.useRef(!1),p=X.useRef(()=>{});return X.useEffect(()=>{const x=c=>{if(c.target&&!u.current){let k=function(){kS(eA,o,A,{discrete:!0})};const A={originalEvent:c};c.pointerType==="touch"?(n.removeEventListener("click",p.current),p.current=k,n.addEventListener("click",p.current,{once:!0})):k()}else n.removeEventListener("click",p.current);u.current=!1},v=window.setTimeout(()=>{n.addEventListener("pointerdown",x)},0);return()=>{window.clearTimeout(v),n.removeEventListener("pointerdown",x),n.removeEventListener("click",p.current)}},[n,o]),{onPointerDownCapture:()=>u.current=!0}}function iA(e,n=globalThis==null?void 0:globalThis.document){const o=Ba(e),u=X.useRef(!1);return X.useEffect(()=>{const p=x=>{x.target&&!u.current&&kS(tA,o,{originalEvent:x},{discrete:!1})};return n.addEventListener("focusin",p),()=>n.removeEventListener("focusin",p)},[n,o]),{onFocusCapture:()=>u.current=!0,onBlurCapture:()=>u.current=!1}}function gb(){const e=new CustomEvent(I_);document.dispatchEvent(e)}function kS(e,n,o,{discrete:u}){const p=o.originalEvent.target,x=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:o});n&&p.addEventListener(e,n,{once:!0}),u?TS(p,x):p.dispatchEvent(x)}var sA=Xv,oA=CS,Na=globalThis!=null&&globalThis.document?X.useLayoutEffect:()=>{},aA="Portal",PS=X.forwardRef((e,n)=>{var c;const{container:o,...u}=e,[p,x]=X.useState(!1);Na(()=>x(!0),[]);const v=o||p&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return v?bS.createPortal(ee.jsx(Ei.div,{...u,ref:n}),v):null});PS.displayName=aA;function lA(e,n){return X.useReducer((o,u)=>n[o][u]??o,e)}var Kv=e=>{const{present:n,children:o}=e,u=uA(n),p=typeof o=="function"?o({present:u.isPresent}):X.Children.only(o),x=Is(u.ref,cA(p));return typeof o=="function"||u.isPresent?X.cloneElement(p,{ref:x}):null};Kv.displayName="Presence";function uA(e){const[n,o]=X.useState(),u=X.useRef(null),p=X.useRef(e),x=X.useRef("none"),v=e?"mounted":"unmounted",[c,k]=lA(v,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return X.useEffect(()=>{const A=dp(u.current);x.current=c==="mounted"?A:"none"},[c]),Na(()=>{const A=u.current,B=p.current;if(B!==e){const L=x.current,$=dp(A);e?k("MOUNT"):$==="none"||(A==null?void 0:A.display)==="none"?k("UNMOUNT"):k(B&&L!==$?"ANIMATION_OUT":"UNMOUNT"),p.current=e}},[e,k]),Na(()=>{if(n){let A;const B=n.ownerDocument.defaultView??window,R=$=>{const Q=dp(u.current).includes(CSS.escape($.animationName));if($.target===n&&Q&&(k("ANIMATION_END"),!p.current)){const se=n.style.animationFillMode;n.style.animationFillMode="forwards",A=B.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=se)})}},L=$=>{$.target===n&&(x.current=dp(u.current))};return n.addEventListener("animationstart",L),n.addEventListener("animationcancel",R),n.addEventListener("animationend",R),()=>{B.clearTimeout(A),n.removeEventListener("animationstart",L),n.removeEventListener("animationcancel",R),n.removeEventListener("animationend",R)}}else k("ANIMATION_END")},[n,k]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:X.useCallback(A=>{u.current=A?getComputedStyle(A):null,o(A)},[])}}function dp(e){return(e==null?void 0:e.animationName)||"none"}function cA(e){var u,p;let n=(u=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:u.get,o=n&&"isReactWarning"in n&&n.isReactWarning;return o?e.ref:(n=(p=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:p.get,o=n&&"isReactWarning"in n&&n.isReactWarning,o?e.props.ref:e.props.ref||e.ref)}var hA=iv[" useInsertionEffect ".trim().toString()]||Na;function dA({prop:e,defaultProp:n,onChange:o=()=>{},caller:u}){const[p,x,v]=fA({defaultProp:n,onChange:o}),c=e!==void 0,k=c?e:p;{const B=X.useRef(e!==void 0);X.useEffect(()=>{const R=B.current;R!==c&&console.warn(`${u} is changing from ${R?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),B.current=c},[c,u])}const A=X.useCallback(B=>{var R;if(c){const L=pA(B)?B(e):B;L!==e&&((R=v.current)==null||R.call(v,L))}else x(B)},[c,e,x,v]);return[k,A]}function fA({defaultProp:e,onChange:n}){const[o,u]=X.useState(e),p=X.useRef(o),x=X.useRef(n);return hA(()=>{x.current=n},[n]),X.useEffect(()=>{var v;p.current!==o&&((v=x.current)==null||v.call(x,o),p.current=o)},[o,p]),[o,u,x]}function pA(e){return typeof e=="function"}var mA=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),gA="VisuallyHidden",Im=X.forwardRef((e,n)=>ee.jsx(Ei.span,{...e,ref:n,style:{...mA,...e.style}}));Im.displayName=gA;var yA=Im,Yv="ToastProvider",[Jv,_A,vA]=qI("Toast"),[IS]=Pm("Toast",[vA]),[xA,Am]=IS(Yv),AS=e=>{const{__scopeToast:n,label:o="Notification",duration:u=5e3,swipeDirection:p="right",swipeThreshold:x=50,children:v}=e,[c,k]=X.useState(null),[A,B]=X.useState(0),R=X.useRef(!1),L=X.useRef(!1);return o.trim()||console.error(`Invalid prop \`label\` supplied to \`${Yv}\`. Expected non-empty \`string\`.`),ee.jsx(Jv.Provider,{scope:n,children:ee.jsx(xA,{scope:n,label:o,duration:u,swipeDirection:p,swipeThreshold:x,toastCount:A,viewport:c,onViewportChange:k,onToastAdd:X.useCallback(()=>B($=>$+1),[]),onToastRemove:X.useCallback(()=>B($=>$-1),[]),isFocusedToastEscapeKeyDownRef:R,isClosePausedRef:L,children:v})})};AS.displayName=Yv;var MS="ToastViewport",wA=["F8"],A_="toast.viewportPause",M_="toast.viewportResume",zS=X.forwardRef((e,n)=>{const{__scopeToast:o,hotkey:u=wA,label:p="Notifications ({hotkey})",...x}=e,v=Am(MS,o),c=_A(o),k=X.useRef(null),A=X.useRef(null),B=X.useRef(null),R=X.useRef(null),L=Is(n,R,v.onViewportChange),$=u.join("+").replace(/Key/g,"").replace(/Digit/g,""),le=v.toastCount>0;X.useEffect(()=>{const se=W=>{var K;u.length!==0&&u.every(he=>W[he]||W.code===he)&&((K=R.current)==null||K.focus())};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[u]),X.useEffect(()=>{const se=k.current,W=R.current;if(le&&se&&W){const G=()=>{if(!v.isClosePausedRef.current){const ke=new CustomEvent(A_);W.dispatchEvent(ke),v.isClosePausedRef.current=!0}},K=()=>{if(v.isClosePausedRef.current){const ke=new CustomEvent(M_);W.dispatchEvent(ke),v.isClosePausedRef.current=!1}},he=ke=>{!se.contains(ke.relatedTarget)&&K()},be=()=>{se.contains(document.activeElement)||K()};return se.addEventListener("focusin",G),se.addEventListener("focusout",he),se.addEventListener("pointermove",G),se.addEventListener("pointerleave",be),window.addEventListener("blur",G),window.addEventListener("focus",K),()=>{se.removeEventListener("focusin",G),se.removeEventListener("focusout",he),se.removeEventListener("pointermove",G),se.removeEventListener("pointerleave",be),window.removeEventListener("blur",G),window.removeEventListener("focus",K)}}},[le,v.isClosePausedRef]);const Q=X.useCallback(({tabbingDirection:se})=>{const G=c().map(K=>{const he=K.ref.current,be=[he,...RA(he)];return se==="forwards"?be:be.reverse()});return(se==="forwards"?G.reverse():G).flat()},[c]);return X.useEffect(()=>{const se=R.current;if(se){const W=G=>{var be,ke,Pe;const K=G.altKey||G.ctrlKey||G.metaKey;if(G.key==="Tab"&&!K){const Fe=document.activeElement,st=G.shiftKey;if(G.target===se&&st){(be=A.current)==null||be.focus();return}const ot=Q({tabbingDirection:st?"backwards":"forwards"}),xt=ot.findIndex(He=>He===Fe);zy(ot.slice(xt+1))?G.preventDefault():st?(ke=A.current)==null||ke.focus():(Pe=B.current)==null||Pe.focus()}};return se.addEventListener("keydown",W),()=>se.removeEventListener("keydown",W)}},[c,Q]),ee.jsxs(oA,{ref:k,role:"region","aria-label":p.replace("{hotkey}",$),tabIndex:-1,style:{pointerEvents:le?void 0:"none"},children:[le&&ee.jsx(z_,{ref:A,onFocusFromOutsideViewport:()=>{const se=Q({tabbingDirection:"forwards"});zy(se)}}),ee.jsx(Jv.Slot,{scope:o,children:ee.jsx(Ei.ol,{tabIndex:-1,...x,ref:L})}),le&&ee.jsx(z_,{ref:B,onFocusFromOutsideViewport:()=>{const se=Q({tabbingDirection:"backwards"});zy(se)}})]})});zS.displayName=MS;var DS="ToastFocusProxy",z_=X.forwardRef((e,n)=>{const{__scopeToast:o,onFocusFromOutsideViewport:u,...p}=e,x=Am(DS,o);return ee.jsx(Im,{tabIndex:0,...p,ref:n,style:{position:"fixed"},onFocus:v=>{var A;const c=v.relatedTarget;!((A=x.viewport)!=null&&A.contains(c))&&u()}})});z_.displayName=DS;var jd="Toast",bA="toast.swipeStart",SA="toast.swipeMove",TA="toast.swipeCancel",EA="toast.swipeEnd",RS=X.forwardRef((e,n)=>{const{forceMount:o,open:u,defaultOpen:p,onOpenChange:x,...v}=e,[c,k]=dA({prop:u,defaultProp:p??!0,onChange:x,caller:jd});return ee.jsx(Kv,{present:o||c,children:ee.jsx(PA,{open:c,...v,ref:n,onClose:()=>k(!1),onPause:Ba(e.onPause),onResume:Ba(e.onResume),onSwipeStart:tn(e.onSwipeStart,A=>{A.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:tn(e.onSwipeMove,A=>{const{x:B,y:R}=A.detail.delta;A.currentTarget.setAttribute("data-swipe","move"),A.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${B}px`),A.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${R}px`)}),onSwipeCancel:tn(e.onSwipeCancel,A=>{A.currentTarget.setAttribute("data-swipe","cancel"),A.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),A.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),A.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),A.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:tn(e.onSwipeEnd,A=>{const{x:B,y:R}=A.detail.delta;A.currentTarget.setAttribute("data-swipe","end"),A.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),A.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),A.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${B}px`),A.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${R}px`),k(!1)})})})});RS.displayName=jd;var[CA,kA]=IS(jd,{onClose(){}}),PA=X.forwardRef((e,n)=>{const{__scopeToast:o,type:u="foreground",duration:p,open:x,onClose:v,onEscapeKeyDown:c,onPause:k,onResume:A,onSwipeStart:B,onSwipeMove:R,onSwipeCancel:L,onSwipeEnd:$,...le}=e,Q=Am(jd,o),[se,W]=X.useState(null),G=Is(n,He=>W(He)),K=X.useRef(null),he=X.useRef(null),be=p||Q.duration,ke=X.useRef(0),Pe=X.useRef(be),Fe=X.useRef(0),{onToastAdd:st,onToastRemove:Be}=Q,qe=Ba(()=>{var It;(se==null?void 0:se.contains(document.activeElement))&&((It=Q.viewport)==null||It.focus()),v()}),ot=X.useCallback(He=>{!He||He===1/0||(window.clearTimeout(Fe.current),ke.current=new Date().getTime(),Fe.current=window.setTimeout(qe,He))},[qe]);X.useEffect(()=>{const He=Q.viewport;if(He){const It=()=>{ot(Pe.current),A==null||A()},bt=()=>{const wt=new Date().getTime()-ke.current;Pe.current=Pe.current-wt,window.clearTimeout(Fe.current),k==null||k()};return He.addEventListener(A_,bt),He.addEventListener(M_,It),()=>{He.removeEventListener(A_,bt),He.removeEventListener(M_,It)}}},[Q.viewport,be,k,A,ot]),X.useEffect(()=>{x&&!Q.isClosePausedRef.current&&ot(be)},[x,be,Q.isClosePausedRef,ot]),X.useEffect(()=>(st(),()=>Be()),[st,Be]);const xt=X.useMemo(()=>se?VS(se):null,[se]);return Q.viewport?ee.jsxs(ee.Fragment,{children:[xt&&ee.jsx(IA,{__scopeToast:o,role:"status","aria-live":u==="foreground"?"assertive":"polite",children:xt}),ee.jsx(CA,{scope:o,onClose:qe,children:Nd.createPortal(ee.jsx(Jv.ItemSlot,{scope:o,children:ee.jsx(sA,{asChild:!0,onEscapeKeyDown:tn(c,()=>{Q.isFocusedToastEscapeKeyDownRef.current||qe(),Q.isFocusedToastEscapeKeyDownRef.current=!1}),children:ee.jsx(Ei.li,{tabIndex:0,"data-state":x?"open":"closed","data-swipe-direction":Q.swipeDirection,...le,ref:G,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:tn(e.onKeyDown,He=>{He.key==="Escape"&&(c==null||c(He.nativeEvent),He.nativeEvent.defaultPrevented||(Q.isFocusedToastEscapeKeyDownRef.current=!0,qe()))}),onPointerDown:tn(e.onPointerDown,He=>{He.button===0&&(K.current={x:He.clientX,y:He.clientY})}),onPointerMove:tn(e.onPointerMove,He=>{if(!K.current)return;const It=He.clientX-K.current.x,bt=He.clientY-K.current.y,wt=!!he.current,De=["left","right"].includes(Q.swipeDirection),Re=["left","up"].includes(Q.swipeDirection)?Math.min:Math.max,et=De?Re(0,It):0,yt=De?0:Re(0,bt),dt=He.pointerType==="touch"?10:2,Mt={x:et,y:yt},At={originalEvent:He,delta:Mt};wt?(he.current=Mt,fp(SA,R,At,{discrete:!1})):yb(Mt,Q.swipeDirection,dt)?(he.current=Mt,fp(bA,B,At,{discrete:!1}),He.target.setPointerCapture(He.pointerId)):(Math.abs(It)>dt||Math.abs(bt)>dt)&&(K.current=null)}),onPointerUp:tn(e.onPointerUp,He=>{const It=he.current,bt=He.target;if(bt.hasPointerCapture(He.pointerId)&&bt.releasePointerCapture(He.pointerId),he.current=null,K.current=null,It){const wt=He.currentTarget,De={originalEvent:He,delta:It};yb(It,Q.swipeDirection,Q.swipeThreshold)?fp(EA,$,De,{discrete:!0}):fp(TA,L,De,{discrete:!0}),wt.addEventListener("click",Re=>Re.preventDefault(),{once:!0})}})})})}),Q.viewport)})]}):null}),IA=e=>{const{__scopeToast:n,children:o,...u}=e,p=Am(jd,n),[x,v]=X.useState(!1),[c,k]=X.useState(!1);return zA(()=>v(!0)),X.useEffect(()=>{const A=window.setTimeout(()=>k(!0),1e3);return()=>window.clearTimeout(A)},[]),c?null:ee.jsx(PS,{asChild:!0,children:ee.jsx(Im,{...u,children:x&&ee.jsxs(ee.Fragment,{children:[p.label," ",o]})})})},AA="ToastTitle",LS=X.forwardRef((e,n)=>{const{__scopeToast:o,...u}=e;return ee.jsx(Ei.div,{...u,ref:n})});LS.displayName=AA;var MA="ToastDescription",FS=X.forwardRef((e,n)=>{const{__scopeToast:o,...u}=e;return ee.jsx(Ei.div,{...u,ref:n})});FS.displayName=MA;var OS="ToastAction",BS=X.forwardRef((e,n)=>{const{altText:o,...u}=e;return o.trim()?ee.jsx(jS,{altText:o,asChild:!0,children:ee.jsx(Qv,{...u,ref:n})}):(console.error(`Invalid prop \`altText\` supplied to \`${OS}\`. Expected non-empty \`string\`.`),null)});BS.displayName=OS;var NS="ToastClose",Qv=X.forwardRef((e,n)=>{const{__scopeToast:o,...u}=e,p=kA(NS,o);return ee.jsx(jS,{asChild:!0,children:ee.jsx(Ei.button,{type:"button",...u,ref:n,onClick:tn(e.onClick,p.onClose)})})});Qv.displayName=NS;var jS=X.forwardRef((e,n)=>{const{__scopeToast:o,altText:u,...p}=e;return ee.jsx(Ei.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":u||void 0,...p,ref:n})});function VS(e){const n=[];return Array.from(e.childNodes).forEach(u=>{if(u.nodeType===u.TEXT_NODE&&u.textContent&&n.push(u.textContent),DA(u)){const p=u.ariaHidden||u.hidden||u.style.display==="none",x=u.dataset.radixToastAnnounceExclude==="";if(!p)if(x){const v=u.dataset.radixToastAnnounceAlt;v&&n.push(v)}else n.push(...VS(u))}}),n}function fp(e,n,o,{discrete:u}){const p=o.originalEvent.currentTarget,x=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:o});n&&p.addEventListener(e,n,{once:!0}),u?TS(p,x):p.dispatchEvent(x)}var yb=(e,n,o=0)=>{const u=Math.abs(e.x),p=Math.abs(e.y),x=u>p;return n==="left"||n==="right"?x&&u>o:!x&&p>o};function zA(e=()=>{}){const n=Ba(e);Na(()=>{let o=0,u=0;return o=window.requestAnimationFrame(()=>u=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(o),window.cancelAnimationFrame(u)}},[n])}function DA(e){return e.nodeType===e.ELEMENT_NODE}function RA(e){const n=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:u=>{const p=u.tagName==="INPUT"&&u.type==="hidden";return u.disabled||u.hidden||p?NodeFilter.FILTER_SKIP:u.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)n.push(o.currentNode);return n}function zy(e){const n=document.activeElement;return e.some(o=>o===n?!0:(o.focus(),document.activeElement!==n))}var LA=AS,$S=zS,US=RS,qS=LS,ZS=FS,HS=BS,GS=Qv;function WS(e){var n,o,u="";if(typeof e=="string"||typeof e=="number")u+=e;else if(typeof e=="object")if(Array.isArray(e)){var p=e.length;for(n=0;n<p;n++)e[n]&&(o=WS(e[n]))&&(u&&(u+=" "),u+=o)}else for(o in e)e[o]&&(u&&(u+=" "),u+=o);return u}function XS(){for(var e,n,o=0,u="",p=arguments.length;o<p;o++)(e=arguments[o])&&(n=WS(e))&&(u&&(u+=" "),u+=n);return u}const _b=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,vb=XS,ex=(e,n)=>o=>{var u;if((n==null?void 0:n.variants)==null)return vb(e,o==null?void 0:o.class,o==null?void 0:o.className);const{variants:p,defaultVariants:x}=n,v=Object.keys(p).map(A=>{const B=o==null?void 0:o[A],R=x==null?void 0:x[A];if(B===null)return null;const L=_b(B)||_b(R);return p[A][L]}),c=o&&Object.entries(o).reduce((A,B)=>{let[R,L]=B;return L===void 0||(A[R]=L),A},{}),k=n==null||(u=n.compoundVariants)===null||u===void 0?void 0:u.reduce((A,B)=>{let{class:R,className:L,...$}=B;return Object.entries($).every(le=>{let[Q,se]=le;return Array.isArray(se)?se.includes({...x,...c}[Q]):{...x,...c}[Q]===se})?[...A,R,L]:A},[]);return vb(e,v,k,o==null?void 0:o.class,o==null?void 0:o.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),KS=(...e)=>e.filter((n,o,u)=>!!n&&n.trim()!==""&&u.indexOf(n)===o).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var OA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=X.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:u,className:p="",children:x,iconNode:v,...c},k)=>X.createElement("svg",{ref:k,...OA,width:n,height:n,stroke:e,strokeWidth:u?Number(o)*24/Number(n):o,className:KS("lucide",p),...c},[...v.map(([A,B])=>X.createElement(A,B)),...Array.isArray(x)?x:[x]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=(e,n)=>{const o=X.forwardRef(({className:u,...p},x)=>X.createElement(BA,{ref:x,iconNode:n,className:KS(`lucide-${FA(e)}`,u),...p}));return o.displayName=`${e}`,o};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NA=oi("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=oi("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=oi("Dog",[["path",{d:"M11.25 16.25h1.5L12 17z",key:"w7jh35"}],["path",{d:"M16 14v.5",key:"1lajdz"}],["path",{d:"M4.42 11.247A13.152 13.152 0 0 0 4 14.556C4 18.728 7.582 21 12 21s8-2.272 8-6.444a11.702 11.702 0 0 0-.493-3.309",key:"u7s9ue"}],["path",{d:"M8 14v.5",key:"1nzgdb"}],["path",{d:"M8.5 8.5c-.384 1.05-1.083 2.028-2.344 2.5-1.931.722-3.576-.297-3.656-1-.113-.994 1.177-6.53 4-7 1.923-.321 3.651.845 3.651 2.235A7.497 7.497 0 0 1 14 5.277c0-1.39 1.844-2.598 3.767-2.277 2.823.47 4.113 6.006 4 7-.08.703-1.725 1.722-3.656 1-1.261-.472-1.855-1.45-2.239-2.5",key:"v8hric"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=oi("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=oi("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=oi("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=oi("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=oi("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=oi("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=oi("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=oi("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=oi("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=oi("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=oi("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=oi("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),rx="-",GA=e=>{const n=XA(e),{conflictingClassGroups:o,conflictingClassGroupModifiers:u}=e;return{getClassGroupId:v=>{const c=v.split(rx);return c[0]===""&&c.length!==1&&c.shift(),JS(c,n)||WA(v)},getConflictingClassGroupIds:(v,c)=>{const k=o[v]||[];return c&&u[v]?[...k,...u[v]]:k}}},JS=(e,n)=>{var v;if(e.length===0)return n.classGroupId;const o=e[0],u=n.nextPart.get(o),p=u?JS(e.slice(1),u):void 0;if(p)return p;if(n.validators.length===0)return;const x=e.join(rx);return(v=n.validators.find(({validator:c})=>c(x)))==null?void 0:v.classGroupId},xb=/^\[(.+)\]$/,WA=e=>{if(xb.test(e)){const n=xb.exec(e)[1],o=n==null?void 0:n.substring(0,n.indexOf(":"));if(o)return"arbitrary.."+o}},XA=e=>{const{theme:n,prefix:o}=e,u={nextPart:new Map,validators:[]};return YA(Object.entries(e.classGroups),o).forEach(([x,v])=>{F_(v,u,x,n)}),u},F_=(e,n,o,u)=>{e.forEach(p=>{if(typeof p=="string"){const x=p===""?n:wb(n,p);x.classGroupId=o;return}if(typeof p=="function"){if(KA(p)){F_(p(u),n,o,u);return}n.validators.push({validator:p,classGroupId:o});return}Object.entries(p).forEach(([x,v])=>{F_(v,wb(n,x),o,u)})})},wb=(e,n)=>{let o=e;return n.split(rx).forEach(u=>{o.nextPart.has(u)||o.nextPart.set(u,{nextPart:new Map,validators:[]}),o=o.nextPart.get(u)}),o},KA=e=>e.isThemeGetter,YA=(e,n)=>n?e.map(([o,u])=>{const p=u.map(x=>typeof x=="string"?n+x:typeof x=="object"?Object.fromEntries(Object.entries(x).map(([v,c])=>[n+v,c])):x);return[o,p]}):e,JA=e=>{if(e<1)return{get:()=>{},set:()=>{}};let n=0,o=new Map,u=new Map;const p=(x,v)=>{o.set(x,v),n++,n>e&&(n=0,u=o,o=new Map)};return{get(x){let v=o.get(x);if(v!==void 0)return v;if((v=u.get(x))!==void 0)return p(x,v),v},set(x,v){o.has(x)?o.set(x,v):p(x,v)}}},QS="!",QA=e=>{const{separator:n,experimentalParseClassName:o}=e,u=n.length===1,p=n[0],x=n.length,v=c=>{const k=[];let A=0,B=0,R;for(let se=0;se<c.length;se++){let W=c[se];if(A===0){if(W===p&&(u||c.slice(se,se+x)===n)){k.push(c.slice(B,se)),B=se+x;continue}if(W==="/"){R=se;continue}}W==="["?A++:W==="]"&&A--}const L=k.length===0?c:c.substring(B),$=L.startsWith(QS),le=$?L.substring(1):L,Q=R&&R>B?R-B:void 0;return{modifiers:k,hasImportantModifier:$,baseClassName:le,maybePostfixModifierPosition:Q}};return o?c=>o({className:c,parseClassName:v}):v},eM=e=>{if(e.length<=1)return e;const n=[];let o=[];return e.forEach(u=>{u[0]==="["?(n.push(...o.sort(),u),o=[]):o.push(u)}),n.push(...o.sort()),n},tM=e=>({cache:JA(e.cacheSize),parseClassName:QA(e),...GA(e)}),rM=/\s+/,nM=(e,n)=>{const{parseClassName:o,getClassGroupId:u,getConflictingClassGroupIds:p}=n,x=[],v=e.trim().split(rM);let c="";for(let k=v.length-1;k>=0;k-=1){const A=v[k],{modifiers:B,hasImportantModifier:R,baseClassName:L,maybePostfixModifierPosition:$}=o(A);let le=!!$,Q=u(le?L.substring(0,$):L);if(!Q){if(!le){c=A+(c.length>0?" "+c:c);continue}if(Q=u(L),!Q){c=A+(c.length>0?" "+c:c);continue}le=!1}const se=eM(B).join(":"),W=R?se+QS:se,G=W+Q;if(x.includes(G))continue;x.push(G);const K=p(Q,le);for(let he=0;he<K.length;++he){const be=K[he];x.push(W+be)}c=A+(c.length>0?" "+c:c)}return c};function iM(){let e=0,n,o,u="";for(;e<arguments.length;)(n=arguments[e++])&&(o=eT(n))&&(u&&(u+=" "),u+=o);return u}const eT=e=>{if(typeof e=="string")return e;let n,o="";for(let u=0;u<e.length;u++)e[u]&&(n=eT(e[u]))&&(o&&(o+=" "),o+=n);return o};function sM(e,...n){let o,u,p,x=v;function v(k){const A=n.reduce((B,R)=>R(B),e());return o=tM(A),u=o.cache.get,p=o.cache.set,x=c,c(k)}function c(k){const A=u(k);if(A)return A;const B=nM(k,o);return p(k,B),B}return function(){return x(iM.apply(null,arguments))}}const vr=e=>{const n=o=>o[e]||[];return n.isThemeGetter=!0,n},tT=/^\[(?:([a-z-]+):)?(.+)\]$/i,oM=/^\d+\/\d+$/,aM=new Set(["px","full","screen"]),lM=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,uM=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,cM=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,hM=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,dM=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,yo=e=>ic(e)||aM.has(e)||oM.test(e),da=e=>Cc(e,"length",xM),ic=e=>!!e&&!Number.isNaN(Number(e)),Dy=e=>Cc(e,"number",ic),Hh=e=>!!e&&Number.isInteger(Number(e)),fM=e=>e.endsWith("%")&&ic(e.slice(0,-1)),jt=e=>tT.test(e),fa=e=>lM.test(e),pM=new Set(["length","size","percentage"]),mM=e=>Cc(e,pM,rT),gM=e=>Cc(e,"position",rT),yM=new Set(["image","url"]),_M=e=>Cc(e,yM,bM),vM=e=>Cc(e,"",wM),Gh=()=>!0,Cc=(e,n,o)=>{const u=tT.exec(e);return u?u[1]?typeof n=="string"?u[1]===n:n.has(u[1]):o(u[2]):!1},xM=e=>uM.test(e)&&!cM.test(e),rT=()=>!1,wM=e=>hM.test(e),bM=e=>dM.test(e),SM=()=>{const e=vr("colors"),n=vr("spacing"),o=vr("blur"),u=vr("brightness"),p=vr("borderColor"),x=vr("borderRadius"),v=vr("borderSpacing"),c=vr("borderWidth"),k=vr("contrast"),A=vr("grayscale"),B=vr("hueRotate"),R=vr("invert"),L=vr("gap"),$=vr("gradientColorStops"),le=vr("gradientColorStopPositions"),Q=vr("inset"),se=vr("margin"),W=vr("opacity"),G=vr("padding"),K=vr("saturate"),he=vr("scale"),be=vr("sepia"),ke=vr("skew"),Pe=vr("space"),Fe=vr("translate"),st=()=>["auto","contain","none"],Be=()=>["auto","hidden","clip","visible","scroll"],qe=()=>["auto",jt,n],ot=()=>[jt,n],xt=()=>["",yo,da],He=()=>["auto",ic,jt],It=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],bt=()=>["solid","dashed","dotted","double","none"],wt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],De=()=>["start","end","center","between","around","evenly","stretch"],Re=()=>["","0",jt],et=()=>["auto","avoid","all","avoid-page","page","left","right","column"],yt=()=>[ic,jt];return{cacheSize:500,separator:":",theme:{colors:[Gh],spacing:[yo,da],blur:["none","",fa,jt],brightness:yt(),borderColor:[e],borderRadius:["none","","full",fa,jt],borderSpacing:ot(),borderWidth:xt(),contrast:yt(),grayscale:Re(),hueRotate:yt(),invert:Re(),gap:ot(),gradientColorStops:[e],gradientColorStopPositions:[fM,da],inset:qe(),margin:qe(),opacity:yt(),padding:ot(),saturate:yt(),scale:yt(),sepia:Re(),skew:yt(),space:ot(),translate:ot()},classGroups:{aspect:[{aspect:["auto","square","video",jt]}],container:["container"],columns:[{columns:[fa]}],"break-after":[{"break-after":et()}],"break-before":[{"break-before":et()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...It(),jt]}],overflow:[{overflow:Be()}],"overflow-x":[{"overflow-x":Be()}],"overflow-y":[{"overflow-y":Be()}],overscroll:[{overscroll:st()}],"overscroll-x":[{"overscroll-x":st()}],"overscroll-y":[{"overscroll-y":st()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[Q]}],"inset-x":[{"inset-x":[Q]}],"inset-y":[{"inset-y":[Q]}],start:[{start:[Q]}],end:[{end:[Q]}],top:[{top:[Q]}],right:[{right:[Q]}],bottom:[{bottom:[Q]}],left:[{left:[Q]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Hh,jt]}],basis:[{basis:qe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",jt]}],grow:[{grow:Re()}],shrink:[{shrink:Re()}],order:[{order:["first","last","none",Hh,jt]}],"grid-cols":[{"grid-cols":[Gh]}],"col-start-end":[{col:["auto",{span:["full",Hh,jt]},jt]}],"col-start":[{"col-start":He()}],"col-end":[{"col-end":He()}],"grid-rows":[{"grid-rows":[Gh]}],"row-start-end":[{row:["auto",{span:[Hh,jt]},jt]}],"row-start":[{"row-start":He()}],"row-end":[{"row-end":He()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",jt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",jt]}],gap:[{gap:[L]}],"gap-x":[{"gap-x":[L]}],"gap-y":[{"gap-y":[L]}],"justify-content":[{justify:["normal",...De()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...De(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...De(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[G]}],px:[{px:[G]}],py:[{py:[G]}],ps:[{ps:[G]}],pe:[{pe:[G]}],pt:[{pt:[G]}],pr:[{pr:[G]}],pb:[{pb:[G]}],pl:[{pl:[G]}],m:[{m:[se]}],mx:[{mx:[se]}],my:[{my:[se]}],ms:[{ms:[se]}],me:[{me:[se]}],mt:[{mt:[se]}],mr:[{mr:[se]}],mb:[{mb:[se]}],ml:[{ml:[se]}],"space-x":[{"space-x":[Pe]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Pe]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",jt,n]}],"min-w":[{"min-w":[jt,n,"min","max","fit"]}],"max-w":[{"max-w":[jt,n,"none","full","min","max","fit","prose",{screen:[fa]},fa]}],h:[{h:[jt,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[jt,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[jt,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[jt,n,"auto","min","max","fit"]}],"font-size":[{text:["base",fa,da]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Dy]}],"font-family":[{font:[Gh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",jt]}],"line-clamp":[{"line-clamp":["none",ic,Dy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",yo,jt]}],"list-image":[{"list-image":["none",jt]}],"list-style-type":[{list:["none","disc","decimal",jt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[W]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[W]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...bt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",yo,da]}],"underline-offset":[{"underline-offset":["auto",yo,jt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ot()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",jt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",jt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[W]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...It(),gM]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",mM]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},_M]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[le]}],"gradient-via-pos":[{via:[le]}],"gradient-to-pos":[{to:[le]}],"gradient-from":[{from:[$]}],"gradient-via":[{via:[$]}],"gradient-to":[{to:[$]}],rounded:[{rounded:[x]}],"rounded-s":[{"rounded-s":[x]}],"rounded-e":[{"rounded-e":[x]}],"rounded-t":[{"rounded-t":[x]}],"rounded-r":[{"rounded-r":[x]}],"rounded-b":[{"rounded-b":[x]}],"rounded-l":[{"rounded-l":[x]}],"rounded-ss":[{"rounded-ss":[x]}],"rounded-se":[{"rounded-se":[x]}],"rounded-ee":[{"rounded-ee":[x]}],"rounded-es":[{"rounded-es":[x]}],"rounded-tl":[{"rounded-tl":[x]}],"rounded-tr":[{"rounded-tr":[x]}],"rounded-br":[{"rounded-br":[x]}],"rounded-bl":[{"rounded-bl":[x]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[W]}],"border-style":[{border:[...bt(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[W]}],"divide-style":[{divide:bt()}],"border-color":[{border:[p]}],"border-color-x":[{"border-x":[p]}],"border-color-y":[{"border-y":[p]}],"border-color-s":[{"border-s":[p]}],"border-color-e":[{"border-e":[p]}],"border-color-t":[{"border-t":[p]}],"border-color-r":[{"border-r":[p]}],"border-color-b":[{"border-b":[p]}],"border-color-l":[{"border-l":[p]}],"divide-color":[{divide:[p]}],"outline-style":[{outline:["",...bt()]}],"outline-offset":[{"outline-offset":[yo,jt]}],"outline-w":[{outline:[yo,da]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:xt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[W]}],"ring-offset-w":[{"ring-offset":[yo,da]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",fa,vM]}],"shadow-color":[{shadow:[Gh]}],opacity:[{opacity:[W]}],"mix-blend":[{"mix-blend":[...wt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":wt()}],filter:[{filter:["","none"]}],blur:[{blur:[o]}],brightness:[{brightness:[u]}],contrast:[{contrast:[k]}],"drop-shadow":[{"drop-shadow":["","none",fa,jt]}],grayscale:[{grayscale:[A]}],"hue-rotate":[{"hue-rotate":[B]}],invert:[{invert:[R]}],saturate:[{saturate:[K]}],sepia:[{sepia:[be]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[o]}],"backdrop-brightness":[{"backdrop-brightness":[u]}],"backdrop-contrast":[{"backdrop-contrast":[k]}],"backdrop-grayscale":[{"backdrop-grayscale":[A]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[B]}],"backdrop-invert":[{"backdrop-invert":[R]}],"backdrop-opacity":[{"backdrop-opacity":[W]}],"backdrop-saturate":[{"backdrop-saturate":[K]}],"backdrop-sepia":[{"backdrop-sepia":[be]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[v]}],"border-spacing-x":[{"border-spacing-x":[v]}],"border-spacing-y":[{"border-spacing-y":[v]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",jt]}],duration:[{duration:yt()}],ease:[{ease:["linear","in","out","in-out",jt]}],delay:[{delay:yt()}],animate:[{animate:["none","spin","ping","pulse","bounce",jt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[he]}],"scale-x":[{"scale-x":[he]}],"scale-y":[{"scale-y":[he]}],rotate:[{rotate:[Hh,jt]}],"translate-x":[{"translate-x":[Fe]}],"translate-y":[{"translate-y":[Fe]}],"skew-x":[{"skew-x":[ke]}],"skew-y":[{"skew-y":[ke]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",jt]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",jt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ot()}],"scroll-mx":[{"scroll-mx":ot()}],"scroll-my":[{"scroll-my":ot()}],"scroll-ms":[{"scroll-ms":ot()}],"scroll-me":[{"scroll-me":ot()}],"scroll-mt":[{"scroll-mt":ot()}],"scroll-mr":[{"scroll-mr":ot()}],"scroll-mb":[{"scroll-mb":ot()}],"scroll-ml":[{"scroll-ml":ot()}],"scroll-p":[{"scroll-p":ot()}],"scroll-px":[{"scroll-px":ot()}],"scroll-py":[{"scroll-py":ot()}],"scroll-ps":[{"scroll-ps":ot()}],"scroll-pe":[{"scroll-pe":ot()}],"scroll-pt":[{"scroll-pt":ot()}],"scroll-pr":[{"scroll-pr":ot()}],"scroll-pb":[{"scroll-pb":ot()}],"scroll-pl":[{"scroll-pl":ot()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",jt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[yo,da,Dy]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},TM=sM(SM);function nn(...e){return TM(XS(e))}const EM=LA,nT=X.forwardRef(({className:e,...n},o)=>ee.jsx($S,{ref:o,className:nn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...n}));nT.displayName=$S.displayName;const CM=ex("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),iT=X.forwardRef(({className:e,variant:n,...o},u)=>ee.jsx(US,{ref:u,className:nn(CM({variant:n}),e),...o}));iT.displayName=US.displayName;const kM=X.forwardRef(({className:e,...n},o)=>ee.jsx(HS,{ref:o,className:nn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...n}));kM.displayName=HS.displayName;const sT=X.forwardRef(({className:e,...n},o)=>ee.jsx(GS,{ref:o,className:nn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...n,children:ee.jsx(YS,{className:"h-4 w-4"})}));sT.displayName=GS.displayName;const oT=X.forwardRef(({className:e,...n},o)=>ee.jsx(qS,{ref:o,className:nn("text-sm font-semibold",e),...n}));oT.displayName=qS.displayName;const aT=X.forwardRef(({className:e,...n},o)=>ee.jsx(ZS,{ref:o,className:nn("text-sm opacity-90",e),...n}));aT.displayName=ZS.displayName;function PM(){const{toasts:e}=OI();return ee.jsxs(EM,{children:[e.map(function({id:n,title:o,description:u,action:p,...x}){return ee.jsxs(iT,{...x,children:[ee.jsxs("div",{className:"grid gap-1",children:[o&&ee.jsx(oT,{children:o}),u&&ee.jsx(aT,{children:u})]}),p,ee.jsx(sT,{})]},n)}),ee.jsx(nT,{})]})}var bb=["light","dark"],IM="(prefers-color-scheme: dark)",AM=X.createContext(void 0),MM={setTheme:e=>{},themes:[]},zM=()=>{var e;return(e=X.useContext(AM))!=null?e:MM};X.memo(({forcedTheme:e,storageKey:n,attribute:o,enableSystem:u,enableColorScheme:p,defaultTheme:x,value:v,attrs:c,nonce:k})=>{let A=x==="system",B=o==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(le=>`'${le}'`).join(",")})`};`:`var d=document.documentElement,n='${o}',s='setAttribute';`,R=p?bb.includes(x)&&x?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${x}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",L=(le,Q=!1,se=!0)=>{let W=v?v[le]:le,G=Q?le+"|| ''":`'${W}'`,K="";return p&&se&&!Q&&bb.includes(le)&&(K+=`d.style.colorScheme = '${le}';`),o==="class"?Q||W?K+=`c.add(${G})`:K+="null":W&&(K+=`d[s](n,${G})`),K},$=e?`!function(){${B}${L(e)}}()`:u?`!function(){try{${B}var e=localStorage.getItem('${n}');if('system'===e||(!e&&${A})){var t='${IM}',m=window.matchMedia(t);if(m.media!==t||m.matches){${L("dark")}}else{${L("light")}}}else if(e){${v?`var x=${JSON.stringify(v)};`:""}${L(v?"x[e]":"e",!0)}}${A?"":"else{"+L(x,!1,!1)+"}"}${R}}catch(e){}}()`:`!function(){try{${B}var e=localStorage.getItem('${n}');if(e){${v?`var x=${JSON.stringify(v)};`:""}${L(v?"x[e]":"e",!0)}}else{${L(x,!1,!1)};}${R}}catch(t){}}();`;return X.createElement("script",{nonce:k,dangerouslySetInnerHTML:{__html:$}})});var DM=e=>{switch(e){case"success":return FM;case"info":return BM;case"warning":return OM;case"error":return NM;default:return null}},RM=Array(12).fill(0),LM=({visible:e,className:n})=>Ye.createElement("div",{className:["sonner-loading-wrapper",n].filter(Boolean).join(" "),"data-visible":e},Ye.createElement("div",{className:"sonner-spinner"},RM.map((o,u)=>Ye.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${u}`})))),FM=Ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ye.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),OM=Ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ye.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),BM=Ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ye.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),NM=Ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ye.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),jM=Ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ye.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ye.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),VM=()=>{let[e,n]=Ye.useState(document.hidden);return Ye.useEffect(()=>{let o=()=>{n(document.hidden)};return document.addEventListener("visibilitychange",o),()=>window.removeEventListener("visibilitychange",o)},[]),e},O_=1,$M=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;let{message:o,...u}=e,p=typeof(e==null?void 0:e.id)=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:O_++,x=this.toasts.find(c=>c.id===p),v=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(p)&&this.dismissedToasts.delete(p),x?this.toasts=this.toasts.map(c=>c.id===p?(this.publish({...c,...e,id:p,title:o}),{...c,...e,id:p,dismissible:v,title:o}):c):this.addToast({title:o,...u,dismissible:v,id:p}),p},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(n=>{this.subscribers.forEach(o=>o({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:e,dismiss:!0})),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let o;n.loading!==void 0&&(o=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let u=e instanceof Promise?e:e(),p=o!==void 0,x,v=u.then(async k=>{if(x=["resolve",k],Ye.isValidElement(k))p=!1,this.create({id:o,type:"default",message:k});else if(qM(k)&&!k.ok){p=!1;let A=typeof n.error=="function"?await n.error(`HTTP error! status: ${k.status}`):n.error,B=typeof n.description=="function"?await n.description(`HTTP error! status: ${k.status}`):n.description;this.create({id:o,type:"error",message:A,description:B})}else if(n.success!==void 0){p=!1;let A=typeof n.success=="function"?await n.success(k):n.success,B=typeof n.description=="function"?await n.description(k):n.description;this.create({id:o,type:"success",message:A,description:B})}}).catch(async k=>{if(x=["reject",k],n.error!==void 0){p=!1;let A=typeof n.error=="function"?await n.error(k):n.error,B=typeof n.description=="function"?await n.description(k):n.description;this.create({id:o,type:"error",message:A,description:B})}}).finally(()=>{var k;p&&(this.dismiss(o),o=void 0),(k=n.finally)==null||k.call(n)}),c=()=>new Promise((k,A)=>v.then(()=>x[0]==="reject"?A(x[1]):k(x[1])).catch(A));return typeof o!="string"&&typeof o!="number"?{unwrap:c}:Object.assign(o,{unwrap:c})},this.custom=(e,n)=>{let o=(n==null?void 0:n.id)||O_++;return this.create({jsx:e(o),id:o,...n}),o},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},vi=new $M,UM=(e,n)=>{let o=(n==null?void 0:n.id)||O_++;return vi.addToast({title:e,...n,id:o}),o},qM=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",ZM=UM,HM=()=>vi.toasts,GM=()=>vi.getActiveToasts(),Br=Object.assign(ZM,{success:vi.success,info:vi.info,warning:vi.warning,error:vi.error,custom:vi.custom,message:vi.message,promise:vi.promise,dismiss:vi.dismiss,loading:vi.loading},{getHistory:HM,getToasts:GM});function WM(e,{insertAt:n}={}){if(typeof document>"u")return;let o=document.head||document.getElementsByTagName("head")[0],u=document.createElement("style");u.type="text/css",n==="top"&&o.firstChild?o.insertBefore(u,o.firstChild):o.appendChild(u),u.styleSheet?u.styleSheet.cssText=e:u.appendChild(document.createTextNode(e))}WM(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function pp(e){return e.label!==void 0}var XM=3,KM="32px",YM="16px",Sb=4e3,JM=356,QM=14,ez=20,tz=200;function _s(...e){return e.filter(Boolean).join(" ")}function rz(e){let[n,o]=e.split("-"),u=[];return n&&u.push(n),o&&u.push(o),u}var nz=e=>{var n,o,u,p,x,v,c,k,A,B,R;let{invert:L,toast:$,unstyled:le,interacting:Q,setHeights:se,visibleToasts:W,heights:G,index:K,toasts:he,expanded:be,removeToast:ke,defaultRichColors:Pe,closeButton:Fe,style:st,cancelButtonStyle:Be,actionButtonStyle:qe,className:ot="",descriptionClassName:xt="",duration:He,position:It,gap:bt,loadingIcon:wt,expandByDefault:De,classNames:Re,icons:et,closeButtonAriaLabel:yt="Close toast",pauseWhenPageIsHidden:dt}=e,[Mt,At]=Ye.useState(null),[Yt,gr]=Ye.useState(null),[zt,Vr]=Ye.useState(!1),[sn,_n]=Ye.useState(!1),[kn,on]=Ye.useState(!1),[Xr,Un]=Ye.useState(!1),[Yi,Te]=Ye.useState(!1),[Ci,ki]=Ye.useState(0),[Ot,lr]=Ye.useState(0),Pi=Ye.useRef($.duration||He||Sb),Ii=Ye.useRef(null),Kr=Ye.useRef(null),zs=K===0,Pn=K+1<=W,$r=$.type,ai=$.dismissible!==!1,Ne=$.className||"",li=$.descriptionClassName||"",zr=Ye.useMemo(()=>G.findIndex(F=>F.toastId===$.id)||0,[G,$.id]),ui=Ye.useMemo(()=>{var F;return(F=$.closeButton)!=null?F:Fe},[$.closeButton,Fe]),Ai=Ye.useMemo(()=>$.duration||He||Sb,[$.duration,He]),je=Ye.useRef(0),Ct=Ye.useRef(0),vt=Ye.useRef(0),Cr=Ye.useRef(null),[qn,kt]=It.split("-"),Zn=Ye.useMemo(()=>G.reduce((F,q,J)=>J>=zr?F:F+q.height,0),[G,zr]),ci=VM(),Ji=$.invert||L,In=$r==="loading";Ct.current=Ye.useMemo(()=>zr*bt+Zn,[zr,Zn]),Ye.useEffect(()=>{Pi.current=Ai},[Ai]),Ye.useEffect(()=>{Vr(!0)},[]),Ye.useEffect(()=>{let F=Kr.current;if(F){let q=F.getBoundingClientRect().height;return lr(q),se(J=>[{toastId:$.id,height:q,position:$.position},...J]),()=>se(J=>J.filter(de=>de.toastId!==$.id))}},[se,$.id]),Ye.useLayoutEffect(()=>{if(!zt)return;let F=Kr.current,q=F.style.height;F.style.height="auto";let J=F.getBoundingClientRect().height;F.style.height=q,lr(J),se(de=>de.find(me=>me.toastId===$.id)?de.map(me=>me.toastId===$.id?{...me,height:J}:me):[{toastId:$.id,height:J,position:$.position},...de])},[zt,$.title,$.description,se,$.id]);let ie=Ye.useCallback(()=>{_n(!0),ki(Ct.current),se(F=>F.filter(q=>q.toastId!==$.id)),setTimeout(()=>{ke($)},tz)},[$,ke,se,Ct]);Ye.useEffect(()=>{if($.promise&&$r==="loading"||$.duration===1/0||$.type==="loading")return;let F;return be||Q||dt&&ci?(()=>{if(vt.current<je.current){let q=new Date().getTime()-je.current;Pi.current=Pi.current-q}vt.current=new Date().getTime()})():Pi.current!==1/0&&(je.current=new Date().getTime(),F=setTimeout(()=>{var q;(q=$.onAutoClose)==null||q.call($,$),ie()},Pi.current)),()=>clearTimeout(F)},[be,Q,$,$r,dt,ci,ie]),Ye.useEffect(()=>{$.delete&&ie()},[ie,$.delete]);function N(){var F,q,J;return et!=null&&et.loading?Ye.createElement("div",{className:_s(Re==null?void 0:Re.loader,(F=$==null?void 0:$.classNames)==null?void 0:F.loader,"sonner-loader"),"data-visible":$r==="loading"},et.loading):wt?Ye.createElement("div",{className:_s(Re==null?void 0:Re.loader,(q=$==null?void 0:$.classNames)==null?void 0:q.loader,"sonner-loader"),"data-visible":$r==="loading"},wt):Ye.createElement(LM,{className:_s(Re==null?void 0:Re.loader,(J=$==null?void 0:$.classNames)==null?void 0:J.loader),visible:$r==="loading"})}return Ye.createElement("li",{tabIndex:0,ref:Kr,className:_s(ot,Ne,Re==null?void 0:Re.toast,(n=$==null?void 0:$.classNames)==null?void 0:n.toast,Re==null?void 0:Re.default,Re==null?void 0:Re[$r],(o=$==null?void 0:$.classNames)==null?void 0:o[$r]),"data-sonner-toast":"","data-rich-colors":(u=$.richColors)!=null?u:Pe,"data-styled":!($.jsx||$.unstyled||le),"data-mounted":zt,"data-promise":!!$.promise,"data-swiped":Yi,"data-removed":sn,"data-visible":Pn,"data-y-position":qn,"data-x-position":kt,"data-index":K,"data-front":zs,"data-swiping":kn,"data-dismissible":ai,"data-type":$r,"data-invert":Ji,"data-swipe-out":Xr,"data-swipe-direction":Yt,"data-expanded":!!(be||De&&zt),style:{"--index":K,"--toasts-before":K,"--z-index":he.length-K,"--offset":`${sn?Ci:Ct.current}px`,"--initial-height":De?"auto":`${Ot}px`,...st,...$.style},onDragEnd:()=>{on(!1),At(null),Cr.current=null},onPointerDown:F=>{In||!ai||(Ii.current=new Date,ki(Ct.current),F.target.setPointerCapture(F.pointerId),F.target.tagName!=="BUTTON"&&(on(!0),Cr.current={x:F.clientX,y:F.clientY}))},onPointerUp:()=>{var F,q,J,de;if(Xr||!ai)return;Cr.current=null;let me=Number(((F=Kr.current)==null?void 0:F.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ye=Number(((q=Kr.current)==null?void 0:q.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ue=new Date().getTime()-((J=Ii.current)==null?void 0:J.getTime()),Se=Mt==="x"?me:ye,Ae=Math.abs(Se)/ue;if(Math.abs(Se)>=ez||Ae>.11){ki(Ct.current),(de=$.onDismiss)==null||de.call($,$),gr(Mt==="x"?me>0?"right":"left":ye>0?"down":"up"),ie(),Un(!0),Te(!1);return}on(!1),At(null)},onPointerMove:F=>{var q,J,de,me;if(!Cr.current||!ai||((q=window.getSelection())==null?void 0:q.toString().length)>0)return;let ye=F.clientY-Cr.current.y,ue=F.clientX-Cr.current.x,Se=(J=e.swipeDirections)!=null?J:rz(It);!Mt&&(Math.abs(ue)>1||Math.abs(ye)>1)&&At(Math.abs(ue)>Math.abs(ye)?"x":"y");let Ae={x:0,y:0};Mt==="y"?(Se.includes("top")||Se.includes("bottom"))&&(Se.includes("top")&&ye<0||Se.includes("bottom")&&ye>0)&&(Ae.y=ye):Mt==="x"&&(Se.includes("left")||Se.includes("right"))&&(Se.includes("left")&&ue<0||Se.includes("right")&&ue>0)&&(Ae.x=ue),(Math.abs(Ae.x)>0||Math.abs(Ae.y)>0)&&Te(!0),(de=Kr.current)==null||de.style.setProperty("--swipe-amount-x",`${Ae.x}px`),(me=Kr.current)==null||me.style.setProperty("--swipe-amount-y",`${Ae.y}px`)}},ui&&!$.jsx?Ye.createElement("button",{"aria-label":yt,"data-disabled":In,"data-close-button":!0,onClick:In||!ai?()=>{}:()=>{var F;ie(),(F=$.onDismiss)==null||F.call($,$)},className:_s(Re==null?void 0:Re.closeButton,(p=$==null?void 0:$.classNames)==null?void 0:p.closeButton)},(x=et==null?void 0:et.close)!=null?x:jM):null,$.jsx||X.isValidElement($.title)?$.jsx?$.jsx:typeof $.title=="function"?$.title():$.title:Ye.createElement(Ye.Fragment,null,$r||$.icon||$.promise?Ye.createElement("div",{"data-icon":"",className:_s(Re==null?void 0:Re.icon,(v=$==null?void 0:$.classNames)==null?void 0:v.icon)},$.promise||$.type==="loading"&&!$.icon?$.icon||N():null,$.type!=="loading"?$.icon||(et==null?void 0:et[$r])||DM($r):null):null,Ye.createElement("div",{"data-content":"",className:_s(Re==null?void 0:Re.content,(c=$==null?void 0:$.classNames)==null?void 0:c.content)},Ye.createElement("div",{"data-title":"",className:_s(Re==null?void 0:Re.title,(k=$==null?void 0:$.classNames)==null?void 0:k.title)},typeof $.title=="function"?$.title():$.title),$.description?Ye.createElement("div",{"data-description":"",className:_s(xt,li,Re==null?void 0:Re.description,(A=$==null?void 0:$.classNames)==null?void 0:A.description)},typeof $.description=="function"?$.description():$.description):null),X.isValidElement($.cancel)?$.cancel:$.cancel&&pp($.cancel)?Ye.createElement("button",{"data-button":!0,"data-cancel":!0,style:$.cancelButtonStyle||Be,onClick:F=>{var q,J;pp($.cancel)&&ai&&((J=(q=$.cancel).onClick)==null||J.call(q,F),ie())},className:_s(Re==null?void 0:Re.cancelButton,(B=$==null?void 0:$.classNames)==null?void 0:B.cancelButton)},$.cancel.label):null,X.isValidElement($.action)?$.action:$.action&&pp($.action)?Ye.createElement("button",{"data-button":!0,"data-action":!0,style:$.actionButtonStyle||qe,onClick:F=>{var q,J;pp($.action)&&((J=(q=$.action).onClick)==null||J.call(q,F),!F.defaultPrevented&&ie())},className:_s(Re==null?void 0:Re.actionButton,(R=$==null?void 0:$.classNames)==null?void 0:R.actionButton)},$.action.label):null))};function Tb(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function iz(e,n){let o={};return[e,n].forEach((u,p)=>{let x=p===1,v=x?"--mobile-offset":"--offset",c=x?YM:KM;function k(A){["top","right","bottom","left"].forEach(B=>{o[`${v}-${B}`]=typeof A=="number"?`${A}px`:A})}typeof u=="number"||typeof u=="string"?k(u):typeof u=="object"?["top","right","bottom","left"].forEach(A=>{u[A]===void 0?o[`${v}-${A}`]=c:o[`${v}-${A}`]=typeof u[A]=="number"?`${u[A]}px`:u[A]}):k(c)}),o}var sz=X.forwardRef(function(e,n){let{invert:o,position:u="bottom-right",hotkey:p=["altKey","KeyT"],expand:x,closeButton:v,className:c,offset:k,mobileOffset:A,theme:B="light",richColors:R,duration:L,style:$,visibleToasts:le=XM,toastOptions:Q,dir:se=Tb(),gap:W=QM,loadingIcon:G,icons:K,containerAriaLabel:he="Notifications",pauseWhenPageIsHidden:be}=e,[ke,Pe]=Ye.useState([]),Fe=Ye.useMemo(()=>Array.from(new Set([u].concat(ke.filter(dt=>dt.position).map(dt=>dt.position)))),[ke,u]),[st,Be]=Ye.useState([]),[qe,ot]=Ye.useState(!1),[xt,He]=Ye.useState(!1),[It,bt]=Ye.useState(B!=="system"?B:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),wt=Ye.useRef(null),De=p.join("+").replace(/Key/g,"").replace(/Digit/g,""),Re=Ye.useRef(null),et=Ye.useRef(!1),yt=Ye.useCallback(dt=>{Pe(Mt=>{var At;return(At=Mt.find(Yt=>Yt.id===dt.id))!=null&&At.delete||vi.dismiss(dt.id),Mt.filter(({id:Yt})=>Yt!==dt.id)})},[]);return Ye.useEffect(()=>vi.subscribe(dt=>{if(dt.dismiss){Pe(Mt=>Mt.map(At=>At.id===dt.id?{...At,delete:!0}:At));return}setTimeout(()=>{bS.flushSync(()=>{Pe(Mt=>{let At=Mt.findIndex(Yt=>Yt.id===dt.id);return At!==-1?[...Mt.slice(0,At),{...Mt[At],...dt},...Mt.slice(At+1)]:[dt,...Mt]})})})}),[]),Ye.useEffect(()=>{if(B!=="system"){bt(B);return}if(B==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?bt("dark"):bt("light")),typeof window>"u")return;let dt=window.matchMedia("(prefers-color-scheme: dark)");try{dt.addEventListener("change",({matches:Mt})=>{bt(Mt?"dark":"light")})}catch{dt.addListener(({matches:At})=>{try{bt(At?"dark":"light")}catch(Yt){console.error(Yt)}})}},[B]),Ye.useEffect(()=>{ke.length<=1&&ot(!1)},[ke]),Ye.useEffect(()=>{let dt=Mt=>{var At,Yt;p.every(gr=>Mt[gr]||Mt.code===gr)&&(ot(!0),(At=wt.current)==null||At.focus()),Mt.code==="Escape"&&(document.activeElement===wt.current||(Yt=wt.current)!=null&&Yt.contains(document.activeElement))&&ot(!1)};return document.addEventListener("keydown",dt),()=>document.removeEventListener("keydown",dt)},[p]),Ye.useEffect(()=>{if(wt.current)return()=>{Re.current&&(Re.current.focus({preventScroll:!0}),Re.current=null,et.current=!1)}},[wt.current]),Ye.createElement("section",{ref:n,"aria-label":`${he} ${De}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},Fe.map((dt,Mt)=>{var At;let[Yt,gr]=dt.split("-");return ke.length?Ye.createElement("ol",{key:dt,dir:se==="auto"?Tb():se,tabIndex:-1,ref:wt,className:c,"data-sonner-toaster":!0,"data-theme":It,"data-y-position":Yt,"data-lifted":qe&&ke.length>1&&!x,"data-x-position":gr,style:{"--front-toast-height":`${((At=st[0])==null?void 0:At.height)||0}px`,"--width":`${JM}px`,"--gap":`${W}px`,...$,...iz(k,A)},onBlur:zt=>{et.current&&!zt.currentTarget.contains(zt.relatedTarget)&&(et.current=!1,Re.current&&(Re.current.focus({preventScroll:!0}),Re.current=null))},onFocus:zt=>{zt.target instanceof HTMLElement&&zt.target.dataset.dismissible==="false"||et.current||(et.current=!0,Re.current=zt.relatedTarget)},onMouseEnter:()=>ot(!0),onMouseMove:()=>ot(!0),onMouseLeave:()=>{xt||ot(!1)},onDragEnd:()=>ot(!1),onPointerDown:zt=>{zt.target instanceof HTMLElement&&zt.target.dataset.dismissible==="false"||He(!0)},onPointerUp:()=>He(!1)},ke.filter(zt=>!zt.position&&Mt===0||zt.position===dt).map((zt,Vr)=>{var sn,_n;return Ye.createElement(nz,{key:zt.id,icons:K,index:Vr,toast:zt,defaultRichColors:R,duration:(sn=Q==null?void 0:Q.duration)!=null?sn:L,className:Q==null?void 0:Q.className,descriptionClassName:Q==null?void 0:Q.descriptionClassName,invert:o,visibleToasts:le,closeButton:(_n=Q==null?void 0:Q.closeButton)!=null?_n:v,interacting:xt,position:dt,style:Q==null?void 0:Q.style,unstyled:Q==null?void 0:Q.unstyled,classNames:Q==null?void 0:Q.classNames,cancelButtonStyle:Q==null?void 0:Q.cancelButtonStyle,actionButtonStyle:Q==null?void 0:Q.actionButtonStyle,removeToast:yt,toasts:ke.filter(kn=>kn.position==zt.position),heights:st.filter(kn=>kn.position==zt.position),setHeights:Be,expandByDefault:x,gap:W,loadingIcon:G,expanded:qe,pauseWhenPageIsHidden:be,swipeDirections:e.swipeDirections})})):null}))});const oz=({...e})=>{const{theme:n="system"}=zM();return ee.jsx(sz,{theme:n,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},az=["top","right","bottom","left"],ja=Math.min,qi=Math.max,im=Math.round,mp=Math.floor,Ks=e=>({x:e,y:e}),lz={left:"right",right:"left",bottom:"top",top:"bottom"},uz={start:"end",end:"start"};function B_(e,n,o){return qi(e,ja(n,o))}function Io(e,n){return typeof e=="function"?e(n):e}function Ao(e){return e.split("-")[0]}function kc(e){return e.split("-")[1]}function nx(e){return e==="x"?"y":"x"}function ix(e){return e==="y"?"height":"width"}const cz=new Set(["top","bottom"]);function Gs(e){return cz.has(Ao(e))?"y":"x"}function sx(e){return nx(Gs(e))}function hz(e,n,o){o===void 0&&(o=!1);const u=kc(e),p=sx(e),x=ix(p);let v=p==="x"?u===(o?"end":"start")?"right":"left":u==="start"?"bottom":"top";return n.reference[x]>n.floating[x]&&(v=sm(v)),[v,sm(v)]}function dz(e){const n=sm(e);return[N_(e),n,N_(n)]}function N_(e){return e.replace(/start|end/g,n=>uz[n])}const Eb=["left","right"],Cb=["right","left"],fz=["top","bottom"],pz=["bottom","top"];function mz(e,n,o){switch(e){case"top":case"bottom":return o?n?Cb:Eb:n?Eb:Cb;case"left":case"right":return n?fz:pz;default:return[]}}function gz(e,n,o,u){const p=kc(e);let x=mz(Ao(e),o==="start",u);return p&&(x=x.map(v=>v+"-"+p),n&&(x=x.concat(x.map(N_)))),x}function sm(e){return e.replace(/left|right|bottom|top/g,n=>lz[n])}function yz(e){return{top:0,right:0,bottom:0,left:0,...e}}function lT(e){return typeof e!="number"?yz(e):{top:e,right:e,bottom:e,left:e}}function om(e){const{x:n,y:o,width:u,height:p}=e;return{width:u,height:p,top:o,left:n,right:n+u,bottom:o+p,x:n,y:o}}function kb(e,n,o){let{reference:u,floating:p}=e;const x=Gs(n),v=sx(n),c=ix(v),k=Ao(n),A=x==="y",B=u.x+u.width/2-p.width/2,R=u.y+u.height/2-p.height/2,L=u[c]/2-p[c]/2;let $;switch(k){case"top":$={x:B,y:u.y-p.height};break;case"bottom":$={x:B,y:u.y+u.height};break;case"right":$={x:u.x+u.width,y:R};break;case"left":$={x:u.x-p.width,y:R};break;default:$={x:u.x,y:u.y}}switch(kc(n)){case"start":$[v]-=L*(o&&A?-1:1);break;case"end":$[v]+=L*(o&&A?-1:1);break}return $}const _z=async(e,n,o)=>{const{placement:u="bottom",strategy:p="absolute",middleware:x=[],platform:v}=o,c=x.filter(Boolean),k=await(v.isRTL==null?void 0:v.isRTL(n));let A=await v.getElementRects({reference:e,floating:n,strategy:p}),{x:B,y:R}=kb(A,u,k),L=u,$={},le=0;for(let Q=0;Q<c.length;Q++){const{name:se,fn:W}=c[Q],{x:G,y:K,data:he,reset:be}=await W({x:B,y:R,initialPlacement:u,placement:L,strategy:p,middlewareData:$,rects:A,platform:v,elements:{reference:e,floating:n}});B=G??B,R=K??R,$={...$,[se]:{...$[se],...he}},be&&le<=50&&(le++,typeof be=="object"&&(be.placement&&(L=be.placement),be.rects&&(A=be.rects===!0?await v.getElementRects({reference:e,floating:n,strategy:p}):be.rects),{x:B,y:R}=kb(A,L,k)),Q=-1)}return{x:B,y:R,placement:L,strategy:p,middlewareData:$}};async function Ed(e,n){var o;n===void 0&&(n={});const{x:u,y:p,platform:x,rects:v,elements:c,strategy:k}=e,{boundary:A="clippingAncestors",rootBoundary:B="viewport",elementContext:R="floating",altBoundary:L=!1,padding:$=0}=Io(n,e),le=lT($),se=c[L?R==="floating"?"reference":"floating":R],W=om(await x.getClippingRect({element:(o=await(x.isElement==null?void 0:x.isElement(se)))==null||o?se:se.contextElement||await(x.getDocumentElement==null?void 0:x.getDocumentElement(c.floating)),boundary:A,rootBoundary:B,strategy:k})),G=R==="floating"?{x:u,y:p,width:v.floating.width,height:v.floating.height}:v.reference,K=await(x.getOffsetParent==null?void 0:x.getOffsetParent(c.floating)),he=await(x.isElement==null?void 0:x.isElement(K))?await(x.getScale==null?void 0:x.getScale(K))||{x:1,y:1}:{x:1,y:1},be=om(x.convertOffsetParentRelativeRectToViewportRelativeRect?await x.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:G,offsetParent:K,strategy:k}):G);return{top:(W.top-be.top+le.top)/he.y,bottom:(be.bottom-W.bottom+le.bottom)/he.y,left:(W.left-be.left+le.left)/he.x,right:(be.right-W.right+le.right)/he.x}}const vz=e=>({name:"arrow",options:e,async fn(n){const{x:o,y:u,placement:p,rects:x,platform:v,elements:c,middlewareData:k}=n,{element:A,padding:B=0}=Io(e,n)||{};if(A==null)return{};const R=lT(B),L={x:o,y:u},$=sx(p),le=ix($),Q=await v.getDimensions(A),se=$==="y",W=se?"top":"left",G=se?"bottom":"right",K=se?"clientHeight":"clientWidth",he=x.reference[le]+x.reference[$]-L[$]-x.floating[le],be=L[$]-x.reference[$],ke=await(v.getOffsetParent==null?void 0:v.getOffsetParent(A));let Pe=ke?ke[K]:0;(!Pe||!await(v.isElement==null?void 0:v.isElement(ke)))&&(Pe=c.floating[K]||x.floating[le]);const Fe=he/2-be/2,st=Pe/2-Q[le]/2-1,Be=ja(R[W],st),qe=ja(R[G],st),ot=Be,xt=Pe-Q[le]-qe,He=Pe/2-Q[le]/2+Fe,It=B_(ot,He,xt),bt=!k.arrow&&kc(p)!=null&&He!==It&&x.reference[le]/2-(He<ot?Be:qe)-Q[le]/2<0,wt=bt?He<ot?He-ot:He-xt:0;return{[$]:L[$]+wt,data:{[$]:It,centerOffset:He-It-wt,...bt&&{alignmentOffset:wt}},reset:bt}}}),xz=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var o,u;const{placement:p,middlewareData:x,rects:v,initialPlacement:c,platform:k,elements:A}=n,{mainAxis:B=!0,crossAxis:R=!0,fallbackPlacements:L,fallbackStrategy:$="bestFit",fallbackAxisSideDirection:le="none",flipAlignment:Q=!0,...se}=Io(e,n);if((o=x.arrow)!=null&&o.alignmentOffset)return{};const W=Ao(p),G=Gs(c),K=Ao(c)===c,he=await(k.isRTL==null?void 0:k.isRTL(A.floating)),be=L||(K||!Q?[sm(c)]:dz(c)),ke=le!=="none";!L&&ke&&be.push(...gz(c,Q,le,he));const Pe=[c,...be],Fe=await Ed(n,se),st=[];let Be=((u=x.flip)==null?void 0:u.overflows)||[];if(B&&st.push(Fe[W]),R){const He=hz(p,v,he);st.push(Fe[He[0]],Fe[He[1]])}if(Be=[...Be,{placement:p,overflows:st}],!st.every(He=>He<=0)){var qe,ot;const He=(((qe=x.flip)==null?void 0:qe.index)||0)+1,It=Pe[He];if(It&&(!(R==="alignment"?G!==Gs(It):!1)||Be.every(De=>Gs(De.placement)===G?De.overflows[0]>0:!0)))return{data:{index:He,overflows:Be},reset:{placement:It}};let bt=(ot=Be.filter(wt=>wt.overflows[0]<=0).sort((wt,De)=>wt.overflows[1]-De.overflows[1])[0])==null?void 0:ot.placement;if(!bt)switch($){case"bestFit":{var xt;const wt=(xt=Be.filter(De=>{if(ke){const Re=Gs(De.placement);return Re===G||Re==="y"}return!0}).map(De=>[De.placement,De.overflows.filter(Re=>Re>0).reduce((Re,et)=>Re+et,0)]).sort((De,Re)=>De[1]-Re[1])[0])==null?void 0:xt[0];wt&&(bt=wt);break}case"initialPlacement":bt=c;break}if(p!==bt)return{reset:{placement:bt}}}return{}}}};function Pb(e,n){return{top:e.top-n.height,right:e.right-n.width,bottom:e.bottom-n.height,left:e.left-n.width}}function Ib(e){return az.some(n=>e[n]>=0)}const wz=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(n){const{rects:o}=n,{strategy:u="referenceHidden",...p}=Io(e,n);switch(u){case"referenceHidden":{const x=await Ed(n,{...p,elementContext:"reference"}),v=Pb(x,o.reference);return{data:{referenceHiddenOffsets:v,referenceHidden:Ib(v)}}}case"escaped":{const x=await Ed(n,{...p,altBoundary:!0}),v=Pb(x,o.floating);return{data:{escapedOffsets:v,escaped:Ib(v)}}}default:return{}}}}},uT=new Set(["left","top"]);async function bz(e,n){const{placement:o,platform:u,elements:p}=e,x=await(u.isRTL==null?void 0:u.isRTL(p.floating)),v=Ao(o),c=kc(o),k=Gs(o)==="y",A=uT.has(v)?-1:1,B=x&&k?-1:1,R=Io(n,e);let{mainAxis:L,crossAxis:$,alignmentAxis:le}=typeof R=="number"?{mainAxis:R,crossAxis:0,alignmentAxis:null}:{mainAxis:R.mainAxis||0,crossAxis:R.crossAxis||0,alignmentAxis:R.alignmentAxis};return c&&typeof le=="number"&&($=c==="end"?le*-1:le),k?{x:$*B,y:L*A}:{x:L*A,y:$*B}}const Sz=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var o,u;const{x:p,y:x,placement:v,middlewareData:c}=n,k=await bz(n,e);return v===((o=c.offset)==null?void 0:o.placement)&&(u=c.arrow)!=null&&u.alignmentOffset?{}:{x:p+k.x,y:x+k.y,data:{...k,placement:v}}}}},Tz=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:o,y:u,placement:p}=n,{mainAxis:x=!0,crossAxis:v=!1,limiter:c={fn:se=>{let{x:W,y:G}=se;return{x:W,y:G}}},...k}=Io(e,n),A={x:o,y:u},B=await Ed(n,k),R=Gs(Ao(p)),L=nx(R);let $=A[L],le=A[R];if(x){const se=L==="y"?"top":"left",W=L==="y"?"bottom":"right",G=$+B[se],K=$-B[W];$=B_(G,$,K)}if(v){const se=R==="y"?"top":"left",W=R==="y"?"bottom":"right",G=le+B[se],K=le-B[W];le=B_(G,le,K)}const Q=c.fn({...n,[L]:$,[R]:le});return{...Q,data:{x:Q.x-o,y:Q.y-u,enabled:{[L]:x,[R]:v}}}}}},Ez=function(e){return e===void 0&&(e={}),{options:e,fn(n){const{x:o,y:u,placement:p,rects:x,middlewareData:v}=n,{offset:c=0,mainAxis:k=!0,crossAxis:A=!0}=Io(e,n),B={x:o,y:u},R=Gs(p),L=nx(R);let $=B[L],le=B[R];const Q=Io(c,n),se=typeof Q=="number"?{mainAxis:Q,crossAxis:0}:{mainAxis:0,crossAxis:0,...Q};if(k){const K=L==="y"?"height":"width",he=x.reference[L]-x.floating[K]+se.mainAxis,be=x.reference[L]+x.reference[K]-se.mainAxis;$<he?$=he:$>be&&($=be)}if(A){var W,G;const K=L==="y"?"width":"height",he=uT.has(Ao(p)),be=x.reference[R]-x.floating[K]+(he&&((W=v.offset)==null?void 0:W[R])||0)+(he?0:se.crossAxis),ke=x.reference[R]+x.reference[K]+(he?0:((G=v.offset)==null?void 0:G[R])||0)-(he?se.crossAxis:0);le<be?le=be:le>ke&&(le=ke)}return{[L]:$,[R]:le}}}},Cz=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(n){var o,u;const{placement:p,rects:x,platform:v,elements:c}=n,{apply:k=()=>{},...A}=Io(e,n),B=await Ed(n,A),R=Ao(p),L=kc(p),$=Gs(p)==="y",{width:le,height:Q}=x.floating;let se,W;R==="top"||R==="bottom"?(se=R,W=L===(await(v.isRTL==null?void 0:v.isRTL(c.floating))?"start":"end")?"left":"right"):(W=R,se=L==="end"?"top":"bottom");const G=Q-B.top-B.bottom,K=le-B.left-B.right,he=ja(Q-B[se],G),be=ja(le-B[W],K),ke=!n.middlewareData.shift;let Pe=he,Fe=be;if((o=n.middlewareData.shift)!=null&&o.enabled.x&&(Fe=K),(u=n.middlewareData.shift)!=null&&u.enabled.y&&(Pe=G),ke&&!L){const Be=qi(B.left,0),qe=qi(B.right,0),ot=qi(B.top,0),xt=qi(B.bottom,0);$?Fe=le-2*(Be!==0||qe!==0?Be+qe:qi(B.left,B.right)):Pe=Q-2*(ot!==0||xt!==0?ot+xt:qi(B.top,B.bottom))}await k({...n,availableWidth:Fe,availableHeight:Pe});const st=await v.getDimensions(c.floating);return le!==st.width||Q!==st.height?{reset:{rects:!0}}:{}}}};function zm(){return typeof window<"u"}function Pc(e){return cT(e)?(e.nodeName||"").toLowerCase():"#document"}function Gi(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Js(e){var n;return(n=(cT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function cT(e){return zm()?e instanceof Node||e instanceof Gi(e).Node:!1}function As(e){return zm()?e instanceof Element||e instanceof Gi(e).Element:!1}function Ys(e){return zm()?e instanceof HTMLElement||e instanceof Gi(e).HTMLElement:!1}function Ab(e){return!zm()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Gi(e).ShadowRoot}const kz=new Set(["inline","contents"]);function Vd(e){const{overflow:n,overflowX:o,overflowY:u,display:p}=Ms(e);return/auto|scroll|overlay|hidden|clip/.test(n+u+o)&&!kz.has(p)}const Pz=new Set(["table","td","th"]);function Iz(e){return Pz.has(Pc(e))}const Az=[":popover-open",":modal"];function Dm(e){return Az.some(n=>{try{return e.matches(n)}catch{return!1}})}const Mz=["transform","translate","scale","rotate","perspective"],zz=["transform","translate","scale","rotate","perspective","filter"],Dz=["paint","layout","strict","content"];function ox(e){const n=ax(),o=As(e)?Ms(e):e;return Mz.some(u=>o[u]?o[u]!=="none":!1)||(o.containerType?o.containerType!=="normal":!1)||!n&&(o.backdropFilter?o.backdropFilter!=="none":!1)||!n&&(o.filter?o.filter!=="none":!1)||zz.some(u=>(o.willChange||"").includes(u))||Dz.some(u=>(o.contain||"").includes(u))}function Rz(e){let n=Va(e);for(;Ys(n)&&!wc(n);){if(ox(n))return n;if(Dm(n))return null;n=Va(n)}return null}function ax(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Lz=new Set(["html","body","#document"]);function wc(e){return Lz.has(Pc(e))}function Ms(e){return Gi(e).getComputedStyle(e)}function Rm(e){return As(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Va(e){if(Pc(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Ab(e)&&e.host||Js(e);return Ab(n)?n.host:n}function hT(e){const n=Va(e);return wc(n)?e.ownerDocument?e.ownerDocument.body:e.body:Ys(n)&&Vd(n)?n:hT(n)}function Cd(e,n,o){var u;n===void 0&&(n=[]),o===void 0&&(o=!0);const p=hT(e),x=p===((u=e.ownerDocument)==null?void 0:u.body),v=Gi(p);if(x){const c=j_(v);return n.concat(v,v.visualViewport||[],Vd(p)?p:[],c&&o?Cd(c):[])}return n.concat(p,Cd(p,[],o))}function j_(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function dT(e){const n=Ms(e);let o=parseFloat(n.width)||0,u=parseFloat(n.height)||0;const p=Ys(e),x=p?e.offsetWidth:o,v=p?e.offsetHeight:u,c=im(o)!==x||im(u)!==v;return c&&(o=x,u=v),{width:o,height:u,$:c}}function lx(e){return As(e)?e:e.contextElement}function sc(e){const n=lx(e);if(!Ys(n))return Ks(1);const o=n.getBoundingClientRect(),{width:u,height:p,$:x}=dT(n);let v=(x?im(o.width):o.width)/u,c=(x?im(o.height):o.height)/p;return(!v||!Number.isFinite(v))&&(v=1),(!c||!Number.isFinite(c))&&(c=1),{x:v,y:c}}const Fz=Ks(0);function fT(e){const n=Gi(e);return!ax()||!n.visualViewport?Fz:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Oz(e,n,o){return n===void 0&&(n=!1),!o||n&&o!==Gi(e)?!1:n}function jl(e,n,o,u){n===void 0&&(n=!1),o===void 0&&(o=!1);const p=e.getBoundingClientRect(),x=lx(e);let v=Ks(1);n&&(u?As(u)&&(v=sc(u)):v=sc(e));const c=Oz(x,o,u)?fT(x):Ks(0);let k=(p.left+c.x)/v.x,A=(p.top+c.y)/v.y,B=p.width/v.x,R=p.height/v.y;if(x){const L=Gi(x),$=u&&As(u)?Gi(u):u;let le=L,Q=j_(le);for(;Q&&u&&$!==le;){const se=sc(Q),W=Q.getBoundingClientRect(),G=Ms(Q),K=W.left+(Q.clientLeft+parseFloat(G.paddingLeft))*se.x,he=W.top+(Q.clientTop+parseFloat(G.paddingTop))*se.y;k*=se.x,A*=se.y,B*=se.x,R*=se.y,k+=K,A+=he,le=Gi(Q),Q=j_(le)}}return om({width:B,height:R,x:k,y:A})}function Lm(e,n){const o=Rm(e).scrollLeft;return n?n.left+o:jl(Js(e)).left+o}function pT(e,n){const o=e.getBoundingClientRect(),u=o.left+n.scrollLeft-Lm(e,o),p=o.top+n.scrollTop;return{x:u,y:p}}function Bz(e){let{elements:n,rect:o,offsetParent:u,strategy:p}=e;const x=p==="fixed",v=Js(u),c=n?Dm(n.floating):!1;if(u===v||c&&x)return o;let k={scrollLeft:0,scrollTop:0},A=Ks(1);const B=Ks(0),R=Ys(u);if((R||!R&&!x)&&((Pc(u)!=="body"||Vd(v))&&(k=Rm(u)),Ys(u))){const $=jl(u);A=sc(u),B.x=$.x+u.clientLeft,B.y=$.y+u.clientTop}const L=v&&!R&&!x?pT(v,k):Ks(0);return{width:o.width*A.x,height:o.height*A.y,x:o.x*A.x-k.scrollLeft*A.x+B.x+L.x,y:o.y*A.y-k.scrollTop*A.y+B.y+L.y}}function Nz(e){return Array.from(e.getClientRects())}function jz(e){const n=Js(e),o=Rm(e),u=e.ownerDocument.body,p=qi(n.scrollWidth,n.clientWidth,u.scrollWidth,u.clientWidth),x=qi(n.scrollHeight,n.clientHeight,u.scrollHeight,u.clientHeight);let v=-o.scrollLeft+Lm(e);const c=-o.scrollTop;return Ms(u).direction==="rtl"&&(v+=qi(n.clientWidth,u.clientWidth)-p),{width:p,height:x,x:v,y:c}}const Mb=25;function Vz(e,n){const o=Gi(e),u=Js(e),p=o.visualViewport;let x=u.clientWidth,v=u.clientHeight,c=0,k=0;if(p){x=p.width,v=p.height;const B=ax();(!B||B&&n==="fixed")&&(c=p.offsetLeft,k=p.offsetTop)}const A=Lm(u);if(A<=0){const B=u.ownerDocument,R=B.body,L=getComputedStyle(R),$=B.compatMode==="CSS1Compat"&&parseFloat(L.marginLeft)+parseFloat(L.marginRight)||0,le=Math.abs(u.clientWidth-R.clientWidth-$);le<=Mb&&(x-=le)}else A<=Mb&&(x+=A);return{width:x,height:v,x:c,y:k}}const $z=new Set(["absolute","fixed"]);function Uz(e,n){const o=jl(e,!0,n==="fixed"),u=o.top+e.clientTop,p=o.left+e.clientLeft,x=Ys(e)?sc(e):Ks(1),v=e.clientWidth*x.x,c=e.clientHeight*x.y,k=p*x.x,A=u*x.y;return{width:v,height:c,x:k,y:A}}function zb(e,n,o){let u;if(n==="viewport")u=Vz(e,o);else if(n==="document")u=jz(Js(e));else if(As(n))u=Uz(n,o);else{const p=fT(e);u={x:n.x-p.x,y:n.y-p.y,width:n.width,height:n.height}}return om(u)}function mT(e,n){const o=Va(e);return o===n||!As(o)||wc(o)?!1:Ms(o).position==="fixed"||mT(o,n)}function qz(e,n){const o=n.get(e);if(o)return o;let u=Cd(e,[],!1).filter(c=>As(c)&&Pc(c)!=="body"),p=null;const x=Ms(e).position==="fixed";let v=x?Va(e):e;for(;As(v)&&!wc(v);){const c=Ms(v),k=ox(v);!k&&c.position==="fixed"&&(p=null),(x?!k&&!p:!k&&c.position==="static"&&!!p&&$z.has(p.position)||Vd(v)&&!k&&mT(e,v))?u=u.filter(B=>B!==v):p=c,v=Va(v)}return n.set(e,u),u}function Zz(e){let{element:n,boundary:o,rootBoundary:u,strategy:p}=e;const v=[...o==="clippingAncestors"?Dm(n)?[]:qz(n,this._c):[].concat(o),u],c=v[0],k=v.reduce((A,B)=>{const R=zb(n,B,p);return A.top=qi(R.top,A.top),A.right=ja(R.right,A.right),A.bottom=ja(R.bottom,A.bottom),A.left=qi(R.left,A.left),A},zb(n,c,p));return{width:k.right-k.left,height:k.bottom-k.top,x:k.left,y:k.top}}function Hz(e){const{width:n,height:o}=dT(e);return{width:n,height:o}}function Gz(e,n,o){const u=Ys(n),p=Js(n),x=o==="fixed",v=jl(e,!0,x,n);let c={scrollLeft:0,scrollTop:0};const k=Ks(0);function A(){k.x=Lm(p)}if(u||!u&&!x)if((Pc(n)!=="body"||Vd(p))&&(c=Rm(n)),u){const $=jl(n,!0,x,n);k.x=$.x+n.clientLeft,k.y=$.y+n.clientTop}else p&&A();x&&!u&&p&&A();const B=p&&!u&&!x?pT(p,c):Ks(0),R=v.left+c.scrollLeft-k.x-B.x,L=v.top+c.scrollTop-k.y-B.y;return{x:R,y:L,width:v.width,height:v.height}}function Ry(e){return Ms(e).position==="static"}function Db(e,n){if(!Ys(e)||Ms(e).position==="fixed")return null;if(n)return n(e);let o=e.offsetParent;return Js(e)===o&&(o=o.ownerDocument.body),o}function gT(e,n){const o=Gi(e);if(Dm(e))return o;if(!Ys(e)){let p=Va(e);for(;p&&!wc(p);){if(As(p)&&!Ry(p))return p;p=Va(p)}return o}let u=Db(e,n);for(;u&&Iz(u)&&Ry(u);)u=Db(u,n);return u&&wc(u)&&Ry(u)&&!ox(u)?o:u||Rz(e)||o}const Wz=async function(e){const n=this.getOffsetParent||gT,o=this.getDimensions,u=await o(e.floating);return{reference:Gz(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:u.width,height:u.height}}};function Xz(e){return Ms(e).direction==="rtl"}const Kz={convertOffsetParentRelativeRectToViewportRelativeRect:Bz,getDocumentElement:Js,getClippingRect:Zz,getOffsetParent:gT,getElementRects:Wz,getClientRects:Nz,getDimensions:Hz,getScale:sc,isElement:As,isRTL:Xz};function yT(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function Yz(e,n){let o=null,u;const p=Js(e);function x(){var c;clearTimeout(u),(c=o)==null||c.disconnect(),o=null}function v(c,k){c===void 0&&(c=!1),k===void 0&&(k=1),x();const A=e.getBoundingClientRect(),{left:B,top:R,width:L,height:$}=A;if(c||n(),!L||!$)return;const le=mp(R),Q=mp(p.clientWidth-(B+L)),se=mp(p.clientHeight-(R+$)),W=mp(B),K={rootMargin:-le+"px "+-Q+"px "+-se+"px "+-W+"px",threshold:qi(0,ja(1,k))||1};let he=!0;function be(ke){const Pe=ke[0].intersectionRatio;if(Pe!==k){if(!he)return v();Pe?v(!1,Pe):u=setTimeout(()=>{v(!1,1e-7)},1e3)}Pe===1&&!yT(A,e.getBoundingClientRect())&&v(),he=!1}try{o=new IntersectionObserver(be,{...K,root:p.ownerDocument})}catch{o=new IntersectionObserver(be,K)}o.observe(e)}return v(!0),x}function Jz(e,n,o,u){u===void 0&&(u={});const{ancestorScroll:p=!0,ancestorResize:x=!0,elementResize:v=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:k=!1}=u,A=lx(e),B=p||x?[...A?Cd(A):[],...Cd(n)]:[];B.forEach(W=>{p&&W.addEventListener("scroll",o,{passive:!0}),x&&W.addEventListener("resize",o)});const R=A&&c?Yz(A,o):null;let L=-1,$=null;v&&($=new ResizeObserver(W=>{let[G]=W;G&&G.target===A&&$&&($.unobserve(n),cancelAnimationFrame(L),L=requestAnimationFrame(()=>{var K;(K=$)==null||K.observe(n)})),o()}),A&&!k&&$.observe(A),$.observe(n));let le,Q=k?jl(e):null;k&&se();function se(){const W=jl(e);Q&&!yT(Q,W)&&o(),Q=W,le=requestAnimationFrame(se)}return o(),()=>{var W;B.forEach(G=>{p&&G.removeEventListener("scroll",o),x&&G.removeEventListener("resize",o)}),R==null||R(),(W=$)==null||W.disconnect(),$=null,k&&cancelAnimationFrame(le)}}const Qz=Sz,eD=Tz,tD=xz,rD=Cz,nD=wz,Rb=vz,iD=Ez,sD=(e,n,o)=>{const u=new Map,p={platform:Kz,...o},x={...p.platform,_c:u};return _z(e,n,{...p,platform:x})};var oD=typeof document<"u",aD=function(){},zp=oD?X.useLayoutEffect:aD;function am(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let o,u,p;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(o=e.length,o!==n.length)return!1;for(u=o;u--!==0;)if(!am(e[u],n[u]))return!1;return!0}if(p=Object.keys(e),o=p.length,o!==Object.keys(n).length)return!1;for(u=o;u--!==0;)if(!{}.hasOwnProperty.call(n,p[u]))return!1;for(u=o;u--!==0;){const x=p[u];if(!(x==="_owner"&&e.$$typeof)&&!am(e[x],n[x]))return!1}return!0}return e!==e&&n!==n}function _T(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Lb(e,n){const o=_T(e);return Math.round(n*o)/o}function Ly(e){const n=X.useRef(e);return zp(()=>{n.current=e}),n}function lD(e){e===void 0&&(e={});const{placement:n="bottom",strategy:o="absolute",middleware:u=[],platform:p,elements:{reference:x,floating:v}={},transform:c=!0,whileElementsMounted:k,open:A}=e,[B,R]=X.useState({x:0,y:0,strategy:o,placement:n,middlewareData:{},isPositioned:!1}),[L,$]=X.useState(u);am(L,u)||$(u);const[le,Q]=X.useState(null),[se,W]=X.useState(null),G=X.useCallback(De=>{De!==ke.current&&(ke.current=De,Q(De))},[]),K=X.useCallback(De=>{De!==Pe.current&&(Pe.current=De,W(De))},[]),he=x||le,be=v||se,ke=X.useRef(null),Pe=X.useRef(null),Fe=X.useRef(B),st=k!=null,Be=Ly(k),qe=Ly(p),ot=Ly(A),xt=X.useCallback(()=>{if(!ke.current||!Pe.current)return;const De={placement:n,strategy:o,middleware:L};qe.current&&(De.platform=qe.current),sD(ke.current,Pe.current,De).then(Re=>{const et={...Re,isPositioned:ot.current!==!1};He.current&&!am(Fe.current,et)&&(Fe.current=et,Nd.flushSync(()=>{R(et)}))})},[L,n,o,qe,ot]);zp(()=>{A===!1&&Fe.current.isPositioned&&(Fe.current.isPositioned=!1,R(De=>({...De,isPositioned:!1})))},[A]);const He=X.useRef(!1);zp(()=>(He.current=!0,()=>{He.current=!1}),[]),zp(()=>{if(he&&(ke.current=he),be&&(Pe.current=be),he&&be){if(Be.current)return Be.current(he,be,xt);xt()}},[he,be,xt,Be,st]);const It=X.useMemo(()=>({reference:ke,floating:Pe,setReference:G,setFloating:K}),[G,K]),bt=X.useMemo(()=>({reference:he,floating:be}),[he,be]),wt=X.useMemo(()=>{const De={position:o,left:0,top:0};if(!bt.floating)return De;const Re=Lb(bt.floating,B.x),et=Lb(bt.floating,B.y);return c?{...De,transform:"translate("+Re+"px, "+et+"px)",..._T(bt.floating)>=1.5&&{willChange:"transform"}}:{position:o,left:Re,top:et}},[o,c,bt.floating,B.x,B.y]);return X.useMemo(()=>({...B,update:xt,refs:It,elements:bt,floatingStyles:wt}),[B,xt,It,bt,wt])}const uD=e=>{function n(o){return{}.hasOwnProperty.call(o,"current")}return{name:"arrow",options:e,fn(o){const{element:u,padding:p}=typeof e=="function"?e(o):e;return u&&n(u)?u.current!=null?Rb({element:u.current,padding:p}).fn(o):{}:u?Rb({element:u,padding:p}).fn(o):{}}}},cD=(e,n)=>({...Qz(e),options:[e,n]}),hD=(e,n)=>({...eD(e),options:[e,n]}),dD=(e,n)=>({...iD(e),options:[e,n]}),fD=(e,n)=>({...tD(e),options:[e,n]}),pD=(e,n)=>({...rD(e),options:[e,n]}),mD=(e,n)=>({...nD(e),options:[e,n]}),gD=(e,n)=>({...uD(e),options:[e,n]});var yD="Arrow",vT=X.forwardRef((e,n)=>{const{children:o,width:u=10,height:p=5,...x}=e;return ee.jsx(Ei.svg,{...x,ref:n,width:u,height:p,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?o:ee.jsx("polygon",{points:"0,0 30,0 15,10"})})});vT.displayName=yD;var _D=vT;function vD(e){const[n,o]=X.useState(void 0);return Na(()=>{if(e){o({width:e.offsetWidth,height:e.offsetHeight});const u=new ResizeObserver(p=>{if(!Array.isArray(p)||!p.length)return;const x=p[0];let v,c;if("borderBoxSize"in x){const k=x.borderBoxSize,A=Array.isArray(k)?k[0]:k;v=A.inlineSize,c=A.blockSize}else v=e.offsetWidth,c=e.offsetHeight;o({width:v,height:c})});return u.observe(e,{box:"border-box"}),()=>u.unobserve(e)}else o(void 0)},[e]),n}var xT="Popper",[wT,bT]=Pm(xT),[JL,ST]=wT(xT),TT="PopperAnchor",ET=X.forwardRef((e,n)=>{const{__scopePopper:o,virtualRef:u,...p}=e,x=ST(TT,o),v=X.useRef(null),c=Is(n,v),k=X.useRef(null);return X.useEffect(()=>{const A=k.current;k.current=(u==null?void 0:u.current)||v.current,A!==k.current&&x.onAnchorChange(k.current)}),u?null:ee.jsx(Ei.div,{...p,ref:c})});ET.displayName=TT;var ux="PopperContent",[xD,wD]=wT(ux),CT=X.forwardRef((e,n)=>{var zt,Vr,sn,_n,kn,on;const{__scopePopper:o,side:u="bottom",sideOffset:p=0,align:x="center",alignOffset:v=0,arrowPadding:c=0,avoidCollisions:k=!0,collisionBoundary:A=[],collisionPadding:B=0,sticky:R="partial",hideWhenDetached:L=!1,updatePositionStrategy:$="optimized",onPlaced:le,...Q}=e,se=ST(ux,o),[W,G]=X.useState(null),K=Is(n,Xr=>G(Xr)),[he,be]=X.useState(null),ke=vD(he),Pe=(ke==null?void 0:ke.width)??0,Fe=(ke==null?void 0:ke.height)??0,st=u+(x!=="center"?"-"+x:""),Be=typeof B=="number"?B:{top:0,right:0,bottom:0,left:0,...B},qe=Array.isArray(A)?A:[A],ot=qe.length>0,xt={padding:Be,boundary:qe.filter(SD),altBoundary:ot},{refs:He,floatingStyles:It,placement:bt,isPositioned:wt,middlewareData:De}=lD({strategy:"fixed",placement:st,whileElementsMounted:(...Xr)=>Jz(...Xr,{animationFrame:$==="always"}),elements:{reference:se.anchor},middleware:[cD({mainAxis:p+Fe,alignmentAxis:v}),k&&hD({mainAxis:!0,crossAxis:!1,limiter:R==="partial"?dD():void 0,...xt}),k&&fD({...xt}),pD({...xt,apply:({elements:Xr,rects:Un,availableWidth:Yi,availableHeight:Te})=>{const{width:Ci,height:ki}=Un.reference,Ot=Xr.floating.style;Ot.setProperty("--radix-popper-available-width",`${Yi}px`),Ot.setProperty("--radix-popper-available-height",`${Te}px`),Ot.setProperty("--radix-popper-anchor-width",`${Ci}px`),Ot.setProperty("--radix-popper-anchor-height",`${ki}px`)}}),he&&gD({element:he,padding:c}),TD({arrowWidth:Pe,arrowHeight:Fe}),L&&mD({strategy:"referenceHidden",...xt})]}),[Re,et]=IT(bt),yt=Ba(le);Na(()=>{wt&&(yt==null||yt())},[wt,yt]);const dt=(zt=De.arrow)==null?void 0:zt.x,Mt=(Vr=De.arrow)==null?void 0:Vr.y,At=((sn=De.arrow)==null?void 0:sn.centerOffset)!==0,[Yt,gr]=X.useState();return Na(()=>{W&&gr(window.getComputedStyle(W).zIndex)},[W]),ee.jsx("div",{ref:He.setFloating,"data-radix-popper-content-wrapper":"",style:{...It,transform:wt?It.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Yt,"--radix-popper-transform-origin":[(_n=De.transformOrigin)==null?void 0:_n.x,(kn=De.transformOrigin)==null?void 0:kn.y].join(" "),...((on=De.hide)==null?void 0:on.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:ee.jsx(xD,{scope:o,placedSide:Re,onArrowChange:be,arrowX:dt,arrowY:Mt,shouldHideArrow:At,children:ee.jsx(Ei.div,{"data-side":Re,"data-align":et,...Q,ref:K,style:{...Q.style,animation:wt?void 0:"none"}})})})});CT.displayName=ux;var kT="PopperArrow",bD={top:"bottom",right:"left",bottom:"top",left:"right"},PT=X.forwardRef(function(n,o){const{__scopePopper:u,...p}=n,x=wD(kT,u),v=bD[x.placedSide];return ee.jsx("span",{ref:x.onArrowChange,style:{position:"absolute",left:x.arrowX,top:x.arrowY,[v]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[x.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[x.placedSide],visibility:x.shouldHideArrow?"hidden":void 0},children:ee.jsx(_D,{...p,ref:o,style:{...p.style,display:"block"}})})});PT.displayName=kT;function SD(e){return e!==null}var TD=e=>({name:"transformOrigin",options:e,fn(n){var se,W,G;const{placement:o,rects:u,middlewareData:p}=n,v=((se=p.arrow)==null?void 0:se.centerOffset)!==0,c=v?0:e.arrowWidth,k=v?0:e.arrowHeight,[A,B]=IT(o),R={start:"0%",center:"50%",end:"100%"}[B],L=(((W=p.arrow)==null?void 0:W.x)??0)+c/2,$=(((G=p.arrow)==null?void 0:G.y)??0)+k/2;let le="",Q="";return A==="bottom"?(le=v?R:`${L}px`,Q=`${-k}px`):A==="top"?(le=v?R:`${L}px`,Q=`${u.floating.height+k}px`):A==="right"?(le=`${-k}px`,Q=v?R:`${$}px`):A==="left"&&(le=`${u.floating.width+k}px`,Q=v?R:`${$}px`),{data:{x:le,y:Q}}}});function IT(e){const[n,o="center"]=e.split("-");return[n,o]}var ED=ET,CD=CT,kD=PT,PD=Symbol("radix.slottable");function ID(e){const n=({children:o})=>ee.jsx(ee.Fragment,{children:o});return n.displayName=`${e}.Slottable`,n.__radixId=PD,n}var[Fm]=Pm("Tooltip",[bT]),cx=bT(),AT="TooltipProvider",AD=700,Fb="tooltip.open",[MD,MT]=Fm(AT),zT=e=>{const{__scopeTooltip:n,delayDuration:o=AD,skipDelayDuration:u=300,disableHoverableContent:p=!1,children:x}=e,v=X.useRef(!0),c=X.useRef(!1),k=X.useRef(0);return X.useEffect(()=>{const A=k.current;return()=>window.clearTimeout(A)},[]),ee.jsx(MD,{scope:n,isOpenDelayedRef:v,delayDuration:o,onOpen:X.useCallback(()=>{window.clearTimeout(k.current),v.current=!1},[]),onClose:X.useCallback(()=>{window.clearTimeout(k.current),k.current=window.setTimeout(()=>v.current=!0,u)},[u]),isPointerInTransitRef:c,onPointerInTransitChange:X.useCallback(A=>{c.current=A},[]),disableHoverableContent:p,children:x})};zT.displayName=AT;var DT="Tooltip",[QL,Om]=Fm(DT),V_="TooltipTrigger",zD=X.forwardRef((e,n)=>{const{__scopeTooltip:o,...u}=e,p=Om(V_,o),x=MT(V_,o),v=cx(o),c=X.useRef(null),k=Is(n,c,p.onTriggerChange),A=X.useRef(!1),B=X.useRef(!1),R=X.useCallback(()=>A.current=!1,[]);return X.useEffect(()=>()=>document.removeEventListener("pointerup",R),[R]),ee.jsx(ED,{asChild:!0,...v,children:ee.jsx(Ei.button,{"aria-describedby":p.open?p.contentId:void 0,"data-state":p.stateAttribute,...u,ref:k,onPointerMove:tn(e.onPointerMove,L=>{L.pointerType!=="touch"&&!B.current&&!x.isPointerInTransitRef.current&&(p.onTriggerEnter(),B.current=!0)}),onPointerLeave:tn(e.onPointerLeave,()=>{p.onTriggerLeave(),B.current=!1}),onPointerDown:tn(e.onPointerDown,()=>{p.open&&p.onClose(),A.current=!0,document.addEventListener("pointerup",R,{once:!0})}),onFocus:tn(e.onFocus,()=>{A.current||p.onOpen()}),onBlur:tn(e.onBlur,p.onClose),onClick:tn(e.onClick,p.onClose)})})});zD.displayName=V_;var DD="TooltipPortal",[e3,RD]=Fm(DD,{forceMount:void 0}),bc="TooltipContent",RT=X.forwardRef((e,n)=>{const o=RD(bc,e.__scopeTooltip),{forceMount:u=o.forceMount,side:p="top",...x}=e,v=Om(bc,e.__scopeTooltip);return ee.jsx(Kv,{present:u||v.open,children:v.disableHoverableContent?ee.jsx(LT,{side:p,...x,ref:n}):ee.jsx(LD,{side:p,...x,ref:n})})}),LD=X.forwardRef((e,n)=>{const o=Om(bc,e.__scopeTooltip),u=MT(bc,e.__scopeTooltip),p=X.useRef(null),x=Is(n,p),[v,c]=X.useState(null),{trigger:k,onClose:A}=o,B=p.current,{onPointerInTransitChange:R}=u,L=X.useCallback(()=>{c(null),R(!1)},[R]),$=X.useCallback((le,Q)=>{const se=le.currentTarget,W={x:le.clientX,y:le.clientY},G=jD(W,se.getBoundingClientRect()),K=VD(W,G),he=$D(Q.getBoundingClientRect()),be=qD([...K,...he]);c(be),R(!0)},[R]);return X.useEffect(()=>()=>L(),[L]),X.useEffect(()=>{if(k&&B){const le=se=>$(se,B),Q=se=>$(se,k);return k.addEventListener("pointerleave",le),B.addEventListener("pointerleave",Q),()=>{k.removeEventListener("pointerleave",le),B.removeEventListener("pointerleave",Q)}}},[k,B,$,L]),X.useEffect(()=>{if(v){const le=Q=>{const se=Q.target,W={x:Q.clientX,y:Q.clientY},G=(k==null?void 0:k.contains(se))||(B==null?void 0:B.contains(se)),K=!UD(W,v);G?L():K&&(L(),A())};return document.addEventListener("pointermove",le),()=>document.removeEventListener("pointermove",le)}},[k,B,v,A,L]),ee.jsx(LT,{...e,ref:x})}),[FD,OD]=Fm(DT,{isInside:!1}),BD=ID("TooltipContent"),LT=X.forwardRef((e,n)=>{const{__scopeTooltip:o,children:u,"aria-label":p,onEscapeKeyDown:x,onPointerDownOutside:v,...c}=e,k=Om(bc,o),A=cx(o),{onClose:B}=k;return X.useEffect(()=>(document.addEventListener(Fb,B),()=>document.removeEventListener(Fb,B)),[B]),X.useEffect(()=>{if(k.trigger){const R=L=>{const $=L.target;$!=null&&$.contains(k.trigger)&&B()};return window.addEventListener("scroll",R,{capture:!0}),()=>window.removeEventListener("scroll",R,{capture:!0})}},[k.trigger,B]),ee.jsx(Xv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:x,onPointerDownOutside:v,onFocusOutside:R=>R.preventDefault(),onDismiss:B,children:ee.jsxs(CD,{"data-state":k.stateAttribute,...A,...c,ref:n,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[ee.jsx(BD,{children:u}),ee.jsx(FD,{scope:o,isInside:!0,children:ee.jsx(yA,{id:k.contentId,role:"tooltip",children:p||u})})]})})});RT.displayName=bc;var FT="TooltipArrow",ND=X.forwardRef((e,n)=>{const{__scopeTooltip:o,...u}=e,p=cx(o);return OD(FT,o).isInside?null:ee.jsx(kD,{...p,...u,ref:n})});ND.displayName=FT;function jD(e,n){const o=Math.abs(n.top-e.y),u=Math.abs(n.bottom-e.y),p=Math.abs(n.right-e.x),x=Math.abs(n.left-e.x);switch(Math.min(o,u,p,x)){case x:return"left";case p:return"right";case o:return"top";case u:return"bottom";default:throw new Error("unreachable")}}function VD(e,n,o=5){const u=[];switch(n){case"top":u.push({x:e.x-o,y:e.y+o},{x:e.x+o,y:e.y+o});break;case"bottom":u.push({x:e.x-o,y:e.y-o},{x:e.x+o,y:e.y-o});break;case"left":u.push({x:e.x+o,y:e.y-o},{x:e.x+o,y:e.y+o});break;case"right":u.push({x:e.x-o,y:e.y-o},{x:e.x-o,y:e.y+o});break}return u}function $D(e){const{top:n,right:o,bottom:u,left:p}=e;return[{x:p,y:n},{x:o,y:n},{x:o,y:u},{x:p,y:u}]}function UD(e,n){const{x:o,y:u}=e;let p=!1;for(let x=0,v=n.length-1;x<n.length;v=x++){const c=n[x],k=n[v],A=c.x,B=c.y,R=k.x,L=k.y;B>u!=L>u&&o<(R-A)*(u-B)/(L-B)+A&&(p=!p)}return p}function qD(e){const n=e.slice();return n.sort((o,u)=>o.x<u.x?-1:o.x>u.x?1:o.y<u.y?-1:o.y>u.y?1:0),ZD(n)}function ZD(e){if(e.length<=1)return e.slice();const n=[];for(let u=0;u<e.length;u++){const p=e[u];for(;n.length>=2;){const x=n[n.length-1],v=n[n.length-2];if((x.x-v.x)*(p.y-v.y)>=(x.y-v.y)*(p.x-v.x))n.pop();else break}n.push(p)}n.pop();const o=[];for(let u=e.length-1;u>=0;u--){const p=e[u];for(;o.length>=2;){const x=o[o.length-1],v=o[o.length-2];if((x.x-v.x)*(p.y-v.y)>=(x.y-v.y)*(p.x-v.x))o.pop();else break}o.push(p)}return o.pop(),n.length===1&&o.length===1&&n[0].x===o[0].x&&n[0].y===o[0].y?n:n.concat(o)}var HD=zT,OT=RT;const GD=HD,WD=X.forwardRef(({className:e,sideOffset:n=4,...o},u)=>ee.jsx(OT,{ref:u,sideOffset:n,className:nn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...o}));WD.displayName=OT.displayName;var Bm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},XD={setTimeout:(e,n)=>setTimeout(e,n),clearTimeout:e=>clearTimeout(e),setInterval:(e,n)=>setInterval(e,n),clearInterval:e=>clearInterval(e)},va,J_,t1,KD=(t1=class{constructor(){Xt(this,va,XD);Xt(this,J_,!1)}setTimeoutProvider(e){Rt(this,va,e)}setTimeout(e,n){return ze(this,va).setTimeout(e,n)}clearTimeout(e){ze(this,va).clearTimeout(e)}setInterval(e,n){return ze(this,va).setInterval(e,n)}clearInterval(e){ze(this,va).clearInterval(e)}},va=new WeakMap,J_=new WeakMap,t1),$_=new KD;function YD(e){setTimeout(e,0)}var Nm=typeof window>"u"||"Deno"in globalThis;function xs(){}function JD(e,n){return typeof e=="function"?e(n):e}function QD(e){return typeof e=="number"&&e>=0&&e!==1/0}function eR(e,n){return Math.max(e+(n||0)-Date.now(),0)}function U_(e,n){return typeof e=="function"?e(n):e}function tR(e,n){return typeof e=="function"?e(n):e}function Ob(e,n){const{type:o="all",exact:u,fetchStatus:p,predicate:x,queryKey:v,stale:c}=e;if(v){if(u){if(n.queryHash!==hx(v,n.options))return!1}else if(!Pd(n.queryKey,v))return!1}if(o!=="all"){const k=n.isActive();if(o==="active"&&!k||o==="inactive"&&k)return!1}return!(typeof c=="boolean"&&n.isStale()!==c||p&&p!==n.state.fetchStatus||x&&!x(n))}function Bb(e,n){const{exact:o,status:u,predicate:p,mutationKey:x}=e;if(x){if(!n.options.mutationKey)return!1;if(o){if(kd(n.options.mutationKey)!==kd(x))return!1}else if(!Pd(n.options.mutationKey,x))return!1}return!(u&&n.state.status!==u||p&&!p(n))}function hx(e,n){return((n==null?void 0:n.queryKeyHashFn)||kd)(e)}function kd(e){return JSON.stringify(e,(n,o)=>q_(o)?Object.keys(o).sort().reduce((u,p)=>(u[p]=o[p],u),{}):o)}function Pd(e,n){return e===n?!0:typeof e!=typeof n?!1:e&&n&&typeof e=="object"&&typeof n=="object"?Object.keys(n).every(o=>Pd(e[o],n[o])):!1}var rR=Object.prototype.hasOwnProperty;function BT(e,n){if(e===n)return e;const o=Nb(e)&&Nb(n);if(!o&&!(q_(e)&&q_(n)))return n;const p=(o?e:Object.keys(e)).length,x=o?n:Object.keys(n),v=x.length,c=o?new Array(v):{};let k=0;for(let A=0;A<v;A++){const B=o?A:x[A],R=e[B],L=n[B];if(R===L){c[B]=R,(o?A<p:rR.call(e,B))&&k++;continue}if(R===null||L===null||typeof R!="object"||typeof L!="object"){c[B]=L;continue}const $=BT(R,L);c[B]=$,$===R&&k++}return p===v&&k===p?e:c}function Nb(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function q_(e){if(!jb(e))return!1;const n=e.constructor;if(n===void 0)return!0;const o=n.prototype;return!(!jb(o)||!o.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function jb(e){return Object.prototype.toString.call(e)==="[object Object]"}function nR(e){return new Promise(n=>{$_.setTimeout(n,e)})}function iR(e,n,o){return typeof o.structuralSharing=="function"?o.structuralSharing(e,n):o.structuralSharing!==!1?BT(e,n):n}function sR(e,n,o=0){const u=[...e,n];return o&&u.length>o?u.slice(1):u}function oR(e,n,o=0){const u=[n,...e];return o&&u.length>o?u.slice(0,-1):u}var dx=Symbol();function NT(e,n){return!e.queryFn&&(n!=null&&n.initialPromise)?()=>n.initialPromise:!e.queryFn||e.queryFn===dx?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function aR(e,n,o){let u=!1,p;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(p??(p=n()),u||(u=!0,p.aborted?o():p.addEventListener("abort",o,{once:!0})),p)}),e}var Tl,xa,oc,r1,lR=(r1=class extends Bm{constructor(){super();Xt(this,Tl);Xt(this,xa);Xt(this,oc);Rt(this,oc,n=>{if(!Nm&&window.addEventListener){const o=()=>n();return window.addEventListener("visibilitychange",o,!1),()=>{window.removeEventListener("visibilitychange",o)}}})}onSubscribe(){ze(this,xa)||this.setEventListener(ze(this,oc))}onUnsubscribe(){var n;this.hasListeners()||((n=ze(this,xa))==null||n.call(this),Rt(this,xa,void 0))}setEventListener(n){var o;Rt(this,oc,n),(o=ze(this,xa))==null||o.call(this),Rt(this,xa,n(u=>{typeof u=="boolean"?this.setFocused(u):this.onFocus()}))}setFocused(n){ze(this,Tl)!==n&&(Rt(this,Tl,n),this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(o=>{o(n)})}isFocused(){var n;return typeof ze(this,Tl)=="boolean"?ze(this,Tl):((n=globalThis.document)==null?void 0:n.visibilityState)!=="hidden"}},Tl=new WeakMap,xa=new WeakMap,oc=new WeakMap,r1),jT=new lR;function uR(){let e,n;const o=new Promise((p,x)=>{e=p,n=x});o.status="pending",o.catch(()=>{});function u(p){Object.assign(o,p),delete o.resolve,delete o.reject}return o.resolve=p=>{u({status:"fulfilled",value:p}),e(p)},o.reject=p=>{u({status:"rejected",reason:p}),n(p)},o}var cR=YD;function hR(){let e=[],n=0,o=c=>{c()},u=c=>{c()},p=cR;const x=c=>{n?e.push(c):p(()=>{o(c)})},v=()=>{const c=e;e=[],c.length&&p(()=>{u(()=>{c.forEach(k=>{o(k)})})})};return{batch:c=>{let k;n++;try{k=c()}finally{n--,n||v()}return k},batchCalls:c=>(...k)=>{x(()=>{c(...k)})},schedule:x,setNotifyFunction:c=>{o=c},setBatchNotifyFunction:c=>{u=c},setScheduler:c=>{p=c}}}var ri=hR(),ac,wa,lc,n1,dR=(n1=class extends Bm{constructor(){super();Xt(this,ac,!0);Xt(this,wa);Xt(this,lc);Rt(this,lc,n=>{if(!Nm&&window.addEventListener){const o=()=>n(!0),u=()=>n(!1);return window.addEventListener("online",o,!1),window.addEventListener("offline",u,!1),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",u)}}})}onSubscribe(){ze(this,wa)||this.setEventListener(ze(this,lc))}onUnsubscribe(){var n;this.hasListeners()||((n=ze(this,wa))==null||n.call(this),Rt(this,wa,void 0))}setEventListener(n){var o;Rt(this,lc,n),(o=ze(this,wa))==null||o.call(this),Rt(this,wa,n(this.setOnline.bind(this)))}setOnline(n){ze(this,ac)!==n&&(Rt(this,ac,n),this.listeners.forEach(u=>{u(n)}))}isOnline(){return ze(this,ac)}},ac=new WeakMap,wa=new WeakMap,lc=new WeakMap,n1),lm=new dR;function fR(e){return Math.min(1e3*2**e,3e4)}function VT(e){return(e??"online")==="online"?lm.isOnline():!0}var Z_=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function $T(e){let n=!1,o=0,u;const p=uR(),x=()=>p.status!=="pending",v=Q=>{var se;if(!x()){const W=new Z_(Q);L(W),(se=e.onCancel)==null||se.call(e,W)}},c=()=>{n=!0},k=()=>{n=!1},A=()=>jT.isFocused()&&(e.networkMode==="always"||lm.isOnline())&&e.canRun(),B=()=>VT(e.networkMode)&&e.canRun(),R=Q=>{x()||(u==null||u(),p.resolve(Q))},L=Q=>{x()||(u==null||u(),p.reject(Q))},$=()=>new Promise(Q=>{var se;u=W=>{(x()||A())&&Q(W)},(se=e.onPause)==null||se.call(e)}).then(()=>{var Q;u=void 0,x()||(Q=e.onContinue)==null||Q.call(e)}),le=()=>{if(x())return;let Q;const se=o===0?e.initialPromise:void 0;try{Q=se??e.fn()}catch(W){Q=Promise.reject(W)}Promise.resolve(Q).then(R).catch(W=>{var ke;if(x())return;const G=e.retry??(Nm?0:3),K=e.retryDelay??fR,he=typeof K=="function"?K(o,W):K,be=G===!0||typeof G=="number"&&o<G||typeof G=="function"&&G(o,W);if(n||!be){L(W);return}o++,(ke=e.onFail)==null||ke.call(e,o,W),nR(he).then(()=>A()?void 0:$()).then(()=>{n?L(W):le()})})};return{promise:p,status:()=>p.status,cancel:v,continue:()=>(u==null||u(),p),cancelRetry:c,continueRetry:k,canStart:B,start:()=>(B()?le():$().then(le),p)}}var El,i1,UT=(i1=class{constructor(){Xt(this,El)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),QD(this.gcTime)&&Rt(this,El,$_.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Nm?1/0:5*60*1e3))}clearGcTimeout(){ze(this,El)&&($_.clearTimeout(ze(this,El)),Rt(this,El,void 0))}},El=new WeakMap,i1),Cl,uc,ss,kl,mn,Md,Pl,ws,_o,s1,pR=(s1=class extends UT{constructor(n){super();Xt(this,ws);Xt(this,Cl);Xt(this,uc);Xt(this,ss);Xt(this,kl);Xt(this,mn);Xt(this,Md);Xt(this,Pl);Rt(this,Pl,!1),Rt(this,Md,n.defaultOptions),this.setOptions(n.options),this.observers=[],Rt(this,kl,n.client),Rt(this,ss,ze(this,kl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,Rt(this,Cl,$b(this.options)),this.state=n.state??ze(this,Cl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=ze(this,mn))==null?void 0:n.promise}setOptions(n){if(this.options={...ze(this,Md),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const o=$b(this.options);o.data!==void 0&&(this.setState(Vb(o.data,o.dataUpdatedAt)),Rt(this,Cl,o))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ze(this,ss).remove(this)}setData(n,o){const u=iR(this.state.data,n,this.options);return Bn(this,ws,_o).call(this,{data:u,type:"success",dataUpdatedAt:o==null?void 0:o.updatedAt,manual:o==null?void 0:o.manual}),u}setState(n,o){Bn(this,ws,_o).call(this,{type:"setState",state:n,setStateOptions:o})}cancel(n){var u,p;const o=(u=ze(this,mn))==null?void 0:u.promise;return(p=ze(this,mn))==null||p.cancel(n),o?o.then(xs).catch(xs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ze(this,Cl))}isActive(){return this.observers.some(n=>tR(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===dx||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>U_(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!eR(this.state.dataUpdatedAt,n)}onFocus(){var o;const n=this.observers.find(u=>u.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(o=ze(this,mn))==null||o.continue()}onOnline(){var o;const n=this.observers.find(u=>u.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(o=ze(this,mn))==null||o.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),ze(this,ss).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(o=>o!==n),this.observers.length||(ze(this,mn)&&(ze(this,Pl)?ze(this,mn).cancel({revert:!0}):ze(this,mn).cancelRetry()),this.scheduleGc()),ze(this,ss).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Bn(this,ws,_o).call(this,{type:"invalidate"})}async fetch(n,o){var k,A,B,R,L,$,le,Q,se,W,G,K;if(this.state.fetchStatus!=="idle"&&((k=ze(this,mn))==null?void 0:k.status())!=="rejected"){if(this.state.data!==void 0&&(o!=null&&o.cancelRefetch))this.cancel({silent:!0});else if(ze(this,mn))return ze(this,mn).continueRetry(),ze(this,mn).promise}if(n&&this.setOptions(n),!this.options.queryFn){const he=this.observers.find(be=>be.options.queryFn);he&&this.setOptions(he.options)}const u=new AbortController,p=he=>{Object.defineProperty(he,"signal",{enumerable:!0,get:()=>(Rt(this,Pl,!0),u.signal)})},x=()=>{const he=NT(this.options,o),ke=(()=>{const Pe={client:ze(this,kl),queryKey:this.queryKey,meta:this.meta};return p(Pe),Pe})();return Rt(this,Pl,!1),this.options.persister?this.options.persister(he,ke,this):he(ke)},c=(()=>{const he={fetchOptions:o,options:this.options,queryKey:this.queryKey,client:ze(this,kl),state:this.state,fetchFn:x};return p(he),he})();(A=this.options.behavior)==null||A.onFetch(c,this),Rt(this,uc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((B=c.fetchOptions)==null?void 0:B.meta))&&Bn(this,ws,_o).call(this,{type:"fetch",meta:(R=c.fetchOptions)==null?void 0:R.meta}),Rt(this,mn,$T({initialPromise:o==null?void 0:o.initialPromise,fn:c.fetchFn,onCancel:he=>{he instanceof Z_&&he.revert&&this.setState({...ze(this,uc),fetchStatus:"idle"}),u.abort()},onFail:(he,be)=>{Bn(this,ws,_o).call(this,{type:"failed",failureCount:he,error:be})},onPause:()=>{Bn(this,ws,_o).call(this,{type:"pause"})},onContinue:()=>{Bn(this,ws,_o).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const he=await ze(this,mn).start();if(he===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(he),($=(L=ze(this,ss).config).onSuccess)==null||$.call(L,he,this),(Q=(le=ze(this,ss).config).onSettled)==null||Q.call(le,he,this.state.error,this),he}catch(he){if(he instanceof Z_){if(he.silent)return ze(this,mn).promise;if(he.revert){if(this.state.data===void 0)throw he;return this.state.data}}throw Bn(this,ws,_o).call(this,{type:"error",error:he}),(W=(se=ze(this,ss).config).onError)==null||W.call(se,he,this),(K=(G=ze(this,ss).config).onSettled)==null||K.call(G,this.state.data,he,this),he}finally{this.scheduleGc()}}},Cl=new WeakMap,uc=new WeakMap,ss=new WeakMap,kl=new WeakMap,mn=new WeakMap,Md=new WeakMap,Pl=new WeakMap,ws=new WeakSet,_o=function(n){const o=u=>{switch(n.type){case"failed":return{...u,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...u,fetchStatus:"paused"};case"continue":return{...u,fetchStatus:"fetching"};case"fetch":return{...u,...mR(u.data,this.options),fetchMeta:n.meta??null};case"success":const p={...u,...Vb(n.data,n.dataUpdatedAt),dataUpdateCount:u.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Rt(this,uc,n.manual?p:void 0),p;case"error":const x=n.error;return{...u,error:x,errorUpdateCount:u.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:u.fetchFailureCount+1,fetchFailureReason:x,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...u,isInvalidated:!0};case"setState":return{...u,...n.state}}};this.state=o(this.state),ri.batch(()=>{this.observers.forEach(u=>{u.onQueryUpdate()}),ze(this,ss).notify({query:this,type:"updated",action:n})})},s1);function mR(e,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:VT(n.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Vb(e,n){return{data:e,dataUpdatedAt:n??Date.now(),error:null,isInvalidated:!1,status:"success"}}function $b(e){const n=typeof e.initialData=="function"?e.initialData():e.initialData,o=n!==void 0,u=o?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:o?u??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:o?"success":"pending",fetchStatus:"idle"}}function Ub(e){return{onFetch:(n,o)=>{var B,R,L,$,le;const u=n.options,p=(L=(R=(B=n.fetchOptions)==null?void 0:B.meta)==null?void 0:R.fetchMore)==null?void 0:L.direction,x=(($=n.state.data)==null?void 0:$.pages)||[],v=((le=n.state.data)==null?void 0:le.pageParams)||[];let c={pages:[],pageParams:[]},k=0;const A=async()=>{let Q=!1;const se=K=>{aR(K,()=>n.signal,()=>Q=!0)},W=NT(n.options,n.fetchOptions),G=async(K,he,be)=>{if(Q)return Promise.reject();if(he==null&&K.pages.length)return Promise.resolve(K);const Pe=(()=>{const qe={client:n.client,queryKey:n.queryKey,pageParam:he,direction:be?"backward":"forward",meta:n.options.meta};return se(qe),qe})(),Fe=await W(Pe),{maxPages:st}=n.options,Be=be?oR:sR;return{pages:Be(K.pages,Fe,st),pageParams:Be(K.pageParams,he,st)}};if(p&&x.length){const K=p==="backward",he=K?gR:qb,be={pages:x,pageParams:v},ke=he(u,be);c=await G(be,ke,K)}else{const K=e??x.length;do{const he=k===0?v[0]??u.initialPageParam:qb(u,c);if(k>0&&he==null)break;c=await G(c,he),k++}while(k<K)}return c};n.options.persister?n.fetchFn=()=>{var Q,se;return(se=(Q=n.options).persister)==null?void 0:se.call(Q,A,{client:n.client,queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},o)}:n.fetchFn=A}}}function qb(e,{pages:n,pageParams:o}){const u=n.length-1;return n.length>0?e.getNextPageParam(n[u],n,o[u],o):void 0}function gR(e,{pages:n,pageParams:o}){var u;return n.length>0?(u=e.getPreviousPageParam)==null?void 0:u.call(e,n[0],n,o[0],o):void 0}var zd,Us,ei,Il,qs,pa,o1,yR=(o1=class extends UT{constructor(n){super();Xt(this,qs);Xt(this,zd);Xt(this,Us);Xt(this,ei);Xt(this,Il);Rt(this,zd,n.client),this.mutationId=n.mutationId,Rt(this,ei,n.mutationCache),Rt(this,Us,[]),this.state=n.state||_R(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){ze(this,Us).includes(n)||(ze(this,Us).push(n),this.clearGcTimeout(),ze(this,ei).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){Rt(this,Us,ze(this,Us).filter(o=>o!==n)),this.scheduleGc(),ze(this,ei).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){ze(this,Us).length||(this.state.status==="pending"?this.scheduleGc():ze(this,ei).remove(this))}continue(){var n;return((n=ze(this,Il))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var v,c,k,A,B,R,L,$,le,Q,se,W,G,K,he,be,ke,Pe,Fe,st;const o=()=>{Bn(this,qs,pa).call(this,{type:"continue"})},u={client:ze(this,zd),meta:this.options.meta,mutationKey:this.options.mutationKey};Rt(this,Il,$T({fn:()=>this.options.mutationFn?this.options.mutationFn(n,u):Promise.reject(new Error("No mutationFn found")),onFail:(Be,qe)=>{Bn(this,qs,pa).call(this,{type:"failed",failureCount:Be,error:qe})},onPause:()=>{Bn(this,qs,pa).call(this,{type:"pause"})},onContinue:o,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ze(this,ei).canRun(this)}));const p=this.state.status==="pending",x=!ze(this,Il).canStart();try{if(p)o();else{Bn(this,qs,pa).call(this,{type:"pending",variables:n,isPaused:x}),await((c=(v=ze(this,ei).config).onMutate)==null?void 0:c.call(v,n,this,u));const qe=await((A=(k=this.options).onMutate)==null?void 0:A.call(k,n,u));qe!==this.state.context&&Bn(this,qs,pa).call(this,{type:"pending",context:qe,variables:n,isPaused:x})}const Be=await ze(this,Il).start();return await((R=(B=ze(this,ei).config).onSuccess)==null?void 0:R.call(B,Be,n,this.state.context,this,u)),await(($=(L=this.options).onSuccess)==null?void 0:$.call(L,Be,n,this.state.context,u)),await((Q=(le=ze(this,ei).config).onSettled)==null?void 0:Q.call(le,Be,null,this.state.variables,this.state.context,this,u)),await((W=(se=this.options).onSettled)==null?void 0:W.call(se,Be,null,n,this.state.context,u)),Bn(this,qs,pa).call(this,{type:"success",data:Be}),Be}catch(Be){try{await((K=(G=ze(this,ei).config).onError)==null?void 0:K.call(G,Be,n,this.state.context,this,u))}catch(qe){Promise.reject(qe)}try{await((be=(he=this.options).onError)==null?void 0:be.call(he,Be,n,this.state.context,u))}catch(qe){Promise.reject(qe)}try{await((Pe=(ke=ze(this,ei).config).onSettled)==null?void 0:Pe.call(ke,void 0,Be,this.state.variables,this.state.context,this,u))}catch(qe){Promise.reject(qe)}try{await((st=(Fe=this.options).onSettled)==null?void 0:st.call(Fe,void 0,Be,n,this.state.context,u))}catch(qe){Promise.reject(qe)}throw Bn(this,qs,pa).call(this,{type:"error",error:Be}),Be}finally{ze(this,ei).runNext(this)}}},zd=new WeakMap,Us=new WeakMap,ei=new WeakMap,Il=new WeakMap,qs=new WeakSet,pa=function(n){const o=u=>{switch(n.type){case"failed":return{...u,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...u,isPaused:!0};case"continue":return{...u,isPaused:!1};case"pending":return{...u,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...u,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...u,data:void 0,error:n.error,failureCount:u.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=o(this.state),ri.batch(()=>{ze(this,Us).forEach(u=>{u.onMutationUpdate(n)}),ze(this,ei).notify({mutation:this,type:"updated",action:n})})},o1);function _R(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var wo,bs,Dd,a1,vR=(a1=class extends Bm{constructor(n={}){super();Xt(this,wo);Xt(this,bs);Xt(this,Dd);this.config=n,Rt(this,wo,new Set),Rt(this,bs,new Map),Rt(this,Dd,0)}build(n,o,u){const p=new yR({client:n,mutationCache:this,mutationId:++Wf(this,Dd)._,options:n.defaultMutationOptions(o),state:u});return this.add(p),p}add(n){ze(this,wo).add(n);const o=gp(n);if(typeof o=="string"){const u=ze(this,bs).get(o);u?u.push(n):ze(this,bs).set(o,[n])}this.notify({type:"added",mutation:n})}remove(n){if(ze(this,wo).delete(n)){const o=gp(n);if(typeof o=="string"){const u=ze(this,bs).get(o);if(u)if(u.length>1){const p=u.indexOf(n);p!==-1&&u.splice(p,1)}else u[0]===n&&ze(this,bs).delete(o)}}this.notify({type:"removed",mutation:n})}canRun(n){const o=gp(n);if(typeof o=="string"){const u=ze(this,bs).get(o),p=u==null?void 0:u.find(x=>x.state.status==="pending");return!p||p===n}else return!0}runNext(n){var u;const o=gp(n);if(typeof o=="string"){const p=(u=ze(this,bs).get(o))==null?void 0:u.find(x=>x!==n&&x.state.isPaused);return(p==null?void 0:p.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ri.batch(()=>{ze(this,wo).forEach(n=>{this.notify({type:"removed",mutation:n})}),ze(this,wo).clear(),ze(this,bs).clear()})}getAll(){return Array.from(ze(this,wo))}find(n){const o={exact:!0,...n};return this.getAll().find(u=>Bb(o,u))}findAll(n={}){return this.getAll().filter(o=>Bb(n,o))}notify(n){ri.batch(()=>{this.listeners.forEach(o=>{o(n)})})}resumePausedMutations(){const n=this.getAll().filter(o=>o.state.isPaused);return ri.batch(()=>Promise.all(n.map(o=>o.continue().catch(xs))))}},wo=new WeakMap,bs=new WeakMap,Dd=new WeakMap,a1);function gp(e){var n;return(n=e.options.scope)==null?void 0:n.id}var Zs,l1,xR=(l1=class extends Bm{constructor(n={}){super();Xt(this,Zs);this.config=n,Rt(this,Zs,new Map)}build(n,o,u){const p=o.queryKey,x=o.queryHash??hx(p,o);let v=this.get(x);return v||(v=new pR({client:n,queryKey:p,queryHash:x,options:n.defaultQueryOptions(o),state:u,defaultOptions:n.getQueryDefaults(p)}),this.add(v)),v}add(n){ze(this,Zs).has(n.queryHash)||(ze(this,Zs).set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const o=ze(this,Zs).get(n.queryHash);o&&(n.destroy(),o===n&&ze(this,Zs).delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){ri.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return ze(this,Zs).get(n)}getAll(){return[...ze(this,Zs).values()]}find(n){const o={exact:!0,...n};return this.getAll().find(u=>Ob(o,u))}findAll(n={}){const o=this.getAll();return Object.keys(n).length>0?o.filter(u=>Ob(n,u)):o}notify(n){ri.batch(()=>{this.listeners.forEach(o=>{o(n)})})}onFocus(){ri.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){ri.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},Zs=new WeakMap,l1),Fr,ba,Sa,cc,hc,Ta,dc,fc,u1,wR=(u1=class{constructor(e={}){Xt(this,Fr);Xt(this,ba);Xt(this,Sa);Xt(this,cc);Xt(this,hc);Xt(this,Ta);Xt(this,dc);Xt(this,fc);Rt(this,Fr,e.queryCache||new xR),Rt(this,ba,e.mutationCache||new vR),Rt(this,Sa,e.defaultOptions||{}),Rt(this,cc,new Map),Rt(this,hc,new Map),Rt(this,Ta,0)}mount(){Wf(this,Ta)._++,ze(this,Ta)===1&&(Rt(this,dc,jT.subscribe(async e=>{e&&(await this.resumePausedMutations(),ze(this,Fr).onFocus())})),Rt(this,fc,lm.subscribe(async e=>{e&&(await this.resumePausedMutations(),ze(this,Fr).onOnline())})))}unmount(){var e,n;Wf(this,Ta)._--,ze(this,Ta)===0&&((e=ze(this,dc))==null||e.call(this),Rt(this,dc,void 0),(n=ze(this,fc))==null||n.call(this),Rt(this,fc,void 0))}isFetching(e){return ze(this,Fr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ze(this,ba).findAll({...e,status:"pending"}).length}getQueryData(e){var o;const n=this.defaultQueryOptions({queryKey:e});return(o=ze(this,Fr).get(n.queryHash))==null?void 0:o.state.data}ensureQueryData(e){const n=this.defaultQueryOptions(e),o=ze(this,Fr).build(this,n),u=o.state.data;return u===void 0?this.fetchQuery(e):(e.revalidateIfStale&&o.isStaleByTime(U_(n.staleTime,o))&&this.prefetchQuery(n),Promise.resolve(u))}getQueriesData(e){return ze(this,Fr).findAll(e).map(({queryKey:n,state:o})=>{const u=o.data;return[n,u]})}setQueryData(e,n,o){const u=this.defaultQueryOptions({queryKey:e}),p=ze(this,Fr).get(u.queryHash),x=p==null?void 0:p.state.data,v=JD(n,x);if(v!==void 0)return ze(this,Fr).build(this,u).setData(v,{...o,manual:!0})}setQueriesData(e,n,o){return ri.batch(()=>ze(this,Fr).findAll(e).map(({queryKey:u})=>[u,this.setQueryData(u,n,o)]))}getQueryState(e){var o;const n=this.defaultQueryOptions({queryKey:e});return(o=ze(this,Fr).get(n.queryHash))==null?void 0:o.state}removeQueries(e){const n=ze(this,Fr);ri.batch(()=>{n.findAll(e).forEach(o=>{n.remove(o)})})}resetQueries(e,n){const o=ze(this,Fr);return ri.batch(()=>(o.findAll(e).forEach(u=>{u.reset()}),this.refetchQueries({type:"active",...e},n)))}cancelQueries(e,n={}){const o={revert:!0,...n},u=ri.batch(()=>ze(this,Fr).findAll(e).map(p=>p.cancel(o)));return Promise.all(u).then(xs).catch(xs)}invalidateQueries(e,n={}){return ri.batch(()=>(ze(this,Fr).findAll(e).forEach(o=>{o.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},n)))}refetchQueries(e,n={}){const o={...n,cancelRefetch:n.cancelRefetch??!0},u=ri.batch(()=>ze(this,Fr).findAll(e).filter(p=>!p.isDisabled()&&!p.isStatic()).map(p=>{let x=p.fetch(void 0,o);return o.throwOnError||(x=x.catch(xs)),p.state.fetchStatus==="paused"?Promise.resolve():x}));return Promise.all(u).then(xs)}fetchQuery(e){const n=this.defaultQueryOptions(e);n.retry===void 0&&(n.retry=!1);const o=ze(this,Fr).build(this,n);return o.isStaleByTime(U_(n.staleTime,o))?o.fetch(n):Promise.resolve(o.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(xs).catch(xs)}fetchInfiniteQuery(e){return e.behavior=Ub(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(xs).catch(xs)}ensureInfiniteQueryData(e){return e.behavior=Ub(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return lm.isOnline()?ze(this,ba).resumePausedMutations():Promise.resolve()}getQueryCache(){return ze(this,Fr)}getMutationCache(){return ze(this,ba)}getDefaultOptions(){return ze(this,Sa)}setDefaultOptions(e){Rt(this,Sa,e)}setQueryDefaults(e,n){ze(this,cc).set(kd(e),{queryKey:e,defaultOptions:n})}getQueryDefaults(e){const n=[...ze(this,cc).values()],o={};return n.forEach(u=>{Pd(e,u.queryKey)&&Object.assign(o,u.defaultOptions)}),o}setMutationDefaults(e,n){ze(this,hc).set(kd(e),{mutationKey:e,defaultOptions:n})}getMutationDefaults(e){const n=[...ze(this,hc).values()],o={};return n.forEach(u=>{Pd(e,u.mutationKey)&&Object.assign(o,u.defaultOptions)}),o}defaultQueryOptions(e){if(e._defaulted)return e;const n={...ze(this,Sa).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return n.queryHash||(n.queryHash=hx(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.queryFn===dx&&(n.enabled=!1),n}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ze(this,Sa).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ze(this,Fr).clear(),ze(this,ba).clear()}},Fr=new WeakMap,ba=new WeakMap,Sa=new WeakMap,cc=new WeakMap,hc=new WeakMap,Ta=new WeakMap,dc=new WeakMap,fc=new WeakMap,u1),bR=X.createContext(void 0),SR=({client:e,children:n})=>(X.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),ee.jsx(bR.Provider,{value:e,children:n}));/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Id(){return Id=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(e[u]=o[u])}return e},Id.apply(this,arguments)}var ka;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ka||(ka={}));const Zb="popstate";function TR(e){e===void 0&&(e={});function n(u,p){let{pathname:x,search:v,hash:c}=u.location;return H_("",{pathname:x,search:v,hash:c},p.state&&p.state.usr||null,p.state&&p.state.key||"default")}function o(u,p){return typeof p=="string"?p:qT(p)}return CR(n,o,null,e)}function Wr(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function fx(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function ER(){return Math.random().toString(36).substr(2,8)}function Hb(e,n){return{usr:e.state,key:e.key,idx:n}}function H_(e,n,o,u){return o===void 0&&(o=null),Id({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Ic(n):n,{state:o,key:n&&n.key||u||ER()})}function qT(e){let{pathname:n="/",search:o="",hash:u=""}=e;return o&&o!=="?"&&(n+=o.charAt(0)==="?"?o:"?"+o),u&&u!=="#"&&(n+=u.charAt(0)==="#"?u:"#"+u),n}function Ic(e){let n={};if(e){let o=e.indexOf("#");o>=0&&(n.hash=e.substr(o),e=e.substr(0,o));let u=e.indexOf("?");u>=0&&(n.search=e.substr(u),e=e.substr(0,u)),e&&(n.pathname=e)}return n}function CR(e,n,o,u){u===void 0&&(u={});let{window:p=document.defaultView,v5Compat:x=!1}=u,v=p.history,c=ka.Pop,k=null,A=B();A==null&&(A=0,v.replaceState(Id({},v.state,{idx:A}),""));function B(){return(v.state||{idx:null}).idx}function R(){c=ka.Pop;let se=B(),W=se==null?null:se-A;A=se,k&&k({action:c,location:Q.location,delta:W})}function L(se,W){c=ka.Push;let G=H_(Q.location,se,W);A=B()+1;let K=Hb(G,A),he=Q.createHref(G);try{v.pushState(K,"",he)}catch(be){if(be instanceof DOMException&&be.name==="DataCloneError")throw be;p.location.assign(he)}x&&k&&k({action:c,location:Q.location,delta:1})}function $(se,W){c=ka.Replace;let G=H_(Q.location,se,W);A=B();let K=Hb(G,A),he=Q.createHref(G);v.replaceState(K,"",he),x&&k&&k({action:c,location:Q.location,delta:0})}function le(se){let W=p.location.origin!=="null"?p.location.origin:p.location.href,G=typeof se=="string"?se:qT(se);return G=G.replace(/ $/,"%20"),Wr(W,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,W)}let Q={get action(){return c},get location(){return e(p,v)},listen(se){if(k)throw new Error("A history only accepts one active listener");return p.addEventListener(Zb,R),k=se,()=>{p.removeEventListener(Zb,R),k=null}},createHref(se){return n(p,se)},createURL:le,encodeLocation(se){let W=le(se);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:L,replace:$,go(se){return v.go(se)}};return Q}var Gb;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Gb||(Gb={}));function kR(e,n,o){return o===void 0&&(o="/"),PR(e,n,o)}function PR(e,n,o,u){let p=typeof n=="string"?Ic(n):n,x=GT(p.pathname||"/",o);if(x==null)return null;let v=ZT(e);IR(v);let c=null;for(let k=0;c==null&&k<v.length;++k){let A=VR(x);c=BR(v[k],A)}return c}function ZT(e,n,o,u){n===void 0&&(n=[]),o===void 0&&(o=[]),u===void 0&&(u="");let p=(x,v,c)=>{let k={relativePath:c===void 0?x.path||"":c,caseSensitive:x.caseSensitive===!0,childrenIndex:v,route:x};k.relativePath.startsWith("/")&&(Wr(k.relativePath.startsWith(u),'Absolute route path "'+k.relativePath+'" nested under path '+('"'+u+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),k.relativePath=k.relativePath.slice(u.length));let A=zl([u,k.relativePath]),B=o.concat(k);x.children&&x.children.length>0&&(Wr(x.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+A+'".')),ZT(x.children,n,B,A)),!(x.path==null&&!x.index)&&n.push({path:A,score:FR(A,x.index),routesMeta:B})};return e.forEach((x,v)=>{var c;if(x.path===""||!((c=x.path)!=null&&c.includes("?")))p(x,v);else for(let k of HT(x.path))p(x,v,k)}),n}function HT(e){let n=e.split("/");if(n.length===0)return[];let[o,...u]=n,p=o.endsWith("?"),x=o.replace(/\?$/,"");if(u.length===0)return p?[x,""]:[x];let v=HT(u.join("/")),c=[];return c.push(...v.map(k=>k===""?x:[x,k].join("/"))),p&&c.push(...v),c.map(k=>e.startsWith("/")&&k===""?"/":k)}function IR(e){e.sort((n,o)=>n.score!==o.score?o.score-n.score:OR(n.routesMeta.map(u=>u.childrenIndex),o.routesMeta.map(u=>u.childrenIndex)))}const AR=/^:[\w-]+$/,MR=3,zR=2,DR=1,RR=10,LR=-2,Wb=e=>e==="*";function FR(e,n){let o=e.split("/"),u=o.length;return o.some(Wb)&&(u+=LR),n&&(u+=zR),o.filter(p=>!Wb(p)).reduce((p,x)=>p+(AR.test(x)?MR:x===""?DR:RR),u)}function OR(e,n){return e.length===n.length&&e.slice(0,-1).every((u,p)=>u===n[p])?e[e.length-1]-n[n.length-1]:0}function BR(e,n,o){let{routesMeta:u}=e,p={},x="/",v=[];for(let c=0;c<u.length;++c){let k=u[c],A=c===u.length-1,B=x==="/"?n:n.slice(x.length)||"/",R=NR({path:k.relativePath,caseSensitive:k.caseSensitive,end:A},B),L=k.route;if(!R)return null;Object.assign(p,R.params),v.push({params:p,pathname:zl([x,R.pathname]),pathnameBase:HR(zl([x,R.pathnameBase])),route:L}),R.pathnameBase!=="/"&&(x=zl([x,R.pathnameBase]))}return v}function NR(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,u]=jR(e.path,e.caseSensitive,e.end),p=n.match(o);if(!p)return null;let x=p[0],v=x.replace(/(.)\/+$/,"$1"),c=p.slice(1);return{params:u.reduce((A,B,R)=>{let{paramName:L,isOptional:$}=B;if(L==="*"){let Q=c[R]||"";v=x.slice(0,x.length-Q.length).replace(/(.)\/+$/,"$1")}const le=c[R];return $&&!le?A[L]=void 0:A[L]=(le||"").replace(/%2F/g,"/"),A},{}),pathname:x,pathnameBase:v,pattern:e}}function jR(e,n,o){n===void 0&&(n=!1),o===void 0&&(o=!0),fx(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let u=[],p="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(v,c,k)=>(u.push({paramName:c,isOptional:k!=null}),k?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(u.push({paramName:"*"}),p+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?p+="\\/*$":e!==""&&e!=="/"&&(p+="(?:(?=\\/|$))"),[new RegExp(p,n?void 0:"i"),u]}function VR(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return fx(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function GT(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let o=n.endsWith("/")?n.length-1:n.length,u=e.charAt(o);return u&&u!=="/"?null:e.slice(o)||"/"}const $R=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,UR=e=>$R.test(e);function qR(e,n){n===void 0&&(n="/");let{pathname:o,search:u="",hash:p=""}=typeof e=="string"?Ic(e):e,x;if(o)if(UR(o))x=o;else{if(o.includes("//")){let v=o;o=o.replace(/\/\/+/g,"/"),fx(!1,"Pathnames cannot have embedded double slashes - normalizing "+(v+" -> "+o))}o.startsWith("/")?x=Xb(o.substring(1),"/"):x=Xb(o,n)}else x=n;return{pathname:x,search:GR(u),hash:WR(p)}}function Xb(e,n){let o=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(p=>{p===".."?o.length>1&&o.pop():p!=="."&&o.push(p)}),o.length>1?o.join("/"):"/"}function Fy(e,n,o,u){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(u)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ZR(e){return e.filter((n,o)=>o===0||n.route.path&&n.route.path.length>0)}function WT(e,n){let o=ZR(e);return n?o.map((u,p)=>p===o.length-1?u.pathname:u.pathnameBase):o.map(u=>u.pathnameBase)}function XT(e,n,o,u){u===void 0&&(u=!1);let p;typeof e=="string"?p=Ic(e):(p=Id({},e),Wr(!p.pathname||!p.pathname.includes("?"),Fy("?","pathname","search",p)),Wr(!p.pathname||!p.pathname.includes("#"),Fy("#","pathname","hash",p)),Wr(!p.search||!p.search.includes("#"),Fy("#","search","hash",p)));let x=e===""||p.pathname==="",v=x?"/":p.pathname,c;if(v==null)c=o;else{let R=n.length-1;if(!u&&v.startsWith("..")){let L=v.split("/");for(;L[0]==="..";)L.shift(),R-=1;p.pathname=L.join("/")}c=R>=0?n[R]:"/"}let k=qR(p,c),A=v&&v!=="/"&&v.endsWith("/"),B=(x||v===".")&&o.endsWith("/");return!k.pathname.endsWith("/")&&(A||B)&&(k.pathname+="/"),k}const zl=e=>e.join("/").replace(/\/\/+/g,"/"),HR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),GR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,WR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function XR(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const KT=["post","put","patch","delete"];new Set(KT);const KR=["get",...KT];new Set(KR);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ad(){return Ad=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(e[u]=o[u])}return e},Ad.apply(this,arguments)}const px=X.createContext(null),YR=X.createContext(null),$d=X.createContext(null),jm=X.createContext(null),Ul=X.createContext({outlet:null,matches:[],isDataRoute:!1}),YT=X.createContext(null);function Ud(){return X.useContext(jm)!=null}function Vm(){return Ud()||Wr(!1),X.useContext(jm).location}function JT(e){X.useContext($d).static||X.useLayoutEffect(e)}function QT(){let{isDataRoute:e}=X.useContext(Ul);return e?cL():JR()}function JR(){Ud()||Wr(!1);let e=X.useContext(px),{basename:n,future:o,navigator:u}=X.useContext($d),{matches:p}=X.useContext(Ul),{pathname:x}=Vm(),v=JSON.stringify(WT(p,o.v7_relativeSplatPath)),c=X.useRef(!1);return JT(()=>{c.current=!0}),X.useCallback(function(A,B){if(B===void 0&&(B={}),!c.current)return;if(typeof A=="number"){u.go(A);return}let R=XT(A,JSON.parse(v),x,B.relative==="path");e==null&&n!=="/"&&(R.pathname=R.pathname==="/"?n:zl([n,R.pathname])),(B.replace?u.replace:u.push)(R,B.state,B)},[n,u,v,x,e])}function QR(e,n){return eL(e,n)}function eL(e,n,o,u){Ud()||Wr(!1);let{navigator:p}=X.useContext($d),{matches:x}=X.useContext(Ul),v=x[x.length-1],c=v?v.params:{};v&&v.pathname;let k=v?v.pathnameBase:"/";v&&v.route;let A=Vm(),B;if(n){var R;let se=typeof n=="string"?Ic(n):n;k==="/"||(R=se.pathname)!=null&&R.startsWith(k)||Wr(!1),B=se}else B=A;let L=B.pathname||"/",$=L;if(k!=="/"){let se=k.replace(/^\//,"").split("/");$="/"+L.replace(/^\//,"").split("/").slice(se.length).join("/")}let le=kR(e,{pathname:$}),Q=sL(le&&le.map(se=>Object.assign({},se,{params:Object.assign({},c,se.params),pathname:zl([k,p.encodeLocation?p.encodeLocation(se.pathname).pathname:se.pathname]),pathnameBase:se.pathnameBase==="/"?k:zl([k,p.encodeLocation?p.encodeLocation(se.pathnameBase).pathname:se.pathnameBase])})),x,o,u);return n&&Q?X.createElement(jm.Provider,{value:{location:Ad({pathname:"/",search:"",hash:"",state:null,key:"default"},B),navigationType:ka.Pop}},Q):Q}function tL(){let e=uL(),n=XR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,p={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},n),o?X.createElement("pre",{style:p},o):null,null)}const rL=X.createElement(tL,null);class nL extends X.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,o){return o.location!==n.location||o.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:o.error,location:o.location,revalidation:n.revalidation||o.revalidation}}componentDidCatch(n,o){console.error("React Router caught the following error during render",n,o)}render(){return this.state.error!==void 0?X.createElement(Ul.Provider,{value:this.props.routeContext},X.createElement(YT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iL(e){let{routeContext:n,match:o,children:u}=e,p=X.useContext(px);return p&&p.static&&p.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(p.staticContext._deepestRenderedBoundaryId=o.route.id),X.createElement(Ul.Provider,{value:n},u)}function sL(e,n,o,u){var p;if(n===void 0&&(n=[]),o===void 0&&(o=null),u===void 0&&(u=null),e==null){var x;if(!o)return null;if(o.errors)e=o.matches;else if((x=u)!=null&&x.v7_partialHydration&&n.length===0&&!o.initialized&&o.matches.length>0)e=o.matches;else return null}let v=e,c=(p=o)==null?void 0:p.errors;if(c!=null){let B=v.findIndex(R=>R.route.id&&(c==null?void 0:c[R.route.id])!==void 0);B>=0||Wr(!1),v=v.slice(0,Math.min(v.length,B+1))}let k=!1,A=-1;if(o&&u&&u.v7_partialHydration)for(let B=0;B<v.length;B++){let R=v[B];if((R.route.HydrateFallback||R.route.hydrateFallbackElement)&&(A=B),R.route.id){let{loaderData:L,errors:$}=o,le=R.route.loader&&L[R.route.id]===void 0&&(!$||$[R.route.id]===void 0);if(R.route.lazy||le){k=!0,A>=0?v=v.slice(0,A+1):v=[v[0]];break}}}return v.reduceRight((B,R,L)=>{let $,le=!1,Q=null,se=null;o&&($=c&&R.route.id?c[R.route.id]:void 0,Q=R.route.errorElement||rL,k&&(A<0&&L===0?(hL("route-fallback"),le=!0,se=null):A===L&&(le=!0,se=R.route.hydrateFallbackElement||null)));let W=n.concat(v.slice(0,L+1)),G=()=>{let K;return $?K=Q:le?K=se:R.route.Component?K=X.createElement(R.route.Component,null):R.route.element?K=R.route.element:K=B,X.createElement(iL,{match:R,routeContext:{outlet:B,matches:W,isDataRoute:o!=null},children:K})};return o&&(R.route.ErrorBoundary||R.route.errorElement||L===0)?X.createElement(nL,{location:o.location,revalidation:o.revalidation,component:Q,error:$,children:G(),routeContext:{outlet:null,matches:W,isDataRoute:!0}}):G()},null)}var eE=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(eE||{}),tE=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(tE||{});function oL(e){let n=X.useContext(px);return n||Wr(!1),n}function aL(e){let n=X.useContext(YR);return n||Wr(!1),n}function lL(e){let n=X.useContext(Ul);return n||Wr(!1),n}function rE(e){let n=lL(),o=n.matches[n.matches.length-1];return o.route.id||Wr(!1),o.route.id}function uL(){var e;let n=X.useContext(YT),o=aL(),u=rE();return n!==void 0?n:(e=o.errors)==null?void 0:e[u]}function cL(){let{router:e}=oL(eE.UseNavigateStable),n=rE(tE.UseNavigateStable),o=X.useRef(!1);return JT(()=>{o.current=!0}),X.useCallback(function(p,x){x===void 0&&(x={}),o.current&&(typeof p=="number"?e.navigate(p):e.navigate(p,Ad({fromRouteId:n},x)))},[e,n])}const Kb={};function hL(e,n,o){Kb[e]||(Kb[e]=!0)}function dL(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function fL(e){let{to:n,replace:o,state:u,relative:p}=e;Ud()||Wr(!1);let{future:x,static:v}=X.useContext($d),{matches:c}=X.useContext(Ul),{pathname:k}=Vm(),A=QT(),B=XT(n,WT(c,x.v7_relativeSplatPath),k,p==="path"),R=JSON.stringify(B);return X.useEffect(()=>A(JSON.parse(R),{replace:o,state:u,relative:p}),[A,R,p,o,u]),null}function Dp(e){Wr(!1)}function pL(e){let{basename:n="/",children:o=null,location:u,navigationType:p=ka.Pop,navigator:x,static:v=!1,future:c}=e;Ud()&&Wr(!1);let k=n.replace(/^\/*/,"/"),A=X.useMemo(()=>({basename:k,navigator:x,static:v,future:Ad({v7_relativeSplatPath:!1},c)}),[k,c,x,v]);typeof u=="string"&&(u=Ic(u));let{pathname:B="/",search:R="",hash:L="",state:$=null,key:le="default"}=u,Q=X.useMemo(()=>{let se=GT(B,k);return se==null?null:{location:{pathname:se,search:R,hash:L,state:$,key:le},navigationType:p}},[k,B,R,L,$,le,p]);return Q==null?null:X.createElement($d.Provider,{value:A},X.createElement(jm.Provider,{children:o,value:Q}))}function mL(e){let{children:n,location:o}=e;return QR(G_(n),o)}new Promise(()=>{});function G_(e,n){n===void 0&&(n=[]);let o=[];return X.Children.forEach(e,(u,p)=>{if(!X.isValidElement(u))return;let x=[...n,p];if(u.type===X.Fragment){o.push.apply(o,G_(u.props.children,x));return}u.type!==Dp&&Wr(!1),!u.props.index||!u.props.children||Wr(!1);let v={id:u.props.id||x.join("-"),caseSensitive:u.props.caseSensitive,element:u.props.element,Component:u.props.Component,index:u.props.index,path:u.props.path,loader:u.props.loader,action:u.props.action,errorElement:u.props.errorElement,ErrorBoundary:u.props.ErrorBoundary,hasErrorBoundary:u.props.ErrorBoundary!=null||u.props.errorElement!=null,shouldRevalidate:u.props.shouldRevalidate,handle:u.props.handle,lazy:u.props.lazy};u.props.children&&(v.children=G_(u.props.children,x)),o.push(v)}),o}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const gL="6";try{window.__reactRouterVersion=gL}catch{}const yL="startTransition",Yb=iv[yL];function _L(e){let{basename:n,children:o,future:u,window:p}=e,x=X.useRef();x.current==null&&(x.current=TR({window:p,v5Compat:!0}));let v=x.current,[c,k]=X.useState({action:v.action,location:v.location}),{v7_startTransition:A}=u||{},B=X.useCallback(R=>{A&&Yb?Yb(()=>k(R)):k(R)},[k,A]);return X.useLayoutEffect(()=>v.listen(B),[v,B]),X.useEffect(()=>dL(u),[u]),X.createElement(pL,{basename:n,children:o,location:c.location,navigationType:c.action,navigator:v,future:u})}var Jb;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Jb||(Jb={}));var Qb;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Qb||(Qb={}));const nE=X.createContext(null);function vL({children:e}){const[n,o]=X.useState(()=>localStorage.getItem("auth_token")),[u,p]=X.useState(()=>{const c=localStorage.getItem("user_email");return c?{email:c}:null}),x=(c,k)=>{localStorage.setItem("auth_token",c),localStorage.setItem("user_email",k),o(c),p({email:k})},v=()=>{localStorage.removeItem("auth_token"),localStorage.removeItem("user_email"),o(null),p(null)};return ee.jsx(nE.Provider,{value:{isAuthenticated:!!n,token:n,user:u,login:x,logout:v},children:e})}function Za(){const e=X.useContext(nE);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}const xL=[{id:"overview",label:"Overview",icon:VA},{id:"users",label:"Users",icon:L_},{id:"dogs",label:"Dogs",icon:D_},{id:"trails",label:"Trails",icon:R_},{id:"map",label:"Map",icon:tx}];function wL({activeView:e,onViewChange:n}){const{logout:o,user:u}=Za();return ee.jsxs("aside",{className:"w-64 h-screen bg-sidebar border-r border-sidebar-border flex flex-col",children:[ee.jsx("div",{className:"p-6 border-b border-sidebar-border",children:ee.jsxs("div",{className:"flex items-center gap-3",children:[ee.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:ee.jsx("span",{className:"text-primary font-bold text-lg",children:"TT"})}),ee.jsxs("div",{children:[ee.jsx("h1",{className:"font-semibold text-foreground",children:"TailTrails"}),ee.jsx("p",{className:"text-xs text-muted-foreground",children:"Admin Panel"})]})]})}),ee.jsx("nav",{className:"flex-1 p-4 space-y-1",children:xL.map(p=>{const x=p.icon,v=e===p.id;return ee.jsxs("button",{onClick:()=>n(p.id),className:nn("w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200",v?"bg-primary/20 text-primary":"text-sidebar-foreground hover:bg-sidebar-accent/50 hover:text-sidebar-accent-foreground"),children:[ee.jsx(x,{className:"w-4 h-4"}),ee.jsx("span",{children:p.label})]},p.id)})}),ee.jsxs("div",{className:"p-4 border-t border-sidebar-border space-y-3",children:[u&&ee.jsxs("div",{className:"px-3 py-2 bg-secondary/50 rounded-lg",children:[ee.jsx("p",{className:"text-xs text-muted-foreground",children:"Signed in as"}),ee.jsx("p",{className:"text-sm font-medium truncate",children:u.email})]}),ee.jsxs("button",{onClick:o,className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-destructive hover:bg-destructive/10 transition-colors",children:[ee.jsx(UA,{className:"w-4 h-4"}),ee.jsx("span",{children:"Sign Out"})]})]})]})}const qd="https://tt-api-340847553966.europe-west1.run.app";async function bL(e){try{const n=await fetch(`${qd}/otp/request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});return n.ok?{success:!0}:{success:!1,error:(await n.json()).detail||"Failed to send OTP"}}catch{return{success:!1,error:"Network error"}}}async function SL(e,n){try{const o=await fetch(`${qd}/otp/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otpCode:n})});if(!o.ok)return{success:!1,error:(await o.json()).detail||"Invalid OTP"};const u=await o.json(),p=u.accessToken??u.access_token??u.access_token_hack??u.token??null;if(p)try{localStorage.setItem("access_token",p)}catch{}return{success:!0,token:p??void 0}}catch{return{success:!1,error:"Network error"}}}function mx(){try{return localStorage.getItem("access_token")}catch{return null}}async function Dl(e,n){try{const o=n??mx(),u={"Content-Type":"application/json"};o&&(u.Authorization=`Bearer ${o}`);const p=await fetch(`${qd}${e}`,{headers:u});return p.ok?{data:await p.json()}:p.status===401?{error:"Unauthorized"}:{error:(await p.json()).detail||"Failed to fetch data"}}catch{return{error:"Network error"}}}async function gx(e,n,o){try{const u=o??mx(),p={"Content-Type":"application/json"};u&&(p.Authorization=`Bearer ${u}`);const x=await fetch(`${qd}${e}`,{method:"PUT",headers:p,body:JSON.stringify(n)});return x.ok?{data:await x.json()}:{error:(await x.json()).detail||"Failed to update"}}catch{return{error:"Network error"}}}async function yx(e,n){try{const o=n??mx(),u={};o&&(u.Authorization=`Bearer ${o}`);const p=await fetch(`${qd}${e}`,{method:"DELETE",headers:u});return p.ok?{success:!0}:{success:!1,error:(await p.json()).detail||"Failed to delete"}}catch{return{success:!1,error:"Network error"}}}function e1({onViewChange:e}){const{token:n}=Za(),[o,u]=X.useState({users:0,dogs:0,trails:0}),[p,x]=X.useState(!0);X.useEffect(()=>{async function c(){if(!n)return;x(!0);const[k,A,B]=await Promise.all([Dl("/admin/users",n),Dl("/admin/dogs",n),Dl("/admin/trails",n)]);u({users:Array.isArray(k.data)?k.data.length:0,dogs:Array.isArray(A.data)?A.data.length:0,trails:Array.isArray(B.data)?B.data.length:0}),x(!1)}c()},[n]);const v=[{label:"Total Users",value:o.users,icon:L_,color:"text-info"},{label:"Registered Dogs",value:o.dogs,icon:D_,color:"text-warning"},{label:"Trails Created",value:o.trails,icon:R_,color:"text-success"}];return p?ee.jsx("div",{className:"flex items-center justify-center py-24",children:ee.jsx(Nl,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):ee.jsxs("div",{className:"space-y-6 animate-fade-in",children:[ee.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:v.map(c=>{const k=c.icon;return ee.jsx("div",{className:"glass-panel rounded-xl p-6",children:ee.jsxs("div",{className:"flex items-center gap-4",children:[ee.jsx("div",{className:`p-3 rounded-lg bg-secondary ${c.color}`,children:ee.jsx(k,{className:"w-6 h-6"})}),ee.jsxs("div",{children:[ee.jsx("p",{className:"text-3xl font-bold",children:c.value}),ee.jsx("p",{className:"text-sm text-muted-foreground",children:c.label})]})]})},c.label)})}),ee.jsxs("div",{className:"glass-panel rounded-xl p-6",children:[ee.jsx("h3",{className:"font-semibold mb-4",children:"Quick Actions"}),ee.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[ee.jsx(yp,{icon:L_,label:"View Users",onClick:()=>e==null?void 0:e("users")}),ee.jsx(yp,{icon:D_,label:"View Dogs",onClick:()=>e==null?void 0:e("dogs")}),ee.jsx(yp,{icon:R_,label:"View Trails",onClick:()=>e==null?void 0:e("trails")}),ee.jsx(yp,{icon:tx,label:"Open Map",onClick:()=>e==null?void 0:e("map")})]})]})]})}function yp({icon:e,label:n,onClick:o}){return ee.jsxs("button",{onClick:o,className:"flex items-center gap-2 p-3 bg-secondary/50 rounded-lg hover:bg-secondary transition-colors text-sm",children:[ee.jsx(e,{className:"w-4 h-4 text-primary"}),ee.jsx("span",{children:n})]})}const iE=X.forwardRef(({className:e,...n},o)=>ee.jsx("div",{className:"relative w-full overflow-auto",children:ee.jsx("table",{ref:o,className:nn("w-full caption-bottom text-sm",e),...n})}));iE.displayName="Table";const sE=X.forwardRef(({className:e,...n},o)=>ee.jsx("thead",{ref:o,className:nn("[&_tr]:border-b",e),...n}));sE.displayName="TableHeader";const oE=X.forwardRef(({className:e,...n},o)=>ee.jsx("tbody",{ref:o,className:nn("[&_tr:last-child]:border-0",e),...n}));oE.displayName="TableBody";const TL=X.forwardRef(({className:e,...n},o)=>ee.jsx("tfoot",{ref:o,className:nn("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...n}));TL.displayName="TableFooter";const W_=X.forwardRef(({className:e,...n},o)=>ee.jsx("tr",{ref:o,className:nn("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...n}));W_.displayName="TableRow";const X_=X.forwardRef(({className:e,...n},o)=>ee.jsx("th",{ref:o,className:nn("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...n}));X_.displayName="TableHead";const K_=X.forwardRef(({className:e,...n},o)=>ee.jsx("td",{ref:o,className:nn("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...n}));K_.displayName="TableCell";const EL=X.forwardRef(({className:e,...n},o)=>ee.jsx("caption",{ref:o,className:nn("mt-4 text-sm text-muted-foreground",e),...n}));EL.displayName="TableCaption";var CL=Symbol.for("react.lazy"),um=iv[" use ".trim().toString()];function kL(e){return typeof e=="object"&&e!==null&&"then"in e}function aE(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===CL&&"_payload"in e&&kL(e._payload)}function lE(e){const n=IL(e),o=X.forwardRef((u,p)=>{let{children:x,...v}=u;aE(x)&&typeof um=="function"&&(x=um(x._payload));const c=X.Children.toArray(x),k=c.find(ML);if(k){const A=k.props.children,B=c.map(R=>R===k?X.Children.count(A)>1?X.Children.only(null):X.isValidElement(A)?A.props.children:null:R);return ee.jsx(n,{...v,ref:p,children:X.isValidElement(A)?X.cloneElement(A,void 0,B):null})}return ee.jsx(n,{...v,ref:p,children:x})});return o.displayName=`${e}.Slot`,o}var PL=lE("Slot");function IL(e){const n=X.forwardRef((o,u)=>{let{children:p,...x}=o;if(aE(p)&&typeof um=="function"&&(p=um(p._payload)),X.isValidElement(p)){const v=DL(p),c=zL(x,p.props);return p.type!==X.Fragment&&(c.ref=u?km(u,v):v),X.cloneElement(p,c)}return X.Children.count(p)>1?X.Children.only(null):null});return n.displayName=`${e}.SlotClone`,n}var AL=Symbol("radix.slottable");function ML(e){return X.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===AL}function zL(e,n){const o={...n};for(const u in n){const p=e[u],x=n[u];/^on[A-Z]/.test(u)?p&&x?o[u]=(...c)=>{const k=x(...c);return p(...c),k}:p&&(o[u]=p):u==="style"?o[u]={...p,...x}:u==="className"&&(o[u]=[p,x].filter(Boolean).join(" "))}return{...e,...o}}function DL(e){var u,p;let n=(u=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:u.get,o=n&&"isReactWarning"in n&&n.isReactWarning;return o?e.ref:(n=(p=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:p.get,o=n&&"isReactWarning"in n&&n.isReactWarning,o?e.props.ref:e.props.ref||e.ref)}const RL=ex("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 hover:shadow-glow",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Es=X.forwardRef(({className:e,variant:n,size:o,asChild:u=!1,...p},x)=>{const v=u?PL:"button";return ee.jsx(v,{className:nn(RL({variant:n,size:o,className:e})),ref:x,...p})});Es.displayName="Button";const cm=X.forwardRef(({className:e,type:n,...o},u)=>ee.jsx("input",{type:n,className:nn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:u,...o}));cm.displayName="Input";function _x({data:e,columns:n,idKey:o,isLoading:u,onUpdate:p,onDelete:x}){const[v,c]=X.useState(null),[k,A]=X.useState({}),[B,R]=X.useState(!1),L=se=>{c(String(se[o])),A(se)},$=async()=>{!v||!p||(R(!0),await p(v,k),R(!1),c(null),A({}))},le=()=>{c(null),A({})},Q=async se=>{x&&confirm("Are you sure you want to delete this item?")&&await x(se)};return u?ee.jsx("div",{className:"flex items-center justify-center py-12",children:ee.jsx(Nl,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):e.length===0?ee.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No data available"}):ee.jsx("div",{className:"border border-border rounded-lg overflow-hidden",children:ee.jsxs(iE,{children:[ee.jsx(sE,{children:ee.jsxs(W_,{className:"bg-secondary/50",children:[n.map(se=>ee.jsx(X_,{className:"font-semibold",children:se.label},String(se.key))),(p||x)&&ee.jsx(X_,{className:"w-24",children:"Actions"})]})}),ee.jsx(oE,{children:e.map(se=>{const W=String(se[o]),G=v===W;return ee.jsxs(W_,{className:"hover:bg-secondary/30",children:[n.map(K=>ee.jsx(K_,{children:G&&K.editable?ee.jsx(cm,{value:String(k[K.key]??""),onChange:he=>A({...k,[K.key]:he.target.value}),className:"h-8 text-sm"}):ee.jsx("span",{className:"text-sm",children:LL(se[K.key])})},String(K.key))),(p||x)&&ee.jsx(K_,{children:ee.jsx("div",{className:"flex items-center gap-1",children:G?ee.jsxs(ee.Fragment,{children:[ee.jsx(Es,{size:"icon",variant:"ghost",onClick:$,disabled:B,className:"h-8 w-8 text-success hover:text-success",children:B?ee.jsx(Nl,{className:"w-4 h-4 animate-spin"}):ee.jsx(jA,{className:"w-4 h-4"})}),ee.jsx(Es,{size:"icon",variant:"ghost",onClick:le,className:"h-8 w-8",children:ee.jsx(YS,{className:"w-4 h-4"})})]}):ee.jsxs(ee.Fragment,{children:[p&&ee.jsx(Es,{size:"icon",variant:"ghost",onClick:()=>L(se),className:"h-8 w-8",children:ee.jsx(ZA,{className:"w-4 h-4"})}),x&&ee.jsx(Es,{size:"icon",variant:"ghost",onClick:()=>Q(W),className:"h-8 w-8 text-destructive hover:text-destructive",children:ee.jsx(HA,{className:"w-4 h-4"})})]})})})]},W)})})]})})}function LL(e){return e==null?"-":typeof e=="boolean"?e?"Yes":"No":typeof e=="object"?JSON.stringify(e):typeof e=="string"&&e.match(/^\d{4}-\d{2}-\d{2}/)?new Date(e).toLocaleDateString():String(e)}function FL(){const{token:e}=Za(),[n,o]=X.useState([]),[u,p]=X.useState(!0),x=async()=>{if(!e)return;p(!0);const A=await Dl("/admin/users",e);A.data?o(A.data):A.error&&Br.error(A.error),p(!1)};X.useEffect(()=>{x()},[e]);const v=async(A,B)=>{if(!e)return;const R=await gx(`/admin/users/${A}`,B,e);R.error?Br.error(R.error):(Br.success("User updated"),x())},c=async A=>{if(!e)return;const B=await yx(`/admin/users/${A}`,e);B.error?Br.error(B.error):(Br.success("User deleted"),x())},k=[{key:"id",label:"ID"},{key:"email",label:"Email",editable:!0},{key:"created_at",label:"Created"}];return ee.jsxs("div",{className:"space-y-4 animate-fade-in",children:[ee.jsxs("div",{className:"flex items-center justify-between",children:[ee.jsxs("div",{children:[ee.jsx("h2",{className:"text-lg font-semibold",children:"Users"}),ee.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.length," total users"]})]}),ee.jsxs(Es,{variant:"secondary",size:"sm",onClick:x,children:[ee.jsx(Mm,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),ee.jsx(_x,{data:n,columns:k,idKey:"id",isLoading:u,onUpdate:v,onDelete:c})]})}function OL(){const{token:e}=Za(),[n,o]=X.useState([]),[u,p]=X.useState(!0),x=async()=>{if(!e)return;p(!0);const A=await Dl("/admin/dogs",e);A.data?o(A.data):A.error&&Br.error(A.error),p(!1)};X.useEffect(()=>{x()},[e]);const v=async(A,B)=>{if(!e)return;const R=await gx(`/admin/dogs/${A}`,B,e);R.error?Br.error(R.error):(Br.success("Dog updated"),x())},c=async A=>{if(!e)return;const B=await yx(`/admin/dogs/${A}`,e);B.error?Br.error(B.error):(Br.success("Dog deleted"),x())},k=[{key:"id",label:"ID"},{key:"name",label:"Name",editable:!0},{key:"breed",label:"Breed",editable:!0},{key:"owner_id",label:"Owner ID"},{key:"created_at",label:"Created"}];return ee.jsxs("div",{className:"space-y-4 animate-fade-in",children:[ee.jsxs("div",{className:"flex items-center justify-between",children:[ee.jsxs("div",{children:[ee.jsx("h2",{className:"text-lg font-semibold",children:"Dogs"}),ee.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.length," registered dogs"]})]}),ee.jsxs(Es,{variant:"secondary",size:"sm",onClick:x,children:[ee.jsx(Mm,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),ee.jsx(_x,{data:n,columns:k,idKey:"id",isLoading:u,onUpdate:v,onDelete:c})]})}function BL(){const{token:e}=Za(),[n,o]=X.useState([]),[u,p]=X.useState(!0),x=async()=>{if(!e)return;p(!0);const A=await Dl("/admin/trails",e);A.data?o(A.data):A.error&&Br.error(A.error),p(!1)};X.useEffect(()=>{x()},[e]);const v=async(A,B)=>{if(!e)return;const R=await gx(`/admin/trails/${A}`,B,e);R.error?Br.error(R.error):(Br.success("Trail updated"),x())},c=async A=>{if(!e)return;const B=await yx(`/admin/trails/${A}`,e);B.error?Br.error(B.error):(Br.success("Trail deleted"),x())},k=[{key:"id",label:"ID"},{key:"name",label:"Name",editable:!0},{key:"distance",label:"Distance (m)"},{key:"duration",label:"Duration (s)"},{key:"user_id",label:"User ID"},{key:"created_at",label:"Created"}];return ee.jsxs("div",{className:"space-y-4 animate-fade-in",children:[ee.jsxs("div",{className:"flex items-center justify-between",children:[ee.jsxs("div",{children:[ee.jsx("h2",{className:"text-lg font-semibold",children:"Trails"}),ee.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.length," trails recorded"]})]}),ee.jsxs(Es,{variant:"secondary",size:"sm",onClick:x,children:[ee.jsx(Mm,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),ee.jsx(_x,{data:n,columns:k,idKey:"id",isLoading:u,onUpdate:v,onDelete:c})]})}var uE={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,n){(function(o,u){e.exports=u()})(ok,function(){var o={},u={};function p(v,c,k){if(u[v]=k,v==="index"){var A="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",B={};return u.shared(B),u.index(o,B),typeof window<"u"&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([A],{type:"text/javascript"}))),o}}p("shared",["exports"],function(v){function c(i,r,s,l){return new(s||(s=Promise))(function(f,y){function _(C){try{S(l.next(C))}catch(P){y(P)}}function w(C){try{S(l.throw(C))}catch(P){y(P)}}function S(C){var P;C.done?f(C.value):(P=C.value,P instanceof s?P:new s(function(M){M(P)})).then(_,w)}S((l=l.apply(i,r||[])).next())})}function k(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var A=B;function B(i,r){this.x=i,this.y=r}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,r){return this.clone()._rotateAround(i,r)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var r=i.x-this.x,s=i.y-this.y;return r*r+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,r){return Math.atan2(this.x*r-this.y*i,this.x*i+this.y*r)},_matMult:function(i){var r=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=r,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var r=Math.cos(i),s=Math.sin(i),l=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=l,this},_rotateAround:function(i,r){var s=Math.cos(i),l=Math.sin(i),f=r.y+l*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-l*(this.y-r.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(i){return i instanceof B?i:Array.isArray(i)?new B(i[0],i[1]):i};var R=k(A),L=$;function $(i,r,s,l){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(l-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=s,this.p2y=l}$.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,r){if(r===void 0&&(r=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,l=0;l<8;l++){var f=this.sampleCurveX(s)-i;if(Math.abs(f)<r)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=f/y}var _=0,w=1;for(s=i,l=0;l<20&&(f=this.sampleCurveX(s),!(Math.abs(f-i)<r));l++)i>f?_=s:w=s,s=.5*(w-_)+_;return s},solve:function(i,r){return this.sampleCurveY(this.solveCurveX(i,r))}};var le=k(L);let Q,se;function W(){return Q==null&&(Q=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Q}function G(){if(se==null&&(se=!1,W())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let l=0;l<5*5;l++){const f=4*l;r.fillStyle=`rgb(${f},${f+1},${f+2})`,r.fillRect(l%5,Math.floor(l/5),1,1)}const s=r.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&s[l]!==l){se=!0;break}}}return se||!1}function K(i,r,s,l){const f=new le(i,r,s,l);return y=>f.solve(y)}const he=K(.25,.1,.25,1);function be(i,r,s){return Math.min(s,Math.max(r,i))}function ke(i,r,s){const l=s-r,f=((i-r)%l+l)%l+r;return f===r?s:f}function Pe(i,...r){for(const s of r)for(const l in s)i[l]=s[l];return i}let Fe=1;function st(i,r,s){const l={};for(const f in i)l[f]=r.call(this,i[f],f,i);return l}function Be(i,r,s){const l={};for(const f in i)r.call(this,i[f],f,i)&&(l[f]=i[f]);return l}function qe(i){return Array.isArray(i)?i.map(qe):typeof i=="object"&&i?st(i,qe):i}const ot={};function xt(i){ot[i]||(typeof console<"u"&&console.warn(i),ot[i]=!0)}function He(i,r,s){return(s.y-i.y)*(r.x-i.x)>(r.y-i.y)*(s.x-i.x)}function It(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let bt=null;function wt(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Re(i,r,s,l,f){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(i,{timestamp:0});try{const _=y==null?void 0:y.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const w=_.startsWith("BGR"),S=new Uint8ClampedArray(l*f*4);if(yield y.copyTo(S,function(C,P,M,O,j){const U=4*Math.max(-P,0),Z=(Math.max(0,M)-M)*O*4+U,re=4*O,oe=Math.max(0,P),xe=Math.max(0,M);return{rect:{x:oe,y:xe,width:Math.min(C.width,P+O)-oe,height:Math.min(C.height,M+j)-xe},layout:[{offset:Z,stride:re}]}}(i,r,s,l,f)),w)for(let C=0;C<S.length;C+=4){const P=S[C];S[C]=S[C+2],S[C+2]=P}return S}finally{y.close()}})}let et,yt;const dt="AbortError";function Mt(){return new Error(dt)}const At={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Yt(i){return At.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const gr="global-dispatcher";class zt extends Error{constructor(r,s,l,f){super(`AJAXError: ${s} (${r}): ${l}`),this.status=r,this.statusText=s,this.url=l,this.body=f}}const Vr=()=>It(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,sn=function(i,r){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const l=Yt(i.url);if(l)return l(i,r);if(It(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:gr},r)}if(!(/^file:/.test(s=i.url)||/^file:/.test(Vr())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,f){return c(this,void 0,void 0,function*(){const y=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Vr(),signal:f.signal});l.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const _=yield fetch(y);if(!_.ok){const C=yield _.blob();throw new zt(_.status,_.statusText,l.url,C)}let w;w=l.type==="arrayBuffer"||l.type==="image"?_.arrayBuffer():l.type==="json"?_.json():_.text();const S=yield w;if(f.signal.aborted)throw Mt();return{data:S,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(i,r);if(It(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:gr},r)}var s;return function(l,f){return new Promise((y,_)=>{var w;const S=new XMLHttpRequest;S.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(S.responseType="arraybuffer");for(const C in l.headers)S.setRequestHeader(C,l.headers[C]);l.type==="json"&&(S.responseType="text",!((w=l.headers)===null||w===void 0)&&w.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=l.credentials==="include",S.onerror=()=>{_(new Error(S.statusText))},S.onload=()=>{if(!f.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let C=S.response;if(l.type==="json")try{C=JSON.parse(S.response)}catch(P){return void _(P)}y({data:C,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const C=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});_(new zt(S.status,S.statusText,l.url,C))}},f.signal.addEventListener("abort",()=>{S.abort(),_(Mt())}),S.send(l.body)})}(i,r)};function _n(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const r=new URL(i),s=window.location;return r.protocol===s.protocol&&r.host===s.host}function kn(i,r,s){s[i]&&s[i].indexOf(r)!==-1||(s[i]=s[i]||[],s[i].push(r))}function on(i,r,s){if(s&&s[i]){const l=s[i].indexOf(r);l!==-1&&s[i].splice(l,1)}}class Xr{constructor(r,s={}){Pe(this,s),this.type=r}}class Un extends Xr{constructor(r,s={}){super("error",Pe({error:r},s))}}class Yi{on(r,s){return this._listeners=this._listeners||{},kn(r,s,this._listeners),this}off(r,s){return on(r,s,this._listeners),on(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},kn(r,s,this._oneTimeListeners),this):new Promise(l=>this.once(r,l))}fire(r,s){typeof r=="string"&&(r=new Xr(r,s||{}));const l=r.type;if(this.listens(l)){r.target=this;const f=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const w of f)w.call(this,r);const y=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const w of y)on(l,w,this._oneTimeListeners),w.call(this,r);const _=this._eventedParent;_&&(Pe(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(r))}else r instanceof Un&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}var Te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ci=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ki(i,r){const s={};for(const l in i)l!=="ref"&&(s[l]=i[l]);return Ci.forEach(l=>{l in r&&(s[l]=r[l])}),s}function Ot(i,r){if(Array.isArray(i)){if(!Array.isArray(r)||i.length!==r.length)return!1;for(let s=0;s<i.length;s++)if(!Ot(i[s],r[s]))return!1;return!0}if(typeof i=="object"&&i!==null&&r!==null){if(typeof r!="object"||Object.keys(i).length!==Object.keys(r).length)return!1;for(const s in i)if(!Ot(i[s],r[s]))return!1;return!0}return i===r}function lr(i,r){i.push(r)}function Pi(i,r,s){lr(s,{command:"addSource",args:[i,r[i]]})}function Ii(i,r,s){lr(r,{command:"removeSource",args:[i]}),s[i]=!0}function Kr(i,r,s,l){Ii(i,s,l),Pi(i,r,s)}function zs(i,r,s){let l;for(l in i[s])if(Object.prototype.hasOwnProperty.call(i[s],l)&&l!=="data"&&!Ot(i[s][l],r[s][l]))return!1;for(l in r[s])if(Object.prototype.hasOwnProperty.call(r[s],l)&&l!=="data"&&!Ot(i[s][l],r[s][l]))return!1;return!0}function Pn(i,r,s,l,f,y){i=i||{},r=r||{};for(const _ in i)Object.prototype.hasOwnProperty.call(i,_)&&(Ot(i[_],r[_])||s.push({command:y,args:[l,_,r[_],f]}));for(const _ in r)Object.prototype.hasOwnProperty.call(r,_)&&!Object.prototype.hasOwnProperty.call(i,_)&&(Ot(i[_],r[_])||s.push({command:y,args:[l,_,r[_],f]}))}function $r(i){return i.id}function ai(i,r){return i[r.id]=r,i}class Ne{constructor(r,s,l,f){this.message=(r?`${r}: `:"")+l,f&&(this.identifier=f),s!=null&&s.__line__&&(this.line=s.__line__)}}function li(i,...r){for(const s of r)for(const l in s)i[l]=s[l];return i}class zr extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class ui{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[l,f]of s)this.bindings[l]=f}concat(r){return new ui(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Ai={kind:"null"},je={kind:"number"},Ct={kind:"string"},vt={kind:"boolean"},Cr={kind:"color"},qn={kind:"object"},kt={kind:"value"},Zn={kind:"collator"},ci={kind:"formatted"},Ji={kind:"padding"},In={kind:"resolvedImage"},ie={kind:"variableAnchorOffsetCollection"};function N(i,r){return{kind:"array",itemType:i,N:r}}function F(i){if(i.kind==="array"){const r=F(i.itemType);return typeof i.N=="number"?`array<${r}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${r}>`}return i.kind}const q=[Ai,je,Ct,vt,Cr,ci,qn,N(kt),Ji,In,ie];function J(i,r){if(r.kind==="error")return null;if(i.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!J(i.itemType,r.itemType))&&(typeof i.N!="number"||i.N===r.N))return null}else{if(i.kind===r.kind)return null;if(i.kind==="value"){for(const s of q)if(!J(s,r))return null}}return`Expected ${F(i)} but found ${F(r)} instead.`}function de(i,r){return r.some(s=>s.kind===i.kind)}function me(i,r){return r.some(s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i)}function ye(i,r){return i.kind==="array"&&r.kind==="array"?i.itemType.kind===r.itemType.kind&&typeof i.N=="number":i.kind===r.kind}const ue=.96422,Se=.82521,Ae=4/29,Ee=6/29,$e=3*Ee*Ee,ft=Ee*Ee*Ee,mt=Math.PI/180,Ut=180/Math.PI;function Pt(i){return(i%=360)<0&&(i+=360),i}function qt([i,r,s,l]){let f,y;const _=Dr((.2225045*(i=Bt(i))+.7168786*(r=Bt(r))+.0606169*(s=Bt(s)))/1);i===r&&r===s?f=y=_:(f=Dr((.4360747*i+.3850649*r+.1430804*s)/ue),y=Dr((.0139322*i+.0971045*r+.7141733*s)/Se));const w=116*_-16;return[w<0?0:w,500*(f-_),200*(_-y),l]}function Bt(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Dr(i){return i>ft?Math.pow(i,1/3):i/$e+Ae}function yr([i,r,s,l]){let f=(i+16)/116,y=isNaN(r)?f:f+r/500,_=isNaN(s)?f:f-s/200;return f=1*Qt(f),y=ue*Qt(y),_=Se*Qt(_),[Lt(3.1338561*y-1.6168667*f-.4906146*_),Lt(-.9787684*y+1.9161415*f+.033454*_),Lt(.0719453*y-.2289914*f+1.4052427*_),l]}function Lt(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Qt(i){return i>Ee?i*i*i:$e*(i-Ae)}function pr(i){return parseInt(i.padEnd(2,i),16)/255}function Ur(i,r){return Yr(r?i/100:i,0,1)}function Yr(i,r,s){return Math.min(Math.max(r,i),s)}function vn(i){return!i.some(Number.isNaN)}const zo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class er{constructor(r,s,l,f=1,y=!0){this.r=r,this.g=s,this.b=l,this.a=f,y||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[r,s,l,f]))}static parse(r){if(r instanceof er)return r;if(typeof r!="string")return;const s=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=zo[l];if(f){const[_,w,S]=f;return[_/255,w/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const _=l.length<6?1:2;let w=1;return[pr(l.slice(w,w+=_)),pr(l.slice(w,w+=_)),pr(l.slice(w,w+=_)),pr(l.slice(w,w+_)||"ff")]}if(l.startsWith("rgb")){const _=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[w,S,C,P,M,O,j,U,Z,re,oe,xe]=_,pe=[P||" ",j||" ",re].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const ve=[C,O,Z].join(""),Ce=ve==="%%%"?100:ve===""?255:0;if(Ce){const Le=[Yr(+S/Ce,0,1),Yr(+M/Ce,0,1),Yr(+U/Ce,0,1),oe?Ur(+oe,xe):1];if(vn(Le))return Le}}return}}const y=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[_,w,S,C,P,M,O,j,U]=y,Z=[S||" ",P||" ",O].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const re=[+w,Yr(+C,0,100),Yr(+M,0,100),j?Ur(+j,U):1];if(vn(re))return function([oe,xe,pe,ve]){function Ce(Le){const Qe=(Le+oe/30)%12,gt=xe*Math.min(pe,1-pe);return pe-gt*Math.max(-1,Math.min(Qe-3,9-Qe,1))}return oe=Pt(oe),xe/=100,pe/=100,[Ce(0),Ce(8),Ce(4),ve]}(re)}}}(r);return s?new er(...s,!1):void 0}get rgb(){const{r,g:s,b:l,a:f}=this,y=f||1/0;return this.overwriteGetter("rgb",[r/y,s/y,l/y,f])}get hcl(){return this.overwriteGetter("hcl",function(r){const[s,l,f,y]=qt(r),_=Math.sqrt(l*l+f*f);return[Math.round(1e4*_)?Pt(Math.atan2(f,l)*Ut):NaN,_,s,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",qt(this.rgb))}overwriteGetter(r,s){return Object.defineProperty(this,r,{value:s}),s}toString(){const[r,s,l,f]=this.rgb;return`rgba(${[r,s,l].map(y=>Math.round(255*y)).join(",")},${f})`}}er.black=new er(0,0,0,1),er.white=new er(1,1,1,1),er.transparent=new er(0,0,0,0),er.red=new er(1,0,0,1);class Ac{constructor(r,s,l){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Mc{constructor(r,s,l,f,y){this.text=r,this.image=s,this.scale=l,this.fontStack=f,this.textColor=y}}class Hn{constructor(r){this.sections=r}static fromString(r){return new Hn([new Mc(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof Hn?r:Hn.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Gn{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Gn)return r;if(typeof r=="number")return new Gn([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const s of r)if(typeof s!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Gn(r)}}toString(){return JSON.stringify(this.values)}}const $m=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class hi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof hi)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let s=0;s<r.length;s+=2){const l=r[s],f=r[s+1];if(typeof l!="string"||!$m.has(l)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new hi(r)}}toString(){return JSON.stringify(this.values)}}class Wn{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Wn({name:r,available:!1}):null}}function Do(i,r,s,l){return typeof i=="number"&&i>=0&&i<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,r,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,r,s,l]:[i,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qs(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof er||i instanceof Ac||i instanceof Hn||i instanceof Gn||i instanceof hi||i instanceof Wn)return!0;if(Array.isArray(i)){for(const r of i)if(!Qs(r))return!1;return!0}if(typeof i=="object"){for(const r in i)if(!Qs(i[r]))return!1;return!0}return!1}function Rr(i){if(i===null)return Ai;if(typeof i=="string")return Ct;if(typeof i=="boolean")return vt;if(typeof i=="number")return je;if(i instanceof er)return Cr;if(i instanceof Ac)return Zn;if(i instanceof Hn)return ci;if(i instanceof Gn)return Ji;if(i instanceof hi)return ie;if(i instanceof Wn)return In;if(Array.isArray(i)){const r=i.length;let s;for(const l of i){const f=Rr(l);if(s){if(s===f)continue;s=kt;break}s=f}return N(s||kt,r)}return qn}function Ha(i){const r=typeof i;return i===null?"":r==="string"||r==="number"||r==="boolean"?String(i):i instanceof er||i instanceof Hn||i instanceof Gn||i instanceof hi||i instanceof Wn?i.toString():JSON.stringify(i)}class Mi{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Qs(r[1]))return s.error("invalid value");const l=r[1];let f=Rr(l);const y=s.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new Mi(f,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class kr{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const ql={string:Ct,number:je,boolean:vt,object:qn};class zi{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let l,f=1;const y=r[0];if(y==="array"){let w,S;if(r.length>2){const C=r[1];if(typeof C!="string"||!(C in ql)||C==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);w=ql[C],f++}else w=kt;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=r[2],f++}l=N(w,S)}else{if(!ql[y])throw new Error(`Types doesn't contain name = ${y}`);l=ql[y]}const _=[];for(;f<r.length;f++){const w=s.parse(r[f],f,kt);if(!w)return null;_.push(w)}return new zi(l,_)}evaluate(r){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(r);if(!J(this.type,Rr(l)))return l;if(s===this.args.length-1)throw new kr(`Expected value to be of type ${F(this.type)}, but found ${F(Rr(l))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const zc={"to-boolean":vt,"to-color":Cr,"to-number":je,"to-string":Ct};class Di{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const l=r[0];if(!zc[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&r.length!==2)return s.error("Expected one argument.");const f=zc[l],y=[];for(let _=1;_<r.length;_++){const w=s.parse(r[_],_,kt);if(!w)return null;y.push(w)}return new Di(f,y)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let s,l;for(const f of this.args){if(s=f.evaluate(r),l=null,s instanceof er)return s;if(typeof s=="string"){const y=r.parseColor(s);if(y)return y}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Do(s[0],s[1],s[2],s[3]),!l))return new er(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new kr(l||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const l of this.args){s=l.evaluate(r);const f=Gn.parse(s);if(f)return f}throw new kr(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const l of this.args){s=l.evaluate(r);const f=hi.parse(s);if(f)return f}throw new kr(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const l of this.args){if(s=l.evaluate(r),s===null)return 0;const f=Number(s);if(!isNaN(f))return f}throw new kr(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return Hn.fromString(Ha(this.args[0].evaluate(r)));case"resolvedImage":return Wn.fromString(Ha(this.args[0].evaluate(r)));default:return Ha(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Um=["Unknown","Point","LineString","Polygon"];class Zl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Um[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=er.parse(r)),s}}class eo{constructor(r,s,l=[],f,y=new ui,_=[]){this.registry=r,this.path=l,this.key=l.map(w=>`[${w}]`).join(""),this.scope=y,this.errors=_,this.expectedType=f,this._isConstant=s}parse(r,s,l,f,y={}){return s?this.concat(s,l,f)._parse(r,y):this._parse(r,y)}_parse(r,s){function l(f,y,_){return _==="assert"?new zi(y,[f]):_==="coerce"?new Di(y,[f]):f}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=r[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let _=y.parse(r,this);if(!_)return null;if(this.expectedType){const w=this.expectedType,S=_.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||S.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(w.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(w,S))return null}else _=l(_,w,s.typeAnnotation||"coerce");else _=l(_,w,s.typeAnnotation||"coerce");else _=l(_,w,s.typeAnnotation||"coerce");else _=l(_,w,s.typeAnnotation||"assert")}if(!(_ instanceof Mi)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const w=new Zl;try{_=new Mi(_.type,_.evaluate(w))}catch(S){return this.error(S.message),null}}return _}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,l){const f=typeof r=="number"?this.path.concat(r):this.path,y=l?this.scope.concat(l):this.scope;return new eo(this.registry,this._isConstant,f,s||null,y,this.errors)}error(r,...s){const l=`${this.key}${s.map(f=>`[${f}]`).join("")}`;this.errors.push(new zr(l,r))}checkSubtype(r,s){const l=J(r,s);return l&&this.error(l),l}}class Ds{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const l=[];for(let y=1;y<r.length-1;y+=2){const _=r[y];if(typeof _!="string")return s.error(`Expected string, but found ${typeof _} instead.`,y);if(/[^a-zA-Z0-9_]/.test(_))return s.error("Variable names must contain only alphanumeric characters or '_'.",y);const w=s.parse(r[y+1],y+1);if(!w)return null;l.push([_,w])}const f=s.parse(r[r.length-1],r.length-1,s.expectedType,l);return f?new Ds(l,f):null}outputDefined(){return this.result.outputDefined()}}class Wt{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const l=r[1];return s.scope.has(l)?new Wt(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Dc{constructor(r,s,l){this.type=r,this.index=s,this.input=l}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,je),f=s.parse(r[2],2,N(s.expectedType||kt));return l&&f?new Dc(f.type.itemType,l,f):null}evaluate(r){const s=this.index.evaluate(r),l=this.input.evaluate(r);if(s<0)throw new kr(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new kr(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new kr(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Rc{constructor(r,s){this.type=vt,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,kt),f=s.parse(r[2],2,kt);return l&&f?de(l.type,[vt,Ct,je,Ai,kt])?new Rc(l,f):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${F(l.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),l=this.haystack.evaluate(r);if(!l)return!1;if(!me(s,["boolean","string","number","null"]))throw new kr(`Expected first argument to be of type boolean, string, number or null, but found ${F(Rr(s))} instead.`);if(!me(l,["string","array"]))throw new kr(`Expected second argument to be of type array or string, but found ${F(Rr(l))} instead.`);return l.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Ro{constructor(r,s,l){this.type=je,this.needle=r,this.haystack=s,this.fromIndex=l}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,kt),f=s.parse(r[2],2,kt);if(!l||!f)return null;if(!de(l.type,[vt,Ct,je,Ai,kt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${F(l.type)} instead`);if(r.length===4){const y=s.parse(r[3],3,je);return y?new Ro(l,f,y):null}return new Ro(l,f)}evaluate(r){const s=this.needle.evaluate(r),l=this.haystack.evaluate(r);if(!me(s,["boolean","string","number","null"]))throw new kr(`Expected first argument to be of type boolean, string, number or null, but found ${F(Rr(s))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(r)),me(l,["string"])){const y=l.indexOf(s,f);return y===-1?-1:[...l.slice(0,y)].length}if(me(l,["array"]))return l.indexOf(s,f);throw new kr(`Expected second argument to be of type array or string, but found ${F(Rr(l))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Lc{constructor(r,s,l,f,y,_){this.inputType=r,this.type=s,this.input=l,this.cases=f,this.outputs=y,this.otherwise=_}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let l,f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const y={},_=[];for(let C=2;C<r.length-1;C+=2){let P=r[C];const M=r[C+1];Array.isArray(P)||(P=[P]);const O=s.concat(C);if(P.length===0)return O.error("Expected at least one branch label.");for(const U of P){if(typeof U!="number"&&typeof U!="string")return O.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof U=="number"&&Math.floor(U)!==U)return O.error("Numeric branch labels must be integer values.");if(l){if(O.checkSubtype(l,Rr(U)))return null}else l=Rr(U);if(y[String(U)]!==void 0)return O.error("Branch labels must be unique.");y[String(U)]=_.length}const j=s.parse(M,C,f);if(!j)return null;f=f||j.type,_.push(j)}const w=s.parse(r[1],1,kt);if(!w)return null;const S=s.parse(r[r.length-1],r.length-1,f);return S?w.type.kind!=="value"&&s.concat(1).checkSubtype(l,w.type)?null:new Lc(l,f,w,y,_,S):null}evaluate(r){const s=this.input.evaluate(r);return(Rr(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class Hl{constructor(r,s,l){this.type=r,this.branches=s,this.otherwise=l}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&s.expectedType.kind!=="value"&&(l=s.expectedType);const f=[];for(let _=1;_<r.length-1;_+=2){const w=s.parse(r[_],_,vt);if(!w)return null;const S=s.parse(r[_+1],_+1,l);if(!S)return null;f.push([w,S]),l=l||S.type}const y=s.parse(r[r.length-1],r.length-1,l);if(!y)return null;if(!l)throw new Error("Can't infer output type");return new Hl(l,f,y)}evaluate(r){for(const[s,l]of this.branches)if(s.evaluate(r))return l.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,l]of this.branches)r(s),r(l);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class Ga{constructor(r,s,l,f){this.type=r,this.input=s,this.beginIndex=l,this.endIndex=f}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,kt),f=s.parse(r[2],2,je);if(!l||!f)return null;if(!de(l.type,[N(kt),Ct,kt]))return s.error(`Expected first argument to be of type array or string, but found ${F(l.type)} instead`);if(r.length===4){const y=s.parse(r[3],3,je);return y?new Ga(l.type,l,f,y):null}return new Ga(l.type,l,f)}evaluate(r){const s=this.input.evaluate(r),l=this.beginIndex.evaluate(r);let f;if(this.endIndex&&(f=this.endIndex.evaluate(r)),me(s,["string"]))return[...s].slice(l,f).join("");if(me(s,["array"]))return s.slice(l,f);throw new kr(`Expected first argument to be of type array or string, but found ${F(Rr(s))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Gl(i,r){const s=i.length-1;let l,f,y=0,_=s,w=0;for(;y<=_;)if(w=Math.floor((y+_)/2),l=i[w],f=i[w+1],l<=r){if(w===s||r<f)return w;y=w+1}else{if(!(l>r))throw new kr("Input is not a number.");_=w-1}return 0}class Lo{constructor(r,s,l){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[f,y]of l)this.labels.push(f),this.outputs.push(y)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(r[1],1,je);if(!l)return null;const f=[];let y=null;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);for(let _=1;_<r.length;_+=2){const w=_===1?-1/0:r[_],S=r[_+1],C=_,P=_+1;if(typeof w!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(f.length&&f[f.length-1][0]>=w)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const M=s.parse(S,P,y);if(!M)return null;y=y||M.type,f.push([w,M])}return new Lo(y,l,f)}evaluate(r){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(r);const f=this.input.evaluate(r);if(f<=s[0])return l[0].evaluate(r);const y=s.length;return f>=s[y-1]?l[y-1].evaluate(r):l[Gl(s,f)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Zd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var qm=Hd;function Hd(i,r,s,l){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(l-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=s,this.p2y=l}Hd.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,r){if(r===void 0&&(r=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,l=0;l<8;l++){var f=this.sampleCurveX(s)-i;if(Math.abs(f)<r)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=f/y}var _=0,w=1;for(s=i,l=0;l<20&&(f=this.sampleCurveX(s),!(Math.abs(f-i)<r));l++)i>f?_=s:w=s,s=.5*(w-_)+_;return s},solve:function(i,r){return this.sampleCurveY(this.solveCurveX(i,r))}};var Zm=Zd(qm);function to(i,r,s){return i+s*(r-i)}function Wa(i,r,s){return i.map((l,f)=>to(l,r[f],s))}const An={number:to,color:function(i,r,s,l="rgb"){switch(l){case"rgb":{const[f,y,_,w]=Wa(i.rgb,r.rgb,s);return new er(f,y,_,w,!1)}case"hcl":{const[f,y,_,w]=i.hcl,[S,C,P,M]=r.hcl;let O,j;if(isNaN(f)||isNaN(S))isNaN(f)?isNaN(S)?O=NaN:(O=S,_!==1&&_!==0||(j=C)):(O=f,P!==1&&P!==0||(j=y));else{let xe=S-f;S>f&&xe>180?xe-=360:S<f&&f-S>180&&(xe+=360),O=f+s*xe}const[U,Z,re,oe]=function([xe,pe,ve,Ce]){return xe=isNaN(xe)?0:xe*mt,yr([ve,Math.cos(xe)*pe,Math.sin(xe)*pe,Ce])}([O,j??to(y,C,s),to(_,P,s),to(w,M,s)]);return new er(U,Z,re,oe,!1)}case"lab":{const[f,y,_,w]=yr(Wa(i.lab,r.lab,s));return new er(f,y,_,w,!1)}}},array:Wa,padding:function(i,r,s){return new Gn(Wa(i.values,r.values,s))},variableAnchorOffsetCollection:function(i,r,s){const l=i.values,f=r.values;if(l.length!==f.length)throw new kr(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${r.toString()}`);const y=[];for(let _=0;_<l.length;_+=2){if(l[_]!==f[_])throw new kr(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${l[_]}, to[${_}]: ${f[_]}`);y.push(l[_]);const[w,S]=l[_+1],[C,P]=f[_+1];y.push([to(w,C,s),to(S,P,s)])}return new hi(y)}};class Mn{constructor(r,s,l,f,y){this.type=r,this.operator=s,this.interpolation=l,this.input=f,this.labels=[],this.outputs=[];for(const[_,w]of y)this.labels.push(_),this.outputs.push(w)}static interpolationFactor(r,s,l,f){let y=0;if(r.name==="exponential")y=Wl(s,r.base,l,f);else if(r.name==="linear")y=Wl(s,1,l,f);else if(r.name==="cubic-bezier"){const _=r.controlPoints;y=new Zm(_[0],_[1],_[2],_[3]).solve(Wl(s,1,l,f))}return y}static parse(r,s){let[l,f,y,..._]=r;if(!Array.isArray(f)||f.length===0)return s.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const C=f[1];if(typeof C!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:C}}else{if(f[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const C=f.slice(1);if(C.length!==4||C.some(P=>typeof P!="number"||P<0||P>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:C}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(y=s.parse(y,2,je),!y)return null;const w=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=Cr:s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType);for(let C=0;C<_.length;C+=2){const P=_[C],M=_[C+1],O=C+3,j=C+4;if(typeof P!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(w.length&&w[w.length-1][0]>=P)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const U=s.parse(M,j,S);if(!U)return null;S=S||U.type,w.push([P,U])}return ye(S,je)||ye(S,Cr)||ye(S,Ji)||ye(S,ie)||ye(S,N(je))?new Mn(S,l,f,y,w):s.error(`Type ${F(S)} is not interpolatable.`)}evaluate(r){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(r);const f=this.input.evaluate(r);if(f<=s[0])return l[0].evaluate(r);const y=s.length;if(f>=s[y-1])return l[y-1].evaluate(r);const _=Gl(s,f),w=Mn.interpolationFactor(this.interpolation,f,s[_],s[_+1]),S=l[_].evaluate(r),C=l[_+1].evaluate(r);switch(this.operator){case"interpolate":return An[this.type.kind](S,C,w);case"interpolate-hcl":return An.color(S,C,w,"hcl");case"interpolate-lab":return An.color(S,C,w,"lab")}}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Wl(i,r,s,l){const f=l-s,y=i-s;return f===0?0:r===1?y/f:(Math.pow(r,y)-1)/(Math.pow(r,f)-1)}class Xl{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expectected at least one argument.");let l=null;const f=s.expectedType;f&&f.kind!=="value"&&(l=f);const y=[];for(const w of r.slice(1)){const S=s.parse(w,1+y.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,y.push(S)}if(!l)throw new Error("No output type");const _=f&&y.some(w=>J(f,w.type));return new Xl(_?kt:l,y)}evaluate(r){let s,l=null,f=0;for(const y of this.args)if(f++,l=y.evaluate(r),l&&l instanceof Wn&&!l.available&&(s||(s=l.name),l=null,f===this.args.length&&(l=s)),l!==null)break;return l}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function Kl(i,r){return i==="=="||i==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Gd(i,r,s,l){return l.compare(r,s)===0}function Fo(i,r,s){const l=i!=="=="&&i!=="!=";return class cE{constructor(y,_,w){this.type=vt,this.lhs=y,this.rhs=_,this.collator=w,this.hasUntypedArgument=y.type.kind==="value"||_.type.kind==="value"}static parse(y,_){if(y.length!==3&&y.length!==4)return _.error("Expected two or three arguments.");const w=y[0];let S=_.parse(y[1],1,kt);if(!S)return null;if(!Kl(w,S.type))return _.concat(1).error(`"${w}" comparisons are not supported for type '${F(S.type)}'.`);let C=_.parse(y[2],2,kt);if(!C)return null;if(!Kl(w,C.type))return _.concat(2).error(`"${w}" comparisons are not supported for type '${F(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return _.error(`Cannot compare types '${F(S.type)}' and '${F(C.type)}'.`);l&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new zi(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new zi(S.type,[C])));let P=null;if(y.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(P=_.parse(y[3],3,Zn),!P)return null}return new cE(S,C,P)}evaluate(y){const _=this.lhs.evaluate(y),w=this.rhs.evaluate(y);if(l&&this.hasUntypedArgument){const S=Rr(_),C=Rr(w);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new kr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Rr(_),C=Rr(w);if(S.kind!=="string"||C.kind!=="string")return r(y,_,w)}return this.collator?s(y,_,w,this.collator.evaluate(y)):r(y,_,w)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Hm=Fo("==",function(i,r,s){return r===s},Gd),Wd=Fo("!=",function(i,r,s){return r!==s},function(i,r,s,l){return!Gd(0,r,s,l)}),Xd=Fo("<",function(i,r,s){return r<s},function(i,r,s,l){return l.compare(r,s)<0}),Gm=Fo(">",function(i,r,s){return r>s},function(i,r,s,l){return l.compare(r,s)>0}),Wm=Fo("<=",function(i,r,s){return r<=s},function(i,r,s,l){return l.compare(r,s)<=0}),Kd=Fo(">=",function(i,r,s){return r>=s},function(i,r,s,l){return l.compare(r,s)>=0});class Xa{constructor(r,s,l){this.type=Zn,this.locale=l,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const l=r[1];if(typeof l!="object"||Array.isArray(l))return s.error("Collator options argument must be an object.");const f=s.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,vt);if(!f)return null;const y=s.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,vt);if(!y)return null;let _=null;return l.locale&&(_=s.parse(l.locale,1,Ct),!_)?null:new Xa(f,y,_)}evaluate(r){return new Ac(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class Fc{constructor(r,s,l,f,y){this.type=Ct,this.number=r,this.locale=s,this.currency=l,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const l=s.parse(r[1],1,je);if(!l)return null;const f=r[2];if(typeof f!="object"||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=s.parse(f.locale,1,Ct),!y))return null;let _=null;if(f.currency&&(_=s.parse(f.currency,1,Ct),!_))return null;let w=null;if(f["min-fraction-digits"]&&(w=s.parse(f["min-fraction-digits"],1,je),!w))return null;let S=null;return f["max-fraction-digits"]&&(S=s.parse(f["max-fraction-digits"],1,je),!S)?null:new Fc(l,y,_,w,S)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class Yl{constructor(r){this.type=ci,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const l=r[1];if(!Array.isArray(l)&&typeof l=="object")return s.error("First argument must be an image or text section.");const f=[];let y=!1;for(let _=1;_<=r.length-1;++_){const w=r[_];if(y&&typeof w=="object"&&!Array.isArray(w)){y=!1;let S=null;if(w["font-scale"]&&(S=s.parse(w["font-scale"],1,je),!S))return null;let C=null;if(w["text-font"]&&(C=s.parse(w["text-font"],1,N(Ct)),!C))return null;let P=null;if(w["text-color"]&&(P=s.parse(w["text-color"],1,Cr),!P))return null;const M=f[f.length-1];M.scale=S,M.font=C,M.textColor=P}else{const S=s.parse(r[_],1,kt);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:S,scale:null,font:null,textColor:null})}}return new Yl(f)}evaluate(r){return new Hn(this.sections.map(s=>{const l=s.content.evaluate(r);return Rr(l)===In?new Mc("",l,null,null,null):new Mc(Ha(l),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null)}))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor)}outputDefined(){return!1}}class Oc{constructor(r){this.type=In,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const l=s.parse(r[1],1,Ct);return l?new Oc(l):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),l=Wn.fromString(s);return l&&r.availableImages&&(l.available=r.availableImages.indexOf(s)>-1),l}eachChild(r){r(this.input)}outputDefined(){return!1}}class Bc{constructor(r){this.type=je,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const l=s.parse(r[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${F(l.type)} instead.`):new Bc(l):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new kr(`Expected value to be of type string or array, but found ${F(Rr(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Qi=8192;function Xm(i,r){const s=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,r.z);return[Math.round(s*f*Qi),Math.round(l*f*Qi)]}function Nc(i,r){const s=Math.pow(2,r.z);return[(f=(i[0]/Qi+r.x)/s,360*f-180),(l=(i[1]/Qi+r.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,f}function ro(i,r){i[0]=Math.min(i[0],r[0]),i[1]=Math.min(i[1],r[1]),i[2]=Math.max(i[2],r[0]),i[3]=Math.max(i[3],r[1])}function Rs(i,r){return!(i[0]<=r[0]||i[2]>=r[2]||i[1]<=r[1]||i[3]>=r[3])}function Kt(i,r,s){const l=i[0]-r[0],f=i[1]-r[1],y=i[0]-s[0],_=i[1]-s[1];return l*_-y*f==0&&l*y<=0&&f*_<=0}function Jl(i,r,s,l){return(f=[l[0]-s[0],l[1]-s[1]])[0]*(y=[r[0]-i[0],r[1]-i[1]])[1]-f[1]*y[0]!=0&&!(!Jd(i,r,s,l)||!Jd(s,l,i,r));var f,y}function Km(i,r,s){for(const l of s)for(let f=0;f<l.length-1;++f)if(Jl(i,r,l[f],l[f+1]))return!0;return!1}function Oo(i,r,s=!1){let l=!1;for(const w of r)for(let S=0;S<w.length-1;S++){if(Kt(i,w[S],w[S+1]))return s;(y=w[S])[1]>(f=i)[1]!=(_=w[S+1])[1]>f[1]&&f[0]<(_[0]-y[0])*(f[1]-y[1])/(_[1]-y[1])+y[0]&&(l=!l)}var f,y,_;return l}function Ym(i,r){for(const s of r)if(Oo(i,s))return!0;return!1}function Yd(i,r){for(const s of i)if(!Oo(s,r))return!1;for(let s=0;s<i.length-1;++s)if(Km(i[s],i[s+1],r))return!1;return!0}function Jm(i,r){for(const s of r)if(Yd(i,s))return!0;return!1}function Jd(i,r,s,l){const f=l[0]-s[0],y=l[1]-s[1],_=(i[0]-s[0])*y-f*(i[1]-s[1]),w=(r[0]-s[0])*y-f*(r[1]-s[1]);return _>0&&w<0||_<0&&w>0}function jc(i,r,s){const l=[];for(let f=0;f<i.length;f++){const y=[];for(let _=0;_<i[f].length;_++){const w=Xm(i[f][_],s);ro(r,w),y.push(w)}l.push(y)}return l}function Qd(i,r,s){const l=[];for(let f=0;f<i.length;f++){const y=jc(i[f],r,s);l.push(y)}return l}function ef(i,r,s,l){if(i[0]<s[0]||i[0]>s[2]){const f=.5*l;let y=i[0]-s[0]>f?-l:s[0]-i[0]>f?l:0;y===0&&(y=i[0]-s[2]>f?-l:s[2]-i[0]>f?l:0),i[0]+=y}ro(r,i)}function tf(i,r,s,l){const f=Math.pow(2,l.z)*Qi,y=[l.x*Qi,l.y*Qi],_=[];for(const w of i)for(const S of w){const C=[S.x+y[0],S.y+y[1]];ef(C,r,s,f),_.push(C)}return _}function rf(i,r,s,l){const f=Math.pow(2,l.z)*Qi,y=[l.x*Qi,l.y*Qi],_=[];for(const S of i){const C=[];for(const P of S){const M=[P.x+y[0],P.y+y[1]];ro(r,M),C.push(M)}_.push(C)}if(r[2]-r[0]<=f/2){(w=r)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const S of _)for(const C of S)ef(C,r,s,f)}var w;return _}class no{constructor(r,s){this.type=vt,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Qs(r[1])){const l=r[1];if(l.type==="FeatureCollection"){const f=[];for(const y of l.features){const{type:_,coordinates:w}=y.geometry;_==="Polygon"&&f.push(w),_==="MultiPolygon"&&f.push(...w)}if(f.length)return new no(l,{type:"MultiPolygon",coordinates:f})}else if(l.type==="Feature"){const f=l.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new no(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new no(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,l){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const w=jc(l.coordinates,y,_),S=tf(s.geometry(),f,y,_);if(!Rs(f,y))return!1;for(const C of S)if(!Oo(C,w))return!1}if(l.type==="MultiPolygon"){const w=Qd(l.coordinates,y,_),S=tf(s.geometry(),f,y,_);if(!Rs(f,y))return!1;for(const C of S)if(!Ym(C,w))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,l){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const w=jc(l.coordinates,y,_),S=rf(s.geometry(),f,y,_);if(!Rs(f,y))return!1;for(const C of S)if(!Yd(C,w))return!1}if(l.type==="MultiPolygon"){const w=Qd(l.coordinates,y,_),S=rf(s.geometry(),f,y,_);if(!Rs(f,y))return!1;for(const C of S)if(!Jm(C,w))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let nf=class{constructor(i=[],r=(s,l)=>s<l?-1:s>l?1:0){if(this.data=i,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:r,compare:s}=this,l=r[i];for(;i>0;){const f=i-1>>1,y=r[f];if(s(l,y)>=0)break;r[i]=y,i=f}r[i]=l}_down(i){const{data:r,compare:s}=this,l=this.length>>1,f=r[i];for(;i<l;){let y=1+(i<<1);const _=y+1;if(_<this.length&&s(r[_],r[y])<0&&(y=_),s(r[y],f)>=0)break;r[i]=r[y],i=y}r[i]=f}};function Qm(i,r,s,l,f){sf(i,r,s,l||i.length-1,f||eg)}function sf(i,r,s,l,f){for(;l>s;){if(l-s>600){var y=l-s+1,_=r-s+1,w=Math.log(y),S=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*S*(y-S)/y)*(_-y/2<0?-1:1);sf(i,r,Math.max(s,Math.floor(r-_*S/y+C)),Math.min(l,Math.floor(r+(y-_)*S/y+C)),f)}var P=i[r],M=s,O=l;for(Ka(i,s,r),f(i[l],P)>0&&Ka(i,s,l);M<O;){for(Ka(i,M,O),M++,O--;f(i[M],P)<0;)M++;for(;f(i[O],P)>0;)O--}f(i[s],P)===0?Ka(i,s,O):Ka(i,++O,l),O<=r&&(s=O+1),r<=O&&(l=O-1)}}function Ka(i,r,s){var l=i[r];i[r]=i[s],i[s]=l}function eg(i,r){return i<r?-1:i>r?1:0}function Ql(i,r){if(i.length<=1)return[i];const s=[];let l,f;for(const y of i){const _=rg(y);_!==0&&(y.area=Math.abs(_),f===void 0&&(f=_<0),f===_<0?(l&&s.push(l),l=[y]):l.push(y))}if(l&&s.push(l),r>1)for(let y=0;y<s.length;y++)s[y].length<=r||(Qm(s[y],r,1,s[y].length-1,tg),s[y]=s[y].slice(0,r));return s}function tg(i,r){return r.area-i.area}function rg(i){let r=0;for(let s,l,f=0,y=i.length,_=y-1;f<y;_=f++)s=i[f],l=i[_],r+=(l.x-s.x)*(s.y+l.y);return r}const of=1/298.257223563,af=of*(2-of),lf=Math.PI/180;class Vc{constructor(r){const s=6378.137*lf*1e3,l=Math.cos(r*lf),f=1/(1-af*(1-l*l)),y=Math.sqrt(f);this.kx=s*y*l,this.ky=s*y*f*(1-af)}distance(r,s){const l=this.wrap(r[0]-s[0])*this.kx,f=(r[1]-s[1])*this.ky;return Math.sqrt(l*l+f*f)}pointOnLine(r,s){let l,f,y,_,w=1/0;for(let S=0;S<r.length-1;S++){let C=r[S][0],P=r[S][1],M=this.wrap(r[S+1][0]-C)*this.kx,O=(r[S+1][1]-P)*this.ky,j=0;M===0&&O===0||(j=(this.wrap(s[0]-C)*this.kx*M+(s[1]-P)*this.ky*O)/(M*M+O*O),j>1?(C=r[S+1][0],P=r[S+1][1]):j>0&&(C+=M/this.kx*j,P+=O/this.ky*j)),M=this.wrap(s[0]-C)*this.kx,O=(s[1]-P)*this.ky;const U=M*M+O*O;U<w&&(w=U,l=C,f=P,y=S,_=j)}return{point:[l,f],index:y,t:Math.max(0,Math.min(1,_))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function uf(i,r){return r[0]-i[0]}function eu(i){return i[1]-i[0]+1}function ds(i,r){return i[1]>=i[0]&&i[1]<r}function $c(i,r){if(i[0]>i[1])return[null,null];const s=eu(i);if(r){if(s===2)return[i,null];const f=Math.floor(s/2);return[[i[0],i[0]+f],[i[0]+f,i[1]]]}if(s===1)return[i,null];const l=Math.floor(s/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}function Uc(i,r){if(!ds(r,i.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let l=r[0];l<=r[1];++l)ro(s,i[l]);return s}function qc(i){const r=[1/0,1/0,-1/0,-1/0];for(const s of i)for(const l of s)ro(r,l);return r}function tu(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Zc(i,r,s){if(!tu(i)||!tu(r))return NaN;let l=0,f=0;return i[2]<r[0]&&(l=r[0]-i[2]),i[0]>r[2]&&(l=i[0]-r[2]),i[1]>r[3]&&(f=i[1]-r[3]),i[3]<r[1]&&(f=r[1]-i[3]),s.distance([0,0],[l,f])}function io(i,r,s){const l=s.pointOnLine(r,i);return s.distance(i,l.point)}function Hc(i,r,s,l,f){const y=Math.min(io(i,[s,l],f),io(r,[s,l],f)),_=Math.min(io(s,[i,r],f),io(l,[i,r],f));return Math.min(y,_)}function ng(i,r,s,l,f){if(!ds(r,i.length)||!ds(l,s.length))return 1/0;let y=1/0;for(let _=r[0];_<r[1];++_){const w=i[_],S=i[_+1];for(let C=l[0];C<l[1];++C){const P=s[C],M=s[C+1];if(Jl(w,S,P,M))return 0;y=Math.min(y,Hc(w,S,P,M,f))}}return y}function br(i,r,s,l,f){if(!ds(r,i.length)||!ds(l,s.length))return NaN;let y=1/0;for(let _=r[0];_<=r[1];++_)for(let w=l[0];w<=l[1];++w)if(y=Math.min(y,f.distance(i[_],s[w])),y===0)return y;return y}function ig(i,r,s){if(Oo(i,r,!0))return 0;let l=1/0;for(const f of r){const y=f[0],_=f[f.length-1];if(y!==_&&(l=Math.min(l,io(i,[_,y],s)),l===0))return l;const w=s.pointOnLine(f,i);if(l=Math.min(l,s.distance(i,w.point)),l===0)return l}return l}function Ft(i,r,s,l){if(!ds(r,i.length))return NaN;for(let y=r[0];y<=r[1];++y)if(Oo(i[y],s,!0))return 0;let f=1/0;for(let y=r[0];y<r[1];++y){const _=i[y],w=i[y+1];for(const S of s)for(let C=0,P=S.length,M=P-1;C<P;M=C++){const O=S[M],j=S[C];if(Jl(_,w,O,j))return 0;f=Math.min(f,Hc(_,w,O,j,l))}}return f}function ru(i,r){for(const s of i)for(const l of s)if(Oo(l,r,!0))return!0;return!1}function sr(i,r,s,l=1/0){const f=qc(i),y=qc(r);if(l!==1/0&&Zc(f,y,s)>=l)return l;if(Rs(f,y)){if(ru(i,r))return 0}else if(ru(r,i))return 0;let _=1/0;for(const w of i)for(let S=0,C=w.length,P=C-1;S<C;P=S++){const M=w[P],O=w[S];for(const j of r)for(let U=0,Z=j.length,re=Z-1;U<Z;re=U++){const oe=j[re],xe=j[U];if(Jl(M,O,oe,xe))return 0;_=Math.min(_,Hc(M,O,oe,xe,s))}}return _}function tr(i,r,s,l,f,y){if(!y)return;const _=Zc(Uc(l,y),f,s);_<r&&i.push([_,y,[0,0]])}function so(i,r,s,l,f,y,_){if(!y||!_)return;const w=Zc(Uc(l,y),Uc(f,_),s);w<r&&i.push([w,y,_])}function Ya(i,r,s,l,f=1/0){let y=Math.min(l.distance(i[0],s[0][0]),f);if(y===0)return y;const _=new nf([[0,[0,i.length-1],[0,0]]],uf),w=qc(s);for(;_.length>0;){const S=_.pop();if(S[0]>=y)continue;const C=S[1],P=r?50:100;if(eu(C)<=P){if(!ds(C,i.length))return NaN;if(r){const M=Ft(i,C,s,l);if(isNaN(M)||M===0)return M;y=Math.min(y,M)}else for(let M=C[0];M<=C[1];++M){const O=ig(i[M],s,l);if(y=Math.min(y,O),y===0)return 0}}else{const M=$c(C,r);tr(_,y,l,i,w,M[0]),tr(_,y,l,i,w,M[1])}}return y}function Ja(i,r,s,l,f,y=1/0){let _=Math.min(y,f.distance(i[0],s[0]));if(_===0)return _;const w=new nf([[0,[0,i.length-1],[0,s.length-1]]],uf);for(;w.length>0;){const S=w.pop();if(S[0]>=_)continue;const C=S[1],P=S[2],M=r?50:100,O=l?50:100;if(eu(C)<=M&&eu(P)<=O){if(!ds(C,i.length)&&ds(P,s.length))return NaN;let j;if(r&&l)j=ng(i,C,s,P,f),_=Math.min(_,j);else if(r&&!l){const U=i.slice(C[0],C[1]+1);for(let Z=P[0];Z<=P[1];++Z)if(j=io(s[Z],U,f),_=Math.min(_,j),_===0)return _}else if(!r&&l){const U=s.slice(P[0],P[1]+1);for(let Z=C[0];Z<=C[1];++Z)if(j=io(i[Z],U,f),_=Math.min(_,j),_===0)return _}else j=br(i,C,s,P,f),_=Math.min(_,j)}else{const j=$c(C,r),U=$c(P,l);so(w,_,f,i,s,j[0],U[0]),so(w,_,f,i,s,j[0],U[1]),so(w,_,f,i,s,j[1],U[0]),so(w,_,f,i,s,j[1],U[1])}}return _}function Gc(i){return i.type==="MultiPolygon"?i.coordinates.map(r=>({type:"Polygon",coordinates:r})):i.type==="MultiLineString"?i.coordinates.map(r=>({type:"LineString",coordinates:r})):i.type==="MultiPoint"?i.coordinates.map(r=>({type:"Point",coordinates:r})):[i]}class oo{constructor(r,s){this.type=je,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Qs(r[1])){const l=r[1];if(l.type==="FeatureCollection")return new oo(l,l.features.map(f=>Gc(f.geometry)).flat());if(l.type==="Feature")return new oo(l,Gc(l.geometry));if("type"in l&&"coordinates"in l)return new oo(l,Gc(l))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,l){const f=s.geometry(),y=f.flat().map(S=>Nc([S.x,S.y],s.canonical));if(f.length===0)return NaN;const _=new Vc(y[0][1]);let w=1/0;for(const S of l){switch(S.type){case"Point":w=Math.min(w,Ja(y,!1,[S.coordinates],!1,_,w));break;case"LineString":w=Math.min(w,Ja(y,!1,S.coordinates,!0,_,w));break;case"Polygon":w=Math.min(w,Ya(y,!1,S.coordinates,_,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,l){const f=s.geometry(),y=f.flat().map(S=>Nc([S.x,S.y],s.canonical));if(f.length===0)return NaN;const _=new Vc(y[0][1]);let w=1/0;for(const S of l){switch(S.type){case"Point":w=Math.min(w,Ja(y,!0,[S.coordinates],!1,_,w));break;case"LineString":w=Math.min(w,Ja(y,!0,S.coordinates,!0,_,w));break;case"Polygon":w=Math.min(w,Ya(y,!0,S.coordinates,_,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="Polygon")return function(s,l){const f=s.geometry();if(f.length===0||f[0].length===0)return NaN;const y=Ql(f,0).map(S=>S.map(C=>C.map(P=>Nc([P.x,P.y],s.canonical)))),_=new Vc(y[0][0][0][1]);let w=1/0;for(const S of l)for(const C of y){switch(S.type){case"Point":w=Math.min(w,Ya([S.coordinates],!1,C,_,w));break;case"LineString":w=Math.min(w,Ya(S.coordinates,!0,C,_,w));break;case"Polygon":w=Math.min(w,sr(C,S.coordinates,_,w))}if(w===0)return w}return w}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Bo={"==":Hm,"!=":Wd,">":Gm,"<":Xd,">=":Kd,"<=":Wm,array:zi,at:Dc,boolean:zi,case:Hl,coalesce:Xl,collator:Xa,format:Yl,image:Oc,in:Rc,"index-of":Ro,interpolate:Mn,"interpolate-hcl":Mn,"interpolate-lab":Mn,length:Bc,let:Ds,literal:Mi,match:Lc,number:zi,"number-format":Fc,object:zi,slice:Ga,step:Lo,string:zi,"to-boolean":Di,"to-color":Di,"to-number":Di,"to-string":Di,var:Wt,within:no,distance:oo};class di{constructor(r,s,l,f){this.name=r,this.type=s,this._evaluate=l,this.args=f}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,s){const l=r[0],f=di.definitions[l];if(!f)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,_=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,w=_.filter(([C])=>!Array.isArray(C)||C.length===r.length-1);let S=null;for(const[C,P]of w){S=new eo(s.registry,Qa,s.path,null,s.scope);const M=[];let O=!1;for(let j=1;j<r.length;j++){const U=r[j],Z=Array.isArray(C)?C[j-1]:C.type,re=S.parse(U,1+M.length,Z);if(!re){O=!0;break}M.push(re)}if(!O)if(Array.isArray(C)&&C.length!==M.length)S.error(`Expected ${C.length} arguments, but found ${M.length} instead.`);else{for(let j=0;j<M.length;j++){const U=Array.isArray(C)?C[j]:C.type,Z=M[j];S.concat(j+1).checkSubtype(U,Z.type)}if(S.errors.length===0)return new di(l,y,P,M)}}if(w.length===1)s.errors.push(...S.errors);else{const C=(w.length?w:_).map(([M])=>{return O=M,Array.isArray(O)?`(${O.map(F).join(", ")})`:`(${F(O.type)}...)`;var O}).join(" | "),P=[];for(let M=1;M<r.length;M++){const O=s.parse(r[M],1+P.length);if(!O)return null;P.push(F(O.type))}s.error(`Expected arguments of type ${C}, but found (${P.join(", ")}) instead.`)}return null}static register(r,s){di.definitions=s;for(const l in s)r[l]=di}}function Wc(i,[r,s,l,f]){r=r.evaluate(i),s=s.evaluate(i),l=l.evaluate(i);const y=f?f.evaluate(i):1,_=Do(r,s,l,y);if(_)throw new kr(_);return new er(r/255,s/255,l/255,y,!1)}function Xc(i,r){return i in r}function Kc(i,r){const s=r[i];return s===void 0?null:s}function ao(i){return{type:i}}function Qa(i){if(i instanceof Wt)return Qa(i.boundExpression);if(i instanceof di&&i.name==="error"||i instanceof Xa||i instanceof no||i instanceof oo)return!1;const r=i instanceof Di||i instanceof zi;let s=!0;return i.eachChild(l=>{s=r?s&&Qa(l):s&&l instanceof Mi}),!!s&&el(i)&&tl(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function el(i){if(i instanceof di&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof no||i instanceof oo)return!1;let r=!0;return i.eachChild(s=>{r&&!el(s)&&(r=!1)}),r}function No(i){if(i instanceof di&&i.name==="feature-state")return!1;let r=!0;return i.eachChild(s=>{r&&!No(s)&&(r=!1)}),r}function tl(i,r){if(i instanceof di&&r.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild(l=>{s&&!tl(l,r)&&(s=!1)}),s}function nu(i){return{result:"success",value:i}}function jo(i){return{result:"error",value:i}}function Vo(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function cf(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Yc(i){return!!i.expression&&i.expression.interpolated}function Ht(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function iu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function sg(i){return i}function hf(i,r){const s=r.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",f=l||!(l||i.property!==void 0),y=i.type||(Yc(r)?"exponential":"interval");if(s||r.type==="padding"){const P=s?er.parse:Gn.parse;(i=li({},i)).stops&&(i.stops=i.stops.map(M=>[M[0],P(M[1])])),i.default=P(i.default?i.default:r.default)}if(i.colorSpace&&(_=i.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var _;let w,S,C;if(y==="exponential")w=ff;else if(y==="interval")w=su;else if(y==="categorical"){w=df,S=Object.create(null);for(const P of i.stops)S[P[0]]=P[1];C=typeof i.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);w=pf}if(l){const P={},M=[];for(let U=0;U<i.stops.length;U++){const Z=i.stops[U],re=Z[0].zoom;P[re]===void 0&&(P[re]={zoom:re,type:i.type,property:i.property,default:i.default,stops:[]},M.push(re)),P[re].stops.push([Z[0].value,Z[1]])}const O=[];for(const U of M)O.push([P[U].zoom,hf(P[U],r)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Mn.interpolationFactor.bind(void 0,j),zoomStops:O.map(U=>U[0]),evaluate:({zoom:U},Z)=>ff({stops:O,base:i.base},r,U).evaluate(U,Z)}}if(f){const P=y==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Mn.interpolationFactor.bind(void 0,P),zoomStops:i.stops.map(M=>M[0]),evaluate:({zoom:M})=>w(i,r,M,S,C)}}return{kind:"source",evaluate(P,M){const O=M&&M.properties?M.properties[i.property]:void 0;return O===void 0?$o(i.default,r.default):w(i,r,O,S,C)}}}function $o(i,r,s){return i!==void 0?i:r!==void 0?r:s!==void 0?s:void 0}function df(i,r,s,l,f){return $o(typeof s===f?l[s]:void 0,i.default,r.default)}function su(i,r,s){if(Ht(s)!=="number")return $o(i.default,r.default);const l=i.stops.length;if(l===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[l-1][0])return i.stops[l-1][1];const f=Gl(i.stops.map(y=>y[0]),s);return i.stops[f][1]}function ff(i,r,s){const l=i.base!==void 0?i.base:1;if(Ht(s)!=="number")return $o(i.default,r.default);const f=i.stops.length;if(f===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[f-1][0])return i.stops[f-1][1];const y=Gl(i.stops.map(P=>P[0]),s),_=function(P,M,O,j){const U=j-O,Z=P-O;return U===0?0:M===1?Z/U:(Math.pow(M,Z)-1)/(Math.pow(M,U)-1)}(s,l,i.stops[y][0],i.stops[y+1][0]),w=i.stops[y][1],S=i.stops[y+1][1],C=An[r.type]||sg;return typeof w.evaluate=="function"?{evaluate(...P){const M=w.evaluate.apply(void 0,P),O=S.evaluate.apply(void 0,P);if(M!==void 0&&O!==void 0)return C(M,O,_,i.colorSpace)}}:C(w,S,_,i.colorSpace)}function pf(i,r,s){switch(r.type){case"color":s=er.parse(s);break;case"formatted":s=Hn.fromString(s.toString());break;case"resolvedImage":s=Wn.fromString(s.toString());break;case"padding":s=Gn.parse(s);break;default:Ht(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0)}return $o(s,i.default,r.default)}di.register(Bo,{error:[{kind:"error"},[Ct],(i,[r])=>{throw new kr(r.evaluate(i))}],typeof:[Ct,[kt],(i,[r])=>F(Rr(r.evaluate(i)))],"to-rgba":[N(je,4),[Cr],(i,[r])=>{const[s,l,f,y]=r.evaluate(i).rgb;return[255*s,255*l,255*f,y]}],rgb:[Cr,[je,je,je],Wc],rgba:[Cr,[je,je,je,je],Wc],has:{type:vt,overloads:[[[Ct],(i,[r])=>Xc(r.evaluate(i),i.properties())],[[Ct,qn],(i,[r,s])=>Xc(r.evaluate(i),s.evaluate(i))]]},get:{type:kt,overloads:[[[Ct],(i,[r])=>Kc(r.evaluate(i),i.properties())],[[Ct,qn],(i,[r,s])=>Kc(r.evaluate(i),s.evaluate(i))]]},"feature-state":[kt,[Ct],(i,[r])=>Kc(r.evaluate(i),i.featureState||{})],properties:[qn,[],i=>i.properties()],"geometry-type":[Ct,[],i=>i.geometryType()],id:[kt,[],i=>i.id()],zoom:[je,[],i=>i.globals.zoom],"heatmap-density":[je,[],i=>i.globals.heatmapDensity||0],"line-progress":[je,[],i=>i.globals.lineProgress||0],accumulated:[kt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[je,ao(je),(i,r)=>{let s=0;for(const l of r)s+=l.evaluate(i);return s}],"*":[je,ao(je),(i,r)=>{let s=1;for(const l of r)s*=l.evaluate(i);return s}],"-":{type:je,overloads:[[[je,je],(i,[r,s])=>r.evaluate(i)-s.evaluate(i)],[[je],(i,[r])=>-r.evaluate(i)]]},"/":[je,[je,je],(i,[r,s])=>r.evaluate(i)/s.evaluate(i)],"%":[je,[je,je],(i,[r,s])=>r.evaluate(i)%s.evaluate(i)],ln2:[je,[],()=>Math.LN2],pi:[je,[],()=>Math.PI],e:[je,[],()=>Math.E],"^":[je,[je,je],(i,[r,s])=>Math.pow(r.evaluate(i),s.evaluate(i))],sqrt:[je,[je],(i,[r])=>Math.sqrt(r.evaluate(i))],log10:[je,[je],(i,[r])=>Math.log(r.evaluate(i))/Math.LN10],ln:[je,[je],(i,[r])=>Math.log(r.evaluate(i))],log2:[je,[je],(i,[r])=>Math.log(r.evaluate(i))/Math.LN2],sin:[je,[je],(i,[r])=>Math.sin(r.evaluate(i))],cos:[je,[je],(i,[r])=>Math.cos(r.evaluate(i))],tan:[je,[je],(i,[r])=>Math.tan(r.evaluate(i))],asin:[je,[je],(i,[r])=>Math.asin(r.evaluate(i))],acos:[je,[je],(i,[r])=>Math.acos(r.evaluate(i))],atan:[je,[je],(i,[r])=>Math.atan(r.evaluate(i))],min:[je,ao(je),(i,r)=>Math.min(...r.map(s=>s.evaluate(i)))],max:[je,ao(je),(i,r)=>Math.max(...r.map(s=>s.evaluate(i)))],abs:[je,[je],(i,[r])=>Math.abs(r.evaluate(i))],round:[je,[je],(i,[r])=>{const s=r.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[je,[je],(i,[r])=>Math.floor(r.evaluate(i))],ceil:[je,[je],(i,[r])=>Math.ceil(r.evaluate(i))],"filter-==":[vt,[Ct,kt],(i,[r,s])=>i.properties()[r.value]===s.value],"filter-id-==":[vt,[kt],(i,[r])=>i.id()===r.value],"filter-type-==":[vt,[Ct],(i,[r])=>i.geometryType()===r.value],"filter-<":[vt,[Ct,kt],(i,[r,s])=>{const l=i.properties()[r.value],f=s.value;return typeof l==typeof f&&l<f}],"filter-id-<":[vt,[kt],(i,[r])=>{const s=i.id(),l=r.value;return typeof s==typeof l&&s<l}],"filter->":[vt,[Ct,kt],(i,[r,s])=>{const l=i.properties()[r.value],f=s.value;return typeof l==typeof f&&l>f}],"filter-id->":[vt,[kt],(i,[r])=>{const s=i.id(),l=r.value;return typeof s==typeof l&&s>l}],"filter-<=":[vt,[Ct,kt],(i,[r,s])=>{const l=i.properties()[r.value],f=s.value;return typeof l==typeof f&&l<=f}],"filter-id-<=":[vt,[kt],(i,[r])=>{const s=i.id(),l=r.value;return typeof s==typeof l&&s<=l}],"filter->=":[vt,[Ct,kt],(i,[r,s])=>{const l=i.properties()[r.value],f=s.value;return typeof l==typeof f&&l>=f}],"filter-id->=":[vt,[kt],(i,[r])=>{const s=i.id(),l=r.value;return typeof s==typeof l&&s>=l}],"filter-has":[vt,[kt],(i,[r])=>r.value in i.properties()],"filter-has-id":[vt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[vt,[N(Ct)],(i,[r])=>r.value.indexOf(i.geometryType())>=0],"filter-id-in":[vt,[N(kt)],(i,[r])=>r.value.indexOf(i.id())>=0],"filter-in-small":[vt,[Ct,N(kt)],(i,[r,s])=>s.value.indexOf(i.properties()[r.value])>=0],"filter-in-large":[vt,[Ct,N(kt)],(i,[r,s])=>function(l,f,y,_){for(;y<=_;){const w=y+_>>1;if(f[w]===l)return!0;f[w]>l?_=w-1:y=w+1}return!1}(i.properties()[r.value],s.value,0,s.value.length-1)],all:{type:vt,overloads:[[[vt,vt],(i,[r,s])=>r.evaluate(i)&&s.evaluate(i)],[ao(vt),(i,r)=>{for(const s of r)if(!s.evaluate(i))return!1;return!0}]]},any:{type:vt,overloads:[[[vt,vt],(i,[r,s])=>r.evaluate(i)||s.evaluate(i)],[ao(vt),(i,r)=>{for(const s of r)if(s.evaluate(i))return!0;return!1}]]},"!":[vt,[vt],(i,[r])=>!r.evaluate(i)],"is-supported-script":[vt,[Ct],(i,[r])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(r.evaluate(i))}],upcase:[Ct,[Ct],(i,[r])=>r.evaluate(i).toUpperCase()],downcase:[Ct,[Ct],(i,[r])=>r.evaluate(i).toLowerCase()],concat:[Ct,ao(kt),(i,r)=>r.map(s=>Ha(s.evaluate(i))).join("")],"resolved-locale":[Ct,[Zn],(i,[r])=>r.evaluate(i).resolvedLocale()]});class ou{constructor(r,s){var l;this.expression=r,this._warningHistory={},this._evaluator=new Zl,this._defaultValue=s?(l=s).type==="color"&&iu(l.default)?new er(0,0,0,0):l.type==="color"?er.parse(l.default)||null:l.type==="padding"?Gn.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?hi.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,l,f,y,_){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(r,s,l,f,y,_){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new kr(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function au(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Bo}function Uo(i,r){const s=new eo(Bo,Qa,[],r?function(f){const y={color:Cr,string:Ct,number:je,enum:Ct,boolean:vt,formatted:ci,padding:Ji,resolvedImage:In,variableAnchorOffsetCollection:ie};return f.type==="array"?N(y[f.value]||kt,f.length):y[f.type]}(r):void 0),l=s.parse(i,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?nu(new ou(l,r)):jo(s.errors)}class qo{constructor(r,s){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!No(s.expression)}evaluateWithoutErrorHandling(r,s,l,f,y,_){return this._styleExpression.evaluateWithoutErrorHandling(r,s,l,f,y,_)}evaluate(r,s,l,f,y,_){return this._styleExpression.evaluate(r,s,l,f,y,_)}}class Zo{constructor(r,s,l,f){this.kind=r,this.zoomStops=l,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!No(s.expression),this.interpolationType=f}evaluateWithoutErrorHandling(r,s,l,f,y,_){return this._styleExpression.evaluateWithoutErrorHandling(r,s,l,f,y,_)}evaluate(r,s,l,f,y,_){return this._styleExpression.evaluate(r,s,l,f,y,_)}interpolationFactor(r,s,l){return this.interpolationType?Mn.interpolationFactor(this.interpolationType,r,s,l):0}}function Jc(i,r){const s=Uo(i,r);if(s.result==="error")return s;const l=s.value.expression,f=el(l);if(!f&&!Vo(r))return jo([new zr("","data expressions not supported")]);const y=tl(l,["zoom"]);if(!y&&!cf(r))return jo([new zr("","zoom expressions not supported")]);const _=rl(l);return _||y?_ instanceof zr?jo([_]):_ instanceof Mn&&!Yc(r)?jo([new zr("",'"interpolate" expressions cannot be used with this property')]):nu(_?new Zo(f?"camera":"composite",s.value,_.labels,_ instanceof Mn?_.interpolation:void 0):new qo(f?"constant":"source",s.value)):jo([new zr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ho{constructor(r,s){this._parameters=r,this._specification=s,li(this,hf(this._parameters,this._specification))}static deserialize(r){return new Ho(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function rl(i){let r=null;if(i instanceof Ds)r=rl(i.result);else if(i instanceof Xl){for(const s of i.args)if(r=rl(s),r)break}else(i instanceof Lo||i instanceof Mn)&&i.input instanceof di&&i.input.name==="zoom"&&(r=i);return r instanceof zr||i.eachChild(s=>{const l=rl(s);l instanceof zr?r=l:!r&&l?r=new zr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&l&&r!==l&&(r=new zr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function lu(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const r of i.slice(1))if(!lu(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const uu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qc(i){if(i==null)return{filter:()=>!0,needGeometry:!1};lu(i)||(i=cu(i));const r=Uo(i,uu);if(r.result==="error")throw new Error(r.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,l,f)=>r.value.evaluate(s,l,{},f),needGeometry:mf(i)}}function og(i,r){return i<r?-1:i>r?1:0}function mf(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let r=1;r<i.length;r++)if(mf(i[r]))return!0;return!1}function cu(i){if(!i)return!0;const r=i[0];return i.length<=1?r!=="any":r==="=="?eh(i[1],i[2],"=="):r==="!="?an(eh(i[1],i[2],"==")):r==="<"||r===">"||r==="<="||r===">="?eh(i[1],i[2],r):r==="any"?(s=i.slice(1),["any"].concat(s.map(cu))):r==="all"?["all"].concat(i.slice(1).map(cu)):r==="none"?["all"].concat(i.slice(1).map(cu).map(an)):r==="in"?nl(i[1],i.slice(2)):r==="!in"?an(nl(i[1],i.slice(2))):r==="has"?il(i[1]):r!=="!has"||an(il(i[1]));var s}function eh(i,r,s){switch(i){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,i,r]}}function nl(i,r){if(r.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(s=>typeof s!=typeof r[0])?["filter-in-large",i,["literal",r.sort(og)]]:["filter-in-small",i,["literal",r]]}}function il(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function an(i){return["!",i]}function lo(i){const r=typeof i;if(r==="number"||r==="boolean"||r==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let f="[";for(const y of i)f+=`${lo(y)},`;return`${f}]`}const s=Object.keys(i).sort();let l="{";for(let f=0;f<s.length;f++)l+=`${JSON.stringify(s[f])}:${lo(i[s[f]])},`;return`${l}}`}function gf(i){let r="";for(const s of Ci)r+=`/${lo(i[s])}`;return r}function yf(i){const r=i.value;return r?[new Ne(i.key,r,"constants have been deprecated as of v8")]:[]}function Sr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Ri(i){if(Array.isArray(i))return i.map(Ri);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const r={};for(const s in i)r[s]=Ri(i[s]);return r}return Sr(i)}function Xn(i){const r=i.key,s=i.value,l=i.valueSpec||{},f=i.objectElementValidators||{},y=i.style,_=i.styleSpec,w=i.validateSpec;let S=[];const C=Ht(s);if(C!=="object")return[new Ne(r,s,`object expected, ${C} found`)];for(const P in s){const M=P.split(".")[0],O=l[M]||l["*"];let j;if(f[M])j=f[M];else if(l[M])j=w;else if(f["*"])j=f["*"];else{if(!l["*"]){S.push(new Ne(r,s[P],`unknown property "${P}"`));continue}j=w}S=S.concat(j({key:(r&&`${r}.`)+P,value:s[P],valueSpec:O,style:y,styleSpec:_,object:s,objectKey:P,validateSpec:w},s))}for(const P in l)f[P]||l[P].required&&l[P].default===void 0&&s[P]===void 0&&S.push(new Ne(r,s,`missing required property "${P}"`));return S}function sl(i){const r=i.value,s=i.valueSpec,l=i.style,f=i.styleSpec,y=i.key,_=i.arrayElementValidator||i.validateSpec;if(Ht(r)!=="array")return[new Ne(y,r,`array expected, ${Ht(r)} found`)];if(s.length&&r.length!==s.length)return[new Ne(y,r,`array length ${s.length} expected, length ${r.length} found`)];if(s["min-length"]&&r.length<s["min-length"])return[new Ne(y,r,`array length at least ${s["min-length"]} expected, length ${r.length} found`)];let w={type:s.value,values:s.values};f.$version<7&&(w.function=s.function),Ht(s.value)==="object"&&(w=s.value);let S=[];for(let C=0;C<r.length;C++)S=S.concat(_({array:r,arrayIndex:C,value:r[C],valueSpec:w,validateSpec:i.validateSpec,style:l,styleSpec:f,key:`${y}[${C}]`}));return S}function th(i){const r=i.key,s=i.value,l=i.valueSpec;let f=Ht(s);return f==="number"&&s!=s&&(f="NaN"),f!=="number"?[new Ne(r,s,`number expected, ${f} found`)]:"minimum"in l&&s<l.minimum?[new Ne(r,s,`${s} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&s>l.maximum?[new Ne(r,s,`${s} is greater than the maximum value ${l.maximum}`)]:[]}function hu(i){const r=i.valueSpec,s=Sr(i.value.type);let l,f,y,_={};const w=s!=="categorical"&&i.value.property===void 0,S=!w,C=Ht(i.value.stops)==="array"&&Ht(i.value.stops[0])==="array"&&Ht(i.value.stops[0][0])==="object",P=Xn({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(j){if(s==="identity")return[new Ne(j.key,j.value,'identity function may not have a "stops" property')];let U=[];const Z=j.value;return U=U.concat(sl({key:j.key,value:Z,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:M})),Ht(Z)==="array"&&Z.length===0&&U.push(new Ne(j.key,Z,"array must have at least one stop")),U},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:r,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return s==="identity"&&w&&P.push(new Ne(i.key,i.value,'missing required property "property"')),s==="identity"||i.value.stops||P.push(new Ne(i.key,i.value,'missing required property "stops"')),s==="exponential"&&i.valueSpec.expression&&!Yc(i.valueSpec)&&P.push(new Ne(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!Vo(i.valueSpec)?P.push(new Ne(i.key,i.value,"property functions not supported")):w&&!cf(i.valueSpec)&&P.push(new Ne(i.key,i.value,"zoom functions not supported"))),s!=="categorical"&&!C||i.value.property!==void 0||P.push(new Ne(i.key,i.value,'"property" property is required')),P;function M(j){let U=[];const Z=j.value,re=j.key;if(Ht(Z)!=="array")return[new Ne(re,Z,`array expected, ${Ht(Z)} found`)];if(Z.length!==2)return[new Ne(re,Z,`array length 2 expected, length ${Z.length} found`)];if(C){if(Ht(Z[0])!=="object")return[new Ne(re,Z,`object expected, ${Ht(Z[0])} found`)];if(Z[0].zoom===void 0)return[new Ne(re,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new Ne(re,Z,"object stop key must have value")];if(y&&y>Sr(Z[0].zoom))return[new Ne(re,Z[0].zoom,"stop zoom values must appear in ascending order")];Sr(Z[0].zoom)!==y&&(y=Sr(Z[0].zoom),f=void 0,_={}),U=U.concat(Xn({key:`${re}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:th,value:O}}))}else U=U.concat(O({key:`${re}[0]`,value:Z[0],validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},Z));return au(Ri(Z[1]))?U.concat([new Ne(`${re}[1]`,Z[1],"expressions are not allowed in function stops.")]):U.concat(j.validateSpec({key:`${re}[1]`,value:Z[1],valueSpec:r,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function O(j,U){const Z=Ht(j.value),re=Sr(j.value),oe=j.value!==null?j.value:U;if(l){if(Z!==l)return[new Ne(j.key,oe,`${Z} stop domain type must match previous stop domain type ${l}`)]}else l=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new Ne(j.key,oe,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&s!=="categorical"){let xe=`number expected, ${Z} found`;return Vo(r)&&s===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(j.key,oe,xe)]}return s!=="categorical"||Z!=="number"||isFinite(re)&&Math.floor(re)===re?s!=="categorical"&&Z==="number"&&f!==void 0&&re<f?[new Ne(j.key,oe,"stop domain values must appear in ascending order")]:(f=re,s==="categorical"&&re in _?[new Ne(j.key,oe,"stop domain values must be unique")]:(_[re]=!0,[])):[new Ne(j.key,oe,`integer expected, found ${re}`)]}}function Go(i){const r=(i.expressionContext==="property"?Jc:Uo)(Ri(i.value),i.valueSpec);if(r.result==="error")return r.value.map(l=>new Ne(`${i.key}${l.key}`,i.value,l.message));const s=r.value.expression||r.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!s.outputDefined())return[new Ne(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!No(s))return[new Ne(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!No(s))return[new Ne(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!tl(s,["zoom","feature-state"]))return[new Ne(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!el(s))return[new Ne(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fs(i){const r=i.key,s=i.value,l=i.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(Sr(s))===-1&&f.push(new Ne(r,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(l.values).indexOf(Sr(s))===-1&&f.push(new Ne(r,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),f}function rh(i){return lu(Ri(i.value))?Go(li({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):du(i)}function du(i){const r=i.value,s=i.key;if(Ht(r)!=="array")return[new Ne(s,r,`array expected, ${Ht(r)} found`)];const l=i.styleSpec;let f,y=[];if(r.length<1)return[new Ne(s,r,"filter array must have at least 1 element")];switch(y=y.concat(fs({key:`${s}[0]`,value:r[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),Sr(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Sr(r[1])==="$type"&&y.push(new Ne(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&y.push(new Ne(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(f=Ht(r[1]),f!=="string"&&y.push(new Ne(`${s}[1]`,r[1],`string expected, ${f} found`)));for(let _=2;_<r.length;_++)f=Ht(r[_]),Sr(r[1])==="$type"?y=y.concat(fs({key:`${s}[${_}]`,value:r[_],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new Ne(`${s}[${_}]`,r[_],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let _=1;_<r.length;_++)y=y.concat(du({key:`${s}[${_}]`,value:r[_],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Ht(r[1]),r.length!==2?y.push(new Ne(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new Ne(`${s}[1]`,r[1],`string expected, ${f} found`))}return y}function nh(i,r){const s=i.key,l=i.validateSpec,f=i.style,y=i.styleSpec,_=i.value,w=i.objectKey,S=y[`${r}_${i.layerType}`];if(!S)return[];const C=w.match(/^(.*)-transition$/);if(r==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return l({key:s,value:_,valueSpec:y.transition,style:f,styleSpec:y});const P=i.valueSpec||S[w];if(!P)return[new Ne(s,_,`unknown property "${w}"`)];let M;if(Ht(_)==="string"&&Vo(P)&&!P.tokens&&(M=/^{([^}]+)}$/.exec(_)))return[new Ne(s,_,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const O=[];return i.layerType==="symbol"&&(w==="text-field"&&f&&!f.glyphs&&O.push(new Ne(s,_,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&iu(Ri(_))&&Sr(_.type)==="identity"&&O.push(new Ne(s,_,'"text-font" does not support identity functions'))),O.concat(l({key:i.key,value:_,valueSpec:P,style:f,styleSpec:y,expressionContext:"property",propertyType:r,propertyKey:w}))}function fu(i){return nh(i,"paint")}function ih(i){return nh(i,"layout")}function sh(i){let r=[];const s=i.value,l=i.key,f=i.style,y=i.styleSpec;s.type||s.ref||r.push(new Ne(l,s,'either "type" or "ref" is required'));let _=Sr(s.type);const w=Sr(s.ref);if(s.id){const S=Sr(s.id);for(let C=0;C<i.arrayIndex;C++){const P=f.layers[C];Sr(P.id)===S&&r.push(new Ne(l,s.id,`duplicate layer id "${s.id}", previously used at line ${P.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in s&&r.push(new Ne(l,s[C],`"${C}" is prohibited for ref layers`))}),f.layers.forEach(C=>{Sr(C.id)===w&&(S=C)}),S?S.ref?r.push(new Ne(l,s.ref,"ref cannot reference another ref layer")):_=Sr(S.type):r.push(new Ne(l,s.ref,`ref layer "${w}" not found`))}else if(_!=="background")if(s.source){const S=f.sources&&f.sources[s.source],C=S&&Sr(S.type);S?C==="vector"&&_==="raster"?r.push(new Ne(l,s.source,`layer "${s.id}" requires a raster source`)):C!=="raster-dem"&&_==="hillshade"?r.push(new Ne(l,s.source,`layer "${s.id}" requires a raster-dem source`)):C==="raster"&&_!=="raster"?r.push(new Ne(l,s.source,`layer "${s.id}" requires a vector source`)):C!=="vector"||s["source-layer"]?C==="raster-dem"&&_!=="hillshade"?r.push(new Ne(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!s.paint||!s.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||r.push(new Ne(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Ne(l,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new Ne(l,s.source,`source "${s.source}" not found`))}else r.push(new Ne(l,s,'missing required property "source"'));return r=r.concat(Xn({key:l,value:s,valueSpec:y.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:s.type,valueSpec:y.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:s,objectKey:"type"}),filter:rh,layout:S=>Xn({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>ih(li({layerType:_},C))}}),paint:S=>Xn({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>fu(li({layerType:_},C))}})}})),r}function uo(i){const r=i.value,s=i.key,l=Ht(r);return l!=="string"?[new Ne(s,r,`string expected, ${l} found`)]:[]}const pu={promoteId:function({key:i,value:r}){if(Ht(r)==="string")return uo({key:i,value:r});{const s=[];for(const l in r)s.push(...uo({key:`${i}.${l}`,value:r[l]}));return s}}};function ol(i){const r=i.value,s=i.key,l=i.styleSpec,f=i.style,y=i.validateSpec;if(!r.type)return[new Ne(s,r,'"type" is required')];const _=Sr(r.type);let w;switch(_){case"vector":case"raster":return w=Xn({key:s,value:r,valueSpec:l[`source_${_.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:pu,validateSpec:y}),w;case"raster-dem":return w=function(S){var C;const P=(C=S.sourceName)!==null&&C!==void 0?C:"",M=S.value,O=S.styleSpec,j=O.source_raster_dem,U=S.style;let Z=[];const re=Ht(M);if(M===void 0)return Z;if(re!=="object")return Z.push(new Ne("source_raster_dem",M,`object expected, ${re} found`)),Z;const oe=Sr(M.encoding)==="custom",xe=["redFactor","greenFactor","blueFactor","baseShift"],pe=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const ve in M)!oe&&xe.includes(ve)?Z.push(new Ne(ve,M[ve],`In "${P}": "${ve}" is only valid when "encoding" is set to "custom". ${pe} encoding found`)):j[ve]?Z=Z.concat(S.validateSpec({key:ve,value:M[ve],valueSpec:j[ve],validateSpec:S.validateSpec,style:U,styleSpec:O})):Z.push(new Ne(ve,M[ve],`unknown property "${ve}"`));return Z}({sourceName:s,value:r,style:i.style,styleSpec:l,validateSpec:y}),w;case"geojson":if(w=Xn({key:s,value:r,valueSpec:l.source_geojson,style:f,styleSpec:l,validateSpec:y,objectElementValidators:pu}),r.cluster)for(const S in r.clusterProperties){const[C,P]=r.clusterProperties[S],M=typeof C=="string"?[C,["accumulated"],["get",S]]:C;w.push(...Go({key:`${s}.${S}.map`,value:P,expressionContext:"cluster-map"})),w.push(...Go({key:`${s}.${S}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return w;case"video":return Xn({key:s,value:r,valueSpec:l.source_video,style:f,validateSpec:y,styleSpec:l});case"image":return Xn({key:s,value:r,valueSpec:l.source_image,style:f,validateSpec:y,styleSpec:l});case"canvas":return[new Ne(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fs({key:`${s}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function oh(i){const r=i.value,s=i.styleSpec,l=s.light,f=i.style;let y=[];const _=Ht(r);if(r===void 0)return y;if(_!=="object")return y=y.concat([new Ne("light",r,`object expected, ${_} found`)]),y;for(const w in r){const S=w.match(/^(.*)-transition$/);y=y.concat(S&&l[S[1]]&&l[S[1]].transition?i.validateSpec({key:w,value:r[w],valueSpec:s.transition,validateSpec:i.validateSpec,style:f,styleSpec:s}):l[w]?i.validateSpec({key:w,value:r[w],valueSpec:l[w],validateSpec:i.validateSpec,style:f,styleSpec:s}):[new Ne(w,r[w],`unknown property "${w}"`)])}return y}function ah(i){const r=i.value,s=i.styleSpec,l=s.sky,f=i.style,y=Ht(r);if(r===void 0)return[];if(y!=="object")return[new Ne("sky",r,`object expected, ${y} found`)];let _=[];for(const w in r)_=_.concat(l[w]?i.validateSpec({key:w,value:r[w],valueSpec:l[w],style:f,styleSpec:s}):[new Ne(w,r[w],`unknown property "${w}"`)]);return _}function lh(i){const r=i.value,s=i.styleSpec,l=s.terrain,f=i.style;let y=[];const _=Ht(r);if(r===void 0)return y;if(_!=="object")return y=y.concat([new Ne("terrain",r,`object expected, ${_} found`)]),y;for(const w in r)y=y.concat(l[w]?i.validateSpec({key:w,value:r[w],valueSpec:l[w],validateSpec:i.validateSpec,style:f,styleSpec:s}):[new Ne(w,r[w],`unknown property "${w}"`)]);return y}function uh(i){let r=[];const s=i.value,l=i.key;if(Array.isArray(s)){const f=[],y=[];for(const _ in s)s[_].id&&f.includes(s[_].id)&&r.push(new Ne(l,s,`all the sprites' ids must be unique, but ${s[_].id} is duplicated`)),f.push(s[_].id),s[_].url&&y.includes(s[_].url)&&r.push(new Ne(l,s,`all the sprites' URLs must be unique, but ${s[_].url} is duplicated`)),y.push(s[_].url),r=r.concat(Xn({key:`${l}[${_}]`,value:s[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return r}return uo({key:l,value:s})}const mu={"*":()=>[],array:sl,boolean:function(i){const r=i.value,s=i.key,l=Ht(r);return l!=="boolean"?[new Ne(s,r,`boolean expected, ${l} found`)]:[]},number:th,color:function(i){const r=i.key,s=i.value,l=Ht(s);return l!=="string"?[new Ne(r,s,`color expected, ${l} found`)]:er.parse(String(s))?[]:[new Ne(r,s,`color expected, "${s}" found`)]},constants:yf,enum:fs,filter:rh,function:hu,layer:sh,object:Xn,source:ol,light:oh,sky:ah,terrain:lh,projection:function(i){const r=i.value,s=i.styleSpec,l=s.projection,f=i.style,y=Ht(r);if(r===void 0)return[];if(y!=="object")return[new Ne("projection",r,`object expected, ${y} found`)];let _=[];for(const w in r)_=_.concat(l[w]?i.validateSpec({key:w,value:r[w],valueSpec:l[w],style:f,styleSpec:s}):[new Ne(w,r[w],`unknown property "${w}"`)]);return _},string:uo,formatted:function(i){return uo(i).length===0?[]:Go(i)},resolvedImage:function(i){return uo(i).length===0?[]:Go(i)},padding:function(i){const r=i.key,s=i.value;if(Ht(s)==="array"){if(s.length<1||s.length>4)return[new Ne(r,s,`padding requires 1 to 4 values; ${s.length} values found`)];const l={type:"number"};let f=[];for(let y=0;y<s.length;y++)f=f.concat(i.validateSpec({key:`${r}[${y}]`,value:s[y],validateSpec:i.validateSpec,valueSpec:l}));return f}return th({key:r,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const r=i.key,s=i.value,l=Ht(s),f=i.styleSpec;if(l!=="array"||s.length<1||s.length%2!=0)return[new Ne(r,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let _=0;_<s.length;_+=2)y=y.concat(fs({key:`${r}[${_}]`,value:s[_],valueSpec:f.layout_symbol["text-anchor"]})),y=y.concat(sl({key:`${r}[${_+1}]`,value:s[_+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:f}));return y},sprite:uh};function al(i){const r=i.value,s=i.valueSpec,l=i.styleSpec;return i.validateSpec=al,s.expression&&iu(Sr(r))?hu(i):s.expression&&au(Ri(r))?Go(i):s.type&&mu[s.type]?mu[s.type](i):Xn(li({},i,{valueSpec:s.type?l[s.type]:s}))}function _f(i){const r=i.value,s=i.key,l=uo(i);return l.length||(r.indexOf("{fontstack}")===-1&&l.push(new Ne(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&l.push(new Ne(s,r,'"glyphs" url must include a "{range}" token'))),l}function fi(i,r=Te){let s=[];return s=s.concat(al({key:"",value:i,valueSpec:r.$root,styleSpec:r,style:i,validateSpec:al,objectElementValidators:{glyphs:_f,"*":()=>[]}})),i.constants&&(s=s.concat(yf({key:"constants",value:i.constants}))),ch(s)}function es(i){return function(r){return i({...r,validateSpec:al})}}function ch(i){return[].concat(i).sort((r,s)=>r.line-s.line)}function Li(i){return function(...r){return ch(i.apply(this,r))}}fi.source=Li(es(ol)),fi.sprite=Li(es(uh)),fi.glyphs=Li(es(_f)),fi.light=Li(es(oh)),fi.sky=Li(es(ah)),fi.terrain=Li(es(lh)),fi.layer=Li(es(sh)),fi.filter=Li(es(rh)),fi.paintProperty=Li(es(fu)),fi.layoutProperty=Li(es(ih));const co=fi,ag=co.light,lg=co.sky,vf=co.paintProperty,xf=co.layoutProperty;function hh(i,r){let s=!1;if(r&&r.length)for(const l of r)i.fire(new Un(new Error(l.message))),s=!0;return s}class Wo{constructor(r,s,l){const f=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const _=new Int32Array(this.arrayBuffer);r=_[0],this.d=(s=_[1])+2*(l=_[2]);for(let S=0;S<this.d*this.d;S++){const C=_[3+S],P=_[3+S+1];f.push(C===P?null:_.subarray(C,P))}const w=_[3+f.length+1];this.keys=_.subarray(_[3+f.length],w),this.bboxes=_.subarray(w),this.insert=this._insertReadonly}else{this.d=s+2*l;for(let _=0;_<this.d*this.d;_++)f.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=r,this.padding=l,this.scale=s/r,this.uid=0;const y=l/s*r;this.min=-y,this.max=r+y}insert(r,s,l,f,y){this._forEachCell(s,l,f,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,s,l,f,y,_){this.cells[y].push(_)}query(r,s,l,f,y){const _=this.min,w=this.max;if(r<=_&&s<=_&&w<=l&&w<=f&&!y)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(r,s,l,f,this._queryCell,S,{},y),S}}_queryCell(r,s,l,f,y,_,w,S){const C=this.cells[y];if(C!==null){const P=this.keys,M=this.bboxes;for(let O=0;O<C.length;O++){const j=C[O];if(w[j]===void 0){const U=4*j;(S?S(M[U+0],M[U+1],M[U+2],M[U+3]):r<=M[U+2]&&s<=M[U+3]&&l>=M[U+0]&&f>=M[U+1])?(w[j]=!0,_.push(P[j])):w[j]=!1}}}}_forEachCell(r,s,l,f,y,_,w,S){const C=this._convertToCellCoord(r),P=this._convertToCellCoord(s),M=this._convertToCellCoord(l),O=this._convertToCellCoord(f);for(let j=C;j<=M;j++)for(let U=P;U<=O;U++){const Z=this.d*U+j;if((!S||S(this._convertFromCellCoord(j),this._convertFromCellCoord(U),this._convertFromCellCoord(j+1),this._convertFromCellCoord(U+1)))&&y.call(this,r,s,l,f,Z,_,w,S))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,s=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const f=new Int32Array(s+l+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let y=s;for(let _=0;_<r.length;_++){const w=r[_];f[3+_]=y,f.set(w,y),y+=w.length}return f[3+r.length]=y,f.set(this.keys,y),y+=this.keys.length,f[3+r.length+1]=y,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer}static serialize(r,s){const l=r.toArrayBuffer();return s&&s.push(l),{buffer:l}}static deserialize(r){return new Wo(r.buffer)}}const pi={};function nt(i,r,s={}){if(pi[i])throw new Error(`${i} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:i,writeable:!1}),pi[i]={klass:r,omit:s.omit||[],shallow:s.shallow||[]}}nt("Object",Object),nt("TransferableGridIndex",Wo),nt("Color",er),nt("Error",Error),nt("AJAXError",zt),nt("ResolvedImage",Wn),nt("StylePropertyFunction",Ho),nt("StyleExpression",ou,{omit:["_evaluator"]}),nt("ZoomDependentExpression",Zo),nt("ZoomConstantExpression",qo),nt("CompoundExpression",di,{omit:["_evaluate"]});for(const i in Bo)Bo[i]._classRegistryKey||nt(`Expression_${i}`,Bo[i]);function gu(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function dh(i){return i.$name||i.constructor._classRegistryKey}function wf(i){return!function(r){if(r===null||typeof r!="object")return!1;const s=dh(r);return!(!s||s==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||gu(i)||wt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function Xo(i,r){if(wf(i))return(gu(i)||wt(i))&&r&&r.push(i),ArrayBuffer.isView(i)&&r&&r.push(i.buffer),i instanceof ImageData&&r&&r.push(i.data.buffer),i;if(Array.isArray(i)){const y=[];for(const _ of i)y.push(Xo(_,r));return y}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const s=dh(i);if(!s)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!pi[s])throw new Error(`${s} is not registered.`);const{klass:l}=pi[s],f=l.serialize?l.serialize(i,r):{};if(l.serialize){if(r&&f===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in i){if(!i.hasOwnProperty(y)||pi[s].omit.indexOf(y)>=0)continue;const _=i[y];f[y]=pi[s].shallow.indexOf(y)>=0?_:Xo(_,r)}i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(f.$name=s),f}function Ko(i){if(wf(i))return i;if(Array.isArray(i))return i.map(Ko);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const r=dh(i)||"Object";if(!pi[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:s}=pi[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(i);const l=Object.create(s.prototype);for(const f of Object.keys(i)){if(f==="$name")continue;const y=i[f];l[f]=pi[r].shallow.indexOf(f)>=0?y:Ko(y)}return l}class fh{constructor(){this.first=!0}update(r,s){const l=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=s),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=l,!0))}}const Vt={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function ph(i){for(const r of i)if(gh(r.charCodeAt(0)))return!0;return!1}function ug(i){for(const r of i)if(!Yo(r.charCodeAt(0)))return!1;return!0}function mh(i){const r=i.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(r.join("|"),"u")}const cg=mh(["Arab","Dupl","Mong","Ougr","Syrc"]);function Yo(i){return!cg.test(String.fromCodePoint(i))}const bf=mh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function gh(i){return!(i!==746&&i!==747&&(i<4352||!(Vt["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Vt["CJK Compatibility"](i)||Vt["CJK Strokes"](i)||!(!Vt["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Vt["Enclosed CJK Letters and Months"](i)||Vt["Ideographic Description Characters"](i)||Vt.Kanbun(i)||Vt.Katakana(i)&&i!==12540||!(!Vt["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Vt["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Vt["Vertical Forms"](i)||Vt["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||bf.test(String.fromCodePoint(i)))))}function Sf(i){return!(gh(i)||function(r){return!!(Vt["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Vt["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Vt["Letterlike Symbols"](r)||Vt["Number Forms"](r)||Vt["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Vt["Control Pictures"](r)&&r!==9251||Vt["Optical Character Recognition"](r)||Vt["Enclosed Alphanumerics"](r)||Vt["Geometric Shapes"](r)||Vt["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Vt["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Vt["CJK Symbols and Punctuation"](r)||Vt.Katakana(r)||Vt["Private Use Area"](r)||Vt["CJK Compatibility Forms"](r)||Vt["Small Form Variants"](r)||Vt["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(i))}const hg=mh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function yh(i){return hg.test(String.fromCodePoint(i))}function dg(i,r){return!(!r&&yh(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Vt.Khmer(i))}function fg(i){for(const r of i)if(yh(r.charCodeAt(0)))return!0;return!1}const Kn=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ur{constructor(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new fh,this.transition={})}isSupportedScript(r){return function(s,l){for(const f of s)if(!dg(f.charCodeAt(0),l))return!1;return!0}(r,Kn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,s=r-Math.floor(r),l=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*s}}}class Jo{constructor(r,s){this.property=r,this.value=s,this.expression=function(l,f){if(iu(l))return new Ho(l,f);if(au(l)){const y=Jc(l,f);if(y.result==="error")throw new Error(y.value.map(_=>`${_.key}: ${_.message}`).join(", "));return y.value}{let y=l;return f.type==="color"&&typeof l=="string"?y=er.parse(l):f.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(y=hi.parse(l)):y=Gn.parse(l),{kind:"constant",evaluate:()=>y}}}(s===void 0?r.specification.default:s,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,s,l){return this.property.possiblyEvaluate(this,r,s,l)}}class yu{constructor(r){this.property=r,this.value=new Jo(r,void 0)}transitioned(r,s){return new Tf(this.property,this.value,s,Pe({},r.transition,this.transition),r.now)}untransitioned(){return new Tf(this.property,this.value,null,{},0)}}class _u{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return qe(this._values[r].value.value)}setValue(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new yu(this._values[r].property)),this._values[r].value=new Jo(this._values[r].property,s===null?void 0:qe(s))}getTransition(r){return qe(this._values[r].transition)}setTransition(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new yu(this._values[r].property)),this._values[r].transition=qe(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(r[s]=l);const f=this.getTransition(s);f!==void 0&&(r[`${s}-transition`]=f)}return r}transitioned(r,s){const l=new ll(this._properties);for(const f of Object.keys(this._values))l._values[f]=this._values[f].transitioned(r,s._values[f]);return l}untransitioned(){const r=new ll(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class Tf{constructor(r,s,l,f,y){this.property=r,this.value=s,this.begin=y+f.delay||0,this.end=this.begin+f.duration||0,r.specification.transition&&(f.delay||f.duration)&&(this.prior=l)}possiblyEvaluate(r,s,l){const f=r.now||0,y=this.value.possiblyEvaluate(r,s,l),_=this.prior;if(_){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return _.possiblyEvaluate(r,s,l);{const w=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(r,s,l),y,function(S){if(S<=0)return 0;if(S>=1)return 1;const C=S*S,P=C*S;return 4*(S<.5?P:3*(S-C)+P-.75)}(w))}}return y}}class ll{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,l){const f=new cl(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(r,s,l);return f}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class ul{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return qe(this._values[r].value)}setValue(r,s){this._values[r]=new Jo(this._values[r].property,s===null?void 0:qe(s))}serialize(){const r={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(r[s]=l)}return r}possiblyEvaluate(r,s,l){const f=new cl(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(r,s,l);return f}}class ts{constructor(r,s,l){this.property=r,this.value=s,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,l,f){return this.property.evaluate(this.value,this.parameters,r,s,l,f)}}class cl{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class at{constructor(r){this.specification=r}possiblyEvaluate(r,s){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(s)}interpolate(r,s,l){const f=An[this.specification.type];return f?f(r,s,l):r}}class _t{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,l,f){return new ts(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},l,f)}:r.expression,s)}interpolate(r,s,l){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new ts(this,{kind:"constant",value:void 0},r.parameters);const f=An[this.specification.type];if(f){const y=f(r.value.value,s.value.value,l);return new ts(this,{kind:"constant",value:y},r.parameters)}return r}evaluate(r,s,l,f,y,_){return r.kind==="constant"?r.value:r.evaluate(s,l,f,y,_)}}class vu extends _t{possiblyEvaluate(r,s,l,f){if(r.value===void 0)return new ts(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){const y=r.expression.evaluate(s,null,{},l,f),_=r.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,w=this._calculate(_,_,_,s);return new ts(this,{kind:"constant",value:w},s)}if(r.expression.kind==="camera"){const y=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new ts(this,{kind:"constant",value:y},s)}return new ts(this,r.expression,s)}evaluate(r,s,l,f,y,_){if(r.kind==="source"){const w=r.evaluate(s,l,f,y,_);return this._calculate(w,w,w,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},l,f),r.evaluate({zoom:Math.floor(s.zoom)},l,f),r.evaluate({zoom:Math.floor(s.zoom)+1},l,f),s):r.value}_calculate(r,s,l,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:l,to:s}}interpolate(r){return r}}class xu{constructor(r){this.specification=r}possiblyEvaluate(r,s,l,f){if(r.value!==void 0){if(r.expression.kind==="constant"){const y=r.expression.evaluate(s,null,{},l,f);return this._calculate(y,y,y,s)}return this._calculate(r.expression.evaluate(new ur(Math.floor(s.zoom-1),s)),r.expression.evaluate(new ur(Math.floor(s.zoom),s)),r.expression.evaluate(new ur(Math.floor(s.zoom+1),s)),s)}}_calculate(r,s,l,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:l,to:s}}interpolate(r){return r}}class _h{constructor(r){this.specification=r}possiblyEvaluate(r,s,l,f){return!!r.expression.evaluate(s,null,{},l,f)}interpolate(){return!1}}class g{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in r){const l=r[s];l.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new Jo(l,void 0),y=this.defaultTransitionablePropertyValues[s]=new yu(l);this.defaultTransitioningPropertyValues[s]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate({})}}}nt("DataDrivenProperty",_t),nt("DataConstantProperty",at),nt("CrossFadedDataDrivenProperty",vu),nt("CrossFadedProperty",xu),nt("ColorRampProperty",_h);const t="-transition";class a extends Yi{constructor(r,s){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),s.layout&&(this._unevaluatedLayout=new ul(s.layout)),s.paint)){this._transitionablePaint=new _u(s.paint);for(const l in r.paint)this.setPaintProperty(l,r.paint[l],{validate:!1});for(const l in r.layout)this.setLayoutProperty(l,r.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new cl(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,s,l={}){s!=null&&this._validate(xf,`layers.${this.id}.layout.${r}`,r,s,l)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)}getPaintProperty(r){return r.endsWith(t)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s,l={}){if(s!=null&&this._validate(vf,`layers.${this.id}.paint.${r}`,r,s,l))return!1;if(r.endsWith(t))return this._transitionablePaint.setTransition(r.slice(0,-11),s||void 0),!1;{const f=this._transitionablePaint._values[r],y=f.property.specification["property-type"]==="cross-faded-data-driven",_=f.value.isDataDriven(),w=f.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);const S=this._transitionablePaint._values[r].value;return S.isDataDriven()||_||y||this._handleOverridablePaintPropertyUpdate(r,w,S)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,s,l){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Be(r,(s,l)=>!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length))}_validate(r,s,l,f,y={}){return(!y||y.validate!==!1)&&hh(this,r.call(co,{key:s,layerType:this.type,objectKey:l,value:f,styleSpec:Te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof ts&&Vo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const h={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class d{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class m{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function b(i,r=1){let s=0,l=0;return{members:i.map(f=>{const y=h[f.type].BYTES_PER_ELEMENT,_=s=T(s,Math.max(r,y)),w=f.components||1;return l=Math.max(l,y),s+=y*w,{name:f.name,type:f.type,components:w,offset:_}}),size:T(s,Math.max(l,r)),alignment:r}}function T(i,r){return Math.ceil(i/r)*r}class E extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const l=this.length;return this.resize(l+1),this.emplace(l,r,s)}emplace(r,s,l){const f=2*r;return this.int16[f+0]=s,this.int16[f+1]=l,r}}E.prototype.bytesPerElement=4,nt("StructArrayLayout2i4",E);class I extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,l)}emplace(r,s,l,f){const y=3*r;return this.int16[y+0]=s,this.int16[y+1]=l,this.int16[y+2]=f,r}}I.prototype.bytesPerElement=6,nt("StructArrayLayout3i6",I);class z extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,f){const y=this.length;return this.resize(y+1),this.emplace(y,r,s,l,f)}emplace(r,s,l,f,y){const _=4*r;return this.int16[_+0]=s,this.int16[_+1]=l,this.int16[_+2]=f,this.int16[_+3]=y,r}}z.prototype.bytesPerElement=8,nt("StructArrayLayout4i8",z);class D extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,f,y,_)}emplace(r,s,l,f,y,_,w){const S=6*r;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=f,this.int16[S+3]=y,this.int16[S+4]=_,this.int16[S+5]=w,r}}D.prototype.bytesPerElement=12,nt("StructArrayLayout2i4i12",D);class V extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,f,y,_)}emplace(r,s,l,f,y,_,w){const S=4*r,C=8*r;return this.int16[S+0]=s,this.int16[S+1]=l,this.uint8[C+4]=f,this.uint8[C+5]=y,this.uint8[C+6]=_,this.uint8[C+7]=w,r}}V.prototype.bytesPerElement=8,nt("StructArrayLayout2i4ub8",V);class H extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const l=this.length;return this.resize(l+1),this.emplace(l,r,s)}emplace(r,s,l){const f=2*r;return this.float32[f+0]=s,this.float32[f+1]=l,r}}H.prototype.bytesPerElement=8,nt("StructArrayLayout2f8",H);class Y extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_,w,S,C,P){const M=this.length;return this.resize(M+1),this.emplace(M,r,s,l,f,y,_,w,S,C,P)}emplace(r,s,l,f,y,_,w,S,C,P,M){const O=10*r;return this.uint16[O+0]=s,this.uint16[O+1]=l,this.uint16[O+2]=f,this.uint16[O+3]=y,this.uint16[O+4]=_,this.uint16[O+5]=w,this.uint16[O+6]=S,this.uint16[O+7]=C,this.uint16[O+8]=P,this.uint16[O+9]=M,r}}Y.prototype.bytesPerElement=20,nt("StructArrayLayout10ui20",Y);class ne extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_,w,S,C,P,M,O){const j=this.length;return this.resize(j+1),this.emplace(j,r,s,l,f,y,_,w,S,C,P,M,O)}emplace(r,s,l,f,y,_,w,S,C,P,M,O,j){const U=12*r;return this.int16[U+0]=s,this.int16[U+1]=l,this.int16[U+2]=f,this.int16[U+3]=y,this.uint16[U+4]=_,this.uint16[U+5]=w,this.uint16[U+6]=S,this.uint16[U+7]=C,this.int16[U+8]=P,this.int16[U+9]=M,this.int16[U+10]=O,this.int16[U+11]=j,r}}ne.prototype.bytesPerElement=24,nt("StructArrayLayout4i4ui4i24",ne);class ae extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,l)}emplace(r,s,l,f){const y=3*r;return this.float32[y+0]=s,this.float32[y+1]=l,this.float32[y+2]=f,r}}ae.prototype.bytesPerElement=12,nt("StructArrayLayout3f12",ae);class ce extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}ce.prototype.bytesPerElement=4,nt("StructArrayLayout1ul4",ce);class fe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_,w,S,C){const P=this.length;return this.resize(P+1),this.emplace(P,r,s,l,f,y,_,w,S,C)}emplace(r,s,l,f,y,_,w,S,C,P){const M=10*r,O=5*r;return this.int16[M+0]=s,this.int16[M+1]=l,this.int16[M+2]=f,this.int16[M+3]=y,this.int16[M+4]=_,this.int16[M+5]=w,this.uint32[O+3]=S,this.uint16[M+8]=C,this.uint16[M+9]=P,r}}fe.prototype.bytesPerElement=20,nt("StructArrayLayout6i1ul2ui20",fe);class te extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,f,y,_)}emplace(r,s,l,f,y,_,w){const S=6*r;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=f,this.int16[S+3]=y,this.int16[S+4]=_,this.int16[S+5]=w,r}}te.prototype.bytesPerElement=12,nt("StructArrayLayout2i2i2i12",te);class ge extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,l,f,y)}emplace(r,s,l,f,y,_){const w=4*r,S=8*r;return this.float32[w+0]=s,this.float32[w+1]=l,this.float32[w+2]=f,this.int16[S+6]=y,this.int16[S+7]=_,r}}ge.prototype.bytesPerElement=16,nt("StructArrayLayout2f1f2i16",ge);class _e extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,f,y,_)}emplace(r,s,l,f,y,_,w){const S=16*r,C=4*r,P=8*r;return this.uint8[S+0]=s,this.uint8[S+1]=l,this.float32[C+1]=f,this.float32[C+2]=y,this.int16[P+6]=_,this.int16[P+7]=w,r}}_e.prototype.bytesPerElement=16,nt("StructArrayLayout2ub2f2i16",_e);class we extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,l)}emplace(r,s,l,f){const y=3*r;return this.uint16[y+0]=s,this.uint16[y+1]=l,this.uint16[y+2]=f,r}}we.prototype.bytesPerElement=6,nt("StructArrayLayout3ui6",we);class Me extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_,w,S,C,P,M,O,j,U,Z,re,oe){const xe=this.length;return this.resize(xe+1),this.emplace(xe,r,s,l,f,y,_,w,S,C,P,M,O,j,U,Z,re,oe)}emplace(r,s,l,f,y,_,w,S,C,P,M,O,j,U,Z,re,oe,xe){const pe=24*r,ve=12*r,Ce=48*r;return this.int16[pe+0]=s,this.int16[pe+1]=l,this.uint16[pe+2]=f,this.uint16[pe+3]=y,this.uint32[ve+2]=_,this.uint32[ve+3]=w,this.uint32[ve+4]=S,this.uint16[pe+10]=C,this.uint16[pe+11]=P,this.uint16[pe+12]=M,this.float32[ve+7]=O,this.float32[ve+8]=j,this.uint8[Ce+36]=U,this.uint8[Ce+37]=Z,this.uint8[Ce+38]=re,this.uint32[ve+10]=oe,this.int16[pe+22]=xe,r}}Me.prototype.bytesPerElement=48,nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Me);class Oe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l,f,y,_,w,S,C,P,M,O,j,U,Z,re,oe,xe,pe,ve,Ce,Le,Qe,gt,Ke,We,ct,it){const rt=this.length;return this.resize(rt+1),this.emplace(rt,r,s,l,f,y,_,w,S,C,P,M,O,j,U,Z,re,oe,xe,pe,ve,Ce,Le,Qe,gt,Ke,We,ct,it)}emplace(r,s,l,f,y,_,w,S,C,P,M,O,j,U,Z,re,oe,xe,pe,ve,Ce,Le,Qe,gt,Ke,We,ct,it,rt){const Ie=32*r,ht=16*r;return this.int16[Ie+0]=s,this.int16[Ie+1]=l,this.int16[Ie+2]=f,this.int16[Ie+3]=y,this.int16[Ie+4]=_,this.int16[Ie+5]=w,this.int16[Ie+6]=S,this.int16[Ie+7]=C,this.uint16[Ie+8]=P,this.uint16[Ie+9]=M,this.uint16[Ie+10]=O,this.uint16[Ie+11]=j,this.uint16[Ie+12]=U,this.uint16[Ie+13]=Z,this.uint16[Ie+14]=re,this.uint16[Ie+15]=oe,this.uint16[Ie+16]=xe,this.uint16[Ie+17]=pe,this.uint16[Ie+18]=ve,this.uint16[Ie+19]=Ce,this.uint16[Ie+20]=Le,this.uint16[Ie+21]=Qe,this.uint16[Ie+22]=gt,this.uint32[ht+12]=Ke,this.float32[ht+13]=We,this.float32[ht+14]=ct,this.uint16[Ie+30]=it,this.uint16[Ie+31]=rt,r}}Oe.prototype.bytesPerElement=64,nt("StructArrayLayout8i15ui1ul2f2ui64",Oe);class Xe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}Xe.prototype.bytesPerElement=4,nt("StructArrayLayout1f4",Xe);class tt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,l)}emplace(r,s,l,f){const y=3*r;return this.uint16[6*r+0]=s,this.float32[y+1]=l,this.float32[y+2]=f,r}}tt.prototype.bytesPerElement=12,nt("StructArrayLayout1ui2f12",tt);class Ze extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,s,l)}emplace(r,s,l,f){const y=4*r;return this.uint32[2*r+0]=s,this.uint16[y+2]=l,this.uint16[y+3]=f,r}}Ze.prototype.bytesPerElement=8,nt("StructArrayLayout1ul2ui8",Ze);class Ue extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const l=this.length;return this.resize(l+1),this.emplace(l,r,s)}emplace(r,s,l){const f=2*r;return this.uint16[f+0]=s,this.uint16[f+1]=l,r}}Ue.prototype.bytesPerElement=4,nt("StructArrayLayout2ui4",Ue);class lt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}lt.prototype.bytesPerElement=2,nt("StructArrayLayout1ui2",lt);class Et extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l,f){const y=this.length;return this.resize(y+1),this.emplace(y,r,s,l,f)}emplace(r,s,l,f,y){const _=4*r;return this.float32[_+0]=s,this.float32[_+1]=l,this.float32[_+2]=f,this.float32[_+3]=y,r}}Et.prototype.bytesPerElement=16,nt("StructArrayLayout4f16",Et);class Ge extends d{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new R(this.anchorPointX,this.anchorPointY)}}Ge.prototype.size=20;class Je extends fe{get(r){return new Ge(this,r)}}nt("CollisionBoxArray",Je);class St extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}St.prototype.size=48;class cr extends Me{get(r){return new St(this,r)}}nt("PlacedSymbolArray",cr);class Dt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Dt.prototype.size=64;class Nt extends Oe{get(r){return new Dt(this,r)}}nt("SymbolInstanceArray",Nt);class hr extends Xe{getoffsetX(r){return this.float32[1*r+0]}}nt("GlyphOffsetArray",hr);class ln extends I{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}nt("SymbolLineVertexArray",ln);class Fi extends d{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Fi.prototype.size=12;class dr extends tt{get(r){return new Fi(this,r)}}nt("TextAnchorOffsetArray",dr);class zn extends d{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}zn.prototype.size=8;class xn extends Ze{get(r){return new zn(this,r)}}nt("FeatureIndexArray",xn);class un extends E{}class wn extends E{}class rs extends E{}class Qo extends D{}class wu extends V{}class ea extends H{}class mi extends Y{}class bu extends ne{}class vh extends ae{}class gi extends ce{}class yi extends te{}class Ls extends _e{}class Oi extends we{}class Jr extends Ue{}const cn=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yn}=cn;class $t{constructor(r=[]){this.segments=r}prepareSegment(r,s,l,f){let y=this.segments[this.segments.length-1];return r>$t.MAX_VERTEX_ARRAY_LENGTH&&xt(`Max vertices per segment is ${$t.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!y||y.vertexLength+r>$t.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:s.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},f!==void 0&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,l,f){return new $t([{vertexOffset:r,primitiveOffset:s,vertexLength:l,primitiveLength:f,vaos:{},sortKey:0}])}}function ho(i,r){return 256*(i=be(Math.floor(i),0,255))+be(Math.floor(r),0,255)}$t.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nt("SegmentVector",$t);const ta=b([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ra={exports:{}},Ef={exports:{}};Ef.exports=function(i,r){var s,l,f,y,_,w,S,C;for(l=i.length-(s=3&i.length),f=r,_=3432918353,w=461845907,C=0;C<l;)S=255&i.charCodeAt(C)|(255&i.charCodeAt(++C))<<8|(255&i.charCodeAt(++C))<<16|(255&i.charCodeAt(++C))<<24,++C,f=27492+(65535&(y=5*(65535&(f=(f^=S=(65535&(S=(S=(65535&S)*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(S=0,s){case 3:S^=(255&i.charCodeAt(C+2))<<16;case 2:S^=(255&i.charCodeAt(C+1))<<8;case 1:f^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(C)))*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var pg=Ef.exports,Cf={exports:{}};Cf.exports=function(i,r){for(var s,l=i.length,f=r^l,y=0;l>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),l-=4,++y;switch(l){case 3:f^=(255&i.charCodeAt(y+2))<<16;case 2:f^=(255&i.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Fs=pg,kf=Cf.exports;ra.exports=Fs,ra.exports.murmur3=Fs,ra.exports.murmur2=kf;var Su=k(ra.exports);class hl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,s,l,f){this.ids.push(Tu(r)),this.positions.push(s,l,f)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Tu(r);let l=0,f=this.ids.length-1;for(;l<f;){const _=l+f>>1;this.ids[_]>=s?f=_:l=_+1}const y=[];for(;this.ids[l]===s;)y.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return y}static serialize(r,s){const l=new Float64Array(r.ids),f=new Uint32Array(r.positions);return Eu(l,f,0,l.length-1),s&&s.push(l.buffer,f.buffer),{ids:l,positions:f}}static deserialize(r){const s=new hl;return s.ids=r.ids,s.positions=r.positions,s.indexed=!0,s}}function Tu(i){const r=+i;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Su(String(i))}function Eu(i,r,s,l){for(;s<l;){const f=i[s+l>>1];let y=s-1,_=l+1;for(;;){do y++;while(i[y]<f);do _--;while(i[_]>f);if(y>=_)break;na(i,y,_),na(r,3*y,3*_),na(r,3*y+1,3*_+1),na(r,3*y+2,3*_+2)}_-s<l-_?(Eu(i,r,s,_),s=_+1):(Eu(i,r,_+1,l),l=_)}}function na(i,r,s){const l=i[r];i[r]=i[s],i[s]=l}nt("FeaturePositionMap",hl);class dl{constructor(r,s){this.gl=r.gl,this.location=s}}class Pf extends dl{constructor(r,s){super(r,s),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class vx extends dl{constructor(r,s){super(r,s),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class xx extends dl{constructor(r,s){super(r,s),this.current=er.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const fE=new Float32Array(16);function mg(i){return[ho(255*i.r,255*i.g),ho(255*i.b,255*i.a)]}class xh{constructor(r,s,l){this.value=r,this.uniformNames=s.map(f=>`u_${f}`),this.type=l}setUniform(r,s,l){r.set(l.constantOr(this.value))}getBinding(r,s,l){return this.type==="color"?new xx(r,s):new Pf(r,s)}}class Cu{constructor(r,s){this.uniformNames=s.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=r.tlbr}setUniform(r,s,l,f){const y=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&r.set(y)}getBinding(r,s,l){return l.substr(0,9)==="u_pattern"?new vx(r,s):new Pf(r,s)}}class fo{constructor(r,s,l,f){this.expression=r,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(r,s,l,f,y){const _=this.paintVertexArray.length,w=this.expression.evaluate(new ur(0),s,{},f,[],y);this.paintVertexArray.resize(r),this._setPaintValue(_,r,w)}updatePaintArray(r,s,l,f){const y=this.expression.evaluate({zoom:0},l,f);this._setPaintValue(r,s,y)}_setPaintValue(r,s,l){if(this.type==="color"){const f=mg(l);for(let y=r;y<s;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=r;f<s;f++)this.paintVertexArray.emplace(f,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ps{constructor(r,s,l,f,y,_){this.expression=r,this.uniformNames=s.map(w=>`u_${w}_t`),this.type=l,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=s.map(w=>({name:`a_${w}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(r,s,l,f,y){const _=this.expression.evaluate(new ur(this.zoom),s,{},f,[],y),w=this.expression.evaluate(new ur(this.zoom+1),s,{},f,[],y),S=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(S,r,_,w)}updatePaintArray(r,s,l,f){const y=this.expression.evaluate({zoom:this.zoom},l,f),_=this.expression.evaluate({zoom:this.zoom+1},l,f);this._setPaintValue(r,s,y,_)}_setPaintValue(r,s,l,f){if(this.type==="color"){const y=mg(l),_=mg(f);for(let w=r;w<s;w++)this.paintVertexArray.emplace(w,y[0],y[1],_[0],_[1])}else{for(let y=r;y<s;y++)this.paintVertexArray.emplace(y,l,f);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(f))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s){const l=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,f=be(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);r.set(f)}getBinding(r,s,l){return new Pf(r,s)}}class ia{constructor(r,s,l,f,y,_){this.expression=r,this.type=s,this.useIntegerZoom=l,this.zoom=f,this.layerId=_,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(r,s,l){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(f,r,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(r,s,l,f,y){this._setPaintValues(r,s,l.patterns&&l.patterns[this.layerId],y)}_setPaintValues(r,s,l,f){if(!f||!l)return;const{min:y,mid:_,max:w}=l,S=f[y],C=f[_],P=f[w];if(S&&C&&P)for(let M=r;M<s;M++)this.zoomInPaintVertexArray.emplace(M,C.tl[0],C.tl[1],C.br[0],C.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],C.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(M,C.tl[0],C.tl[1],C.br[0],C.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],C.pixelRatio,P.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,ta.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,ta.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class wx{constructor(r,s,l){this.binders={},this._buffers=[];const f=[];for(const y in r.paint._values){if(!l(y))continue;const _=r.paint.get(y);if(!(_ instanceof ts&&Vo(_.property.specification)))continue;const w=pE(y,r.type),S=_.value,C=_.property.specification.type,P=_.property.useIntegerZoom,M=_.property.specification["property-type"],O=M==="cross-faded"||M==="cross-faded-data-driven";if(S.kind==="constant")this.binders[y]=O?new Cu(S.value,w):new xh(S.value,w,C),f.push(`/u_${y}`);else if(S.kind==="source"||O){const j=bx(y,C,"source");this.binders[y]=O?new ia(S,C,P,s,j,r.id):new fo(S,w,C,j),f.push(`/a_${y}`)}else{const j=bx(y,C,"composite");this.binders[y]=new ps(S,w,C,P,s,j),f.push(`/z_${y}`)}}this.cacheKey=f.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof fo||s instanceof ps?s.maxValue:0}populatePaintArrays(r,s,l,f,y){for(const _ in this.binders){const w=this.binders[_];(w instanceof fo||w instanceof ps||w instanceof ia)&&w.populatePaintArray(r,s,l,f,y)}}setConstantPatternPositions(r,s){for(const l in this.binders){const f=this.binders[l];f instanceof Cu&&f.setConstantPatternPositions(r,s)}}updatePaintArrays(r,s,l,f,y){let _=!1;for(const w in r){const S=s.getPositions(w);for(const C of S){const P=l.feature(C.index);for(const M in this.binders){const O=this.binders[M];if((O instanceof fo||O instanceof ps||O instanceof ia)&&O.expression.isStateDependent===!0){const j=f.paint.get(M);O.expression=j.value,O.updatePaintArray(C.start,C.end,P,r[w],y),_=!0}}}}return _}defines(){const r=[];for(const s in this.binders){const l=this.binders[s];(l instanceof xh||l instanceof Cu)&&r.push(...l.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof fo||l instanceof ps)for(let f=0;f<l.paintVertexAttributes.length;f++)r.push(l.paintVertexAttributes[f].name);else if(l instanceof ia)for(let f=0;f<ta.members.length;f++)r.push(ta.members[f].name)}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof xh||l instanceof Cu||l instanceof ps)for(const f of l.uniformNames)r.push(f)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,s){const l=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof xh||y instanceof Cu||y instanceof ps){for(const _ of y.uniformNames)if(s[_]){const w=y.getBinding(r,s[_],_);l.push({name:_,property:f,binding:w})}}}return l}setUniforms(r,s,l,f){for(const{name:y,property:_,binding:w}of s)this.binders[_].setUniform(w,f,l.get(_),y)}updatePaintBuffers(r){this._buffers=[];for(const s in this.binders){const l=this.binders[s];if(r&&l instanceof ia){const f=r.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(l instanceof fo||l instanceof ps)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(r){for(const s in this.binders){const l=this.binders[s];(l instanceof fo||l instanceof ps||l instanceof ia)&&l.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof fo||s instanceof ps||s instanceof ia)&&s.destroy()}}}class fl{constructor(r,s,l=()=>!0){this.programConfigurations={};for(const f of r)this.programConfigurations[f.id]=new wx(f,s,l);this.needsUpload=!1,this._featureMap=new hl,this._bufferOffset=0}populatePaintArrays(r,s,l,f,y,_){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(r,s,f,y,_);s.id!==void 0&&this._featureMap.add(s.id,l,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,l,f){for(const y of l)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(r,this._featureMap,s,y,f)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function pE(i,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${r}-`,"").replace(/-/g,"_")]}function bx(i,r,s){const l={color:{source:H,composite:Et},number:{source:Xe,composite:H}},f=function(y){return{"line-pattern":{source:mi,composite:mi},"fill-pattern":{source:mi,composite:mi},"fill-extrusion-pattern":{source:mi,composite:mi}}[y]}(i);return f&&f[s]||l[r][s]}nt("ConstantBinder",xh),nt("CrossFadedConstantBinder",Cu),nt("SourceExpressionBinder",fo),nt("CrossFadedCompositeBinder",ia),nt("CompositeExpressionBinder",ps),nt("ProgramConfiguration",wx,{omit:["_buffers"]}),nt("ProgramConfigurationSet",fl);const Lr=8192,gg=Math.pow(2,14)-1,Sx=-gg-1;function pl(i){const r=Lr/i.extent,s=i.loadGeometry();for(let l=0;l<s.length;l++){const f=s[l];for(let y=0;y<f.length;y++){const _=f[y],w=Math.round(_.x*r),S=Math.round(_.y*r);_.x=be(w,Sx,gg),_.y=be(S,Sx,gg),(w<_.x||w>_.x+1||S<_.y||S>_.y+1)&&xt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function ml(i,r){return{type:i.type,id:i.id,properties:i.properties,geometry:r?pl(i):[]}}function If(i,r,s,l,f){i.emplaceBack(2*r+(l+1)/2,2*s+(f+1)/2)}class yg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new wn,this.indexArray=new Oi,this.segments=new $t,this.programConfigurations=new fl(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){const f=this.layers[0],y=[];let _=null,w=!1;f.type==="circle"&&(_=f.layout.get("circle-sort-key"),w=!_.isConstant());for(const{feature:S,id:C,index:P,sourceLayerIndex:M}of r){const O=this.layers[0]._featureFilter.needGeometry,j=ml(S,O);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),j,l))continue;const U=w?_.evaluate(j,{},l):void 0,Z={id:C,properties:S.properties,type:S.type,sourceLayerIndex:M,index:P,geometry:O?j.geometry:pl(S),patterns:{},sortKey:U};y.push(Z)}w&&y.sort((S,C)=>S.sortKey-C.sortKey);for(const S of y){const{geometry:C,index:P,sourceLayerIndex:M}=S,O=r[P].feature;this.addFeature(S,C,P,l),s.featureIndex.insert(O,C,P,M,this.index)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Yn),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,l,f){for(const y of s)for(const _ of y){const w=_.x,S=_.y;if(w<0||w>=Lr||S<0||S>=Lr)continue;const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),P=C.vertexLength;If(this.layoutVertexArray,w,S,-1,-1),If(this.layoutVertexArray,w,S,1,-1),If(this.layoutVertexArray,w,S,1,1),If(this.layoutVertexArray,w,S,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,{},f)}}function Tx(i,r){for(let s=0;s<i.length;s++)if(ku(r,i[s]))return!0;for(let s=0;s<r.length;s++)if(ku(i,r[s]))return!0;return!!_g(i,r)}function mE(i,r,s){return!!ku(i,r)||!!vg(r,i,s)}function Ex(i,r){if(i.length===1)return kx(r,i[0]);for(let s=0;s<r.length;s++){const l=r[s];for(let f=0;f<l.length;f++)if(ku(i,l[f]))return!0}for(let s=0;s<i.length;s++)if(kx(r,i[s]))return!0;for(let s=0;s<r.length;s++)if(_g(i,r[s]))return!0;return!1}function gE(i,r,s){if(i.length>1){if(_g(i,r))return!0;for(let l=0;l<r.length;l++)if(vg(r[l],i,s))return!0}for(let l=0;l<i.length;l++)if(vg(i[l],r,s))return!0;return!1}function _g(i,r){if(i.length===0||r.length===0)return!1;for(let s=0;s<i.length-1;s++){const l=i[s],f=i[s+1];for(let y=0;y<r.length-1;y++)if(yE(l,f,r[y],r[y+1]))return!0}return!1}function yE(i,r,s,l){return He(i,s,l)!==He(r,s,l)&&He(i,r,s)!==He(i,r,l)}function vg(i,r,s){const l=s*s;if(r.length===1)return i.distSqr(r[0])<l;for(let f=1;f<r.length;f++)if(Cx(i,r[f-1],r[f])<l)return!0;return!1}function Cx(i,r,s){const l=r.distSqr(s);if(l===0)return i.distSqr(r);const f=((i.x-r.x)*(s.x-r.x)+(i.y-r.y)*(s.y-r.y))/l;return i.distSqr(f<0?r:f>1?s:s.sub(r)._mult(f)._add(r))}function kx(i,r){let s,l,f,y=!1;for(let _=0;_<i.length;_++){s=i[_];for(let w=0,S=s.length-1;w<s.length;S=w++)l=s[w],f=s[S],l.y>r.y!=f.y>r.y&&r.x<(f.x-l.x)*(r.y-l.y)/(f.y-l.y)+l.x&&(y=!y)}return y}function ku(i,r){let s=!1;for(let l=0,f=i.length-1;l<i.length;f=l++){const y=i[l],_=i[f];y.y>r.y!=_.y>r.y&&r.x<(_.x-y.x)*(r.y-y.y)/(_.y-y.y)+y.x&&(s=!s)}return s}function _E(i,r,s){const l=s[0],f=s[2];if(i.x<l.x&&r.x<l.x||i.x>f.x&&r.x>f.x||i.y<l.y&&r.y<l.y||i.y>f.y&&r.y>f.y)return!1;const y=He(i,r,s[0]);return y!==He(i,r,s[1])||y!==He(i,r,s[2])||y!==He(i,r,s[3])}function wh(i,r,s){const l=r.paint.get(i).value;return l.kind==="constant"?l.value:s.programConfigurations.get(r.id).getMaxValue(i)}function Af(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Mf(i,r,s,l,f){if(!r[0]&&!r[1])return i;const y=R.convert(r)._mult(f);s==="viewport"&&y._rotate(-l);const _=[];for(let w=0;w<i.length;w++)_.push(i[w].sub(y));return _}let Px,Ix;nt("CircleBucket",yg,{omit:["layers"]});var vE={get paint(){return Ix=Ix||new g({"circle-radius":new _t(Te.paint_circle["circle-radius"]),"circle-color":new _t(Te.paint_circle["circle-color"]),"circle-blur":new _t(Te.paint_circle["circle-blur"]),"circle-opacity":new _t(Te.paint_circle["circle-opacity"]),"circle-translate":new at(Te.paint_circle["circle-translate"]),"circle-translate-anchor":new at(Te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new at(Te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new at(Te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _t(Te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _t(Te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _t(Te.paint_circle["circle-stroke-opacity"])})},get layout(){return Px=Px||new g({"circle-sort-key":new _t(Te.layout_circle["circle-sort-key"])})}},Dn=1e-6,Pu=typeof Float32Array<"u"?Float32Array:Array;function xg(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Ax(i,r,s){var l=r[0],f=r[1],y=r[2],_=r[3],w=r[4],S=r[5],C=r[6],P=r[7],M=r[8],O=r[9],j=r[10],U=r[11],Z=r[12],re=r[13],oe=r[14],xe=r[15],pe=s[0],ve=s[1],Ce=s[2],Le=s[3];return i[0]=pe*l+ve*w+Ce*M+Le*Z,i[1]=pe*f+ve*S+Ce*O+Le*re,i[2]=pe*y+ve*C+Ce*j+Le*oe,i[3]=pe*_+ve*P+Ce*U+Le*xe,i[4]=(pe=s[4])*l+(ve=s[5])*w+(Ce=s[6])*M+(Le=s[7])*Z,i[5]=pe*f+ve*S+Ce*O+Le*re,i[6]=pe*y+ve*C+Ce*j+Le*oe,i[7]=pe*_+ve*P+Ce*U+Le*xe,i[8]=(pe=s[8])*l+(ve=s[9])*w+(Ce=s[10])*M+(Le=s[11])*Z,i[9]=pe*f+ve*S+Ce*O+Le*re,i[10]=pe*y+ve*C+Ce*j+Le*oe,i[11]=pe*_+ve*P+Ce*U+Le*xe,i[12]=(pe=s[12])*l+(ve=s[13])*w+(Ce=s[14])*M+(Le=s[15])*Z,i[13]=pe*f+ve*S+Ce*O+Le*re,i[14]=pe*y+ve*C+Ce*j+Le*oe,i[15]=pe*_+ve*P+Ce*U+Le*xe,i}Math.hypot||(Math.hypot=function(){for(var i=0,r=arguments.length;r--;)i+=arguments[r]*arguments[r];return Math.sqrt(i)});var bh,xE=Ax;function zf(i,r,s){var l=r[0],f=r[1],y=r[2],_=r[3];return i[0]=s[0]*l+s[4]*f+s[8]*y+s[12]*_,i[1]=s[1]*l+s[5]*f+s[9]*y+s[13]*_,i[2]=s[2]*l+s[6]*f+s[10]*y+s[14]*_,i[3]=s[3]*l+s[7]*f+s[11]*y+s[15]*_,i}bh=new Pu(4),Pu!=Float32Array&&(bh[0]=0,bh[1]=0,bh[2]=0,bh[3]=0);class wE extends a{constructor(r){super(r,vE)}createBucket(r){return new yg(r)}queryRadius(r){const s=r;return wh("circle-radius",this,s)+wh("circle-stroke-width",this,s)+Af(this.paint.get("circle-translate"))}queryIntersectsFeature(r,s,l,f,y,_,w,S){const C=Mf(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,w),P=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),M=this.paint.get("circle-pitch-alignment")==="map",O=M?C:function(U,Z){return U.map(re=>Mx(re,Z))}(C,S),j=M?P*w:P;for(const U of f)for(const Z of U){const re=M?Z:Mx(Z,S);let oe=j;const xe=zf([],[Z.x,Z.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?oe*=xe[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(oe*=_.cameraToCenterDistance/xe[3]),mE(O,re,oe))return!0}return!1}}function Mx(i,r){const s=zf([],[i.x,i.y,0,1],r);return new R(s[0]/s[3],s[1]/s[3])}class zx extends yg{}let Dx;nt("HeatmapBucket",zx,{omit:["layers"]});var bE={get paint(){return Dx=Dx||new g({"heatmap-radius":new _t(Te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _t(Te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new at(Te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _h(Te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new at(Te.paint_heatmap["heatmap-opacity"])})}};function wg(i,{width:r,height:s},l,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==r*s*l)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${r*s*l}`)}else f=new Uint8Array(r*s*l);return i.width=r,i.height=s,i.data=f,i}function Rx(i,{width:r,height:s},l){if(r===i.width&&s===i.height)return;const f=wg({},{width:r,height:s},l);bg(i,f,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,r),height:Math.min(i.height,s)},l),i.width=r,i.height=s,i.data=f.data}function bg(i,r,s,l,f,y){if(f.width===0||f.height===0)return r;if(f.width>i.width||f.height>i.height||s.x>i.width-f.width||s.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>r.width||f.height>r.height||l.x>r.width-f.width||l.y>r.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const _=i.data,w=r.data;if(_===w)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<f.height;S++){const C=((s.y+S)*i.width+s.x)*y,P=((l.y+S)*r.width+l.x)*y;for(let M=0;M<f.width*y;M++)w[P+M]=_[C+M]}return r}class Sh{constructor(r,s){wg(this,r,1,s)}resize(r){Rx(this,r,1)}clone(){return new Sh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,l,f,y){bg(r,s,l,f,y,1)}}class Bi{constructor(r,s){wg(this,r,4,s)}resize(r){Rx(this,r,4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Bi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,l,f,y){bg(r,s,l,f,y,4)}}function Lx(i){const r={},s=i.resolution||256,l=i.clips?i.clips.length:1,f=i.image||new Bi({width:s,height:l});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const y=(_,w,S)=>{r[i.evaluationKey]=S;const C=i.expression.evaluate(r);f.data[_+w+0]=Math.floor(255*C.r/C.a),f.data[_+w+1]=Math.floor(255*C.g/C.a),f.data[_+w+2]=Math.floor(255*C.b/C.a),f.data[_+w+3]=Math.floor(255*C.a)};if(i.clips)for(let _=0,w=0;_<l;++_,w+=4*s)for(let S=0,C=0;S<s;S++,C+=4){const P=S/(s-1),{start:M,end:O}=i.clips[_];y(w,C,M*(1-P)+O*P)}else for(let _=0,w=0;_<s;_++,w+=4)y(0,w,_/(s-1));return f}nt("AlphaImage",Sh),nt("RGBAImage",Bi);const Sg="big-fb";class SE extends a{createBucket(r){return new zx(r)}constructor(r){super(r,bE),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Lx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Sg)&&this.heatmapFbos.delete(Sg)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Fx;var TE={get paint(){return Fx=Fx||new g({"hillshade-illumination-direction":new at(Te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new at(Te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new at(Te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new at(Te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new at(Te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new at(Te.paint_hillshade["hillshade-accent-color"])})}};class EE extends a{constructor(r){super(r,TE)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const CE=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:kE}=CE;function Ox(i,r,s=2){const l=r&&r.length,f=l?r[0]*s:i.length;let y=Bx(i,0,f,s,!0);const _=[];if(!y||y.next===y.prev)return _;let w,S,C;if(l&&(y=function(P,M,O,j){const U=[];for(let Z=0,re=M.length;Z<re;Z++){const oe=Bx(P,M[Z]*j,Z<re-1?M[Z+1]*j:P.length,j,!1);oe===oe.next&&(oe.steiner=!0),U.push(LE(oe))}U.sort(zE);for(let Z=0;Z<U.length;Z++)O=DE(U[Z],O);return O}(i,r,y,s)),i.length>80*s){w=1/0,S=1/0;let P=-1/0,M=-1/0;for(let O=s;O<f;O+=s){const j=i[O],U=i[O+1];j<w&&(w=j),U<S&&(S=U),j>P&&(P=j),U>M&&(M=U)}C=Math.max(P-w,M-S),C=C!==0?32767/C:0}return Th(y,_,s,w,S,C,0),_}function Bx(i,r,s,l,f){let y;if(f===function(_,w,S,C){let P=0;for(let M=w,O=S-C;M<S;M+=C)P+=(_[O]-_[M])*(_[M+1]+_[O+1]),O=M;return P}(i,r,s,l)>0)for(let _=r;_<s;_+=l)y=Vx(_/l|0,i[_],i[_+1],y);else for(let _=s-l;_>=r;_-=l)y=Vx(_/l|0,i[_],i[_+1],y);return y&&Df(y,y.next)&&(Ch(y),y=y.next),y}function gl(i,r){if(!i)return i;r||(r=i);let s,l=i;do if(s=!1,l.steiner||!Df(l,l.next)&&Pr(l.prev,l,l.next)!==0)l=l.next;else{if(Ch(l),l=r=l.prev,l===l.next)break;s=!0}while(s||l!==r);return r}function Th(i,r,s,l,f,y,_){if(!i)return;!_&&y&&function(S,C,P,M){let O=S;do O.z===0&&(O.z=Tg(O.x,O.y,C,P,M)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==S);O.prevZ.nextZ=null,O.prevZ=null,function(j){let U,Z=1;do{let re,oe=j;j=null;let xe=null;for(U=0;oe;){U++;let pe=oe,ve=0;for(let Le=0;Le<Z&&(ve++,pe=pe.nextZ,pe);Le++);let Ce=Z;for(;ve>0||Ce>0&&pe;)ve!==0&&(Ce===0||!pe||oe.z<=pe.z)?(re=oe,oe=oe.nextZ,ve--):(re=pe,pe=pe.nextZ,Ce--),xe?xe.nextZ=re:j=re,re.prevZ=xe,xe=re;oe=pe}xe.nextZ=null,Z*=2}while(U>1)}(O)}(i,l,f,y);let w=i;for(;i.prev!==i.next;){const S=i.prev,C=i.next;if(y?IE(i,l,f,y):PE(i))r.push(S.i,i.i,C.i),Ch(i),i=C.next,w=C.next;else if((i=C)===w){_?_===1?Th(i=AE(gl(i),r),r,s,l,f,y,2):_===2&&ME(i,r,s,l,f,y):Th(gl(i),r,s,l,f,y,1);break}}}function PE(i){const r=i.prev,s=i,l=i.next;if(Pr(r,s,l)>=0)return!1;const f=r.x,y=s.x,_=l.x,w=r.y,S=s.y,C=l.y,P=f<y?f<_?f:_:y<_?y:_,M=w<S?w<C?w:C:S<C?S:C,O=f>y?f>_?f:_:y>_?y:_,j=w>S?w>C?w:C:S>C?S:C;let U=l.next;for(;U!==r;){if(U.x>=P&&U.x<=O&&U.y>=M&&U.y<=j&&Iu(f,w,y,S,_,C,U.x,U.y)&&Pr(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function IE(i,r,s,l){const f=i.prev,y=i,_=i.next;if(Pr(f,y,_)>=0)return!1;const w=f.x,S=y.x,C=_.x,P=f.y,M=y.y,O=_.y,j=w<S?w<C?w:C:S<C?S:C,U=P<M?P<O?P:O:M<O?M:O,Z=w>S?w>C?w:C:S>C?S:C,re=P>M?P>O?P:O:M>O?M:O,oe=Tg(j,U,r,s,l),xe=Tg(Z,re,r,s,l);let pe=i.prevZ,ve=i.nextZ;for(;pe&&pe.z>=oe&&ve&&ve.z<=xe;){if(pe.x>=j&&pe.x<=Z&&pe.y>=U&&pe.y<=re&&pe!==f&&pe!==_&&Iu(w,P,S,M,C,O,pe.x,pe.y)&&Pr(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,ve.x>=j&&ve.x<=Z&&ve.y>=U&&ve.y<=re&&ve!==f&&ve!==_&&Iu(w,P,S,M,C,O,ve.x,ve.y)&&Pr(ve.prev,ve,ve.next)>=0))return!1;ve=ve.nextZ}for(;pe&&pe.z>=oe;){if(pe.x>=j&&pe.x<=Z&&pe.y>=U&&pe.y<=re&&pe!==f&&pe!==_&&Iu(w,P,S,M,C,O,pe.x,pe.y)&&Pr(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;ve&&ve.z<=xe;){if(ve.x>=j&&ve.x<=Z&&ve.y>=U&&ve.y<=re&&ve!==f&&ve!==_&&Iu(w,P,S,M,C,O,ve.x,ve.y)&&Pr(ve.prev,ve,ve.next)>=0)return!1;ve=ve.nextZ}return!0}function AE(i,r){let s=i;do{const l=s.prev,f=s.next.next;!Df(l,f)&&Nx(l,s,s.next,f)&&Eh(l,f)&&Eh(f,l)&&(r.push(l.i,s.i,f.i),Ch(s),Ch(s.next),s=i=f),s=s.next}while(s!==i);return gl(s)}function ME(i,r,s,l,f,y){let _=i;do{let w=_.next.next;for(;w!==_.prev;){if(_.i!==w.i&&FE(_,w)){let S=jx(_,w);return _=gl(_,_.next),S=gl(S,S.next),Th(_,r,s,l,f,y,0),void Th(S,r,s,l,f,y,0)}w=w.next}_=_.next}while(_!==i)}function zE(i,r){return i.x-r.x}function DE(i,r){const s=function(f,y){let _=y;const w=f.x,S=f.y;let C,P=-1/0;do{if(S<=_.y&&S>=_.next.y&&_.next.y!==_.y){const Z=_.x+(S-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(Z<=w&&Z>P&&(P=Z,C=_.x<_.next.x?_:_.next,Z===w))return C}_=_.next}while(_!==y);if(!C)return null;const M=C,O=C.x,j=C.y;let U=1/0;_=C;do{if(w>=_.x&&_.x>=O&&w!==_.x&&Iu(S<j?w:P,S,O,j,S<j?P:w,S,_.x,_.y)){const Z=Math.abs(S-_.y)/(w-_.x);Eh(_,f)&&(Z<U||Z===U&&(_.x>C.x||_.x===C.x&&RE(C,_)))&&(C=_,U=Z)}_=_.next}while(_!==M);return C}(i,r);if(!s)return r;const l=jx(s,i);return gl(l,l.next),gl(s,s.next)}function RE(i,r){return Pr(i.prev,i,r.prev)<0&&Pr(r.next,i,i.next)<0}function Tg(i,r,s,l,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-l)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function LE(i){let r=i,s=i;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==i);return s}function Iu(i,r,s,l,f,y,_,w){return(f-_)*(r-w)>=(i-_)*(y-w)&&(i-_)*(l-w)>=(s-_)*(r-w)&&(s-_)*(y-w)>=(f-_)*(l-w)}function FE(i,r){return i.next.i!==r.i&&i.prev.i!==r.i&&!function(s,l){let f=s;do{if(f.i!==s.i&&f.next.i!==s.i&&f.i!==l.i&&f.next.i!==l.i&&Nx(f,f.next,s,l))return!0;f=f.next}while(f!==s);return!1}(i,r)&&(Eh(i,r)&&Eh(r,i)&&function(s,l){let f=s,y=!1;const _=(s.x+l.x)/2,w=(s.y+l.y)/2;do f.y>w!=f.next.y>w&&f.next.y!==f.y&&_<(f.next.x-f.x)*(w-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==s);return y}(i,r)&&(Pr(i.prev,i,r.prev)||Pr(i,r.prev,r))||Df(i,r)&&Pr(i.prev,i,i.next)>0&&Pr(r.prev,r,r.next)>0)}function Pr(i,r,s){return(r.y-i.y)*(s.x-r.x)-(r.x-i.x)*(s.y-r.y)}function Df(i,r){return i.x===r.x&&i.y===r.y}function Nx(i,r,s,l){const f=Lf(Pr(i,r,s)),y=Lf(Pr(i,r,l)),_=Lf(Pr(s,l,i)),w=Lf(Pr(s,l,r));return f!==y&&_!==w||!(f!==0||!Rf(i,s,r))||!(y!==0||!Rf(i,l,r))||!(_!==0||!Rf(s,i,l))||!(w!==0||!Rf(s,r,l))}function Rf(i,r,s){return r.x<=Math.max(i.x,s.x)&&r.x>=Math.min(i.x,s.x)&&r.y<=Math.max(i.y,s.y)&&r.y>=Math.min(i.y,s.y)}function Lf(i){return i>0?1:i<0?-1:0}function Eh(i,r){return Pr(i.prev,i,i.next)<0?Pr(i,r,i.next)>=0&&Pr(i,i.prev,r)>=0:Pr(i,r,i.prev)<0||Pr(i,i.next,r)<0}function jx(i,r){const s=Eg(i.i,i.x,i.y),l=Eg(r.i,r.x,r.y),f=i.next,y=r.prev;return i.next=r,r.prev=i,s.next=f,f.prev=s,l.next=s,s.prev=l,y.next=l,l.prev=y,l}function Vx(i,r,s,l){const f=Eg(i,r,s);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function Ch(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Eg(i,r,s){return{i,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Cg(i,r,s){const l=s.patternDependencies;let f=!1;for(const y of r){const _=y.paint.get(`${i}-pattern`);_.isConstant()||(f=!0);const w=_.constantOr(null);w&&(f=!0,l[w.to]=!0,l[w.from]=!0)}return f}function kg(i,r,s,l,f){const y=f.patternDependencies;for(const _ of r){const w=_.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let S=w.evaluate({zoom:l-1},s,{},f.availableImages),C=w.evaluate({zoom:l},s,{},f.availableImages),P=w.evaluate({zoom:l+1},s,{},f.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,P=P&&P.name?P.name:P,y[S]=!0,y[C]=!0,y[P]=!0,s.patterns[_.id]={min:S,mid:C,max:P}}}return s}class Pg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rs,this.indexArray=new Oi,this.indexArray2=new Jr,this.programConfigurations=new fl(r.layers,r.zoom),this.segments=new $t,this.segments2=new $t,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){this.hasPattern=Cg("fill",this.layers,s);const f=this.layers[0].layout.get("fill-sort-key"),y=!f.isConstant(),_=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:P}of r){const M=this.layers[0]._featureFilter.needGeometry,O=ml(w,M);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),O,l))continue;const j=y?f.evaluate(O,{},l,s.availableImages):void 0,U={id:S,properties:w.properties,type:w.type,sourceLayerIndex:P,index:C,geometry:M?O.geometry:pl(w),patterns:{},sortKey:j};_.push(U)}y&&_.sort((w,S)=>w.sortKey-S.sortKey);for(const w of _){const{geometry:S,index:C,sourceLayerIndex:P}=w;if(this.hasPattern){const M=kg("fill",this.layers,w,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(w,S,C,l,{});s.featureIndex.insert(r[C].feature,S,C,P,this.index)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}addFeatures(r,s,l){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,kE),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,l,f,y){for(const _ of Ql(s,500)){let w=0;for(const j of _)w+=j.length;const S=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),C=S.vertexLength,P=[],M=[];for(const j of _){if(j.length===0)continue;j!==_[0]&&M.push(P.length/2);const U=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),Z=U.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(Z+j.length-1,Z),P.push(j[0].x),P.push(j[0].y);for(let re=1;re<j.length;re++)this.layoutVertexArray.emplaceBack(j[re].x,j[re].y),this.indexArray2.emplaceBack(Z+re-1,Z+re),P.push(j[re].x),P.push(j[re].y);U.vertexLength+=j.length,U.primitiveLength+=j.length}const O=Ox(P,M);for(let j=0;j<O.length;j+=3)this.indexArray.emplaceBack(C+O[j],C+O[j+1],C+O[j+2]);S.vertexLength+=w,S.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,y,f)}}let $x,Ux;nt("FillBucket",Pg,{omit:["layers","patternFeatures"]});var OE={get paint(){return Ux=Ux||new g({"fill-antialias":new at(Te.paint_fill["fill-antialias"]),"fill-opacity":new _t(Te.paint_fill["fill-opacity"]),"fill-color":new _t(Te.paint_fill["fill-color"]),"fill-outline-color":new _t(Te.paint_fill["fill-outline-color"]),"fill-translate":new at(Te.paint_fill["fill-translate"]),"fill-translate-anchor":new at(Te.paint_fill["fill-translate-anchor"]),"fill-pattern":new vu(Te.paint_fill["fill-pattern"])})},get layout(){return $x=$x||new g({"fill-sort-key":new _t(Te.layout_fill["fill-sort-key"])})}};class BE extends a{constructor(r){super(r,OE)}recalculate(r,s){super.recalculate(r,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Pg(r)}queryRadius(){return Af(this.paint.get("fill-translate"))}queryIntersectsFeature(r,s,l,f,y,_,w){return Ex(Mf(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,w),f)}isTileClipped(){return!0}}const NE=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),jE=b([{name:"a_centroid",components:2,type:"Int16"}],4),{members:VE}=NE;var sa={},$E=A,qx=Au;function Au(i,r,s,l,f){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=f,i.readFields(UE,this,r)}function UE(i,r,s){i==1?r.id=s.readVarint():i==2?function(l,f){for(var y=l.readVarint()+l.pos;l.pos<y;){var _=f._keys[l.readVarint()],w=f._values[l.readVarint()];f.properties[_]=w}}(s,r):i==3?r.type=s.readVarint():i==4&&(r._geometry=s.pos)}function qE(i){for(var r,s,l=0,f=0,y=i.length,_=y-1;f<y;_=f++)l+=((s=i[_]).x-(r=i[f]).x)*(r.y+s.y);return l}Au.types=["Unknown","Point","LineString","Polygon"],Au.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var r,s=i.readVarint()+i.pos,l=1,f=0,y=0,_=0,w=[];i.pos<s;){if(f<=0){var S=i.readVarint();l=7&S,f=S>>3}if(f--,l===1||l===2)y+=i.readSVarint(),_+=i.readSVarint(),l===1&&(r&&w.push(r),r=[]),r.push(new $E(y,_));else{if(l!==7)throw new Error("unknown command "+l);r&&r.push(r[0].clone())}}return r&&w.push(r),w},Au.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var r=i.readVarint()+i.pos,s=1,l=0,f=0,y=0,_=1/0,w=-1/0,S=1/0,C=-1/0;i.pos<r;){if(l<=0){var P=i.readVarint();s=7&P,l=P>>3}if(l--,s===1||s===2)(f+=i.readSVarint())<_&&(_=f),f>w&&(w=f),(y+=i.readSVarint())<S&&(S=y),y>C&&(C=y);else if(s!==7)throw new Error("unknown command "+s)}return[_,S,w,C]},Au.prototype.toGeoJSON=function(i,r,s){var l,f,y=this.extent*Math.pow(2,s),_=this.extent*i,w=this.extent*r,S=this.loadGeometry(),C=Au.types[this.type];function P(j){for(var U=0;U<j.length;U++){var Z=j[U];j[U]=[360*(Z.x+_)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+w)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(l=0;l<S.length;l++)M[l]=S[l][0];P(S=M);break;case 2:for(l=0;l<S.length;l++)P(S[l]);break;case 3:for(S=function(j){var U=j.length;if(U<=1)return[j];for(var Z,re,oe=[],xe=0;xe<U;xe++){var pe=qE(j[xe]);pe!==0&&(re===void 0&&(re=pe<0),re===pe<0?(Z&&oe.push(Z),Z=[j[xe]]):Z.push(j[xe]))}return Z&&oe.push(Z),oe}(S),l=0;l<S.length;l++)for(f=0;f<S[l].length;f++)P(S[l][f])}S.length===1?S=S[0]:C="Multi"+C;var O={type:"Feature",geometry:{type:C,coordinates:S},properties:this.properties};return"id"in this&&(O.id=this.id),O};var ZE=qx,Zx=Hx;function Hx(i,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(HE,this,r),this.length=this._features.length}function HE(i,r,s){i===15?r.version=s.readVarint():i===1?r.name=s.readString():i===5?r.extent=s.readVarint():i===2?r._features.push(s.pos):i===3?r._keys.push(s.readString()):i===4&&r._values.push(function(l){for(var f=null,y=l.readVarint()+l.pos;l.pos<y;){var _=l.readVarint()>>3;f=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return f}(s))}Hx.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var r=this._pbf.readVarint()+this._pbf.pos;return new ZE(this._pbf,r,this.extent,this._keys,this._values)};var GE=Zx;function WE(i,r,s){if(i===3){var l=new GE(s,s.readVarint()+s.pos);l.length&&(r[l.name]=l)}}sa.VectorTile=function(i,r){this.layers=i.readFields(WE,{},r)},sa.VectorTileFeature=qx,sa.VectorTileLayer=Zx;const XE=sa.VectorTileFeature.types,Ig=Math.pow(2,13);function kh(i,r,s,l,f,y,_,w){i.emplaceBack(r,s,2*Math.floor(l*Ig)+_,f*Ig*2,y*Ig*2,Math.round(w))}class Ag{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Qo,this.centroidVertexArray=new un,this.indexArray=new Oi,this.programConfigurations=new fl(r.layers,r.zoom),this.segments=new $t,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){this.features=[],this.hasPattern=Cg("fill-extrusion",this.layers,s);for(const{feature:f,id:y,index:_,sourceLayerIndex:w}of r){const S=this.layers[0]._featureFilter.needGeometry,C=ml(f,S);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),C,l))continue;const P={id:y,sourceLayerIndex:w,index:_,geometry:S?C.geometry:pl(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(kg("fill-extrusion",this.layers,P,this.zoom,s)):this.addFeature(P,P.geometry,_,l,{}),s.featureIndex.insert(f,P.geometry,_,w,this.index,!0)}}addFeatures(r,s,l){for(const f of this.features){const{geometry:y}=f;this.addFeature(f,y,f.index,s,l)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,VE),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,jE.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,s,l,f,y){for(const _ of Ql(s,500)){const w={x:0,y:0,vertexCount:0};let S=0;for(const U of _)S+=U.length;let C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const U of _){if(U.length===0||YE(U))continue;let Z=0;for(let re=0;re<U.length;re++){const oe=U[re];if(re>=1){const xe=U[re-1];if(!KE(oe,xe)){C.vertexLength+4>$t.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const pe=oe.sub(xe)._perp()._unit(),ve=xe.dist(oe);Z+ve>32768&&(Z=0),kh(this.layoutVertexArray,oe.x,oe.y,pe.x,pe.y,0,0,Z),kh(this.layoutVertexArray,oe.x,oe.y,pe.x,pe.y,0,1,Z),w.x+=2*oe.x,w.y+=2*oe.y,w.vertexCount+=2,Z+=ve,kh(this.layoutVertexArray,xe.x,xe.y,pe.x,pe.y,0,0,Z),kh(this.layoutVertexArray,xe.x,xe.y,pe.x,pe.y,0,1,Z),w.x+=2*xe.x,w.y+=2*xe.y,w.vertexCount+=2;const Ce=C.vertexLength;this.indexArray.emplaceBack(Ce,Ce+2,Ce+1),this.indexArray.emplaceBack(Ce+1,Ce+2,Ce+3),C.vertexLength+=4,C.primitiveLength+=2}}}}if(C.vertexLength+S>$t.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),XE[r.type]!=="Polygon")continue;const P=[],M=[],O=C.vertexLength;for(const U of _)if(U.length!==0){U!==_[0]&&M.push(P.length/2);for(let Z=0;Z<U.length;Z++){const re=U[Z];kh(this.layoutVertexArray,re.x,re.y,0,0,1,1,0),w.x+=re.x,w.y+=re.y,w.vertexCount+=1,P.push(re.x),P.push(re.y)}}const j=Ox(P,M);for(let U=0;U<j.length;U+=3)this.indexArray.emplaceBack(O+j[U],O+j[U+2],O+j[U+1]);C.primitiveLength+=j.length/3,C.vertexLength+=S;for(let U=0;U<w.vertexCount;U++){const Z=Math.floor(w.x/w.vertexCount),re=Math.floor(w.y/w.vertexCount);this.centroidVertexArray.emplaceBack(Z,re)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,y,f)}}function KE(i,r){return i.x===r.x&&(i.x<0||i.x>Lr)||i.y===r.y&&(i.y<0||i.y>Lr)}function YE(i){return i.every(r=>r.x<0)||i.every(r=>r.x>Lr)||i.every(r=>r.y<0)||i.every(r=>r.y>Lr)}let Gx;nt("FillExtrusionBucket",Ag,{omit:["layers","features"]});var JE={get paint(){return Gx=Gx||new g({"fill-extrusion-opacity":new at(Te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _t(Te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new at(Te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new at(Te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vu(Te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _t(Te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _t(Te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new at(Te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class QE extends a{constructor(r){super(r,JE)}createBucket(r){return new Ag(r)}queryRadius(){return Af(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,s,l,f,y,_,w,S){const C=Mf(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,w),P=this.paint.get("fill-extrusion-height").evaluate(s,l),M=this.paint.get("fill-extrusion-base").evaluate(s,l),O=function(U,Z,re,oe){const xe=[];for(const pe of U){const ve=[pe.x,pe.y,0,1];zf(ve,ve,Z),xe.push(new R(ve[0]/ve[3],ve[1]/ve[3]))}return xe}(C,S),j=function(U,Z,re,oe){const xe=[],pe=[],ve=oe[8]*Z,Ce=oe[9]*Z,Le=oe[10]*Z,Qe=oe[11]*Z,gt=oe[8]*re,Ke=oe[9]*re,We=oe[10]*re,ct=oe[11]*re;for(const it of U){const rt=[],Ie=[];for(const ht of it){const ut=ht.x,Tt=ht.y,ir=oe[0]*ut+oe[4]*Tt+oe[12],nr=oe[1]*ut+oe[5]*Tt+oe[13],qr=oe[2]*ut+oe[6]*Tt+oe[14],ns=oe[3]*ut+oe[7]*Tt+oe[15],dn=qr+Le,Zr=ns+Qe,Rn=ir+gt,Ln=nr+Ke,Fn=qr+We,Tr=ns+ct,Hr=new R((ir+ve)/Zr,(nr+Ce)/Zr);Hr.z=dn/Zr,rt.push(Hr);const bn=new R(Rn/Tr,Ln/Tr);bn.z=Fn/Tr,Ie.push(bn)}xe.push(rt),pe.push(Ie)}return[xe,pe]}(f,M,P,S);return function(U,Z,re){let oe=1/0;Ex(re,Z)&&(oe=Wx(re,Z[0]));for(let xe=0;xe<Z.length;xe++){const pe=Z[xe],ve=U[xe];for(let Ce=0;Ce<pe.length-1;Ce++){const Le=pe[Ce],Qe=[Le,pe[Ce+1],ve[Ce+1],ve[Ce],Le];Tx(re,Qe)&&(oe=Math.min(oe,Wx(re,Qe)))}}return oe!==1/0&&oe}(j[0],j[1],O)}}function Ph(i,r){return i.x*r.x+i.y*r.y}function Wx(i,r){if(i.length===1){let s=0;const l=r[s++];let f;for(;!f||l.equals(f);)if(f=r[s++],!f)return 1/0;for(;s<r.length;s++){const y=r[s],_=i[0],w=f.sub(l),S=y.sub(l),C=_.sub(l),P=Ph(w,w),M=Ph(w,S),O=Ph(S,S),j=Ph(C,w),U=Ph(C,S),Z=P*O-M*M,re=(O*j-M*U)/Z,oe=(P*U-M*j)/Z,xe=l.z*(1-re-oe)+f.z*re+y.z*oe;if(isFinite(xe))return xe}return 1/0}{let s=1/0;for(const l of r)s=Math.min(s,l.z);return s}}const eC=b([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:tC}=eC,rC=b([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:nC}=rC,iC=sa.VectorTileFeature.types,sC=Math.cos(Math.PI/180*37.5),Xx=Math.pow(2,14)/.5;class Mg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new wu,this.layoutVertexArray2=new ea,this.indexArray=new Oi,this.programConfigurations=new fl(r.layers,r.zoom),this.segments=new $t,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){this.hasPattern=Cg("line",this.layers,s);const f=this.layers[0].layout.get("line-sort-key"),y=!f.isConstant(),_=[];for(const{feature:w,id:S,index:C,sourceLayerIndex:P}of r){const M=this.layers[0]._featureFilter.needGeometry,O=ml(w,M);if(!this.layers[0]._featureFilter.filter(new ur(this.zoom),O,l))continue;const j=y?f.evaluate(O,{},l):void 0,U={id:S,properties:w.properties,type:w.type,sourceLayerIndex:P,index:C,geometry:M?O.geometry:pl(w),patterns:{},sortKey:j};_.push(U)}y&&_.sort((w,S)=>w.sortKey-S.sortKey);for(const w of _){const{geometry:S,index:C,sourceLayerIndex:P}=w;if(this.hasPattern){const M=kg("line",this.layers,w,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(w,S,C,l,{});s.featureIndex.insert(r[C].feature,S,C,P,this.index)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}addFeatures(r,s,l){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,nC)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,tC),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,l,f,y){const _=this.layers[0].layout,w=_.get("line-join").evaluate(r,{}),S=_.get("line-cap"),C=_.get("line-miter-limit"),P=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const M of s)this.addLine(M,r,w,S,C,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,y,f)}addLine(r,s,l,f,y,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<r.length-1;oe++)this.totalDistance+=r[oe].dist(r[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=iC[s.type]==="Polygon";let S=r.length;for(;S>=2&&r[S-1].equals(r[S-2]);)S--;let C=0;for(;C<S-1&&r[C].equals(r[C+1]);)C++;if(S<(w?3:2))return;l==="bevel"&&(y=1.05);const P=this.overscaling<=16?15*Lr/(512*this.overscaling):0,M=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let O,j,U,Z,re;this.e1=this.e2=-1,w&&(O=r[S-2],re=r[C].sub(O)._unit()._perp());for(let oe=C;oe<S;oe++){if(U=oe===S-1?w?r[C+1]:void 0:r[oe+1],U&&r[oe].equals(U))continue;re&&(Z=re),O&&(j=O),O=r[oe],re=U?U.sub(O)._unit()._perp():Z,Z=Z||re;let xe=Z.add(re);xe.x===0&&xe.y===0||xe._unit();const pe=Z.x*re.x+Z.y*re.y,ve=xe.x*re.x+xe.y*re.y,Ce=ve!==0?1/ve:1/0,Le=2*Math.sqrt(2-2*ve),Qe=ve<sC&&j&&U,gt=Z.x*re.y-Z.y*re.x>0;if(Qe&&oe>C){const ct=O.dist(j);if(ct>2*P){const it=O.sub(O.sub(j)._mult(P/ct)._round());this.updateDistance(j,it),this.addCurrentVertex(it,Z,0,0,M),j=it}}const Ke=j&&U;let We=Ke?l:w?"butt":f;if(Ke&&We==="round"&&(Ce<_?We="miter":Ce<=2&&(We="fakeround")),We==="miter"&&Ce>y&&(We="bevel"),We==="bevel"&&(Ce>2&&(We="flipbevel"),Ce<y&&(We="miter")),j&&this.updateDistance(j,O),We==="miter")xe._mult(Ce),this.addCurrentVertex(O,xe,0,0,M);else if(We==="flipbevel"){if(Ce>100)xe=re.mult(-1);else{const ct=Ce*Z.add(re).mag()/Z.sub(re).mag();xe._perp()._mult(ct*(gt?-1:1))}this.addCurrentVertex(O,xe,0,0,M),this.addCurrentVertex(O,xe.mult(-1),0,0,M)}else if(We==="bevel"||We==="fakeround"){const ct=-Math.sqrt(Ce*Ce-1),it=gt?ct:0,rt=gt?0:ct;if(j&&this.addCurrentVertex(O,Z,it,rt,M),We==="fakeround"){const Ie=Math.round(180*Le/Math.PI/20);for(let ht=1;ht<Ie;ht++){let ut=ht/Ie;if(ut!==.5){const ir=ut-.5;ut+=ut*ir*(ut-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*ir*ir+(.848013+pe*(.215638*pe-1.06021)))}const Tt=re.sub(Z)._mult(ut)._add(Z)._unit()._mult(gt?-1:1);this.addHalfVertex(O,Tt.x,Tt.y,!1,gt,0,M)}}U&&this.addCurrentVertex(O,re,-it,-rt,M)}else if(We==="butt")this.addCurrentVertex(O,xe,0,0,M);else if(We==="square"){const ct=j?1:-1;this.addCurrentVertex(O,xe,ct,ct,M)}else We==="round"&&(j&&(this.addCurrentVertex(O,Z,0,0,M),this.addCurrentVertex(O,Z,1,1,M,!0)),U&&(this.addCurrentVertex(O,re,-1,-1,M,!0),this.addCurrentVertex(O,re,0,0,M)));if(Qe&&oe<S-1){const ct=O.dist(U);if(ct>2*P){const it=O.add(U.sub(O)._mult(P/ct)._round());this.updateDistance(O,it),this.addCurrentVertex(it,re,0,0,M),O=it}}}}addCurrentVertex(r,s,l,f,y,_=!1){const w=s.y*f-s.x,S=-s.y-s.x*f;this.addHalfVertex(r,s.x+s.y*l,s.y-s.x*l,_,!1,l,y),this.addHalfVertex(r,w,S,_,!0,-f,y),this.distance>Xx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,s,l,f,y,_))}addHalfVertex({x:r,y:s},l,f,y,_,w,S){const C=.5*(this.lineClips?this.scaledDistance*(Xx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(y?1:0),(s<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*f)+128,1+(w===0?0:w<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),S.primitiveLength++),_?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}}let Kx,Yx;nt("LineBucket",Mg,{omit:["layers","patternFeatures"]});var Jx={get paint(){return Yx=Yx||new g({"line-opacity":new _t(Te.paint_line["line-opacity"]),"line-color":new _t(Te.paint_line["line-color"]),"line-translate":new at(Te.paint_line["line-translate"]),"line-translate-anchor":new at(Te.paint_line["line-translate-anchor"]),"line-width":new _t(Te.paint_line["line-width"]),"line-gap-width":new _t(Te.paint_line["line-gap-width"]),"line-offset":new _t(Te.paint_line["line-offset"]),"line-blur":new _t(Te.paint_line["line-blur"]),"line-dasharray":new xu(Te.paint_line["line-dasharray"]),"line-pattern":new vu(Te.paint_line["line-pattern"]),"line-gradient":new _h(Te.paint_line["line-gradient"])})},get layout(){return Kx=Kx||new g({"line-cap":new at(Te.layout_line["line-cap"]),"line-join":new _t(Te.layout_line["line-join"]),"line-miter-limit":new at(Te.layout_line["line-miter-limit"]),"line-round-limit":new at(Te.layout_line["line-round-limit"]),"line-sort-key":new _t(Te.layout_line["line-sort-key"])})}};class oC extends _t{possiblyEvaluate(r,s){return s=new ur(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(r,s)}evaluate(r,s,l,f){return s=Pe({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(r,s,l,f)}}let Ff;class aC extends a{constructor(r){super(r,Jx),this.gradientVersion=0,Ff||(Ff=new oC(Jx.paint.properties["line-width"].specification),Ff.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof Lo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,s){super.recalculate(r,s),this.paint._values["line-floorwidth"]=Ff.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Mg(r)}queryRadius(r){const s=r,l=Qx(wh("line-width",this,s),wh("line-gap-width",this,s)),f=wh("line-offset",this,s);return l/2+Math.abs(f)+Af(this.paint.get("line-translate"))}queryIntersectsFeature(r,s,l,f,y,_,w){const S=Mf(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,w),C=w/2*Qx(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),P=this.paint.get("line-offset").evaluate(s,l);return P&&(f=function(M,O){const j=[];for(let U=0;U<M.length;U++){const Z=M[U],re=[];for(let oe=0;oe<Z.length;oe++){const xe=Z[oe-1],pe=Z[oe],ve=Z[oe+1],Ce=oe===0?new R(0,0):pe.sub(xe)._unit()._perp(),Le=oe===Z.length-1?new R(0,0):ve.sub(pe)._unit()._perp(),Qe=Ce._add(Le)._unit(),gt=Qe.x*Le.x+Qe.y*Le.y;gt!==0&&Qe._mult(1/gt),re.push(Qe._mult(O)._add(pe))}j.push(re)}return j}(f,P*w)),function(M,O,j){for(let U=0;U<O.length;U++){const Z=O[U];if(M.length>=3){for(let re=0;re<Z.length;re++)if(ku(M,Z[re]))return!0}if(gE(M,Z,j))return!0}return!1}(S,f,C)}isTileClipped(){return!0}}function Qx(i,r){return r>0?r+2*i:i}const lC=b([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),uC=b([{name:"a_projected_pos",components:3,type:"Float32"}],4);b([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const cC=b([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);b([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const e0=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),hC=b([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function dC(i,r,s){return i.sections.forEach(l=>{l.text=function(f,y,_){const w=y.layout.get("text-transform").evaluate(_,{});return w==="uppercase"?f=f.toLocaleUpperCase():w==="lowercase"&&(f=f.toLocaleLowerCase()),Kn.applyArabicShaping&&(f=Kn.applyArabicShaping(f)),f}(l.text,r,s)}),i}b([{name:"triangle",components:3,type:"Uint16"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),b([{type:"Float32",name:"offsetX"}]),b([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),b([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ih={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Nr=24,t0=rr,r0=function(i,r,s,l,f){var y,_,w=8*f-l-1,S=(1<<w)-1,C=S>>1,P=-7,M=f-1,O=-1,j=i[r+M];for(M+=O,y=j&(1<<-P)-1,j>>=-P,P+=w;P>0;y=256*y+i[r+M],M+=O,P-=8);for(_=y&(1<<-P)-1,y>>=-P,P+=l;P>0;_=256*_+i[r+M],M+=O,P-=8);if(y===0)y=1-C;else{if(y===S)return _?NaN:1/0*(j?-1:1);_+=Math.pow(2,l),y-=C}return(j?-1:1)*_*Math.pow(2,y-l)},n0=function(i,r,s,l,f,y){var _,w,S,C=8*y-f-1,P=(1<<C)-1,M=P>>1,O=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=0,U=1,Z=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(w=isNaN(r)?1:0,_=P):(_=Math.floor(Math.log(r)/Math.LN2),r*(S=Math.pow(2,-_))<1&&(_--,S*=2),(r+=_+M>=1?O/S:O*Math.pow(2,1-M))*S>=2&&(_++,S/=2),_+M>=P?(w=0,_=P):_+M>=1?(w=(r*S-1)*Math.pow(2,f),_+=M):(w=r*Math.pow(2,M-1)*Math.pow(2,f),_=0));f>=8;i[s+j]=255&w,j+=U,w/=256,f-=8);for(_=_<<f|w,C+=f;C>0;i[s+j]=255&_,j+=U,_/=256,C-=8);i[s+j-U]|=128*Z};function rr(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}rr.Varint=0,rr.Fixed64=1,rr.Bytes=2,rr.Fixed32=5;var zg=4294967296,i0=1/zg,s0=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function po(i){return i.type===rr.Bytes?i.readVarint()+i.pos:i.pos+1}function Mu(i,r,s){return s?4294967296*r+(i>>>0):4294967296*(r>>>0)+(i>>>0)}function o0(i,r,s){var l=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(l);for(var f=s.pos-1;f>=i;f--)s.buf[f+l]=s.buf[f]}function fC(i,r){for(var s=0;s<i.length;s++)r.writeVarint(i[s])}function pC(i,r){for(var s=0;s<i.length;s++)r.writeSVarint(i[s])}function mC(i,r){for(var s=0;s<i.length;s++)r.writeFloat(i[s])}function gC(i,r){for(var s=0;s<i.length;s++)r.writeDouble(i[s])}function yC(i,r){for(var s=0;s<i.length;s++)r.writeBoolean(i[s])}function _C(i,r){for(var s=0;s<i.length;s++)r.writeFixed32(i[s])}function vC(i,r){for(var s=0;s<i.length;s++)r.writeSFixed32(i[s])}function xC(i,r){for(var s=0;s<i.length;s++)r.writeFixed64(i[s])}function wC(i,r){for(var s=0;s<i.length;s++)r.writeSFixed64(i[s])}function Of(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+16777216*i[r+3]}function zu(i,r,s){i[s]=r,i[s+1]=r>>>8,i[s+2]=r>>>16,i[s+3]=r>>>24}function a0(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+(i[r+3]<<24)}rr.prototype={destroy:function(){this.buf=null},readFields:function(i,r,s){for(s=s||this.length;this.pos<s;){var l=this.readVarint(),f=l>>3,y=this.pos;this.type=7&l,i(f,r,this),this.pos===y&&this.skip(l)}return r},readMessage:function(i,r){return this.readFields(i,r,this.readVarint()+this.pos)},readFixed32:function(){var i=Of(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=a0(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Of(this.buf,this.pos)+Of(this.buf,this.pos+4)*zg;return this.pos+=8,i},readSFixed64:function(){var i=Of(this.buf,this.pos)+a0(this.buf,this.pos+4)*zg;return this.pos+=8,i},readFloat:function(){var i=r0(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=r0(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var r,s,l=this.buf;return r=127&(s=l[this.pos++]),s<128?r:(r|=(127&(s=l[this.pos++]))<<7,s<128?r:(r|=(127&(s=l[this.pos++]))<<14,s<128?r:(r|=(127&(s=l[this.pos++]))<<21,s<128?r:function(f,y,_){var w,S,C=_.buf;if(w=(112&(S=C[_.pos++]))>>4,S<128||(w|=(127&(S=C[_.pos++]))<<3,S<128)||(w|=(127&(S=C[_.pos++]))<<10,S<128)||(w|=(127&(S=C[_.pos++]))<<17,S<128)||(w|=(127&(S=C[_.pos++]))<<24,S<128)||(w|=(1&(S=C[_.pos++]))<<31,S<128))return Mu(f,w,y);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(s=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,r=this.pos;return this.pos=i,i-r>=12&&s0?function(s,l,f){return s0.decode(s.subarray(l,f))}(this.buf,r,i):function(s,l,f){for(var y="",_=l;_<f;){var w,S,C,P=s[_],M=null,O=P>239?4:P>223?3:P>191?2:1;if(_+O>f)break;O===1?P<128&&(M=P):O===2?(192&(w=s[_+1]))==128&&(M=(31&P)<<6|63&w)<=127&&(M=null):O===3?(S=s[_+2],(192&(w=s[_+1]))==128&&(192&S)==128&&((M=(15&P)<<12|(63&w)<<6|63&S)<=2047||M>=55296&&M<=57343)&&(M=null)):O===4&&(S=s[_+2],C=s[_+3],(192&(w=s[_+1]))==128&&(192&S)==128&&(192&C)==128&&((M=(15&P)<<18|(63&w)<<12|(63&S)<<6|63&C)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,O=1):M>65535&&(M-=65536,y+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),y+=String.fromCharCode(M),_+=O}return y}(this.buf,r,i)},readBytes:function(){var i=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,i);return this.pos=i,r},readPackedVarint:function(i,r){if(this.type!==rr.Bytes)return i.push(this.readVarint(r));var s=po(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(r));return i},readPackedSVarint:function(i){if(this.type!==rr.Bytes)return i.push(this.readSVarint());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==rr.Bytes)return i.push(this.readBoolean());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==rr.Bytes)return i.push(this.readFloat());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==rr.Bytes)return i.push(this.readDouble());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==rr.Bytes)return i.push(this.readFixed32());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==rr.Bytes)return i.push(this.readSFixed32());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==rr.Bytes)return i.push(this.readFixed64());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==rr.Bytes)return i.push(this.readSFixed64());var r=po(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed64());return i},skip:function(i){var r=7&i;if(r===rr.Varint)for(;this.buf[this.pos++]>127;);else if(r===rr.Bytes)this.pos=this.readVarint()+this.pos;else if(r===rr.Fixed32)this.pos+=4;else{if(r!==rr.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(i,r){this.writeVarint(i<<3|r)},realloc:function(i){for(var r=this.length||16;r<this.pos+i;)r*=2;if(r!==this.length){var s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),zu(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),zu(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),zu(this.buf,-1&i,this.pos),zu(this.buf,Math.floor(i*i0),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),zu(this.buf,-1&i,this.pos),zu(this.buf,Math.floor(i*i0),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(r,s){var l,f;if(r>=0?(l=r%4294967296|0,f=r/4294967296|0):(f=~(-r/4294967296),4294967295^(l=~(-r%4294967296))?l=l+1|0:(l=0,f=f+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(y,_,w){w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,w.buf[w.pos]=127&(y>>>=7)}(l,0,s),function(y,_){var w=(7&y)<<4;_.buf[_.pos++]|=w|((y>>>=3)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y)))))}(f,s)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var r=this.pos;this.pos=function(l,f,y){for(var _,w,S=0;S<f.length;S++){if((_=f.charCodeAt(S))>55295&&_<57344){if(!w){_>56319||S+1===f.length?(l[y++]=239,l[y++]=191,l[y++]=189):w=_;continue}if(_<56320){l[y++]=239,l[y++]=191,l[y++]=189,w=_;continue}_=w-55296<<10|_-56320|65536,w=null}else w&&(l[y++]=239,l[y++]=191,l[y++]=189,w=null);_<128?l[y++]=_:(_<2048?l[y++]=_>>6|192:(_<65536?l[y++]=_>>12|224:(l[y++]=_>>18|240,l[y++]=_>>12&63|128),l[y++]=_>>6&63|128),l[y++]=63&_|128)}return y}(this.buf,i,this.pos);var s=this.pos-r;s>=128&&o0(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),n0(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),n0(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var r=i.length;this.writeVarint(r),this.realloc(r);for(var s=0;s<r;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,r){this.pos++;var s=this.pos;i(r,this);var l=this.pos-s;l>=128&&o0(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,r,s){this.writeTag(i,rr.Bytes),this.writeRawMessage(r,s)},writePackedVarint:function(i,r){r.length&&this.writeMessage(i,fC,r)},writePackedSVarint:function(i,r){r.length&&this.writeMessage(i,pC,r)},writePackedBoolean:function(i,r){r.length&&this.writeMessage(i,yC,r)},writePackedFloat:function(i,r){r.length&&this.writeMessage(i,mC,r)},writePackedDouble:function(i,r){r.length&&this.writeMessage(i,gC,r)},writePackedFixed32:function(i,r){r.length&&this.writeMessage(i,_C,r)},writePackedSFixed32:function(i,r){r.length&&this.writeMessage(i,vC,r)},writePackedFixed64:function(i,r){r.length&&this.writeMessage(i,xC,r)},writePackedSFixed64:function(i,r){r.length&&this.writeMessage(i,wC,r)},writeBytesField:function(i,r){this.writeTag(i,rr.Bytes),this.writeBytes(r)},writeFixed32Field:function(i,r){this.writeTag(i,rr.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(i,r){this.writeTag(i,rr.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(i,r){this.writeTag(i,rr.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(i,r){this.writeTag(i,rr.Fixed64),this.writeSFixed64(r)},writeVarintField:function(i,r){this.writeTag(i,rr.Varint),this.writeVarint(r)},writeSVarintField:function(i,r){this.writeTag(i,rr.Varint),this.writeSVarint(r)},writeStringField:function(i,r){this.writeTag(i,rr.Bytes),this.writeString(r)},writeFloatField:function(i,r){this.writeTag(i,rr.Fixed32),this.writeFloat(r)},writeDoubleField:function(i,r){this.writeTag(i,rr.Fixed64),this.writeDouble(r)},writeBooleanField:function(i,r){this.writeVarintField(i,!!r)}};var Dg=k(t0);const Rg=3;function bC(i,r,s){i===1&&s.readMessage(SC,r)}function SC(i,r,s){if(i===3){const{id:l,bitmap:f,width:y,height:_,left:w,top:S,advance:C}=s.readMessage(TC,{});r.push({id:l,bitmap:new Sh({width:y+2*Rg,height:_+2*Rg},f),metrics:{width:y,height:_,left:w,top:S,advance:C}})}}function TC(i,r,s){i===1?r.id=s.readVarint():i===2?r.bitmap=s.readBytes():i===3?r.width=s.readVarint():i===4?r.height=s.readVarint():i===5?r.left=s.readSVarint():i===6?r.top=s.readSVarint():i===7&&(r.advance=s.readVarint())}const l0=Rg;function u0(i){let r=0,s=0;for(const _ of i)r+=_.w*_.h,s=Math.max(s,_.w);i.sort((_,w)=>w.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let f=0,y=0;for(const _ of i)for(let w=l.length-1;w>=0;w--){const S=l[w];if(!(_.w>S.w||_.h>S.h)){if(_.x=S.x,_.y=S.y,y=Math.max(y,_.y+_.h),f=Math.max(f,_.x+_.w),_.w===S.w&&_.h===S.h){const C=l.pop();w<l.length&&(l[w]=C)}else _.h===S.h?(S.x+=_.w,S.w-=_.w):_.w===S.w?(S.y+=_.h,S.h-=_.h):(l.push({x:S.x+_.w,y:S.y,w:S.w-_.w,h:_.h}),S.y+=_.h,S.h-=_.h);break}}return{w:f,h:y,fill:r/(f*y)||0}}const Jn=1;class Lg{constructor(r,{pixelRatio:s,version:l,stretchX:f,stretchY:y,content:_,textFitWidth:w,textFitHeight:S}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=f,this.stretchY=y,this.content=_,this.version=l,this.textFitWidth=w,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Jn,this.paddedRect.y+Jn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Jn,this.paddedRect.y+this.paddedRect.h-Jn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Jn)/this.pixelRatio,(this.paddedRect.h-2*Jn)/this.pixelRatio]}}class c0{constructor(r,s){const l={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(r,l,y),this.addImages(s,f,y);const{w:_,h:w}=u0(y),S=new Bi({width:_||1,height:w||1});for(const C in r){const P=r[C],M=l[C].paddedRect;Bi.copy(P.data,S,{x:0,y:0},{x:M.x+Jn,y:M.y+Jn},P.data)}for(const C in s){const P=s[C],M=f[C].paddedRect,O=M.x+Jn,j=M.y+Jn,U=P.data.width,Z=P.data.height;Bi.copy(P.data,S,{x:0,y:0},{x:O,y:j},P.data),Bi.copy(P.data,S,{x:0,y:Z-1},{x:O,y:j-1},{width:U,height:1}),Bi.copy(P.data,S,{x:0,y:0},{x:O,y:j+Z},{width:U,height:1}),Bi.copy(P.data,S,{x:U-1,y:0},{x:O-1,y:j},{width:1,height:Z}),Bi.copy(P.data,S,{x:0,y:0},{x:O+U,y:j},{width:1,height:Z})}this.image=S,this.iconPositions=l,this.patternPositions=f}addImages(r,s,l){for(const f in r){const y=r[f],_={x:0,y:0,w:y.data.width+2*Jn,h:y.data.height+2*Jn};l.push(_),s[f]=new Lg(_,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(r,s){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in r.updatedImages)this.patchUpdatedImage(this.iconPositions[l],r.getImage(l),s),this.patchUpdatedImage(this.patternPositions[l],r.getImage(l),s)}patchUpdatedImage(r,s,l){if(!r||!s||r.version===s.version)return;r.version=s.version;const[f,y]=r.tl;l.update(s.data,void 0,{x:f,y})}}var oa;nt("ImagePosition",Lg),nt("ImageAtlas",c0),v.ah=void 0,(oa=v.ah||(v.ah={}))[oa.none=0]="none",oa[oa.horizontal=1]="horizontal",oa[oa.vertical=2]="vertical",oa[oa.horizontalOnly=3]="horizontalOnly";const Ah=-17;class Mh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,s){const l=new Mh;return l.scale=r||1,l.fontStack=s,l}static forImage(r){const s=new Mh;return s.imageName=r,s}}class Du{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s){const l=new Du;for(let f=0;f<r.sections.length;f++){const y=r.sections[f];y.image?l.addImageSection(y):l.addTextSection(y,s)}return l}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let s="";for(let l=0;l<r.length;l++){const f=r.charCodeAt(l+1)||null,y=r.charCodeAt(l-1)||null;s+=f&&Sf(f)&&!Ih[r[l+1]]||y&&Sf(y)&&!Ih[r[l-1]]||!Ih[r[l]]?r[l]:Ih[r[l]]}return s}(this.text)}trim(){let r=0;for(let l=0;l<this.text.length&&Nf[this.text.charCodeAt(l)];l++)r++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=r&&Nf[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const l=new Du;return l.text=this.text.substring(r,s),l.sectionIndex=this.sectionIndex.slice(r,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,s)=>Math.max(r,this.sections[s].scale),0)}addTextSection(r,s){this.text+=r.text,this.sections.push(Mh.forText(r.scale,r.fontStack||s));const l=this.sections.length-1;for(let f=0;f<r.text.length;++f)this.sectionIndex.push(l)}addImageSection(r){const s=r.image?r.image.name:"";if(s.length===0)return void xt("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Mh.forImage(s)),this.sectionIndex.push(this.sections.length-1)):xt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Bf(i,r,s,l,f,y,_,w,S,C,P,M,O,j,U){const Z=Du.fromFeature(i,f);let re;M===v.ah.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:oe,processStyledBidirectionalText:xe}=Kn;if(oe&&Z.sections.length===1){re=[];const Ce=oe(Z.toString(),Fg(Z,C,y,r,l,j));for(const Le of Ce){const Qe=new Du;Qe.text=Le,Qe.sections=Z.sections;for(let gt=0;gt<Le.length;gt++)Qe.sectionIndex.push(0);re.push(Qe)}}else if(xe){re=[];const Ce=xe(Z.text,Z.sectionIndex,Fg(Z,C,y,r,l,j));for(const Le of Ce){const Qe=new Du;Qe.text=Le[0],Qe.sectionIndex=Le[1],Qe.sections=Z.sections,re.push(Qe)}}else re=function(Ce,Le){const Qe=[],gt=Ce.text;let Ke=0;for(const We of Le)Qe.push(Ce.substring(Ke,We)),Ke=We;return Ke<gt.length&&Qe.push(Ce.substring(Ke,gt.length)),Qe}(Z,Fg(Z,C,y,r,l,j));const pe=[],ve={positionedLines:pe,text:Z.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:M,iconsInText:!1,verticalizable:!1};return function(Ce,Le,Qe,gt,Ke,We,ct,it,rt,Ie,ht,ut){let Tt=0,ir=Ah,nr=0,qr=0;const ns=it==="right"?1:it==="left"?0:.5;let dn=0;for(const Tr of Ke){Tr.trim();const Hr=Tr.getMaxScale(),bn=(Hr-1)*Nr,fn={positionedGlyphs:[],lineOffset:0};Ce.positionedLines[dn]=fn;const On=fn.positionedGlyphs;let pn=0;if(!Tr.length()){ir+=We,++dn;continue}for(let Qn=0;Qn<Tr.length();Qn++){const Gt=Tr.getSection(Qn),or=Tr.getSectionIndex(Qn),fr=Tr.getCharCode(Qn);let _i=0,_r=null,Ou=null,Bs=null,Ns=Nr;const is=!(rt===v.ah.horizontal||!ht&&!gh(fr)||ht&&(Nf[fr]||(Zr=fr,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Zr)))));if(Gt.imageName){const Vi=gt[Gt.imageName];if(!Vi)continue;Bs=Gt.imageName,Ce.iconsInText=Ce.iconsInText||!0,Ou=Vi.paddedRect;const Qr=Vi.displaySize;Gt.scale=Gt.scale*Nr/ut,_r={width:Qr[0],height:Qr[1],left:Jn,top:-l0,advance:is?Qr[1]:Qr[0]},_i=bn+(Nr-Qr[1]*Gt.scale),Ns=_r.advance;const mo=is?Qr[0]*Gt.scale-Nr*Hr:Qr[1]*Gt.scale-Nr*Hr;mo>0&&mo>pn&&(pn=mo)}else{const Vi=Qe[Gt.fontStack],Qr=Vi&&Vi[fr];if(Qr&&Qr.rect)Ou=Qr.rect,_r=Qr.metrics;else{const mo=Le[Gt.fontStack],Oh=mo&&mo[fr];if(!Oh)continue;_r=Oh.metrics}_i=(Hr-Gt.scale)*Nr}is?(Ce.verticalizable=!0,On.push({glyph:fr,imageName:Bs,x:Tt,y:ir+_i,vertical:is,scale:Gt.scale,fontStack:Gt.fontStack,sectionIndex:or,metrics:_r,rect:Ou}),Tt+=Ns*Gt.scale+Ie):(On.push({glyph:fr,imageName:Bs,x:Tt,y:ir+_i,vertical:is,scale:Gt.scale,fontStack:Gt.fontStack,sectionIndex:or,metrics:_r,rect:Ou}),Tt+=_r.advance*Gt.scale+Ie)}On.length!==0&&(nr=Math.max(Tt-Ie,nr),PC(On,0,On.length-1,ns,pn)),Tt=0;const ji=We*Hr+pn;fn.lineOffset=Math.max(pn,bn),ir+=ji,qr=Math.max(ji,qr),++dn}var Zr;const Rn=ir-Ah,{horizontalAlign:Ln,verticalAlign:Fn}=Og(ct);(function(Tr,Hr,bn,fn,On,pn,ji,Qn,Gt){const or=(Hr-bn)*On;let fr=0;fr=pn!==ji?-Qn*fn-Ah:(-fn*Gt+.5)*ji;for(const _i of Tr)for(const _r of _i.positionedGlyphs)_r.x+=or,_r.y+=fr})(Ce.positionedLines,ns,Ln,Fn,nr,qr,We,Rn,Ke.length),Ce.top+=-Fn*Rn,Ce.bottom=Ce.top+Rn,Ce.left+=-Ln*nr,Ce.right=Ce.left+nr}(ve,r,s,l,re,_,w,S,M,C,O,U),!function(Ce){for(const Le of Ce)if(Le.positionedGlyphs.length!==0)return!1;return!0}(pe)&&ve}const Nf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},EC={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},CC={40:!0};function h0(i,r,s,l,f,y){if(r.imageName){const _=l[r.imageName];return _?_.displaySize[0]*r.scale*Nr/y+f:0}{const _=s[r.fontStack],w=_&&_[i];return w?w.metrics.advance*r.scale+f:0}}function d0(i,r,s,l){const f=Math.pow(i-r,2);return l?i<r?f/2:2*f:f+Math.abs(s)*s}function kC(i,r,s){let l=0;return i===10&&(l-=1e4),s&&(l+=150),i!==40&&i!==65288||(l+=50),r!==41&&r!==65289||(l+=50),l}function f0(i,r,s,l,f,y){let _=null,w=d0(r,s,f,y);for(const S of l){const C=d0(r-S.x,s,f,y)+S.badness;C<=w&&(_=S,w=C)}return{index:i,x:r,priorBreak:_,badness:w}}function p0(i){return i?p0(i.priorBreak).concat(i.index):[]}function Fg(i,r,s,l,f,y){if(!i)return[];const _=[],w=function(M,O,j,U,Z,re){let oe=0;for(let xe=0;xe<M.length();xe++){const pe=M.getSection(xe);oe+=h0(M.getCharCode(xe),pe,U,Z,O,re)}return oe/Math.max(1,Math.ceil(oe/j))}(i,r,s,l,f,y),S=i.text.indexOf("")>=0;let C=0;for(let M=0;M<i.length();M++){const O=i.getSection(M),j=i.getCharCode(M);if(Nf[j]||(C+=h0(j,O,l,f,r,y)),M<i.length()-1){const U=!((P=j)<11904)&&(!!Vt["CJK Compatibility Forms"](P)||!!Vt["CJK Compatibility"](P)||!!Vt["CJK Strokes"](P)||!!Vt["CJK Symbols and Punctuation"](P)||!!Vt["Enclosed CJK Letters and Months"](P)||!!Vt["Halfwidth and Fullwidth Forms"](P)||!!Vt["Ideographic Description Characters"](P)||!!Vt["Vertical Forms"](P)||bf.test(String.fromCodePoint(P)));(EC[j]||U||O.imageName||M!==i.length()-2&&CC[i.getCharCode(M+1)])&&_.push(f0(M+1,C,w,_,kC(j,i.getCharCode(M+1),U&&S),!1))}}var P;return p0(f0(i.length(),C,w,_,0,!0))}function Og(i){let r=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function PC(i,r,s,l,f){if(!l&&!f)return;const y=i[s],_=(i[s].x+y.metrics.advance*y.scale)*l;for(let w=r;w<=s;w++)i[w].x-=_,i[w].y+=f}function IC(i,r,s){const{horizontalAlign:l,verticalAlign:f}=Og(s),y=r[0]-i.displaySize[0]*l,_=r[1]-i.displaySize[1]*f;return{image:i,top:_,bottom:_+i.displaySize[1],left:y,right:y+i.displaySize[0]}}function m0(i){var r,s;let l=i.left,f=i.top,y=i.right-l,_=i.bottom-f;const w=(r=i.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",S=(s=i.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",C=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(S==="proportional"){if(w==="stretchOnly"&&y/_<C||w==="proportional"){const P=Math.ceil(_*C);l*=P/y,y=P}}else if(w==="proportional"&&S==="stretchOnly"&&C!==0&&y/_>C){const P=Math.ceil(y/C);f*=P/_,_=P}return{x1:l,y1:f,x2:l+y,y2:f+_}}function g0(i,r,s,l,f,y){const _=i.image;let w;if(_.content){const re=_.content,oe=_.pixelRatio||1;w=[re[0]/oe,re[1]/oe,_.displaySize[0]-re[2]/oe,_.displaySize[1]-re[3]/oe]}const S=r.left*y,C=r.right*y;let P,M,O,j;s==="width"||s==="both"?(j=f[0]+S-l[3],M=f[0]+C+l[1]):(j=f[0]+(S+C-_.displaySize[0])/2,M=j+_.displaySize[0]);const U=r.top*y,Z=r.bottom*y;return s==="height"||s==="both"?(P=f[1]+U-l[0],O=f[1]+Z+l[2]):(P=f[1]+(U+Z-_.displaySize[1])/2,O=P+_.displaySize[1]),{image:_,top:P,right:M,bottom:O,left:j,collisionPadding:w}}const zh=255,Os=128,aa=zh*Os;function y0(i,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ur(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:f}=s;let y=0;for(;y<l.length&&l[y]<=i;)y++;y=Math.max(0,y-1);let _=y;for(;_<l.length&&l[_]<i+1;)_++;_=Math.min(l.length-1,_);const w=l[y],S=l[_];return s.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:w,maxZoom:S,minSize:s.evaluate(new ur(w)),maxSize:s.evaluate(new ur(S)),interpolationType:f}}}function Bg(i,r,s){let l="never";const f=i.get(r);return f?l=f:i.get(s)&&(l="always"),l}const AC=sa.VectorTileFeature.types,MC=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function jf(i,r,s,l,f,y,_,w,S,C,P,M,O){const j=w?Math.min(aa,Math.round(w[0])):0,U=w?Math.min(aa,Math.round(w[1])):0;i.emplaceBack(r,s,Math.round(32*l),Math.round(32*f),y,_,(j<<1)+(S?1:0),U,16*C,16*P,256*M,256*O)}function Ng(i,r,s){i.emplaceBack(r.x,r.y,s),i.emplaceBack(r.x,r.y,s),i.emplaceBack(r.x,r.y,s),i.emplaceBack(r.x,r.y,s)}function zC(i){for(const r of i.sections)if(fg(r.text))return!0;return!1}class jg{constructor(r){this.layoutVertexArray=new bu,this.indexArray=new Oi,this.programConfigurations=r,this.segments=new $t,this.dynamicLayoutVertexArray=new vh,this.opacityVertexArray=new gi,this.hasVisibleVertices=!1,this.placedSymbolArray=new cr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,s,l,f){this.isEmpty()||(l&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,lC.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,uC.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,MC,!0),this.opacityVertexBuffer.itemSize=1),(l||f)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}nt("SymbolBuffers",jg);class Vg{constructor(r,s,l){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new l,this.segments=new $t,this.collisionVertexArray=new Ls}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,cC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}nt("CollisionBuffers",Vg);class Ru{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(_=>_.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=xg([]),this.placementViewportMatrix=xg([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=y0(this.zoom,s["text-size"]),this.iconSizeData=y0(this.zoom,s["icon-size"]);const l=this.layers[0].layout,f=l.get("symbol-sort-key"),y=l.get("symbol-z-order");this.canOverlap=Bg(l,"text-overlap","text-allow-overlap")!=="never"||Bg(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>v.ah[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=r.sourceID}createArrays(){this.text=new jg(new fl(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new jg(new fl(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new hr,this.lineVertexArray=new ln,this.symbolInstances=new Nt,this.textAnchorOffsets=new dr}calculateGlyphDependencies(r,s,l,f,y){for(let _=0;_<r.length;_++)if(s[r.charCodeAt(_)]=!0,(l||f)&&y){const w=Ih[r.charAt(_)];w&&(s[w.charCodeAt(0)]=!0)}}populate(r,s,l){const f=this.layers[0],y=f.layout,_=y.get("text-font"),w=y.get("text-field"),S=y.get("icon-image"),C=(w.value.kind!=="constant"||w.value.value instanceof Hn&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),P=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,M=y.get("symbol-sort-key");if(this.features=[],!C&&!P)return;const O=s.iconDependencies,j=s.glyphDependencies,U=s.availableImages,Z=new ur(this.zoom);for(const{feature:re,id:oe,index:xe,sourceLayerIndex:pe}of r){const ve=f._featureFilter.needGeometry,Ce=ml(re,ve);if(!f._featureFilter.filter(Z,Ce,l))continue;let Le,Qe;if(ve||(Ce.geometry=pl(re)),C){const Ke=f.getValueAndResolveTokens("text-field",Ce,l,U),We=Hn.factory(Ke),ct=this.hasRTLText=this.hasRTLText||zC(We);(!ct||Kn.getRTLTextPluginStatus()==="unavailable"||ct&&Kn.isParsed())&&(Le=dC(We,f,Ce))}if(P){const Ke=f.getValueAndResolveTokens("icon-image",Ce,l,U);Qe=Ke instanceof Wn?Ke:Wn.fromString(Ke)}if(!Le&&!Qe)continue;const gt=this.sortFeaturesByKey?M.evaluate(Ce,{},l):void 0;if(this.features.push({id:oe,text:Le,icon:Qe,index:xe,sourceLayerIndex:pe,geometry:Ce.geometry,properties:re.properties,type:AC[re.type],sortKey:gt}),Qe&&(O[Qe.name]=!0),Le){const Ke=_.evaluate(Ce,{},l).join(","),We=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ah.vertical)>=0;for(const ct of Le.sections)if(ct.image)O[ct.image.name]=!0;else{const it=ph(Le.toString()),rt=ct.fontStack||Ke,Ie=j[rt]=j[rt]||{};this.calculateGlyphDependencies(ct.text,Ie,We,this.allowVerticalPlacement,it)}}}y.get("symbol-placement")==="line"&&(this.features=function(re){const oe={},xe={},pe=[];let ve=0;function Ce(Ke){pe.push(re[Ke]),ve++}function Le(Ke,We,ct){const it=xe[Ke];return delete xe[Ke],xe[We]=it,pe[it].geometry[0].pop(),pe[it].geometry[0]=pe[it].geometry[0].concat(ct[0]),it}function Qe(Ke,We,ct){const it=oe[We];return delete oe[We],oe[Ke]=it,pe[it].geometry[0].shift(),pe[it].geometry[0]=ct[0].concat(pe[it].geometry[0]),it}function gt(Ke,We,ct){const it=ct?We[0][We[0].length-1]:We[0][0];return`${Ke}:${it.x}:${it.y}`}for(let Ke=0;Ke<re.length;Ke++){const We=re[Ke],ct=We.geometry,it=We.text?We.text.toString():null;if(!it){Ce(Ke);continue}const rt=gt(it,ct),Ie=gt(it,ct,!0);if(rt in xe&&Ie in oe&&xe[rt]!==oe[Ie]){const ht=Qe(rt,Ie,ct),ut=Le(rt,Ie,pe[ht].geometry);delete oe[rt],delete xe[Ie],xe[gt(it,pe[ut].geometry,!0)]=ut,pe[ht].geometry=null}else rt in xe?Le(rt,Ie,ct):Ie in oe?Qe(rt,Ie,ct):(Ce(Ke),oe[rt]=ve-1,xe[Ie]=ve-1)}return pe.filter(Ke=>Ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((re,oe)=>re.sortKey-oe.sortKey)}update(r,s,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,s,this.layers,l),this.icon.programConfigurations.updatePaintArrays(r,s,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,s){const l=this.lineVertexArray.length;if(r.segment!==void 0){let f=r.dist(s[r.segment+1]),y=r.dist(s[r.segment]);const _={};for(let w=r.segment+1;w<s.length;w++)_[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:f},w<s.length-1&&(f+=s[w+1].dist(s[w]));for(let w=r.segment||0;w>=0;w--)_[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:y},w>0&&(y+=s[w-1].dist(s[w]));for(let w=0;w<s.length;w++){const S=_[w];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(r,s,l,f,y,_,w,S,C,P,M,O){const j=r.indexArray,U=r.layoutVertexArray,Z=r.segments.prepareSegment(4*s.length,U,j,this.canOverlap?_.sortKey:void 0),re=this.glyphOffsetArray.length,oe=Z.vertexLength,xe=this.allowVerticalPlacement&&w===v.ah.vertical?Math.PI/2:0,pe=_.text&&_.text.sections;for(let ve=0;ve<s.length;ve++){const{tl:Ce,tr:Le,bl:Qe,br:gt,tex:Ke,pixelOffsetTL:We,pixelOffsetBR:ct,minFontScaleX:it,minFontScaleY:rt,glyphOffset:Ie,isSDF:ht,sectionIndex:ut}=s[ve],Tt=Z.vertexLength,ir=Ie[1];jf(U,S.x,S.y,Ce.x,ir+Ce.y,Ke.x,Ke.y,l,ht,We.x,We.y,it,rt),jf(U,S.x,S.y,Le.x,ir+Le.y,Ke.x+Ke.w,Ke.y,l,ht,ct.x,We.y,it,rt),jf(U,S.x,S.y,Qe.x,ir+Qe.y,Ke.x,Ke.y+Ke.h,l,ht,We.x,ct.y,it,rt),jf(U,S.x,S.y,gt.x,ir+gt.y,Ke.x+Ke.w,Ke.y+Ke.h,l,ht,ct.x,ct.y,it,rt),Ng(r.dynamicLayoutVertexArray,S,xe),j.emplaceBack(Tt,Tt+1,Tt+2),j.emplaceBack(Tt+1,Tt+2,Tt+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ie[0]),ve!==s.length-1&&ut===s[ve+1].sectionIndex||r.programConfigurations.populatePaintArrays(U.length,_,_.index,{},O,pe&&pe[ut])}r.placedSymbolArray.emplaceBack(S.x,S.y,re,this.glyphOffsetArray.length-re,oe,C,P,S.segment,l?l[0]:0,l?l[1]:0,f[0],f[1],w,0,!1,0,M)}_addCollisionDebugVertex(r,s,l,f,y,_){return s.emplaceBack(0,0),r.emplaceBack(l.x,l.y,f,y,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(r,s,l,f,y,_,w){const S=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),C=S.vertexLength,P=y.layoutVertexArray,M=y.collisionVertexArray,O=w.anchorX,j=w.anchorY;this._addCollisionDebugVertex(P,M,_,O,j,new R(r,s)),this._addCollisionDebugVertex(P,M,_,O,j,new R(l,s)),this._addCollisionDebugVertex(P,M,_,O,j,new R(l,f)),this._addCollisionDebugVertex(P,M,_,O,j,new R(r,f)),S.vertexLength+=4;const U=y.indexArray;U.emplaceBack(C,C+1),U.emplaceBack(C+1,C+2),U.emplaceBack(C+2,C+3),U.emplaceBack(C+3,C),S.primitiveLength+=4}addDebugCollisionBoxes(r,s,l,f){for(let y=r;y<s;y++){const _=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,f?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Vg(yi,e0.members,Jr),this.iconCollisionBox=new Vg(yi,e0.members,Jr);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(r,s,l,f,y,_,w,S,C){const P={};for(let M=s;M<l;M++){const O=r.get(M);P.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.textFeatureIndex=O.featureIndex;break}for(let M=f;M<y;M++){const O=r.get(M);P.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalTextFeatureIndex=O.featureIndex;break}for(let M=_;M<w;M++){const O=r.get(M);P.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.iconFeatureIndex=O.featureIndex;break}for(let M=S;M<C;M++){const O=r.get(M);P.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalIconFeatureIndex=O.featureIndex;break}return P}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,s){const l=r.placedSymbolArray.get(s),f=l.vertexStartIndex+4*l.numGlyphs;for(let y=l.vertexStartIndex;y<f;y+=4)r.indexArray.emplaceBack(y,y+1,y+2),r.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),l=Math.cos(r),f=[],y=[],_=[];for(let w=0;w<this.symbolInstances.length;++w){_.push(w);const S=this.symbolInstances.get(w);f.push(0|Math.round(s*S.anchorX+l*S.anchorY)),y.push(S.featureIndex)}return _.sort((w,S)=>f[w]-f[S]||y[S]-y[w]),_}addToSortKeyRanges(r,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((f,y,_)=>{f>=0&&_.indexOf(f)===y&&this.addIndicesForPlacedSymbol(this.text,f)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let _0,v0;nt("SymbolBucket",Ru,{omit:["layers","collisionBoxArray","features","compareText"]}),Ru.MAX_GLYPHS=65535,Ru.addDynamicAttributes=Ng;var $g={get paint(){return v0=v0||new g({"icon-opacity":new _t(Te.paint_symbol["icon-opacity"]),"icon-color":new _t(Te.paint_symbol["icon-color"]),"icon-halo-color":new _t(Te.paint_symbol["icon-halo-color"]),"icon-halo-width":new _t(Te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _t(Te.paint_symbol["icon-halo-blur"]),"icon-translate":new at(Te.paint_symbol["icon-translate"]),"icon-translate-anchor":new at(Te.paint_symbol["icon-translate-anchor"]),"text-opacity":new _t(Te.paint_symbol["text-opacity"]),"text-color":new _t(Te.paint_symbol["text-color"],{runtimeType:Cr,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new _t(Te.paint_symbol["text-halo-color"]),"text-halo-width":new _t(Te.paint_symbol["text-halo-width"]),"text-halo-blur":new _t(Te.paint_symbol["text-halo-blur"]),"text-translate":new at(Te.paint_symbol["text-translate"]),"text-translate-anchor":new at(Te.paint_symbol["text-translate-anchor"])})},get layout(){return _0=_0||new g({"symbol-placement":new at(Te.layout_symbol["symbol-placement"]),"symbol-spacing":new at(Te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new at(Te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _t(Te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new at(Te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new at(Te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new at(Te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new at(Te.layout_symbol["icon-ignore-placement"]),"icon-optional":new at(Te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new at(Te.layout_symbol["icon-rotation-alignment"]),"icon-size":new _t(Te.layout_symbol["icon-size"]),"icon-text-fit":new at(Te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new at(Te.layout_symbol["icon-text-fit-padding"]),"icon-image":new _t(Te.layout_symbol["icon-image"]),"icon-rotate":new _t(Te.layout_symbol["icon-rotate"]),"icon-padding":new _t(Te.layout_symbol["icon-padding"]),"icon-keep-upright":new at(Te.layout_symbol["icon-keep-upright"]),"icon-offset":new _t(Te.layout_symbol["icon-offset"]),"icon-anchor":new _t(Te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new at(Te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new at(Te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new at(Te.layout_symbol["text-rotation-alignment"]),"text-field":new _t(Te.layout_symbol["text-field"]),"text-font":new _t(Te.layout_symbol["text-font"]),"text-size":new _t(Te.layout_symbol["text-size"]),"text-max-width":new _t(Te.layout_symbol["text-max-width"]),"text-line-height":new at(Te.layout_symbol["text-line-height"]),"text-letter-spacing":new _t(Te.layout_symbol["text-letter-spacing"]),"text-justify":new _t(Te.layout_symbol["text-justify"]),"text-radial-offset":new _t(Te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new at(Te.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new _t(Te.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new _t(Te.layout_symbol["text-anchor"]),"text-max-angle":new at(Te.layout_symbol["text-max-angle"]),"text-writing-mode":new at(Te.layout_symbol["text-writing-mode"]),"text-rotate":new _t(Te.layout_symbol["text-rotate"]),"text-padding":new at(Te.layout_symbol["text-padding"]),"text-keep-upright":new at(Te.layout_symbol["text-keep-upright"]),"text-transform":new _t(Te.layout_symbol["text-transform"]),"text-offset":new _t(Te.layout_symbol["text-offset"]),"text-allow-overlap":new at(Te.layout_symbol["text-allow-overlap"]),"text-overlap":new at(Te.layout_symbol["text-overlap"]),"text-ignore-placement":new at(Te.layout_symbol["text-ignore-placement"]),"text-optional":new at(Te.layout_symbol["text-optional"])})}};class x0{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Ai,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nt("FormatSectionOverride",x0,{omit:["defaultValue"]});class Vf extends a{constructor(r){super(r,$g)}recalculate(r,s){if(super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const f=[];for(const y of l)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,s,l,f){const y=this.layout.get(r).evaluate(s,{},l,f),_=this._unevaluatedLayout._values[r];return _.isDataDriven()||au(_.value)||!y?y:function(w,S){return S.replace(/{([^{}]+)}/g,(C,P)=>w&&P in w?String(w[P]):"")}(s.properties,y)}createBucket(r){return new Ru(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of $g.paint.overridableProperties){if(!Vf.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),l=new x0(s),f=new ou(l,s.property.specification);let y=null;y=s.value.kind==="constant"||s.value.kind==="source"?new qo("source",f):new Zo("composite",f,s.value.zoomStops),this.paint._values[r]=new ts(s.property,y,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&Vf.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const l=r.get("text-field"),f=$g.paint.properties[s];let y=!1;const _=w=>{for(const S of w)if(f.overrides&&f.overrides.hasOverride(S))return void(y=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Hn)_(l.value.value.sections);else if(l.value.kind==="source"){const w=C=>{y||(C instanceof Mi&&Rr(C.value)===ci?_(C.value.sections):C instanceof Yl?_(C.sections):C.eachChild(w))},S=l.value;S._styleExpression&&w(S._styleExpression.expression)}return y}}let w0;var DC={get paint(){return w0=w0||new g({"background-color":new at(Te.paint_background["background-color"]),"background-pattern":new xu(Te.paint_background["background-pattern"]),"background-opacity":new at(Te.paint_background["background-opacity"])})}};class RC extends a{constructor(r){super(r,DC)}}let b0;var LC={get paint(){return b0=b0||new g({"raster-opacity":new at(Te.paint_raster["raster-opacity"]),"raster-hue-rotate":new at(Te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new at(Te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new at(Te.paint_raster["raster-brightness-max"]),"raster-saturation":new at(Te.paint_raster["raster-saturation"]),"raster-contrast":new at(Te.paint_raster["raster-contrast"]),"raster-resampling":new at(Te.paint_raster["raster-resampling"]),"raster-fade-duration":new at(Te.paint_raster["raster-fade-duration"])})}};class FC extends a{constructor(r){super(r,LC)}}class OC extends a{constructor(r){super(r,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class BC{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Ug=63710088e-1;class la{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new la(ke(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,l=this.lat*s,f=r.lat*s,y=Math.sin(l)*Math.sin(f)+Math.cos(l)*Math.cos(f)*Math.cos((r.lng-this.lng)*s);return Ug*Math.acos(Math.min(y,1))}static convert(r){if(r instanceof la)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new la(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new la(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const S0=2*Math.PI*Ug;function T0(i){return S0*Math.cos(i*Math.PI/180)}function E0(i){return(180+i)/360}function C0(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function k0(i,r){return i/T0(r)}function qg(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Dh{constructor(r,s,l=0){this.x=+r,this.y=+s,this.z=+l}static fromLngLat(r,s=0){const l=la.convert(r);return new Dh(E0(l.lng),C0(l.lat),k0(s,l.lat))}toLngLat(){return new la(360*this.x-180,qg(this.y))}toAltitude(){return this.z*T0(qg(this.y))}meterInMercatorCoordinateUnits(){return 1/S0*(r=qg(this.y),1/Math.cos(r*Math.PI/180));var r}}function P0(i,r,s){var l=2*Math.PI*6378137/256/Math.pow(2,s);return[i*l-2*Math.PI*6378137/2,r*l-2*Math.PI*6378137/2]}class Zg{constructor(r,s,l){if(!function(f,y,_){return!(f<0||f>25||_<0||_>=Math.pow(2,f)||y<0||y>=Math.pow(2,f))}(r,s,l))throw new Error(`x=${s}, y=${l}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=s,this.y=l,this.key=Rh(0,r,r,s,l)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s,l){const f=(_=this.y,w=this.z,S=P0(256*(y=this.x),256*(_=Math.pow(2,w)-_-1),w),C=P0(256*(y+1),256*(_+1),w),S[0]+","+S[1]+","+C[0]+","+C[1]);var y,_,w,S,C;const P=function(M,O,j){let U,Z="";for(let re=M;re>0;re--)U=1<<re-1,Z+=(O&U?1:0)+(j&U?2:0);return Z}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,f)}isChildOf(r){const s=this.z-r.z;return s>0&&r.x===this.x>>s&&r.y===this.y>>s}getTilePoint(r){const s=Math.pow(2,this.z);return new R((r.x*s-this.x)*Lr,(r.y*s-this.y)*Lr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class I0{constructor(r,s){this.wrap=r,this.canonical=s,this.key=Rh(r,s.z,s.z,s.x,s.y)}}class Ni{constructor(r,s,l,f,y){if(r<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${l}`);this.overscaledZ=r,this.wrap=s,this.canonical=new Zg(l,+f,+y),this.key=Rh(s,r,l,f,y)}clone(){return new Ni(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-r;return r>this.canonical.z?new Ni(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ni(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(r,s){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-r;return r>this.canonical.z?Rh(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y):Rh(this.wrap*+s,r,r,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const s=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Ni(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,f=2*this.canonical.y;return[new Ni(s,this.wrap,s,l,f),new Ni(s,this.wrap,s,l+1,f),new Ni(s,this.wrap,s,l,f+1),new Ni(s,this.wrap,s,l+1,f+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ni(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ni(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new I0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Dh(r.x-this.wrap,r.y))}}function Rh(i,r,s,l,f){(i*=2)<0&&(i=-1*i-1);const y=1<<s;return(y*y*i+y*f+l).toString(36)+s.toString(36)+r.toString(36)}nt("CanonicalTileID",Zg),nt("OverscaledTileID",Ni,{omit:["posMatrix"]});class A0{constructor(r,s,l,f=1,y=1,_=1,w=0){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void xt(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const S=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=y,this.blueFactor=_,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<S;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(S,C)]=this.data[this._idx(S-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,S)]=this.data[this._idx(C,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<S;C++)for(let P=0;P<S;P++){const M=this.get(C,P);M>this.max&&(this.max=M),M<this.min&&(this.min=M)}}get(r,s){const l=new Uint8Array(this.data.buffer),f=4*this._idx(r,s);return this.unpack(l[f],l[f+1],l[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}unpack(r,s,l){return r*this.redFactor+s*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Bi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,s,l){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let f=s*this.dim,y=s*this.dim+this.dim,_=l*this.dim,w=l*this.dim+this.dim;switch(s){case-1:f=y-1;break;case 1:y=f+1}switch(l){case-1:_=w-1;break;case 1:w=_+1}const S=-s*this.dim,C=-l*this.dim;for(let P=_;P<w;P++)for(let M=f;M<y;M++)this.data[this._idx(M,P)]=r.data[this._idx(M+S,P+C)]}}nt("DEMData",A0);class M0{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const l=r[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class z0{constructor(r,s,l,f,y){this.type="Feature",this._vectorTileFeature=r,r._z=s,r._x=l,r._y=f,this.properties=r.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(r[s]=this[s]);return r}}class D0{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Wo(Lr,16,0),this.grid3D=new Wo(Lr,16,0),this.featureIndexArray=new xn,this.promoteId=s}insert(r,s,l,f,y,_){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,f,y);const S=_?this.grid3D:this.grid;for(let C=0;C<s.length;C++){const P=s[C],M=[1/0,1/0,-1/0,-1/0];for(let O=0;O<P.length;O++){const j=P[O];M[0]=Math.min(M[0],j.x),M[1]=Math.min(M[1],j.y),M[2]=Math.max(M[2],j.x),M[3]=Math.max(M[3],j.y)}M[0]<Lr&&M[1]<Lr&&M[2]>=0&&M[3]>=0&&S.insert(w,M[0],M[1],M[2],M[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new sa.VectorTile(new Dg(this.rawTileData)).layers,this.sourceLayerCoder=new M0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,s,l,f){this.loadVTLayers();const y=r.params||{},_=Lr/r.tileSize/r.scale,w=Qc(y.filter),S=r.queryGeometry,C=r.queryPadding*_,P=L0(S),M=this.grid.query(P.minX-C,P.minY-C,P.maxX+C,P.maxY+C),O=L0(r.cameraQueryGeometry),j=this.grid3D.query(O.minX-C,O.minY-C,O.maxX+C,O.maxY+C,(re,oe,xe,pe)=>function(ve,Ce,Le,Qe,gt){for(const We of ve)if(Ce<=We.x&&Le<=We.y&&Qe>=We.x&&gt>=We.y)return!0;const Ke=[new R(Ce,Le),new R(Ce,gt),new R(Qe,gt),new R(Qe,Le)];if(ve.length>2){for(const We of Ke)if(ku(ve,We))return!0}for(let We=0;We<ve.length-1;We++)if(_E(ve[We],ve[We+1],Ke))return!0;return!1}(r.cameraQueryGeometry,re-C,oe-C,xe+C,pe+C));for(const re of j)M.push(re);M.sort(NC);const U={};let Z;for(let re=0;re<M.length;re++){const oe=M[re];if(oe===Z)continue;Z=oe;const xe=this.featureIndexArray.get(oe);let pe=null;this.loadMatchingFeature(U,xe.bucketIndex,xe.sourceLayerIndex,xe.featureIndex,w,y.layers,y.availableImages,s,l,f,(ve,Ce,Le)=>(pe||(pe=pl(ve)),Ce.queryIntersectsFeature(S,ve,Le,pe,this.z,r.transform,_,r.pixelPosMatrix)))}return U}loadMatchingFeature(r,s,l,f,y,_,w,S,C,P,M){const O=this.bucketLayerIDs[s];if(_&&!function(re,oe){for(let xe=0;xe<re.length;xe++)if(oe.indexOf(re[xe])>=0)return!0;return!1}(_,O))return;const j=this.sourceLayerCoder.decode(l),U=this.vtLayers[j].feature(f);if(y.needGeometry){const re=ml(U,!0);if(!y.filter(new ur(this.tileID.overscaledZ),re,this.tileID.canonical))return}else if(!y.filter(new ur(this.tileID.overscaledZ),U))return;const Z=this.getId(U,j);for(let re=0;re<O.length;re++){const oe=O[re];if(_&&_.indexOf(oe)<0)continue;const xe=S[oe];if(!xe)continue;let pe={};Z&&P&&(pe=P.getState(xe.sourceLayer||"_geojsonTileLayer",Z));const ve=Pe({},C[oe]);ve.paint=R0(ve.paint,xe.paint,U,pe,w),ve.layout=R0(ve.layout,xe.layout,U,pe,w);const Ce=!M||M(U,xe,pe);if(!Ce)continue;const Le=new z0(U,this.z,this.x,this.y,Z);Le.layer=ve;let Qe=r[oe];Qe===void 0&&(Qe=r[oe]=[]),Qe.push({featureIndex:f,feature:Le,intersectionZ:Ce})}}lookupSymbolFeatures(r,s,l,f,y,_,w,S){const C={};this.loadVTLayers();const P=Qc(y);for(const M of r)this.loadMatchingFeature(C,l,f,M,P,_,w,S,s);return C}hasLayer(r){for(const s of this.bucketLayerIDs)for(const l of s)if(r===l)return!0;return!1}getId(r,s){let l=r.id;return this.promoteId&&(l=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof l=="boolean"&&(l=Number(l))),l}}function R0(i,r,s,l,f){return st(i,(y,_)=>{const w=r instanceof cl?r.get(_):null;return w&&w.evaluate?w.evaluate(s,l,f):w})}function L0(i){let r=1/0,s=1/0,l=-1/0,f=-1/0;for(const y of i)r=Math.min(r,y.x),s=Math.min(s,y.y),l=Math.max(l,y.x),f=Math.max(f,y.y);return{minX:r,minY:s,maxX:l,maxY:f}}function NC(i,r){return r-i}function F0(i,r,s,l,f){const y=[];for(let _=0;_<i.length;_++){const w=i[_];let S;for(let C=0;C<w.length-1;C++){let P=w[C],M=w[C+1];P.x<r&&M.x<r||(P.x<r?P=new R(r,P.y+(r-P.x)/(M.x-P.x)*(M.y-P.y))._round():M.x<r&&(M=new R(r,P.y+(r-P.x)/(M.x-P.x)*(M.y-P.y))._round()),P.y<s&&M.y<s||(P.y<s?P=new R(P.x+(s-P.y)/(M.y-P.y)*(M.x-P.x),s)._round():M.y<s&&(M=new R(P.x+(s-P.y)/(M.y-P.y)*(M.x-P.x),s)._round()),P.x>=l&&M.x>=l||(P.x>=l?P=new R(l,P.y+(l-P.x)/(M.x-P.x)*(M.y-P.y))._round():M.x>=l&&(M=new R(l,P.y+(l-P.x)/(M.x-P.x)*(M.y-P.y))._round()),P.y>=f&&M.y>=f||(P.y>=f?P=new R(P.x+(f-P.y)/(M.y-P.y)*(M.x-P.x),f)._round():M.y>=f&&(M=new R(P.x+(f-P.y)/(M.y-P.y)*(M.x-P.x),f)._round()),S&&P.equals(S[S.length-1])||(S=[P],y.push(S)),S.push(M)))))}}return y}nt("FeatureIndex",D0,{omit:["rawTileData","sourceLayerCoder"]});class ua extends R{constructor(r,s,l,f){super(r,s),this.angle=l,f!==void 0&&(this.segment=f)}clone(){return new ua(this.x,this.y,this.angle,this.segment)}}function O0(i,r,s,l,f){if(r.segment===void 0||s===0)return!0;let y=r,_=r.segment+1,w=0;for(;w>-s/2;){if(_--,_<0)return!1;w-=i[_].dist(y),y=i[_]}w+=i[_].dist(i[_+1]),_++;const S=[];let C=0;for(;w<s/2;){const P=i[_],M=i[_+1];if(!M)return!1;let O=i[_-1].angleTo(P)-P.angleTo(M);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:w,angleDelta:O}),C+=O;w-S[0].distance>l;)C-=S.shift().angleDelta;if(C>f)return!1;_++,w+=P.dist(M)}return!0}function B0(i){let r=0;for(let s=0;s<i.length-1;s++)r+=i[s].dist(i[s+1]);return r}function N0(i,r,s){return i?.6*r*s:0}function j0(i,r){return Math.max(i?i.right-i.left:0,r?r.right-r.left:0)}function jC(i,r,s,l,f,y){const _=N0(s,f,y),w=j0(s,l)*y;let S=0;const C=B0(i)/2;for(let P=0;P<i.length-1;P++){const M=i[P],O=i[P+1],j=M.dist(O);if(S+j>C){const U=(C-S)/j,Z=An.number(M.x,O.x,U),re=An.number(M.y,O.y,U),oe=new ua(Z,re,O.angleTo(M),P);return oe._round(),!_||O0(i,oe,w,_,r)?oe:void 0}S+=j}}function VC(i,r,s,l,f,y,_,w,S){const C=N0(l,y,_),P=j0(l,f),M=P*_,O=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return r-M<r/4&&(r=M+r/4),V0(i,O?r/2*w%r:(P/2+2*y)*_*w%r,r,C,s,M,O,!1,S)}function V0(i,r,s,l,f,y,_,w,S){const C=y/2,P=B0(i);let M=0,O=r-s,j=[];for(let U=0;U<i.length-1;U++){const Z=i[U],re=i[U+1],oe=Z.dist(re),xe=re.angleTo(Z);for(;O+s<M+oe;){O+=s;const pe=(O-M)/oe,ve=An.number(Z.x,re.x,pe),Ce=An.number(Z.y,re.y,pe);if(ve>=0&&ve<S&&Ce>=0&&Ce<S&&O-C>=0&&O+C<=P){const Le=new ua(ve,Ce,xe,U);Le._round(),l&&!O0(i,Le,y,l,f)||j.push(Le)}}M+=oe}return w||j.length||_||(j=V0(i,M/2,s,l,f,y,_,!0,S)),j}nt("Anchor",ua);const Lu=Jn;function $0(i,r,s,l){const f=[],y=i.image,_=y.pixelRatio,w=y.paddedRect.w-2*Lu,S=y.paddedRect.h-2*Lu;let C={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const P=y.stretchX||[[0,w]],M=y.stretchY||[[0,S]],O=(Ie,ht)=>Ie+ht[1]-ht[0],j=P.reduce(O,0),U=M.reduce(O,0),Z=w-j,re=S-U;let oe=0,xe=j,pe=0,ve=U,Ce=0,Le=Z,Qe=0,gt=re;if(y.content&&l){const Ie=y.content,ht=Ie[2]-Ie[0],ut=Ie[3]-Ie[1];(y.textFitWidth||y.textFitHeight)&&(C=m0(i)),oe=$f(P,0,Ie[0]),pe=$f(M,0,Ie[1]),xe=$f(P,Ie[0],Ie[2]),ve=$f(M,Ie[1],Ie[3]),Ce=Ie[0]-oe,Qe=Ie[1]-pe,Le=ht-xe,gt=ut-ve}const Ke=C.x1,We=C.y1,ct=C.x2-Ke,it=C.y2-We,rt=(Ie,ht,ut,Tt)=>{const ir=Uf(Ie.stretch-oe,xe,ct,Ke),nr=qf(Ie.fixed-Ce,Le,Ie.stretch,j),qr=Uf(ht.stretch-pe,ve,it,We),ns=qf(ht.fixed-Qe,gt,ht.stretch,U),dn=Uf(ut.stretch-oe,xe,ct,Ke),Zr=qf(ut.fixed-Ce,Le,ut.stretch,j),Rn=Uf(Tt.stretch-pe,ve,it,We),Ln=qf(Tt.fixed-Qe,gt,Tt.stretch,U),Fn=new R(ir,qr),Tr=new R(dn,qr),Hr=new R(dn,Rn),bn=new R(ir,Rn),fn=new R(nr/_,ns/_),On=new R(Zr/_,Ln/_),pn=r*Math.PI/180;if(pn){const Gt=Math.sin(pn),or=Math.cos(pn),fr=[or,-Gt,Gt,or];Fn._matMult(fr),Tr._matMult(fr),bn._matMult(fr),Hr._matMult(fr)}const ji=Ie.stretch+Ie.fixed,Qn=ht.stretch+ht.fixed;return{tl:Fn,tr:Tr,bl:bn,br:Hr,tex:{x:y.paddedRect.x+Lu+ji,y:y.paddedRect.y+Lu+Qn,w:ut.stretch+ut.fixed-ji,h:Tt.stretch+Tt.fixed-Qn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fn,pixelOffsetBR:On,minFontScaleX:Le/_/ct,minFontScaleY:gt/_/it,isSDF:s}};if(l&&(y.stretchX||y.stretchY)){const Ie=U0(P,Z,j),ht=U0(M,re,U);for(let ut=0;ut<Ie.length-1;ut++){const Tt=Ie[ut],ir=Ie[ut+1];for(let nr=0;nr<ht.length-1;nr++)f.push(rt(Tt,ht[nr],ir,ht[nr+1]))}}else f.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:S+1}));return f}function $f(i,r,s){let l=0;for(const f of i)l+=Math.max(r,Math.min(s,f[1]))-Math.max(r,Math.min(s,f[0]));return l}function U0(i,r,s){const l=[{fixed:-Lu,stretch:0}];for(const[f,y]of i){const _=l[l.length-1];l.push({fixed:f-_.stretch,stretch:_.stretch}),l.push({fixed:f-_.stretch,stretch:_.stretch+(y-f)})}return l.push({fixed:r+Lu,stretch:s}),l}function Uf(i,r,s,l){return i/r*s+l}function qf(i,r,s,l){return i-r*s/l}class Zf{constructor(r,s,l,f,y,_,w,S,C,P){var M;if(this.boxStartIndex=r.length,C){let O=_.top,j=_.bottom;const U=_.collisionPadding;U&&(O-=U[1],j+=U[3]);let Z=j-O;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const O=!((M=_.image)===null||M===void 0)&&M.content&&(_.image.textFitWidth||_.image.textFitHeight)?m0(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};O.y1=O.y1*w-S[0],O.y2=O.y2*w+S[2],O.x1=O.x1*w-S[3],O.x2=O.x2*w+S[1];const j=_.collisionPadding;if(j&&(O.x1-=j[0]*w,O.y1-=j[1]*w,O.x2+=j[2]*w,O.y2+=j[3]*w),P){const U=new R(O.x1,O.y1),Z=new R(O.x2,O.y1),re=new R(O.x1,O.y2),oe=new R(O.x2,O.y2),xe=P*Math.PI/180;U._rotate(xe),Z._rotate(xe),re._rotate(xe),oe._rotate(xe),O.x1=Math.min(U.x,Z.x,re.x,oe.x),O.x2=Math.max(U.x,Z.x,re.x,oe.x),O.y1=Math.min(U.y,Z.y,re.y,oe.y),O.y2=Math.max(U.y,Z.y,re.y,oe.y)}r.emplaceBack(s.x,s.y,O.x1,O.y1,O.x2,O.y2,l,f,y)}this.boxEndIndex=r.length}}class $C{constructor(r=[],s=(l,f)=>l<f?-1:l>f?1:0){if(this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:s,compare:l}=this,f=s[r];for(;r>0;){const y=r-1>>1,_=s[y];if(l(f,_)>=0)break;s[r]=_,r=y}s[r]=f}_down(r){const{data:s,compare:l}=this,f=this.length>>1,y=s[r];for(;r<f;){let _=1+(r<<1);const w=_+1;if(w<this.length&&l(s[w],s[_])<0&&(_=w),l(s[_],y)>=0)break;s[r]=s[_],r=_}s[r]=y}}function UC(i,r=1,s=!1){let l=1/0,f=1/0,y=-1/0,_=-1/0;const w=i[0];for(let j=0;j<w.length;j++){const U=w[j];(!j||U.x<l)&&(l=U.x),(!j||U.y<f)&&(f=U.y),(!j||U.x>y)&&(y=U.x),(!j||U.y>_)&&(_=U.y)}const S=Math.min(y-l,_-f);let C=S/2;const P=new $C([],qC);if(S===0)return new R(l,f);for(let j=l;j<y;j+=S)for(let U=f;U<_;U+=S)P.push(new Fu(j+C,U+C,C,i));let M=function(j){let U=0,Z=0,re=0;const oe=j[0];for(let xe=0,pe=oe.length,ve=pe-1;xe<pe;ve=xe++){const Ce=oe[xe],Le=oe[ve],Qe=Ce.x*Le.y-Le.x*Ce.y;Z+=(Ce.x+Le.x)*Qe,re+=(Ce.y+Le.y)*Qe,U+=3*Qe}return new Fu(Z/U,re/U,0,j)}(i),O=P.length;for(;P.length;){const j=P.pop();(j.d>M.d||!M.d)&&(M=j,s&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,O)),j.max-M.d<=r||(C=j.h/2,P.push(new Fu(j.p.x-C,j.p.y-C,C,i)),P.push(new Fu(j.p.x+C,j.p.y-C,C,i)),P.push(new Fu(j.p.x-C,j.p.y+C,C,i)),P.push(new Fu(j.p.x+C,j.p.y+C,C,i)),O+=4)}return s&&(console.log(`num probes: ${O}`),console.log(`best distance: ${M.d}`)),M.p}function qC(i,r){return r.max-i.max}function Fu(i,r,s,l){this.p=new R(i,r),this.h=s,this.d=function(f,y){let _=!1,w=1/0;for(let S=0;S<y.length;S++){const C=y[S];for(let P=0,M=C.length,O=M-1;P<M;O=P++){const j=C[P],U=C[O];j.y>f.y!=U.y>f.y&&f.x<(U.x-j.x)*(f.y-j.y)/(U.y-j.y)+j.x&&(_=!_),w=Math.min(w,Cx(f,j,U))}}return(_?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var hn;v.aq=void 0,(hn=v.aq||(v.aq={}))[hn.center=1]="center",hn[hn.left=2]="left",hn[hn.right=3]="right",hn[hn.top=4]="top",hn[hn.bottom=5]="bottom",hn[hn["top-left"]=6]="top-left",hn[hn["top-right"]=7]="top-right",hn[hn["bottom-left"]=8]="bottom-left",hn[hn["bottom-right"]=9]="bottom-right";const ca=7,Hg=Number.POSITIVE_INFINITY;function q0(i,r){return r[1]!==Hg?function(s,l,f){let y=0,_=0;switch(l=Math.abs(l),f=Math.abs(f),s){case"top-right":case"top-left":case"top":_=f-ca;break;case"bottom-right":case"bottom-left":case"bottom":_=-f+ca}switch(s){case"top-right":case"bottom-right":case"right":y=-l;break;case"top-left":case"bottom-left":case"left":y=l}return[y,_]}(i,r[0],r[1]):function(s,l){let f=0,y=0;l<0&&(l=0);const _=l/Math.SQRT2;switch(s){case"top-right":case"top-left":y=_-ca;break;case"bottom-right":case"bottom-left":y=-_+ca;break;case"bottom":y=-l+ca;break;case"top":y=l-ca}switch(s){case"top-right":case"bottom-right":f=-_;break;case"top-left":case"bottom-left":f=_;break;case"left":f=l;break;case"right":f=-l}return[f,y]}(i,r[0])}function Z0(i,r,s){var l;const f=i.layout,y=(l=f.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(r,{},s);if(y){const w=y.values,S=[];for(let C=0;C<w.length;C+=2){const P=S[C]=w[C],M=w[C+1].map(O=>O*Nr);P.startsWith("top")?M[1]-=ca:P.startsWith("bottom")&&(M[1]+=ca),S[C+1]=M}return new hi(S)}const _=f.get("text-variable-anchor");if(_){let w;w=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(r,{},s)*Nr,Hg]:f.get("text-offset").evaluate(r,{},s).map(C=>C*Nr);const S=[];for(const C of _)S.push(C,q0(C,w));return new hi(S)}return null}function Gg(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ZC(i,r,s,l,f,y,_,w,S,C,P){let M=y.textMaxSize.evaluate(r,{});M===void 0&&(M=_);const O=i.layers[0].layout,j=O.get("icon-offset").evaluate(r,{},P),U=G0(s.horizontal),Z=_/24,re=i.tilePixelRatio*Z,oe=i.tilePixelRatio*M/24,xe=i.tilePixelRatio*w,pe=i.tilePixelRatio*O.get("symbol-spacing"),ve=O.get("text-padding")*i.tilePixelRatio,Ce=function(Ie,ht,ut,Tt=1){const ir=Ie.get("icon-padding").evaluate(ht,{},ut),nr=ir&&ir.values;return[nr[0]*Tt,nr[1]*Tt,nr[2]*Tt,nr[3]*Tt]}(O,r,P,i.tilePixelRatio),Le=O.get("text-max-angle")/180*Math.PI,Qe=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",gt=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",Ke=O.get("symbol-placement"),We=pe/2,ct=O.get("icon-text-fit");let it;l&&ct!=="none"&&(i.allowVerticalPlacement&&s.vertical&&(it=g0(l,s.vertical,ct,O.get("icon-text-fit-padding"),j,Z)),U&&(l=g0(l,U,ct,O.get("icon-text-fit-padding"),j,Z)));const rt=(Ie,ht)=>{ht.x<0||ht.x>=Lr||ht.y<0||ht.y>=Lr||function(ut,Tt,ir,nr,qr,ns,dn,Zr,Rn,Ln,Fn,Tr,Hr,bn,fn,On,pn,ji,Qn,Gt,or,fr,_i,_r,Ou){const Bs=ut.addToLineVertexArray(Tt,ir);let Ns,is,Vi,Qr,mo=0,Oh=0,Y0=0,J0=0,ty=-1,ry=-1;const go={};let Q0=Su("");if(ut.allowVerticalPlacement&&nr.vertical){const Sn=Zr.layout.get("text-rotate").evaluate(or,{},_r)+90;Vi=new Zf(Rn,Tt,Ln,Fn,Tr,nr.vertical,Hr,bn,fn,Sn),dn&&(Qr=new Zf(Rn,Tt,Ln,Fn,Tr,dn,pn,ji,fn,Sn))}if(qr){const Sn=Zr.layout.get("icon-rotate").evaluate(or,{}),$i=Zr.layout.get("icon-text-fit")!=="none",yl=$0(qr,Sn,_i,$i),gs=dn?$0(dn,Sn,_i,$i):void 0;is=new Zf(Rn,Tt,Ln,Fn,Tr,qr,pn,ji,!1,Sn),mo=4*yl.length;const _l=ut.iconSizeData;let js=null;_l.kind==="source"?(js=[Os*Zr.layout.get("icon-size").evaluate(or,{})],js[0]>aa&&xt(`${ut.layerIds[0]}: Value for "icon-size" is >= ${zh}. Reduce your "icon-size".`)):_l.kind==="composite"&&(js=[Os*fr.compositeIconSizes[0].evaluate(or,{},_r),Os*fr.compositeIconSizes[1].evaluate(or,{},_r)],(js[0]>aa||js[1]>aa)&&xt(`${ut.layerIds[0]}: Value for "icon-size" is >= ${zh}. Reduce your "icon-size".`)),ut.addSymbols(ut.icon,yl,js,Gt,Qn,or,v.ah.none,Tt,Bs.lineStartIndex,Bs.lineLength,-1,_r),ty=ut.icon.placedSymbolArray.length-1,gs&&(Oh=4*gs.length,ut.addSymbols(ut.icon,gs,js,Gt,Qn,or,v.ah.vertical,Tt,Bs.lineStartIndex,Bs.lineLength,-1,_r),ry=ut.icon.placedSymbolArray.length-1)}const ew=Object.keys(nr.horizontal);for(const Sn of ew){const $i=nr.horizontal[Sn];if(!Ns){Q0=Su($i.text);const gs=Zr.layout.get("text-rotate").evaluate(or,{},_r);Ns=new Zf(Rn,Tt,Ln,Fn,Tr,$i,Hr,bn,fn,gs)}const yl=$i.positionedLines.length===1;if(Y0+=H0(ut,Tt,$i,ns,Zr,fn,or,On,Bs,nr.vertical?v.ah.horizontal:v.ah.horizontalOnly,yl?ew:[Sn],go,ty,fr,_r),yl)break}nr.vertical&&(J0+=H0(ut,Tt,nr.vertical,ns,Zr,fn,or,On,Bs,v.ah.vertical,["vertical"],go,ry,fr,_r));const WC=Ns?Ns.boxStartIndex:ut.collisionBoxArray.length,XC=Ns?Ns.boxEndIndex:ut.collisionBoxArray.length,KC=Vi?Vi.boxStartIndex:ut.collisionBoxArray.length,YC=Vi?Vi.boxEndIndex:ut.collisionBoxArray.length,JC=is?is.boxStartIndex:ut.collisionBoxArray.length,QC=is?is.boxEndIndex:ut.collisionBoxArray.length,ek=Qr?Qr.boxStartIndex:ut.collisionBoxArray.length,tk=Qr?Qr.boxEndIndex:ut.collisionBoxArray.length;let ms=-1;const Gf=(Sn,$i)=>Sn&&Sn.circleDiameter?Math.max(Sn.circleDiameter,$i):$i;ms=Gf(Ns,ms),ms=Gf(Vi,ms),ms=Gf(is,ms),ms=Gf(Qr,ms);const tw=ms>-1?1:0;tw&&(ms*=Ou/Nr),ut.glyphOffsetArray.length>=Ru.MAX_GLYPHS&&xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),or.sortKey!==void 0&&ut.addToSortKeyRanges(ut.symbolInstances.length,or.sortKey);const rk=Z0(Zr,or,_r),[nk,ik]=function(Sn,$i){const yl=Sn.length,gs=$i==null?void 0:$i.values;if((gs==null?void 0:gs.length)>0)for(let _l=0;_l<gs.length;_l+=2){const js=gs[_l+1];Sn.emplaceBack(v.aq[gs[_l]],js[0],js[1])}return[yl,Sn.length]}(ut.textAnchorOffsets,rk);ut.symbolInstances.emplaceBack(Tt.x,Tt.y,go.right>=0?go.right:-1,go.center>=0?go.center:-1,go.left>=0?go.left:-1,go.vertical||-1,ty,ry,Q0,WC,XC,KC,YC,JC,QC,ek,tk,Ln,Y0,J0,mo,Oh,tw,0,Hr,ms,nk,ik)}(i,ht,Ie,s,l,f,it,i.layers[0],i.collisionBoxArray,r.index,r.sourceLayerIndex,i.index,re,[ve,ve,ve,ve],Qe,S,xe,Ce,gt,j,r,y,C,P,_)};if(Ke==="line")for(const Ie of F0(r.geometry,0,0,Lr,Lr)){const ht=VC(Ie,pe,Le,s.vertical||U,l,24,oe,i.overscaling,Lr);for(const ut of ht)U&&HC(i,U.text,We,ut)||rt(Ie,ut)}else if(Ke==="line-center"){for(const Ie of r.geometry)if(Ie.length>1){const ht=jC(Ie,Le,s.vertical||U,l,24,oe);ht&&rt(Ie,ht)}}else if(r.type==="Polygon")for(const Ie of Ql(r.geometry,0)){const ht=UC(Ie,16);rt(Ie[0],new ua(ht.x,ht.y,0))}else if(r.type==="LineString")for(const Ie of r.geometry)rt(Ie,new ua(Ie[0].x,Ie[0].y,0));else if(r.type==="Point")for(const Ie of r.geometry)for(const ht of Ie)rt([ht],new ua(ht.x,ht.y,0))}function H0(i,r,s,l,f,y,_,w,S,C,P,M,O,j,U){const Z=function(xe,pe,ve,Ce,Le,Qe,gt,Ke){const We=Ce.layout.get("text-rotate").evaluate(Qe,{})*Math.PI/180,ct=[];for(const it of pe.positionedLines)for(const rt of it.positionedGlyphs){if(!rt.rect)continue;const Ie=rt.rect||{};let ht=l0+1,ut=!0,Tt=1,ir=0;const nr=(Le||Ke)&&rt.vertical,qr=rt.metrics.advance*rt.scale/2;if(Ke&&pe.verticalizable&&(ir=it.lineOffset/2-(rt.imageName?-(Nr-rt.metrics.width*rt.scale)/2:(rt.scale-1)*Nr)),rt.imageName){const Gt=gt[rt.imageName];ut=Gt.sdf,Tt=Gt.pixelRatio,ht=Jn/Tt}const ns=Le?[rt.x+qr,rt.y]:[0,0];let dn=Le?[0,0]:[rt.x+qr+ve[0],rt.y+ve[1]-ir],Zr=[0,0];nr&&(Zr=dn,dn=[0,0]);const Rn=rt.metrics.isDoubleResolution?2:1,Ln=(rt.metrics.left-ht)*rt.scale-qr+dn[0],Fn=(-rt.metrics.top-ht)*rt.scale+dn[1],Tr=Ln+Ie.w/Rn*rt.scale/Tt,Hr=Fn+Ie.h/Rn*rt.scale/Tt,bn=new R(Ln,Fn),fn=new R(Tr,Fn),On=new R(Ln,Hr),pn=new R(Tr,Hr);if(nr){const Gt=new R(-qr,qr-Ah),or=-Math.PI/2,fr=Nr/2-qr,_i=new R(5-Ah-fr,-(rt.imageName?fr:0)),_r=new R(...Zr);bn._rotateAround(or,Gt)._add(_i)._add(_r),fn._rotateAround(or,Gt)._add(_i)._add(_r),On._rotateAround(or,Gt)._add(_i)._add(_r),pn._rotateAround(or,Gt)._add(_i)._add(_r)}if(We){const Gt=Math.sin(We),or=Math.cos(We),fr=[or,-Gt,Gt,or];bn._matMult(fr),fn._matMult(fr),On._matMult(fr),pn._matMult(fr)}const ji=new R(0,0),Qn=new R(0,0);ct.push({tl:bn,tr:fn,bl:On,br:pn,tex:Ie,writingMode:pe.writingMode,glyphOffset:ns,sectionIndex:rt.sectionIndex,isSDF:ut,pixelOffsetTL:ji,pixelOffsetBR:Qn,minFontScaleX:0,minFontScaleY:0})}return ct}(0,s,w,f,y,_,l,i.allowVerticalPlacement),re=i.textSizeData;let oe=null;re.kind==="source"?(oe=[Os*f.layout.get("text-size").evaluate(_,{})],oe[0]>aa&&xt(`${i.layerIds[0]}: Value for "text-size" is >= ${zh}. Reduce your "text-size".`)):re.kind==="composite"&&(oe=[Os*j.compositeTextSizes[0].evaluate(_,{},U),Os*j.compositeTextSizes[1].evaluate(_,{},U)],(oe[0]>aa||oe[1]>aa)&&xt(`${i.layerIds[0]}: Value for "text-size" is >= ${zh}. Reduce your "text-size".`)),i.addSymbols(i.text,Z,oe,w,y,_,C,r,S.lineStartIndex,S.lineLength,O,U);for(const xe of P)M[xe]=i.text.placedSymbolArray.length-1;return 4*Z.length}function G0(i){for(const r in i)return i[r];return null}function HC(i,r,s,l){const f=i.compareText;if(r in f){const y=f[r];for(let _=y.length-1;_>=0;_--)if(l.dist(y[_])<s)return!0}else f[r]=[];return f[r].push(l),!1}const W0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Wg{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=l>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=W0[15&l];if(!y)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(r,2,1),[w]=new Uint32Array(r,4,1);return new Wg(w,_,y,r)}constructor(r,s=64,l=Float64Array,f){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const y=W0.indexOf(this.ArrayType),_=2*r*this.ArrayType.BYTES_PER_ELEMENT,w=r*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-w%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${l}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+S,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+_+w+S),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+S,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=r,this.coords[this._pos++]=s,l}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Xg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,l,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:_,nodeSize:w}=this,S=[0,y.length-1,0],C=[];for(;S.length;){const P=S.pop()||0,M=S.pop()||0,O=S.pop()||0;if(M-O<=w){for(let re=O;re<=M;re++){const oe=_[2*re],xe=_[2*re+1];oe>=r&&oe<=l&&xe>=s&&xe<=f&&C.push(y[re])}continue}const j=O+M>>1,U=_[2*j],Z=_[2*j+1];U>=r&&U<=l&&Z>=s&&Z<=f&&C.push(y[j]),(P===0?r<=U:s<=Z)&&(S.push(O),S.push(j-1),S.push(1-P)),(P===0?l>=U:f>=Z)&&(S.push(j+1),S.push(M),S.push(1-P))}return C}within(r,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:_}=this,w=[0,f.length-1,0],S=[],C=l*l;for(;w.length;){const P=w.pop()||0,M=w.pop()||0,O=w.pop()||0;if(M-O<=_){for(let re=O;re<=M;re++)K0(y[2*re],y[2*re+1],r,s)<=C&&S.push(f[re]);continue}const j=O+M>>1,U=y[2*j],Z=y[2*j+1];K0(U,Z,r,s)<=C&&S.push(f[j]),(P===0?r-l<=U:s-l<=Z)&&(w.push(O),w.push(j-1),w.push(1-P)),(P===0?r+l>=U:s+l>=Z)&&(w.push(j+1),w.push(M),w.push(1-P))}return S}}function Xg(i,r,s,l,f,y){if(f-l<=s)return;const _=l+f>>1;X0(i,r,_,l,f,y),Xg(i,r,s,l,_-1,1-y),Xg(i,r,s,_+1,f,1-y)}function X0(i,r,s,l,f,y){for(;f>l;){if(f-l>600){const C=f-l+1,P=s-l+1,M=Math.log(C),O=.5*Math.exp(2*M/3),j=.5*Math.sqrt(M*O*(C-O)/C)*(P-C/2<0?-1:1);X0(i,r,s,Math.max(l,Math.floor(s-P*O/C+j)),Math.min(f,Math.floor(s+(C-P)*O/C+j)),y)}const _=r[2*s+y];let w=l,S=f;for(Lh(i,r,l,s),r[2*f+y]>_&&Lh(i,r,l,f);w<S;){for(Lh(i,r,w,S),w++,S--;r[2*w+y]<_;)w++;for(;r[2*S+y]>_;)S--}r[2*l+y]===_?Lh(i,r,l,S):(S++,Lh(i,r,S,f)),S<=s&&(l=S+1),s<=S&&(f=S-1)}}function Lh(i,r,s,l){Kg(i,s,l),Kg(r,2*s,2*l),Kg(r,2*s+1,2*l+1)}function Kg(i,r,s){const l=i[r];i[r]=i[s],i[s]=l}function K0(i,r,s,l){const f=i-s,y=r-l;return f*f+y*y}var Yg;v.bg=void 0,(Yg=v.bg||(v.bg={})).create="create",Yg.load="load",Yg.fullLoad="fullLoad";let Hf=null,Fh=[];const Jg=1e3/60,Qg="loadTime",ey="fullLoadTime",GC={mark(i){performance.mark(i)},frame(i){const r=i;Hf!=null&&Fh.push(r-Hf),Hf=r},clearMetrics(){Hf=null,Fh=[],performance.clearMeasures(Qg),performance.clearMeasures(ey);for(const i in v.bg)performance.clearMarks(v.bg[i])},getPerformanceMetrics(){performance.measure(Qg,v.bg.create,v.bg.load),performance.measure(ey,v.bg.create,v.bg.fullLoad);const i=performance.getEntriesByName(Qg)[0].duration,r=performance.getEntriesByName(ey)[0].duration,s=Fh.length,l=1/(Fh.reduce((y,_)=>y+_,0)/s/1e3),f=Fh.filter(y=>y>Jg).reduce((y,_)=>y+(_-Jg)/Jg,0);return{loadTime:i,fullLoadTime:r,fps:l,percentDroppedFrames:f/(s+f)*100,totalFrames:s}}};v.$=class extends z{},v.A=Pu,v.B=lg,v.C=function(i){if(bt==null){const r=i.navigator?i.navigator.userAgent:null;bt=!!i.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return bt},v.D=at,v.E=Yi,v.F=class{constructor(i,r){this.target=i,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new BC(()=>this.process()),this.subscription=function(s,l,f,y){return s.addEventListener(l,f,!1),{unsubscribe:()=>{s.removeEventListener(l,f,!1)}}}(this.target,"message",s=>this.receive(s)),this.globalScope=It(self)?i:window}registerMessageHandler(i,r){this.messageHandlers[i]=r}sendAsync(i,r){return new Promise((s,l)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[f]={resolve:s,reject:l},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[f];const w={id:f,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},{once:!0});const y=[],_=Object.assign(Object.assign({},i),{id:f,sourceMapId:this.mapId,origin:location.origin,data:Xo(i.data,y)});this.target.postMessage(_,{transfer:y})})}receive(i){const r=i.data,s=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[s];const l=this.abortControllers[s];return delete this.abortControllers[s],void(l&&l.abort())}if(It(self)||r.mustQueue)return this.tasks[s]=r,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,r)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),r=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(i,r)}processTask(i,r){return c(this,void 0,void 0,function*(){if(r.type==="<response>"){const f=this.resolveRejects[i];return delete this.resolveRejects[i],f?void(r.error?f.reject(Ko(r.error)):f.resolve(Ko(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=Ko(r.data),l=new AbortController;this.abortControllers[i]=l;try{const f=yield this.messageHandlers[r.type](r.sourceMapId,s,l);this.completeTask(i,null,f)}catch(f){this.completeTask(i,f)}})}completeTask(i,r,s){const l=[];delete this.abortControllers[i];const f={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?Xo(r):null,data:Xo(s,l)};this.target.postMessage(f,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.G=gr,v.H=function(){var i=new Pu(16);return Pu!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},v.I=Lg,v.J=function(i,r,s){var l,f,y,_,w,S,C,P,M,O,j,U,Z=s[0],re=s[1],oe=s[2];return r===i?(i[12]=r[0]*Z+r[4]*re+r[8]*oe+r[12],i[13]=r[1]*Z+r[5]*re+r[9]*oe+r[13],i[14]=r[2]*Z+r[6]*re+r[10]*oe+r[14],i[15]=r[3]*Z+r[7]*re+r[11]*oe+r[15]):(f=r[1],y=r[2],_=r[3],w=r[4],S=r[5],C=r[6],P=r[7],M=r[8],O=r[9],j=r[10],U=r[11],i[0]=l=r[0],i[1]=f,i[2]=y,i[3]=_,i[4]=w,i[5]=S,i[6]=C,i[7]=P,i[8]=M,i[9]=O,i[10]=j,i[11]=U,i[12]=l*Z+w*re+M*oe+r[12],i[13]=f*Z+S*re+O*oe+r[13],i[14]=y*Z+C*re+j*oe+r[14],i[15]=_*Z+P*re+U*oe+r[15]),i},v.K=function(i,r,s){var l=s[0],f=s[1],y=s[2];return i[0]=r[0]*l,i[1]=r[1]*l,i[2]=r[2]*l,i[3]=r[3]*l,i[4]=r[4]*f,i[5]=r[5]*f,i[6]=r[6]*f,i[7]=r[7]*f,i[8]=r[8]*y,i[9]=r[9]*y,i[10]=r[10]*y,i[11]=r[11]*y,i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},v.L=Ax,v.M=function(i,r){const s={};for(let l=0;l<r.length;l++){const f=r[l];f in i&&(s[f]=i[f])}return s},v.N=la,v.O=E0,v.P=R,v.Q=C0,v.R=Bi,v.S=Ni,v.T=_u,v.U=W,v.V=G,v.W=Re,v.X=Lr,v.Y=b,v.Z=Dh,v._=c,v.a=At,v.a$=function(i,r){var s=i[0],l=i[1],f=i[2],y=i[3],_=i[4],w=i[5],S=i[6],C=i[7],P=i[8],M=i[9],O=i[10],j=i[11],U=i[12],Z=i[13],re=i[14],oe=i[15],xe=r[0],pe=r[1],ve=r[2],Ce=r[3],Le=r[4],Qe=r[5],gt=r[6],Ke=r[7],We=r[8],ct=r[9],it=r[10],rt=r[11],Ie=r[12],ht=r[13],ut=r[14],Tt=r[15];return Math.abs(s-xe)<=Dn*Math.max(1,Math.abs(s),Math.abs(xe))&&Math.abs(l-pe)<=Dn*Math.max(1,Math.abs(l),Math.abs(pe))&&Math.abs(f-ve)<=Dn*Math.max(1,Math.abs(f),Math.abs(ve))&&Math.abs(y-Ce)<=Dn*Math.max(1,Math.abs(y),Math.abs(Ce))&&Math.abs(_-Le)<=Dn*Math.max(1,Math.abs(_),Math.abs(Le))&&Math.abs(w-Qe)<=Dn*Math.max(1,Math.abs(w),Math.abs(Qe))&&Math.abs(S-gt)<=Dn*Math.max(1,Math.abs(S),Math.abs(gt))&&Math.abs(C-Ke)<=Dn*Math.max(1,Math.abs(C),Math.abs(Ke))&&Math.abs(P-We)<=Dn*Math.max(1,Math.abs(P),Math.abs(We))&&Math.abs(M-ct)<=Dn*Math.max(1,Math.abs(M),Math.abs(ct))&&Math.abs(O-it)<=Dn*Math.max(1,Math.abs(O),Math.abs(it))&&Math.abs(j-rt)<=Dn*Math.max(1,Math.abs(j),Math.abs(rt))&&Math.abs(U-Ie)<=Dn*Math.max(1,Math.abs(U),Math.abs(Ie))&&Math.abs(Z-ht)<=Dn*Math.max(1,Math.abs(Z),Math.abs(ht))&&Math.abs(re-ut)<=Dn*Math.max(1,Math.abs(re),Math.abs(ut))&&Math.abs(oe-Tt)<=Dn*Math.max(1,Math.abs(oe),Math.abs(Tt))},v.a0=$t,v.a1=Zg,v.a2=Ne,v.a3=i=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(s=>{r.onloadstart=()=>{s(r)};for(const l of i){const f=window.document.createElement("source");_n(l)||(r.crossOrigin="Anonymous"),f.src=l,r.appendChild(f)}})},v.a4=function(){return Fe++},v.a5=Je,v.a6=Ru,v.a7=Qc,v.a8=ml,v.a9=z0,v.aA=function(i){if(i.type==="custom")return new OC(i);switch(i.type){case"background":return new RC(i);case"circle":return new wE(i);case"fill":return new BE(i);case"fill-extrusion":return new QE(i);case"heatmap":return new SE(i);case"hillshade":return new EE(i);case"line":return new aC(i);case"raster":return new FC(i);case"symbol":return new Vf(i)}},v.aB=qe,v.aC=function(i,r){if(!i)return[{command:"setStyle",args:[r]}];let s=[];try{if(!Ot(i.version,r.version))return[{command:"setStyle",args:[r]}];Ot(i.center,r.center)||s.push({command:"setCenter",args:[r.center]}),Ot(i.zoom,r.zoom)||s.push({command:"setZoom",args:[r.zoom]}),Ot(i.bearing,r.bearing)||s.push({command:"setBearing",args:[r.bearing]}),Ot(i.pitch,r.pitch)||s.push({command:"setPitch",args:[r.pitch]}),Ot(i.sprite,r.sprite)||s.push({command:"setSprite",args:[r.sprite]}),Ot(i.glyphs,r.glyphs)||s.push({command:"setGlyphs",args:[r.glyphs]}),Ot(i.transition,r.transition)||s.push({command:"setTransition",args:[r.transition]}),Ot(i.light,r.light)||s.push({command:"setLight",args:[r.light]}),Ot(i.terrain,r.terrain)||s.push({command:"setTerrain",args:[r.terrain]}),Ot(i.sky,r.sky)||s.push({command:"setSky",args:[r.sky]}),Ot(i.projection,r.projection)||s.push({command:"setProjection",args:[r.projection]});const l={},f=[];(function(_,w,S,C){let P;for(P in w=w||{},_=_||{})Object.prototype.hasOwnProperty.call(_,P)&&(Object.prototype.hasOwnProperty.call(w,P)||Ii(P,S,C));for(P in w)Object.prototype.hasOwnProperty.call(w,P)&&(Object.prototype.hasOwnProperty.call(_,P)?Ot(_[P],w[P])||(_[P].type==="geojson"&&w[P].type==="geojson"&&zs(_,w,P)?lr(S,{command:"setGeoJSONSourceData",args:[P,w[P].data]}):Kr(P,w,S,C)):Pi(P,w,S))})(i.sources,r.sources,f,l);const y=[];i.layers&&i.layers.forEach(_=>{"source"in _&&l[_.source]?s.push({command:"removeLayer",args:[_.id]}):y.push(_)}),s=s.concat(f),function(_,w,S){w=w||[];const C=(_=_||[]).map($r),P=w.map($r),M=_.reduce(ai,{}),O=w.reduce(ai,{}),j=C.slice(),U=Object.create(null);let Z,re,oe,xe,pe;for(let ve=0,Ce=0;ve<C.length;ve++)Z=C[ve],Object.prototype.hasOwnProperty.call(O,Z)?Ce++:(lr(S,{command:"removeLayer",args:[Z]}),j.splice(j.indexOf(Z,Ce),1));for(let ve=0,Ce=0;ve<P.length;ve++)Z=P[P.length-1-ve],j[j.length-1-ve]!==Z&&(Object.prototype.hasOwnProperty.call(M,Z)?(lr(S,{command:"removeLayer",args:[Z]}),j.splice(j.lastIndexOf(Z,j.length-Ce),1)):Ce++,xe=j[j.length-ve],lr(S,{command:"addLayer",args:[O[Z],xe]}),j.splice(j.length-ve,0,Z),U[Z]=!0);for(let ve=0;ve<P.length;ve++)if(Z=P[ve],re=M[Z],oe=O[Z],!U[Z]&&!Ot(re,oe))if(Ot(re.source,oe.source)&&Ot(re["source-layer"],oe["source-layer"])&&Ot(re.type,oe.type)){for(pe in Pn(re.layout,oe.layout,S,Z,null,"setLayoutProperty"),Pn(re.paint,oe.paint,S,Z,null,"setPaintProperty"),Ot(re.filter,oe.filter)||lr(S,{command:"setFilter",args:[Z,oe.filter]}),Ot(re.minzoom,oe.minzoom)&&Ot(re.maxzoom,oe.maxzoom)||lr(S,{command:"setLayerZoomRange",args:[Z,oe.minzoom,oe.maxzoom]}),re)Object.prototype.hasOwnProperty.call(re,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?Pn(re[pe],oe[pe],S,Z,pe.slice(6),"setPaintProperty"):Ot(re[pe],oe[pe])||lr(S,{command:"setLayerProperty",args:[Z,pe,oe[pe]]}));for(pe in oe)Object.prototype.hasOwnProperty.call(oe,pe)&&!Object.prototype.hasOwnProperty.call(re,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?Pn(re[pe],oe[pe],S,Z,pe.slice(6),"setPaintProperty"):Ot(re[pe],oe[pe])||lr(S,{command:"setLayerProperty",args:[Z,pe,oe[pe]]}))}else lr(S,{command:"removeLayer",args:[Z]}),xe=j[j.lastIndexOf(Z)+1],lr(S,{command:"addLayer",args:[oe,xe]})}(y,r.layers,s)}catch(l){console.warn("Unable to compute style diff:",l),s=[{command:"setStyle",args:[r]}]}return s},v.aD=function(i){const r=[],s=i.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},v.aE=function i(r,s){if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let l=0;l<r.length;l++)if(!i(r[l],s[l]))return!1;return!0}if(typeof r=="object"&&r!==null&&s!==null){if(typeof s!="object"||Object.keys(r).length!==Object.keys(s).length)return!1;for(const l in r)if(!i(r[l],s[l]))return!1;return!0}return r===s},v.aF=st,v.aG=Be,v.aH=class extends dl{constructor(i,r){super(i,r),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},v.aI=Pf,v.aJ=class extends dl{constructor(i,r){super(i,r),this.current=fE}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let r=1;r<16;r++)if(i[r]!==this.current[r]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},v.aK=vx,v.aL=xx,v.aM=er,v.aN=class extends dl{constructor(i,r){super(i,r),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},v.aO=class extends dl{constructor(i,r){super(i,r),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},v.aP=function(i,r,s,l,f,y,_){var w=1/(r-s),S=1/(l-f),C=1/(y-_);return i[0]=-2*w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*C,i[11]=0,i[12]=(r+s)*w,i[13]=(f+l)*S,i[14]=(_+y)*C,i[15]=1,i},v.aQ=xE,v.aR=class extends ge{},v.aS=hC,v.aT=class extends we{},v.aU=Sg,v.aV=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},v.aW=Lx,v.aX=un,v.aY=Oi,v.aZ=class extends lt{},v.a_=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]&&i[9]===r[9]&&i[10]===r[10]&&i[11]===r[11]&&i[12]===r[12]&&i[13]===r[13]&&i[14]===r[14]&&i[15]===r[15]},v.aa=function(i){const r={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,f,y)=>{const _=f||y;return r[l]=!_||_.toLowerCase(),""}),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r},v.ab=function(i,r){const s=[];for(const l in i)l in r||s.push(l);return s},v.ac=be,v.ad=function(i,r,s){var l=Math.sin(s),f=Math.cos(s),y=r[0],_=r[1],w=r[2],S=r[3],C=r[4],P=r[5],M=r[6],O=r[7];return r!==i&&(i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=y*f+C*l,i[1]=_*f+P*l,i[2]=w*f+M*l,i[3]=S*f+O*l,i[4]=C*f-y*l,i[5]=P*f-_*l,i[6]=M*f-w*l,i[7]=O*f-S*l,i},v.ae=function(i){var r=new Pu(16);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r},v.af=zf,v.ag=function(i,r){let s=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:_}=i,w=f?be(Mn.interpolationFactor(f,r,y,_),0,1):0;i.kind==="camera"?l=An.number(i.minSize,i.maxSize,w):s=w}return{uSizeT:s,uSize:l}},v.ai=function(i,{uSize:r,uSizeT:s},{lowerSize:l,upperSize:f}){return i.kind==="source"?l/Os:i.kind==="composite"?An.number(l/Os,f/Os,s):r},v.aj=Ng,v.ak=function(i,r,s,l){const f=r.y-i.y,y=r.x-i.x,_=l.y-s.y,w=l.x-s.x,S=_*y-w*f;if(S===0)return null;const C=(w*(i.y-s.y)-_*(i.x-s.x))/S;return new R(i.x+C*y,i.y+C*f)},v.al=F0,v.am=Tx,v.an=xg,v.ao=function(i){let r=1/0,s=1/0,l=-1/0,f=-1/0;for(const y of i)r=Math.min(r,y.x),s=Math.min(s,y.y),l=Math.max(l,y.x),f=Math.max(f,y.y);return[r,s,l,f]},v.ap=Nr,v.ar=Bg,v.as=function(i,r){var s=r[0],l=r[1],f=r[2],y=r[3],_=r[4],w=r[5],S=r[6],C=r[7],P=r[8],M=r[9],O=r[10],j=r[11],U=r[12],Z=r[13],re=r[14],oe=r[15],xe=s*w-l*_,pe=s*S-f*_,ve=s*C-y*_,Ce=l*S-f*w,Le=l*C-y*w,Qe=f*C-y*S,gt=P*Z-M*U,Ke=P*re-O*U,We=P*oe-j*U,ct=M*re-O*Z,it=M*oe-j*Z,rt=O*oe-j*re,Ie=xe*rt-pe*it+ve*ct+Ce*We-Le*Ke+Qe*gt;return Ie?(i[0]=(w*rt-S*it+C*ct)*(Ie=1/Ie),i[1]=(f*it-l*rt-y*ct)*Ie,i[2]=(Z*Qe-re*Le+oe*Ce)*Ie,i[3]=(O*Le-M*Qe-j*Ce)*Ie,i[4]=(S*We-_*rt-C*Ke)*Ie,i[5]=(s*rt-f*We+y*Ke)*Ie,i[6]=(re*ve-U*Qe-oe*pe)*Ie,i[7]=(P*Qe-O*ve+j*pe)*Ie,i[8]=(_*it-w*We+C*gt)*Ie,i[9]=(l*We-s*it-y*gt)*Ie,i[10]=(U*Le-Z*ve+oe*xe)*Ie,i[11]=(M*ve-P*Le-j*xe)*Ie,i[12]=(w*Ke-_*ct-S*gt)*Ie,i[13]=(s*ct-l*Ke+f*gt)*Ie,i[14]=(Z*pe-U*Ce-re*xe)*Ie,i[15]=(P*Ce-M*pe+O*xe)*Ie,i):null},v.at=Gg,v.au=Og,v.av=Wg,v.aw=function(){const i={},r=Te.$version;for(const s in Te.$root){const l=Te.$root[s];if(l.required){let f=null;f=s==="version"?r:l.type==="array"?[]:{},f!=null&&(i[s]=f)}}return i},v.ax=fh,v.ay=Vr,v.az=function(i){i=i.slice();const r=Object.create(null);for(let s=0;s<i.length;s++)r[i[s].id]=i[s];for(let s=0;s<i.length;s++)"ref"in i[s]&&(i[s]=ki(i[s],r[i[s].ref]));return i},v.b=wt,v.b0=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},v.b1=function(i,r,s){return i[0]=r[0]*s[0],i[1]=r[1]*s[1],i[2]=r[2]*s[2],i[3]=r[3]*s[3],i},v.b2=function(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]+i[3]*r[3]},v.b3=ke,v.b4=I0,v.b5=k0,v.b6=function(i,r,s,l,f){var y,_=1/Math.tan(r/2);return i[0]=_/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+l)*(y=1/(l-f)),i[14]=2*f*l*y):(i[10]=-1,i[14]=-2*l),i},v.b7=function(i,r,s){var l=Math.sin(s),f=Math.cos(s),y=r[4],_=r[5],w=r[6],S=r[7],C=r[8],P=r[9],M=r[10],O=r[11];return r!==i&&(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[4]=y*f+C*l,i[5]=_*f+P*l,i[6]=w*f+M*l,i[7]=S*f+O*l,i[8]=C*f-y*l,i[9]=P*f-_*l,i[10]=M*f-w*l,i[11]=O*f-S*l,i},v.b8=K,v.b9=he,v.bA=t0,v.bB=function(i){return i.message===dt},v.bC=Uo,v.bD=Kn,v.ba=function(i){return i*Math.PI/180},v.bb=function(i,r){const{x:s,y:l}=Dh.fromLngLat(r);return!(i<0||i>25||l<0||l>=1||s<0||s>=1)},v.bc=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},v.bd=class extends I{},v.be=Ug,v.bf=GC,v.bh=zt,v.bi=function(i,r){At.REGISTERED_PROTOCOLS[i]=r},v.bj=function(i){delete At.REGISTERED_PROTOCOLS[i]},v.bk=function(i,r){const s={};for(let f=0;f<i.length;f++){const y=r&&r[i[f].id]||gf(i[f]);r&&(r[i[f].id]=y);let _=s[y];_||(_=s[y]=[]),_.push(i[f])}const l=[];for(const f in s)l.push(s[f]);return l},v.bl=nt,v.bm=M0,v.bn=D0,v.bo=c0,v.bp=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Lr/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const r=i.bucket.layers[0],s=r.layout,l=r._unevaluatedLayout._values,f={layoutIconSize:l["icon-size"].possiblyEvaluate(new ur(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new ur(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new ur(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:P}=i.bucket.textSizeData;f.compositeTextSizes=[l["text-size"].possiblyEvaluate(new ur(C),i.canonical),l["text-size"].possiblyEvaluate(new ur(P),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:P}=i.bucket.iconSizeData;f.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new ur(C),i.canonical),l["icon-size"].possiblyEvaluate(new ur(P),i.canonical)]}const y=s.get("text-line-height")*Nr,_=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",w=s.get("text-keep-upright"),S=s.get("text-size");for(const C of i.bucket.features){const P=s.get("text-font").evaluate(C,{},i.canonical).join(","),M=S.evaluate(C,{},i.canonical),O=f.layoutTextSize.evaluate(C,{},i.canonical),j=f.layoutIconSize.evaluate(C,{},i.canonical),U={horizontal:{},vertical:void 0},Z=C.text;let re,oe=[0,0];if(Z){const ve=Z.toString(),Ce=s.get("text-letter-spacing").evaluate(C,{},i.canonical)*Nr,Le=ug(ve)?Ce:0,Qe=s.get("text-anchor").evaluate(C,{},i.canonical),gt=Z0(r,C,i.canonical);if(!gt){const it=s.get("text-radial-offset").evaluate(C,{},i.canonical);oe=it?q0(Qe,[it*Nr,Hg]):s.get("text-offset").evaluate(C,{},i.canonical).map(rt=>rt*Nr)}let Ke=_?"center":s.get("text-justify").evaluate(C,{},i.canonical);const We=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(C,{},i.canonical)*Nr:1/0,ct=()=>{i.bucket.allowVerticalPlacement&&ph(ve)&&(U.vertical=Bf(Z,i.glyphMap,i.glyphPositions,i.imagePositions,P,We,y,Qe,"left",Le,oe,v.ah.vertical,!0,O,M))};if(!_&&gt){const it=new Set;if(Ke==="auto")for(let Ie=0;Ie<gt.values.length;Ie+=2)it.add(Gg(gt.values[Ie]));else it.add(Ke);let rt=!1;for(const Ie of it)if(!U.horizontal[Ie])if(rt)U.horizontal[Ie]=U.horizontal[0];else{const ht=Bf(Z,i.glyphMap,i.glyphPositions,i.imagePositions,P,We,y,"center",Ie,Le,oe,v.ah.horizontal,!1,O,M);ht&&(U.horizontal[Ie]=ht,rt=ht.positionedLines.length===1)}ct()}else{Ke==="auto"&&(Ke=Gg(Qe));const it=Bf(Z,i.glyphMap,i.glyphPositions,i.imagePositions,P,We,y,Qe,Ke,Le,oe,v.ah.horizontal,!1,O,M);it&&(U.horizontal[Ke]=it),ct(),ph(ve)&&_&&w&&(U.vertical=Bf(Z,i.glyphMap,i.glyphPositions,i.imagePositions,P,We,y,Qe,Ke,Le,oe,v.ah.vertical,!1,O,M))}}let xe=!1;if(C.icon&&C.icon.name){const ve=i.imageMap[C.icon.name];ve&&(re=IC(i.imagePositions[C.icon.name],s.get("icon-offset").evaluate(C,{},i.canonical),s.get("icon-anchor").evaluate(C,{},i.canonical)),xe=!!ve.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=xe:i.bucket.sdfIcons!==xe&&xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ve.pixelRatio!==i.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const pe=G0(U.horizontal)||U.vertical;i.bucket.iconsInText=!!pe&&pe.iconsInText,(pe||re)&&ZC(i.bucket,C,U,re,i.imageMap,f,O,j,oe,xe,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},v.bq=Mg,v.br=Pg,v.bs=Ag,v.bt=sa,v.bu=Dg,v.bv=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},v.bw=function(i,r,s,l,f){return c(this,void 0,void 0,function*(){if(G())try{return yield Re(i,r,s,l,f)}catch{}return function(y,_,w,S,C){const P=y.width,M=y.height;et&&yt||(et=new OffscreenCanvas(P,M),yt=et.getContext("2d",{willReadFrequently:!0})),et.width=P,et.height=M,yt.drawImage(y,0,0,P,M);const O=yt.getImageData(_,w,S,C);return yt.clearRect(0,0,P,M),O.data}(i,r,s,l,f)})},v.bx=A0,v.by=k,v.bz=A,v.c=Mt,v.d=i=>c(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(r)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.e=Pe,v.f=i=>new Promise((r,s)=>{const l=new Image;l.onload=()=>{r(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=De})},l.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(i)],{type:"image/png"});l.src=i.byteLength?URL.createObjectURL(f):De}),v.g=Yt,v.h=(i,r)=>sn(Pe(i,{type:"json"}),r),v.i=It,v.j=Un,v.k=Xr,v.l=(i,r)=>sn(Pe(i,{type:"arrayBuffer"}),r),v.m=sn,v.n=function(i){return new Dg(i).readFields(bC,[])},v.o=Sh,v.p=u0,v.q=g,v.r=ag,v.s=_n,v.t=hh,v.u=co,v.v=Te,v.w=xt,v.x=function([i,r,s]){return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:i*Math.cos(r)*Math.sin(s),y:i*Math.sin(r)*Math.sin(s),z:i*Math.cos(s)}},v.y=An,v.z=ur}),p("worker",["./shared"],function(v){class c{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,F){for(const J of N){this._layerConfigs[J.id]=J;const de=this._layers[J.id]=v.aA(J);de._featureFilter=v.a7(de.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of F)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const q=v.bk(Object.values(this._layerConfigs),this.keyCache);for(const J of q){const de=J.map(Ee=>this._layers[Ee.id]),me=de[0];if(me.visibility==="none")continue;const ye=me.source||"";let ue=this.familiesBySource[ye];ue||(ue=this.familiesBySource[ye]={});const Se=me.sourceLayer||"_geojsonTileLayer";let Ae=ue[Se];Ae||(Ae=ue[Se]=[]),Ae.push(de)}}}class k{constructor(N){const F={},q=[];for(const ye in N){const ue=N[ye],Se=F[ye]={};for(const Ae in ue){const Ee=ue[+Ae];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const $e={x:0,y:0,w:Ee.bitmap.width+2,h:Ee.bitmap.height+2};q.push($e),Se[Ae]={rect:$e,metrics:Ee.metrics}}}const{w:J,h:de}=v.p(q),me=new v.o({width:J||1,height:de||1});for(const ye in N){const ue=N[ye];for(const Se in ue){const Ae=ue[+Se];if(!Ae||Ae.bitmap.width===0||Ae.bitmap.height===0)continue;const Ee=F[ye][Se].rect;v.o.copy(Ae.bitmap,me,{x:0,y:0},{x:Ee.x+1,y:Ee.y+1},Ae.bitmap)}}this.image=me,this.positions=F}}v.bl("GlyphAtlas",k);class A{constructor(N){this.tileID=new v.S(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[]}parse(N,F,q,J){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=N,this.collisionBoxArray=new v.a5;const de=new v.bm(Object.keys(N.layers).sort()),me=new v.bn(this.tileID,this.promoteId);me.bucketLayerIDs=[];const ye={},ue={featureIndex:me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},Se=F.familiesBySource[this.source];for(const Lt in Se){const Qt=N.layers[Lt];if(!Qt)continue;Qt.version===1&&v.w(`Vector tile source "${this.source}" layer "${Lt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pr=de.encode(Lt),Ur=[];for(let Yr=0;Yr<Qt.length;Yr++){const vn=Qt.feature(Yr),zo=me.getId(vn,Lt);Ur.push({feature:vn,id:zo,index:Yr,sourceLayerIndex:pr})}for(const Yr of Se[Lt]){const vn=Yr[0];vn.source!==this.source&&v.w(`layer.source = ${vn.source} does not equal this.source = ${this.source}`),vn.minzoom&&this.zoom<Math.floor(vn.minzoom)||vn.maxzoom&&this.zoom>=vn.maxzoom||vn.visibility!=="none"&&(B(Yr,this.zoom,q),(ye[vn.id]=vn.createBucket({index:me.bucketLayerIDs.length,layers:Yr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pr,sourceID:this.source})).populate(Ur,ue,this.tileID.canonical),me.bucketLayerIDs.push(Yr.map(zo=>zo.id)))}}const Ae=v.aF(ue.glyphDependencies,Lt=>Object.keys(Lt).map(Number));this.inFlightDependencies.forEach(Lt=>Lt==null?void 0:Lt.abort()),this.inFlightDependencies=[];let Ee=Promise.resolve({});if(Object.keys(Ae).length){const Lt=new AbortController;this.inFlightDependencies.push(Lt),Ee=J.sendAsync({type:"GG",data:{stacks:Ae,source:this.source,tileID:this.tileID,type:"glyphs"}},Lt)}const $e=Object.keys(ue.iconDependencies);let ft=Promise.resolve({});if($e.length){const Lt=new AbortController;this.inFlightDependencies.push(Lt),ft=J.sendAsync({type:"GI",data:{icons:$e,source:this.source,tileID:this.tileID,type:"icons"}},Lt)}const mt=Object.keys(ue.patternDependencies);let Ut=Promise.resolve({});if(mt.length){const Lt=new AbortController;this.inFlightDependencies.push(Lt),Ut=J.sendAsync({type:"GI",data:{icons:mt,source:this.source,tileID:this.tileID,type:"patterns"}},Lt)}const[Pt,qt,Bt]=yield Promise.all([Ee,ft,Ut]),Dr=new k(Pt),yr=new v.bo(qt,Bt);for(const Lt in ye){const Qt=ye[Lt];Qt instanceof v.a6?(B(Qt.layers,this.zoom,q),v.bp({bucket:Qt,glyphMap:Pt,glyphPositions:Dr.positions,imageMap:qt,imagePositions:yr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Qt.hasPattern&&(Qt instanceof v.bq||Qt instanceof v.br||Qt instanceof v.bs)&&(B(Qt.layers,this.zoom,q),Qt.addFeatures(ue,this.tileID.canonical,yr.patternPositions))}return this.status="done",{buckets:Object.values(ye).filter(Lt=>!Lt.isEmpty()),featureIndex:me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Dr.image,imageAtlas:yr,glyphMap:this.returnDependencies?Pt:null,iconMap:this.returnDependencies?qt:null,glyphPositions:this.returnDependencies?Dr.positions:null}})}}function B(ie,N,F){const q=new v.z(N);for(const J of ie)J.recalculate(q,F)}class R{constructor(N,F,q){this.actor=N,this.layerIndex=F,this.availableImages=q,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(N,F){return v._(this,void 0,void 0,function*(){const q=yield v.l(N.request,F);try{return{vectorTile:new v.bt.VectorTile(new v.bu(q.data)),rawData:q.data,cacheControl:q.cacheControl,expires:q.expires}}catch(J){const de=new Uint8Array(q.data);let me=`Unable to parse the tile at ${N.request.url}, `;throw me+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${J.message}`,new Error(me)}})}loadTile(N){return v._(this,void 0,void 0,function*(){const F=N.uid,q=!!(N&&N.request&&N.request.collectResourceTiming)&&new v.bv(N.request),J=new A(N);this.loading[F]=J;const de=new AbortController;J.abort=de;try{const me=yield this.loadVectorTile(N,de);if(delete this.loading[F],!me)return null;const ye=me.rawData,ue={};me.expires&&(ue.expires=me.expires),me.cacheControl&&(ue.cacheControl=me.cacheControl);const Se={};if(q){const Ee=q.finish();Ee&&(Se.resourceTiming=JSON.parse(JSON.stringify(Ee)))}J.vectorTile=me.vectorTile;const Ae=J.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[F]=J,this.fetching[F]={rawTileData:ye,cacheControl:ue,resourceTiming:Se};try{const Ee=yield Ae;return v.e({rawTileData:ye.slice(0)},Ee,ue,Se)}finally{delete this.fetching[F]}}catch(me){throw delete this.loading[F],J.status="done",this.loaded[F]=J,me}})}reloadTile(N){return v._(this,void 0,void 0,function*(){const F=N.uid;if(!this.loaded||!this.loaded[F])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const q=this.loaded[F];if(q.showCollisionBoxes=N.showCollisionBoxes,q.status==="parsing"){const J=yield q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor);let de;if(this.fetching[F]){const{rawTileData:me,cacheControl:ye,resourceTiming:ue}=this.fetching[F];delete this.fetching[F],de=v.e({rawTileData:me.slice(0)},J,ye,ue)}else de=J;return de}if(q.status==="done"&&q.vectorTile)return q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(N){return v._(this,void 0,void 0,function*(){const F=this.loading,q=N.uid;F&&F[q]&&F[q].abort&&(F[q].abort.abort(),delete F[q])})}removeTile(N){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[N.uid]&&delete this.loaded[N.uid]})}}class L{constructor(){this.loaded={}}loadTile(N){return v._(this,void 0,void 0,function*(){const{uid:F,encoding:q,rawImageData:J,redFactor:de,greenFactor:me,blueFactor:ye,baseShift:ue}=N,Se=J.width+2,Ae=J.height+2,Ee=v.b(J)?new v.R({width:Se,height:Ae},yield v.bw(J,-1,-1,Se,Ae)):J,$e=new v.bx(F,Ee,q,de,me,ye,ue);return this.loaded=this.loaded||{},this.loaded[F]=$e,$e})}removeTile(N){const F=this.loaded,q=N.uid;F&&F[q]&&delete F[q]}}function $(ie,N){if(ie.length!==0){le(ie[0],N);for(var F=1;F<ie.length;F++)le(ie[F],!N)}}function le(ie,N){for(var F=0,q=0,J=0,de=ie.length,me=de-1;J<de;me=J++){var ye=(ie[J][0]-ie[me][0])*(ie[me][1]+ie[J][1]),ue=F+ye;q+=Math.abs(F)>=Math.abs(ye)?F-ue+ye:ye-ue+F,F=ue}F+q>=0!=!!N&&ie.reverse()}var Q=v.by(function ie(N,F){var q,J=N&&N.type;if(J==="FeatureCollection")for(q=0;q<N.features.length;q++)ie(N.features[q],F);else if(J==="GeometryCollection")for(q=0;q<N.geometries.length;q++)ie(N.geometries[q],F);else if(J==="Feature")ie(N.geometry,F);else if(J==="Polygon")$(N.coordinates,F);else if(J==="MultiPolygon")for(q=0;q<N.coordinates.length;q++)$(N.coordinates[q],F);return N});const se=v.bt.VectorTileFeature.prototype.toGeoJSON;var W={exports:{}},G=v.bz,K=v.bt.VectorTileFeature,he=be;function be(ie,N){this.options=N||{},this.features=ie,this.length=ie.length}function ke(ie,N){this.id=typeof ie.id=="number"?ie.id:void 0,this.type=ie.type,this.rawGeometry=ie.type===1?[ie.geometry]:ie.geometry,this.properties=ie.tags,this.extent=N||4096}be.prototype.feature=function(ie){return new ke(this.features[ie],this.options.extent)},ke.prototype.loadGeometry=function(){var ie=this.rawGeometry;this.geometry=[];for(var N=0;N<ie.length;N++){for(var F=ie[N],q=[],J=0;J<F.length;J++)q.push(new G(F[J][0],F[J][1]));this.geometry.push(q)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ie=this.geometry,N=1/0,F=-1/0,q=1/0,J=-1/0,de=0;de<ie.length;de++)for(var me=ie[de],ye=0;ye<me.length;ye++){var ue=me[ye];N=Math.min(N,ue.x),F=Math.max(F,ue.x),q=Math.min(q,ue.y),J=Math.max(J,ue.y)}return[N,q,F,J]},ke.prototype.toGeoJSON=K.prototype.toGeoJSON;var Pe=v.bA,Fe=he;function st(ie){var N=new Pe;return function(F,q){for(var J in F.layers)q.writeMessage(3,Be,F.layers[J])}(ie,N),N.finish()}function Be(ie,N){var F;N.writeVarintField(15,ie.version||1),N.writeStringField(1,ie.name||""),N.writeVarintField(5,ie.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<ie.length;F++)q.feature=ie.feature(F),N.writeMessage(2,qe,q);var J=q.keys;for(F=0;F<J.length;F++)N.writeStringField(3,J[F]);var de=q.values;for(F=0;F<de.length;F++)N.writeMessage(4,bt,de[F])}function qe(ie,N){var F=ie.feature;F.id!==void 0&&N.writeVarintField(1,F.id),N.writeMessage(2,ot,ie),N.writeVarintField(3,F.type),N.writeMessage(4,It,F)}function ot(ie,N){var F=ie.feature,q=ie.keys,J=ie.values,de=ie.keycache,me=ie.valuecache;for(var ye in F.properties){var ue=F.properties[ye],Se=de[ye];if(ue!==null){Se===void 0&&(q.push(ye),de[ye]=Se=q.length-1),N.writeVarint(Se);var Ae=typeof ue;Ae!=="string"&&Ae!=="boolean"&&Ae!=="number"&&(ue=JSON.stringify(ue));var Ee=Ae+":"+ue,$e=me[Ee];$e===void 0&&(J.push(ue),me[Ee]=$e=J.length-1),N.writeVarint($e)}}}function xt(ie,N){return(N<<3)+(7&ie)}function He(ie){return ie<<1^ie>>31}function It(ie,N){for(var F=ie.loadGeometry(),q=ie.type,J=0,de=0,me=F.length,ye=0;ye<me;ye++){var ue=F[ye],Se=1;q===1&&(Se=ue.length),N.writeVarint(xt(1,Se));for(var Ae=q===3?ue.length-1:ue.length,Ee=0;Ee<Ae;Ee++){Ee===1&&q!==1&&N.writeVarint(xt(2,Ae-1));var $e=ue[Ee].x-J,ft=ue[Ee].y-de;N.writeVarint(He($e)),N.writeVarint(He(ft)),J+=$e,de+=ft}q===3&&N.writeVarint(xt(7,1))}}function bt(ie,N){var F=typeof ie;F==="string"?N.writeStringField(1,ie):F==="boolean"?N.writeBooleanField(7,ie):F==="number"&&(ie%1!=0?N.writeDoubleField(3,ie):ie<0?N.writeSVarintField(6,ie):N.writeVarintField(5,ie))}W.exports=st,W.exports.fromVectorTileJs=st,W.exports.fromGeojsonVt=function(ie,N){N=N||{};var F={};for(var q in ie)F[q]=new Fe(ie[q].features,N),F[q].name=q,F[q].version=N.version,F[q].extent=N.extent;return st({layers:F})},W.exports.GeoJSONWrapper=Fe;var wt=v.by(W.exports);const De={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ie=>ie},Re=Math.fround||(et=new Float32Array(1),ie=>(et[0]=+ie,et[0]));var et;const yt=3,dt=5,Mt=6;class At{constructor(N){this.options=Object.assign(Object.create(De),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:F,minZoom:q,maxZoom:J}=this.options;F&&console.time("total time");const de=`prepare ${N.length} points`;F&&console.time(de),this.points=N;const me=[];for(let ue=0;ue<N.length;ue++){const Se=N[ue];if(!Se.geometry)continue;const[Ae,Ee]=Se.geometry.coordinates,$e=Re(zt(Ae)),ft=Re(Vr(Ee));me.push($e,ft,1/0,ue,-1,1),this.options.reduce&&me.push(0)}let ye=this.trees[J+1]=this._createTree(me);F&&console.timeEnd(de);for(let ue=J;ue>=q;ue--){const Se=+Date.now();ye=this.trees[ue]=this._createTree(this._cluster(ye,ue)),F&&console.log("z%d: %d clusters in %dms",ue,ye.numItems,+Date.now()-Se)}return F&&console.timeEnd("total time"),this}getClusters(N,F){let q=((N[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,N[1]));let de=N[2]===180?180:((N[2]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)q=-180,de=180;else if(q>de){const Ee=this.getClusters([q,J,180,me],F),$e=this.getClusters([-180,J,de,me],F);return Ee.concat($e)}const ye=this.trees[this._limitZoom(F)],ue=ye.range(zt(q),Vr(me),zt(de),Vr(J)),Se=ye.data,Ae=[];for(const Ee of ue){const $e=this.stride*Ee;Ae.push(Se[$e+dt]>1?Yt(Se,$e,this.clusterProps):this.points[Se[$e+yt]])}return Ae}getChildren(N){const F=this._getOriginId(N),q=this._getOriginZoom(N),J="No cluster with the specified id.",de=this.trees[q];if(!de)throw new Error(J);const me=de.data;if(F*this.stride>=me.length)throw new Error(J);const ye=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ue=de.within(me[F*this.stride],me[F*this.stride+1],ye),Se=[];for(const Ae of ue){const Ee=Ae*this.stride;me[Ee+4]===N&&Se.push(me[Ee+dt]>1?Yt(me,Ee,this.clusterProps):this.points[me[Ee+yt]])}if(Se.length===0)throw new Error(J);return Se}getLeaves(N,F,q){const J=[];return this._appendLeaves(J,N,F=F||10,q=q||0,0),J}getTile(N,F,q){const J=this.trees[this._limitZoom(N)],de=Math.pow(2,N),{extent:me,radius:ye}=this.options,ue=ye/me,Se=(q-ue)/de,Ae=(q+1+ue)/de,Ee={features:[]};return this._addTileFeatures(J.range((F-ue)/de,Se,(F+1+ue)/de,Ae),J.data,F,q,de,Ee),F===0&&this._addTileFeatures(J.range(1-ue/de,Se,1,Ae),J.data,de,q,de,Ee),F===de-1&&this._addTileFeatures(J.range(0,Se,ue/de,Ae),J.data,-1,q,de,Ee),Ee.features.length?Ee:null}getClusterExpansionZoom(N){let F=this._getOriginZoom(N)-1;for(;F<=this.options.maxZoom;){const q=this.getChildren(N);if(F++,q.length!==1)break;N=q[0].properties.cluster_id}return F}_appendLeaves(N,F,q,J,de){const me=this.getChildren(F);for(const ye of me){const ue=ye.properties;if(ue&&ue.cluster?de+ue.point_count<=J?de+=ue.point_count:de=this._appendLeaves(N,ue.cluster_id,q,J,de):de<J?de++:N.push(ye),N.length===q)break}return de}_createTree(N){const F=new v.av(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<N.length;q+=this.stride)F.add(N[q],N[q+1]);return F.finish(),F.data=N,F}_addTileFeatures(N,F,q,J,de,me){for(const ye of N){const ue=ye*this.stride,Se=F[ue+dt]>1;let Ae,Ee,$e;if(Se)Ae=gr(F,ue,this.clusterProps),Ee=F[ue],$e=F[ue+1];else{const Ut=this.points[F[ue+yt]];Ae=Ut.properties;const[Pt,qt]=Ut.geometry.coordinates;Ee=zt(Pt),$e=Vr(qt)}const ft={type:1,geometry:[[Math.round(this.options.extent*(Ee*de-q)),Math.round(this.options.extent*($e*de-J))]],tags:Ae};let mt;mt=Se||this.options.generateId?F[ue+yt]:this.points[F[ue+yt]].id,mt!==void 0&&(ft.id=mt),me.features.push(ft)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,F){const{radius:q,extent:J,reduce:de,minPoints:me}=this.options,ye=q/(J*Math.pow(2,F)),ue=N.data,Se=[],Ae=this.stride;for(let Ee=0;Ee<ue.length;Ee+=Ae){if(ue[Ee+2]<=F)continue;ue[Ee+2]=F;const $e=ue[Ee],ft=ue[Ee+1],mt=N.within(ue[Ee],ue[Ee+1],ye),Ut=ue[Ee+dt];let Pt=Ut;for(const qt of mt){const Bt=qt*Ae;ue[Bt+2]>F&&(Pt+=ue[Bt+dt])}if(Pt>Ut&&Pt>=me){let qt,Bt=$e*Ut,Dr=ft*Ut,yr=-1;const Lt=((Ee/Ae|0)<<5)+(F+1)+this.points.length;for(const Qt of mt){const pr=Qt*Ae;if(ue[pr+2]<=F)continue;ue[pr+2]=F;const Ur=ue[pr+dt];Bt+=ue[pr]*Ur,Dr+=ue[pr+1]*Ur,ue[pr+4]=Lt,de&&(qt||(qt=this._map(ue,Ee,!0),yr=this.clusterProps.length,this.clusterProps.push(qt)),de(qt,this._map(ue,pr)))}ue[Ee+4]=Lt,Se.push(Bt/Pt,Dr/Pt,1/0,Lt,-1,Pt),de&&Se.push(yr)}else{for(let qt=0;qt<Ae;qt++)Se.push(ue[Ee+qt]);if(Pt>1)for(const qt of mt){const Bt=qt*Ae;if(!(ue[Bt+2]<=F)){ue[Bt+2]=F;for(let Dr=0;Dr<Ae;Dr++)Se.push(ue[Bt+Dr])}}}}return Se}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,F,q){if(N[F+dt]>1){const me=this.clusterProps[N[F+Mt]];return q?Object.assign({},me):me}const J=this.points[N[F+yt]].properties,de=this.options.map(J);return q&&de===J?Object.assign({},de):de}}function Yt(ie,N,F){return{type:"Feature",id:ie[N+yt],properties:gr(ie,N,F),geometry:{type:"Point",coordinates:[(q=ie[N],360*(q-.5)),sn(ie[N+1])]}};var q}function gr(ie,N,F){const q=ie[N+dt],J=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,de=ie[N+Mt],me=de===-1?{}:Object.assign({},F[de]);return Object.assign(me,{cluster:!0,cluster_id:ie[N+yt],point_count:q,point_count_abbreviated:J})}function zt(ie){return ie/360+.5}function Vr(ie){const N=Math.sin(ie*Math.PI/180),F=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return F<0?0:F>1?1:F}function sn(ie){const N=(180-360*ie)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function _n(ie,N,F,q){let J=q;const de=N+(F-N>>1);let me,ye=F-N;const ue=ie[N],Se=ie[N+1],Ae=ie[F],Ee=ie[F+1];for(let $e=N+3;$e<F;$e+=3){const ft=kn(ie[$e],ie[$e+1],ue,Se,Ae,Ee);if(ft>J)me=$e,J=ft;else if(ft===J){const mt=Math.abs($e-de);mt<ye&&(me=$e,ye=mt)}}J>q&&(me-N>3&&_n(ie,N,me,q),ie[me+2]=J,F-me>3&&_n(ie,me,F,q))}function kn(ie,N,F,q,J,de){let me=J-F,ye=de-q;if(me!==0||ye!==0){const ue=((ie-F)*me+(N-q)*ye)/(me*me+ye*ye);ue>1?(F=J,q=de):ue>0&&(F+=me*ue,q+=ye*ue)}return me=ie-F,ye=N-q,me*me+ye*ye}function on(ie,N,F,q){const J={id:ie??null,type:N,geometry:F,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(N==="Point"||N==="MultiPoint"||N==="LineString")Xr(J,F);else if(N==="Polygon")Xr(J,F[0]);else if(N==="MultiLineString")for(const de of F)Xr(J,de);else if(N==="MultiPolygon")for(const de of F)Xr(J,de[0]);return J}function Xr(ie,N){for(let F=0;F<N.length;F+=3)ie.minX=Math.min(ie.minX,N[F]),ie.minY=Math.min(ie.minY,N[F+1]),ie.maxX=Math.max(ie.maxX,N[F]),ie.maxY=Math.max(ie.maxY,N[F+1])}function Un(ie,N,F,q){if(!N.geometry)return;const J=N.geometry.coordinates;if(J&&J.length===0)return;const de=N.geometry.type,me=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2);let ye=[],ue=N.id;if(F.promoteId?ue=N.properties[F.promoteId]:F.generateId&&(ue=q||0),de==="Point")Yi(J,ye);else if(de==="MultiPoint")for(const Se of J)Yi(Se,ye);else if(de==="LineString")Te(J,ye,me,!1);else if(de==="MultiLineString"){if(F.lineMetrics){for(const Se of J)ye=[],Te(Se,ye,me,!1),ie.push(on(ue,"LineString",ye,N.properties));return}Ci(J,ye,me,!1)}else if(de==="Polygon")Ci(J,ye,me,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(const Se of N.geometry.geometries)Un(ie,{id:ue,geometry:Se,properties:N.properties},F,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Se of J){const Ae=[];Ci(Se,Ae,me,!0),ye.push(Ae)}}ie.push(on(ue,de,ye,N.properties))}function Yi(ie,N){N.push(ki(ie[0]),Ot(ie[1]),0)}function Te(ie,N,F,q){let J,de,me=0;for(let ue=0;ue<ie.length;ue++){const Se=ki(ie[ue][0]),Ae=Ot(ie[ue][1]);N.push(Se,Ae,0),ue>0&&(me+=q?(J*Ae-Se*de)/2:Math.sqrt(Math.pow(Se-J,2)+Math.pow(Ae-de,2))),J=Se,de=Ae}const ye=N.length-3;N[2]=1,_n(N,0,ye,F),N[ye+2]=1,N.size=Math.abs(me),N.start=0,N.end=N.size}function Ci(ie,N,F,q){for(let J=0;J<ie.length;J++){const de=[];Te(ie[J],de,F,q),N.push(de)}}function ki(ie){return ie/360+.5}function Ot(ie){const N=Math.sin(ie*Math.PI/180),F=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return F<0?0:F>1?1:F}function lr(ie,N,F,q,J,de,me,ye){if(q/=N,de>=(F/=N)&&me<q)return ie;if(me<F||de>=q)return null;const ue=[];for(const Se of ie){const Ae=Se.geometry;let Ee=Se.type;const $e=J===0?Se.minX:Se.minY,ft=J===0?Se.maxX:Se.maxY;if($e>=F&&ft<q){ue.push(Se);continue}if(ft<F||$e>=q)continue;let mt=[];if(Ee==="Point"||Ee==="MultiPoint")Pi(Ae,mt,F,q,J);else if(Ee==="LineString")Ii(Ae,mt,F,q,J,!1,ye.lineMetrics);else if(Ee==="MultiLineString")zs(Ae,mt,F,q,J,!1);else if(Ee==="Polygon")zs(Ae,mt,F,q,J,!0);else if(Ee==="MultiPolygon")for(const Ut of Ae){const Pt=[];zs(Ut,Pt,F,q,J,!0),Pt.length&&mt.push(Pt)}if(mt.length){if(ye.lineMetrics&&Ee==="LineString"){for(const Ut of mt)ue.push(on(Se.id,Ee,Ut,Se.tags));continue}Ee!=="LineString"&&Ee!=="MultiLineString"||(mt.length===1?(Ee="LineString",mt=mt[0]):Ee="MultiLineString"),Ee!=="Point"&&Ee!=="MultiPoint"||(Ee=mt.length===3?"Point":"MultiPoint"),ue.push(on(Se.id,Ee,mt,Se.tags))}}return ue.length?ue:null}function Pi(ie,N,F,q,J){for(let de=0;de<ie.length;de+=3){const me=ie[de+J];me>=F&&me<=q&&Pn(N,ie[de],ie[de+1],ie[de+2])}}function Ii(ie,N,F,q,J,de,me){let ye=Kr(ie);const ue=J===0?$r:ai;let Se,Ae,Ee=ie.start;for(let Pt=0;Pt<ie.length-3;Pt+=3){const qt=ie[Pt],Bt=ie[Pt+1],Dr=ie[Pt+2],yr=ie[Pt+3],Lt=ie[Pt+4],Qt=J===0?qt:Bt,pr=J===0?yr:Lt;let Ur=!1;me&&(Se=Math.sqrt(Math.pow(qt-yr,2)+Math.pow(Bt-Lt,2))),Qt<F?pr>F&&(Ae=ue(ye,qt,Bt,yr,Lt,F),me&&(ye.start=Ee+Se*Ae)):Qt>q?pr<q&&(Ae=ue(ye,qt,Bt,yr,Lt,q),me&&(ye.start=Ee+Se*Ae)):Pn(ye,qt,Bt,Dr),pr<F&&Qt>=F&&(Ae=ue(ye,qt,Bt,yr,Lt,F),Ur=!0),pr>q&&Qt<=q&&(Ae=ue(ye,qt,Bt,yr,Lt,q),Ur=!0),!de&&Ur&&(me&&(ye.end=Ee+Se*Ae),N.push(ye),ye=Kr(ie)),me&&(Ee+=Se)}let $e=ie.length-3;const ft=ie[$e],mt=ie[$e+1],Ut=J===0?ft:mt;Ut>=F&&Ut<=q&&Pn(ye,ft,mt,ie[$e+2]),$e=ye.length-3,de&&$e>=3&&(ye[$e]!==ye[0]||ye[$e+1]!==ye[1])&&Pn(ye,ye[0],ye[1],ye[2]),ye.length&&N.push(ye)}function Kr(ie){const N=[];return N.size=ie.size,N.start=ie.start,N.end=ie.end,N}function zs(ie,N,F,q,J,de){for(const me of ie)Ii(me,N,F,q,J,de,!1)}function Pn(ie,N,F,q){ie.push(N,F,q)}function $r(ie,N,F,q,J,de){const me=(de-N)/(q-N);return Pn(ie,de,F+(J-F)*me,1),me}function ai(ie,N,F,q,J,de){const me=(de-F)/(J-F);return Pn(ie,N+(q-N)*me,de,1),me}function Ne(ie,N){const F=[];for(let q=0;q<ie.length;q++){const J=ie[q],de=J.type;let me;if(de==="Point"||de==="MultiPoint"||de==="LineString")me=li(J.geometry,N);else if(de==="MultiLineString"||de==="Polygon"){me=[];for(const ye of J.geometry)me.push(li(ye,N))}else if(de==="MultiPolygon"){me=[];for(const ye of J.geometry){const ue=[];for(const Se of ye)ue.push(li(Se,N));me.push(ue)}}F.push(on(J.id,de,me,J.tags))}return F}function li(ie,N){const F=[];F.size=ie.size,ie.start!==void 0&&(F.start=ie.start,F.end=ie.end);for(let q=0;q<ie.length;q+=3)F.push(ie[q]+N,ie[q+1],ie[q+2]);return F}function zr(ie,N){if(ie.transformed)return ie;const F=1<<ie.z,q=ie.x,J=ie.y;for(const de of ie.features){const me=de.geometry,ye=de.type;if(de.geometry=[],ye===1)for(let ue=0;ue<me.length;ue+=2)de.geometry.push(ui(me[ue],me[ue+1],N,F,q,J));else for(let ue=0;ue<me.length;ue++){const Se=[];for(let Ae=0;Ae<me[ue].length;Ae+=2)Se.push(ui(me[ue][Ae],me[ue][Ae+1],N,F,q,J));de.geometry.push(Se)}}return ie.transformed=!0,ie}function ui(ie,N,F,q,J,de){return[Math.round(F*(ie*q-J)),Math.round(F*(N*q-de))]}function Ai(ie,N,F,q,J){const de=N===J.maxZoom?0:J.tolerance/((1<<N)*J.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:ie.length,source:null,x:F,y:q,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ye of ie)je(me,ye,de,J);return me}function je(ie,N,F,q){const J=N.geometry,de=N.type,me=[];if(ie.minX=Math.min(ie.minX,N.minX),ie.minY=Math.min(ie.minY,N.minY),ie.maxX=Math.max(ie.maxX,N.maxX),ie.maxY=Math.max(ie.maxY,N.maxY),de==="Point"||de==="MultiPoint")for(let ye=0;ye<J.length;ye+=3)me.push(J[ye],J[ye+1]),ie.numPoints++,ie.numSimplified++;else if(de==="LineString")Ct(me,J,ie,F,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(let ye=0;ye<J.length;ye++)Ct(me,J[ye],ie,F,de==="Polygon",ye===0);else if(de==="MultiPolygon")for(let ye=0;ye<J.length;ye++){const ue=J[ye];for(let Se=0;Se<ue.length;Se++)Ct(me,ue[Se],ie,F,!0,Se===0)}if(me.length){let ye=N.tags||null;if(de==="LineString"&&q.lineMetrics){ye={};for(const Se in N.tags)ye[Se]=N.tags[Se];ye.mapbox_clip_start=J.start/J.size,ye.mapbox_clip_end=J.end/J.size}const ue={geometry:me,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:ye};N.id!==null&&(ue.id=N.id),ie.features.push(ue)}}function Ct(ie,N,F,q,J,de){const me=q*q;if(q>0&&N.size<(J?me:q))return void(F.numPoints+=N.length/3);const ye=[];for(let ue=0;ue<N.length;ue+=3)(q===0||N[ue+2]>me)&&(F.numSimplified++,ye.push(N[ue],N[ue+1])),F.numPoints++;J&&function(ue,Se){let Ae=0;for(let Ee=0,$e=ue.length,ft=$e-2;Ee<$e;ft=Ee,Ee+=2)Ae+=(ue[Ee]-ue[ft])*(ue[Ee+1]+ue[ft+1]);if(Ae>0===Se)for(let Ee=0,$e=ue.length;Ee<$e/2;Ee+=2){const ft=ue[Ee],mt=ue[Ee+1];ue[Ee]=ue[$e-2-Ee],ue[Ee+1]=ue[$e-1-Ee],ue[$e-2-Ee]=ft,ue[$e-1-Ee]=mt}}(ye,de),ie.push(ye)}const vt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Cr{constructor(N,F){const q=(F=this.options=function(de,me){for(const ye in me)de[ye]=me[ye];return de}(Object.create(vt),F)).debug;if(q&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");let J=function(de,me){const ye=[];if(de.type==="FeatureCollection")for(let ue=0;ue<de.features.length;ue++)Un(ye,de.features[ue],me,ue);else Un(ye,de.type==="Feature"?de:{geometry:de},me);return ye}(N,F);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),J=function(de,me){const ye=me.buffer/me.extent;let ue=de;const Se=lr(de,1,-1-ye,ye,0,-1,2,me),Ae=lr(de,1,1-ye,2+ye,0,-1,2,me);return(Se||Ae)&&(ue=lr(de,1,-ye,1+ye,0,-1,2,me)||[],Se&&(ue=Ne(Se,1).concat(ue)),Ae&&(ue=ue.concat(Ne(Ae,-1)))),ue}(J,F),J.length&&this.splitTile(J,0,0,0),q&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(N,F,q,J,de,me,ye){const ue=[N,F,q,J],Se=this.options,Ae=Se.debug;for(;ue.length;){J=ue.pop(),q=ue.pop(),F=ue.pop(),N=ue.pop();const Ee=1<<F,$e=qn(F,q,J);let ft=this.tiles[$e];if(!ft&&(Ae>1&&console.time("creation"),ft=this.tiles[$e]=Ai(N,F,q,J,Se),this.tileCoords.push({z:F,x:q,y:J}),Ae)){Ae>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,q,J,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));const Ur=`z${F}`;this.stats[Ur]=(this.stats[Ur]||0)+1,this.total++}if(ft.source=N,de==null){if(F===Se.indexMaxZoom||ft.numPoints<=Se.indexMaxPoints)continue}else{if(F===Se.maxZoom||F===de)continue;if(de!=null){const Ur=de-F;if(q!==me>>Ur||J!==ye>>Ur)continue}}if(ft.source=null,N.length===0)continue;Ae>1&&console.time("clipping");const mt=.5*Se.buffer/Se.extent,Ut=.5-mt,Pt=.5+mt,qt=1+mt;let Bt=null,Dr=null,yr=null,Lt=null,Qt=lr(N,Ee,q-mt,q+Pt,0,ft.minX,ft.maxX,Se),pr=lr(N,Ee,q+Ut,q+qt,0,ft.minX,ft.maxX,Se);N=null,Qt&&(Bt=lr(Qt,Ee,J-mt,J+Pt,1,ft.minY,ft.maxY,Se),Dr=lr(Qt,Ee,J+Ut,J+qt,1,ft.minY,ft.maxY,Se),Qt=null),pr&&(yr=lr(pr,Ee,J-mt,J+Pt,1,ft.minY,ft.maxY,Se),Lt=lr(pr,Ee,J+Ut,J+qt,1,ft.minY,ft.maxY,Se),pr=null),Ae>1&&console.timeEnd("clipping"),ue.push(Bt||[],F+1,2*q,2*J),ue.push(Dr||[],F+1,2*q,2*J+1),ue.push(yr||[],F+1,2*q+1,2*J),ue.push(Lt||[],F+1,2*q+1,2*J+1)}}getTile(N,F,q){N=+N,F=+F,q=+q;const J=this.options,{extent:de,debug:me}=J;if(N<0||N>24)return null;const ye=1<<N,ue=qn(N,F=F+ye&ye-1,q);if(this.tiles[ue])return zr(this.tiles[ue],de);me>1&&console.log("drilling down to z%d-%d-%d",N,F,q);let Se,Ae=N,Ee=F,$e=q;for(;!Se&&Ae>0;)Ae--,Ee>>=1,$e>>=1,Se=this.tiles[qn(Ae,Ee,$e)];return Se&&Se.source?(me>1&&(console.log("found parent tile z%d-%d-%d",Ae,Ee,$e),console.time("drilling down")),this.splitTile(Se.source,Ae,Ee,$e,N,F,q),me>1&&console.timeEnd("drilling down"),this.tiles[ue]?zr(this.tiles[ue],de):null):null}}function qn(ie,N,F){return 32*((1<<ie)*F+N)+ie}function kt(ie,N){return N?ie.properties[N]:ie.id}function Zn(ie,N){if(ie==null)return!0;if(ie.type==="Feature")return kt(ie,N)!=null;if(ie.type==="FeatureCollection"){const F=new Set;for(const q of ie.features){const J=kt(q,N);if(J==null||F.has(J))return!1;F.add(J)}return!0}return!1}function ci(ie,N){const F=new Map;if(ie!=null)if(ie.type==="Feature")F.set(kt(ie,N),ie);else for(const q of ie.features)F.set(kt(q,N),q);return F}class Ji extends R{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(N,F){return v._(this,void 0,void 0,function*(){const q=N.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const J=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!J)return null;const de=new class{constructor(ye){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.X,this.length=ye.length,this._features=ye}feature(ye){return new class{constructor(ue){this._feature=ue,this.extent=v.X,this.type=ue.type,this.properties=ue.tags,"id"in ue&&!isNaN(ue.id)&&(this.id=parseInt(ue.id,10))}loadGeometry(){if(this._feature.type===1){const ue=[];for(const Se of this._feature.geometry)ue.push([new v.P(Se[0],Se[1])]);return ue}{const ue=[];for(const Se of this._feature.geometry){const Ae=[];for(const Ee of Se)Ae.push(new v.P(Ee[0],Ee[1]));ue.push(Ae)}return ue}}toGeoJSON(ue,Se,Ae){return se.call(this,ue,Se,Ae)}}(this._features[ye])}}(J.features);let me=wt(de);return me.byteOffset===0&&me.byteLength===me.buffer.byteLength||(me=new Uint8Array(me)),{vectorTile:de,rawData:me.buffer}})}loadData(N){return v._(this,void 0,void 0,function*(){var F;(F=this._pendingRequest)===null||F===void 0||F.abort();const q=!!(N&&N.request&&N.request.collectResourceTiming)&&new v.bv(N.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(N,this._pendingRequest),this._geoJSONIndex=N.cluster?new At(function({superclusterOptions:me,clusterProperties:ye}){if(!ye||!me)return me;const ue={},Se={},Ae={accumulated:null,zoom:0},Ee={properties:null},$e=Object.keys(ye);for(const ft of $e){const[mt,Ut]=ye[ft],Pt=v.bC(Ut),qt=v.bC(typeof mt=="string"?[mt,["accumulated"],["get",ft]]:mt);ue[ft]=Pt.value,Se[ft]=qt.value}return me.map=ft=>{Ee.properties=ft;const mt={};for(const Ut of $e)mt[Ut]=ue[Ut].evaluate(Ae,Ee);return mt},me.reduce=(ft,mt)=>{Ee.properties=mt;for(const Ut of $e)Ae.accumulated=ft[Ut],ft[Ut]=Se[Ut].evaluate(Ae,Ee)},me}(N)).load((yield this._pendingData).features):(J=yield this._pendingData,new Cr(J,N.geojsonVtOptions)),this.loaded={};const de={};if(q){const me=q.finish();me&&(de.resourceTiming={},de.resourceTiming[N.source]=JSON.parse(JSON.stringify(me)))}return de}catch(de){if(delete this._pendingRequest,v.bB(de))return{abandoned:!0};throw de}var J})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(N){const F=this.loaded;return F&&F[N.uid]?super.reloadTile(N):this.loadTile(N)}loadAndProcessGeoJSON(N,F){return v._(this,void 0,void 0,function*(){let q=yield this.loadGeoJSON(N,F);if(delete this._pendingRequest,typeof q!="object")throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(Q(q,!0),N.filter){const J=v.bC(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(me=>`${me.key}: ${me.message}`).join(", "));q={type:"FeatureCollection",features:q.features.filter(me=>J.value.evaluate({zoom:0},me))}}return q})}loadGeoJSON(N,F){return v._(this,void 0,void 0,function*(){const{promoteId:q}=N;if(N.request){const J=yield v.h(N.request,F);return this._dataUpdateable=Zn(J.data,q)?ci(J.data,q):void 0,J.data}if(typeof N.data=="string")try{const J=JSON.parse(N.data);return this._dataUpdateable=Zn(J,q)?ci(J,q):void 0,J}catch{throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`)}if(!N.dataDiff)throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${N.source}`);return function(J,de,me){var ye,ue,Se,Ae;if(de.removeAll&&J.clear(),de.remove)for(const Ee of de.remove)J.delete(Ee);if(de.add)for(const Ee of de.add){const $e=kt(Ee,me);$e!=null&&J.set($e,Ee)}if(de.update)for(const Ee of de.update){let $e=J.get(Ee.id);if($e==null)continue;const ft=!Ee.removeAllProperties&&(((ye=Ee.removeProperties)===null||ye===void 0?void 0:ye.length)>0||((ue=Ee.addOrUpdateProperties)===null||ue===void 0?void 0:ue.length)>0);if((Ee.newGeometry||Ee.removeAllProperties||ft)&&($e=Object.assign({},$e),J.set(Ee.id,$e),ft&&($e.properties=Object.assign({},$e.properties))),Ee.newGeometry&&($e.geometry=Ee.newGeometry),Ee.removeAllProperties)$e.properties={};else if(((Se=Ee.removeProperties)===null||Se===void 0?void 0:Se.length)>0)for(const mt of Ee.removeProperties)Object.prototype.hasOwnProperty.call($e.properties,mt)&&delete $e.properties[mt];if(((Ae=Ee.addOrUpdateProperties)===null||Ae===void 0?void 0:Ae.length)>0)for(const{key:mt,value:Ut}of Ee.addOrUpdateProperties)$e.properties[mt]=Ut}}(this._dataUpdateable,N.dataDiff,q),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(N){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(N){return this._geoJSONIndex.getClusterExpansionZoom(N.clusterId)}getClusterChildren(N){return this._geoJSONIndex.getChildren(N.clusterId)}getClusterLeaves(N){return this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset)}}class In{constructor(N){this.self=N,this.actor=new v.F(N),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(F,q)=>{if(this.externalWorkerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.externalWorkerSourceTypes[F]=q},this.self.addProtocol=v.bi,this.self.removeProtocol=v.bj,this.self.registerRTLTextPlugin=F=>{if(v.bD.isParsed())throw new Error("RTL text plugin already registered.");v.bD.setMethods(F)},this.actor.registerMessageHandler("LDT",(F,q)=>this._getDEMWorkerSource(F,q.source).loadTile(q)),this.actor.registerMessageHandler("RDT",(F,q)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(F,q.source).removeTile(q)})),this.actor.registerMessageHandler("GCEZ",(F,q)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(F,q.type,q.source).getClusterExpansionZoom(q)})),this.actor.registerMessageHandler("GCC",(F,q)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(F,q.type,q.source).getClusterChildren(q)})),this.actor.registerMessageHandler("GCL",(F,q)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(F,q.type,q.source).getClusterLeaves(q)})),this.actor.registerMessageHandler("LD",(F,q)=>this._getWorkerSource(F,q.type,q.source).loadData(q)),this.actor.registerMessageHandler("GD",(F,q)=>this._getWorkerSource(F,q.type,q.source).getData()),this.actor.registerMessageHandler("LT",(F,q)=>this._getWorkerSource(F,q.type,q.source).loadTile(q)),this.actor.registerMessageHandler("RT",(F,q)=>this._getWorkerSource(F,q.type,q.source).reloadTile(q)),this.actor.registerMessageHandler("AT",(F,q)=>this._getWorkerSource(F,q.type,q.source).abortTile(q)),this.actor.registerMessageHandler("RMT",(F,q)=>this._getWorkerSource(F,q.type,q.source).removeTile(q)),this.actor.registerMessageHandler("RS",(F,q)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[F]||!this.workerSources[F][q.type]||!this.workerSources[F][q.type][q.source])return;const J=this.workerSources[F][q.type][q.source];delete this.workerSources[F][q.type][q.source],J.removeSource!==void 0&&J.removeSource(q)})),this.actor.registerMessageHandler("RM",F=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[F],delete this.availableImages[F],delete this.workerSources[F],delete this.demWorkerSources[F]})),this.actor.registerMessageHandler("SR",(F,q)=>v._(this,void 0,void 0,function*(){this.referrer=q})),this.actor.registerMessageHandler("SRPS",(F,q)=>this._syncRTLPluginState(F,q)),this.actor.registerMessageHandler("IS",(F,q)=>v._(this,void 0,void 0,function*(){this.self.importScripts(q)})),this.actor.registerMessageHandler("SI",(F,q)=>this._setImages(F,q)),this.actor.registerMessageHandler("UL",(F,q)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(F).update(q.layers,q.removedIds)})),this.actor.registerMessageHandler("SL",(F,q)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(F).replace(q)}))}_setImages(N,F){return v._(this,void 0,void 0,function*(){this.availableImages[N]=F;for(const q in this.workerSources[N]){const J=this.workerSources[N][q];for(const de in J)J[de].availableImages=F}})}_syncRTLPluginState(N,F){return v._(this,void 0,void 0,function*(){if(v.bD.isParsed())return v.bD.getState();if(F.pluginStatus!=="loading")return v.bD.setState(F),F;const q=F.pluginURL;if(this.self.importScripts(q),v.bD.isParsed()){const J={pluginStatus:"loaded",pluginURL:q};return v.bD.setState(J),J}throw v.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${q}`)})}_getAvailableImages(N){let F=this.availableImages[N];return F||(F=[]),F}_getLayerIndex(N){let F=this.layerIndexes[N];return F||(F=this.layerIndexes[N]=new c),F}_getWorkerSource(N,F,q){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][F]||(this.workerSources[N][F]={}),!this.workerSources[N][F][q]){const J={sendAsync:(de,me)=>(de.targetMapId=N,this.actor.sendAsync(de,me))};switch(F){case"vector":this.workerSources[N][F][q]=new R(J,this._getLayerIndex(N),this._getAvailableImages(N));break;case"geojson":this.workerSources[N][F][q]=new Ji(J,this._getLayerIndex(N),this._getAvailableImages(N));break;default:this.workerSources[N][F][q]=new this.externalWorkerSourceTypes[F](J,this._getLayerIndex(N),this._getAvailableImages(N))}}return this.workerSources[N][F][q]}_getDEMWorkerSource(N,F){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][F]||(this.demWorkerSources[N][F]=new L),this.demWorkerSources[N][F]}}return v.i(self)&&(self.worker=new In(self)),In}),p("index",["exports","./shared"],function(v,c){var k="4.7.1";let A,B;const R={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((t,a)=>{const h=requestAnimationFrame(t);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(h),a(c.c())})}),getImageData(g,t=0){return this.getImageCanvasContext(g).getImageData(-t,-t,g.width+2*t,g.height+2*t)},getImageCanvasContext(g){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=g.width,t.height=g.height,a.drawImage(g,0,0,g.width,g.height),a},resolveURL:g=>(A||(A=document.createElement("a")),A.href=g,A.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class L{static testProp(t){if(!L.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in L.docStyle)return t[a];return t[0]}static create(t,a,h){const d=window.document.createElement(t);return a!==void 0&&(d.className=a),h&&h.appendChild(d),d}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){L.docStyle&&L.selectProp&&(L.userSelect=L.docStyle[L.selectProp],L.docStyle[L.selectProp]="none")}static enableDrag(){L.docStyle&&L.selectProp&&(L.docStyle[L.selectProp]=L.userSelect)}static setTransform(t,a){t.style[L.transformProp]=a}static addEventListener(t,a,h,d={}){t.addEventListener(a,h,"passive"in d?d:d.capture)}static removeEventListener(t,a,h,d={}){t.removeEventListener(a,h,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",L.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",L.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",L.suppressClickInternal,!0)},0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,h){const d=a.boundingClientRect;return new c.P((h.clientX-d.left)/a.x-t.clientLeft,(h.clientY-d.top)/a.y-t.clientTop)}static mousePos(t,a){const h=L.getScale(t);return L.getPoint(t,h,a)}static touchPos(t,a){const h=[],d=L.getScale(t);for(let m=0;m<a.length;m++)h.push(L.getPoint(t,d,a[m]));return h}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}L.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,L.selectProp=L.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),L.transformProp=L.testProp(["transform","WebkitTransform"]);const $={supported:!1,testSupport:function(g){!se&&Q&&(W?G(g):le=g)}};let le,Q,se=!1,W=!1;function G(g){const t=g.createTexture();g.bindTexture(g.TEXTURE_2D,t);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Q),g.isContextLost())return;$.supported=!0}catch{}g.deleteTexture(t),se=!0}var K;typeof document<"u"&&(Q=document.createElement("img"),Q.onload=()=>{le&&G(le),le=null,W=!0},Q.onerror=()=>{se=!0,le=null},Q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let t,a,h,d;g.resetRequestQueue=()=>{t=[],a=0,h=0,d={}},g.addThrottleControl=E=>{const I=h++;return d[I]=E,I},g.removeThrottleControl=E=>{delete d[E],b()},g.getImage=(E,I,z=!0)=>new Promise((D,V)=>{$.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),c.e(E,{type:"image"}),t.push({abortController:I,requestParameters:E,supportImageRefresh:z,state:"queued",onError:H=>{V(H)},onSuccess:H=>{D(H)}}),b()});const m=E=>c._(this,void 0,void 0,function*(){E.state="running";const{requestParameters:I,supportImageRefresh:z,onError:D,onSuccess:V,abortController:H}=E,Y=z===!1&&!c.i(self)&&!c.g(I.url)&&(!I.headers||Object.keys(I.headers).reduce((ce,fe)=>ce&&fe==="accept",!0));a++;const ne=Y?T(I,H):c.m(I,H);try{const ce=yield ne;delete E.abortController,E.state="completed",ce.data instanceof HTMLImageElement||c.b(ce.data)?V(ce):ce.data&&V({data:yield(ae=ce.data,typeof createImageBitmap=="function"?c.d(ae):c.f(ae)),cacheControl:ce.cacheControl,expires:ce.expires})}catch(ce){delete E.abortController,D(ce)}finally{a--,b()}var ae}),b=()=>{const E=(()=>{for(const I of Object.keys(d))if(d[I]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=a;I<E&&t.length>0;I++){const z=t.shift();z.abortController.signal.aborted?I--:m(z)}},T=(E,I)=>new Promise((z,D)=>{const V=new Image,H=E.url,Y=E.credentials;Y&&Y==="include"?V.crossOrigin="use-credentials":(Y&&Y==="same-origin"||!c.s(H))&&(V.crossOrigin="anonymous"),I.signal.addEventListener("abort",()=>{V.src="",D(c.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,z({data:V})},V.onerror=()=>{V.onerror=V.onload=null,I.signal.aborted||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=H})}(K||(K={})),K.resetRequestQueue();class he{constructor(t){this._transformRequestFn=t}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function be(g){var t=new c.A(3);return t[0]=g[0],t[1]=g[1],t[2]=g[2],t}var ke,Pe=function(g,t,a){return g[0]=t[0]-a[0],g[1]=t[1]-a[1],g[2]=t[2]-a[2],g};ke=new c.A(3),c.A!=Float32Array&&(ke[0]=0,ke[1]=0,ke[2]=0);var Fe=function(g){var t=g[0],a=g[1];return t*t+a*a};function st(g){const t=[];if(typeof g=="string")t.push({id:"default",url:g});else if(g&&g.length>0){const a=[];for(const{id:h,url:d}of g){const m=`${h}${d}`;a.indexOf(m)===-1&&(a.push(m),t.push({id:h,url:d}))}}return t}function Be(g,t,a){const h=g.split("?");return h[0]+=`${t}${a}`,h.join("?")}(function(){var g=new c.A(2);c.A!=Float32Array&&(g[0]=0,g[1]=0)})();class qe{constructor(t,a,h,d){this.context=t,this.format=h,this.texture=t.gl.createTexture(),this.update(a,d)}update(t,a,h){const{width:d,height:m}=t,b=!(this.size&&this.size[0]===d&&this.size[1]===m||h),{context:T}=this,{gl:E}=T;if(this.useMipmap=!!(a&&a.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!a||a.premultiply!==!1)),b)this.size=[d,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,t):E.texImage2D(E.TEXTURE_2D,0,this.format,d,m,0,this.format,E.UNSIGNED_BYTE,t.data);else{const{x:I,y:z}=h||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?E.texSubImage2D(E.TEXTURE_2D,0,I,z,E.RGBA,E.UNSIGNED_BYTE,t):E.texSubImage2D(E.TEXTURE_2D,0,I,z,d,m,E.RGBA,E.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(t,a,h){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),h!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,h||t),this.filter=t),a!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,a),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function ot(g){const{userImage:t}=g;return!!(t&&t.render&&t.render())&&(g.data.replace(new Uint8Array(t.data.buffer)),!0)}class xt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:h}of this.requestors)h(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const h=a.spriteData;a.data=new c.R({width:h.width,height:h.height},h.context.getImageData(h.x,h.y,h.width,h.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let h=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchX" value`))),h=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchY" value`))),h=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "content" value`))),h=!1),h}_validateStretch(t,a){if(!t)return!0;let h=0;for(const d of t){if(d[0]<h||d[1]<d[0]||a<d[1])return!1;h=d[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const h=a.spriteData,d=h&&h.width||a.data.width,m=h&&h.height||a.data.height;return!(t[0]<0||d<t[0]||t[1]<0||m<t[1]||t[2]<0||d<t[2]||t[3]<0||m<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,h=!0){const d=this.getImage(t);if(h&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((a,h)=>{let d=!0;if(!this.isLoaded())for(const m of t)this.images[m]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})})}_getImagesForIds(t){const a={};for(const h of t){let d=this.getImage(h);d||(this.fire(new c.k("styleimagemissing",{id:h})),d=this.getImage(h)),d?a[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:c.w(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],h=this.getImage(t);if(!h)return null;if(a&&a.position.version===h.version)return a.position;if(a)a.position.version=h.version;else{const d={w:h.data.width+2,h:h.data.height+2,x:0,y:0},m=new c.I(d,h);this.patterns[t]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new qe(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const m in this.patterns)t.push(this.patterns[m].bin);const{w:a,h}=c.p(t),d=this.atlasImage;d.resize({width:a||1,height:h||1});for(const m in this.patterns){const{bin:b}=this.patterns[m],T=b.x+1,E=b.y+1,I=this.getImage(m).data,z=I.width,D=I.height;c.R.copy(I,d,{x:0,y:0},{x:T,y:E},{width:z,height:D}),c.R.copy(I,d,{x:0,y:D-1},{x:T,y:E-1},{width:z,height:1}),c.R.copy(I,d,{x:0,y:0},{x:T,y:E+D},{width:z,height:1}),c.R.copy(I,d,{x:z-1,y:0},{x:T-1,y:E},{width:1,height:D}),c.R.copy(I,d,{x:0,y:0},{x:T+z,y:E},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const h=this.getImage(a);h||c.w(`Image with ID: "${a}" was not found`),ot(h)&&this.updateImage(a,h)}}}const He=1e20;function It(g,t,a,h,d,m,b,T,E){for(let I=t;I<t+h;I++)bt(g,a*m+I,m,d,b,T,E);for(let I=a;I<a+d;I++)bt(g,I*m+t,1,h,b,T,E)}function bt(g,t,a,h,d,m,b){m[0]=0,b[0]=-He,b[1]=He,d[0]=g[t];for(let T=1,E=0,I=0;T<h;T++){d[T]=g[t+T*a];const z=T*T;do{const D=m[E];I=(d[T]-d[D]+z-D*D)/(T-D)/2}while(I<=b[E]&&--E>-1);E++,m[E]=T,b[E]=I,b[E+1]=He}for(let T=0,E=0;T<h;T++){for(;b[E+1]<T;)E++;const I=m[E],z=T-I;g[t+T*a]=d[I]+z*z}}class wt{constructor(t,a){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,function*(){const a=[];for(const m in t)for(const b of t[m])a.push(this._getAndCacheGlyphsPromise(m,b));const h=yield Promise.all(a),d={};for(const{stack:m,id:b,glyph:T}of h)d[m]||(d[m]={}),d[m][b]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return d})}_getAndCacheGlyphsPromise(t,a){return c._(this,void 0,void 0,function*(){let h=this.entries[t];h||(h=this.entries[t]={glyphs:{},requests:{},ranges:{}});let d=h.glyphs[a];if(d!==void 0)return{stack:t,id:a,glyph:d};if(d=this._tinySDF(h,t,a),d)return h.glyphs[a]=d,{stack:t,id:a,glyph:d};const m=Math.floor(a/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(h.ranges[m])return{stack:t,id:a,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!h.requests[m]){const T=wt.loadGlyphRange(t,m,this.url,this.requestManager);h.requests[m]=T}const b=yield h.requests[m];for(const T in b)this._doesCharSupportLocalGlyph(+T)||(h.glyphs[+T]=b[+T]);return h.ranges[m]=!0,{stack:t,id:a,glyph:b[a]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))}_tinySDF(t,a,h){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(h))return;let m=t.tinySDF;if(!m){let T="400";/bold/i.test(a)?T="900":/medium/i.test(a)?T="500":/light/i.test(a)&&(T="200"),m=t.tinySDF=new wt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:T})}const b=m.draw(String.fromCharCode(h));return{id:h,bitmap:new c.o({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}wt.loadGlyphRange=function(g,t,a,h){return c._(this,void 0,void 0,function*(){const d=256*t,m=d+255,b=h.transformRequest(a.replace("{fontstack}",g).replace("{range}",`${d}-${m}`),"Glyphs"),T=yield c.l(b,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${t}, ${d}-${m}`);const E={};for(const I of c.n(T.data))E[I.id]=I;return E})},wt.TinySDF=class{constructor({fontSize:g=24,buffer:t=3,radius:a=8,cutoff:h=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:b="normal"}={}){this.buffer=t,this.cutoff=h,this.radius=a;const T=this.size=g+4*t,E=this._createCanvas(T),I=this.ctx=E.getContext("2d",{willReadFrequently:!0});I.font=`${b} ${m} ${g}px ${d}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(g){const t=document.createElement("canvas");return t.width=t.height=g,t}draw(g){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(g),b=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),E=Math.min(this.size-this.buffer,b+Math.ceil(h)),I=T+2*this.buffer,z=E+2*this.buffer,D=Math.max(I*z,0),V=new Uint8ClampedArray(D),H={data:V,width:I,height:z,glyphWidth:T,glyphHeight:E,glyphTop:b,glyphLeft:0,glyphAdvance:t};if(T===0||E===0)return H;const{ctx:Y,buffer:ne,gridInner:ae,gridOuter:ce}=this;Y.clearRect(ne,ne,T,E),Y.fillText(g,ne,ne+b);const fe=Y.getImageData(ne,ne,T,E);ce.fill(He,0,D),ae.fill(0,0,D);for(let te=0;te<E;te++)for(let ge=0;ge<T;ge++){const _e=fe.data[4*(te*T+ge)+3]/255;if(_e===0)continue;const we=(te+ne)*I+ge+ne;if(_e===1)ce[we]=0,ae[we]=He;else{const Me=.5-_e;ce[we]=Me>0?Me*Me:0,ae[we]=Me<0?Me*Me:0}}It(ce,0,0,I,z,I,this.f,this.v,this.z),It(ae,ne,ne,T,E,I,this.f,this.v,this.z);for(let te=0;te<D;te++){const ge=Math.sqrt(ce[te])-Math.sqrt(ae[te]);V[te]=Math.round(255-255*(ge/this.radius+this.cutoff))}return H}};class De{constructor(){this.specification=c.v.light.position}possiblyEvaluate(t,a){return c.x(t.expression.evaluate(a))}interpolate(t,a,h){return{x:c.y.number(t.x,a.x,h),y:c.y.number(t.y,a.y,h),z:c.y.number(t.z,a.z,h)}}}let Re;class et extends c.E{constructor(t){super(),Re=Re||new c.q({anchor:new c.D(c.v.light.anchor),position:new De,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(Re),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(c.r,t,a))for(const h in t){const d=t[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,h){return(!h||h.validate!==!1)&&c.t(this,t.call(c.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const yt=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class dt extends c.E{constructor(t){super(),this._transitionable=new c.T(yt),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(t,a={}){if(!this._validate(c.B,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const h in t){const d=t[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,h={}){return(h==null?void 0:h.validate)!==!1&&c.t(this,t.call(c.u,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Mt{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const h=t.join(",")+String(a);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(t,a)),this.dashEntry[h]}getDashRanges(t,a,h){const d=[];let m=t.length%2==1?-t[t.length-1]*h:0,b=t[0]*h,T=!0;d.push({left:m,right:b,isDash:T,zeroLength:t[0]===0});let E=t[0];for(let I=1;I<t.length;I++){T=!T;const z=t[I];m=E*h,E+=z,b=E*h,d.push({left:m,right:b,isDash:T,zeroLength:z===0})}return d}addRoundDash(t,a,h){const d=a/2;for(let m=-h;m<=h;m++){const b=this.width*(this.nextRow+h+m);let T=0,E=t[T];for(let I=0;I<this.width;I++){I/E.right>1&&(E=t[++T]);const z=Math.abs(I-E.left),D=Math.abs(I-E.right),V=Math.min(z,D);let H;const Y=m/h*(d+1);if(E.isDash){const ne=d-Math.abs(Y);H=Math.sqrt(V*V+ne*ne)}else H=d-Math.sqrt(V*V+Y*Y);this.data[b+I]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(t){for(let T=t.length-1;T>=0;--T){const E=t[T],I=t[T+1];E.zeroLength?t.splice(T,1):I&&I.isDash===E.isDash&&(I.left=E.left,t.splice(T,1))}const a=t[0],h=t[t.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const d=this.width*this.nextRow;let m=0,b=t[m];for(let T=0;T<this.width;T++){T/b.right>1&&(b=t[++m]);const E=Math.abs(T-b.left),I=Math.abs(T-b.right),z=Math.min(E,I);this.data[d+T]=Math.max(0,Math.min(255,(b.isDash?z:-z)+128))}}addDash(t,a){const h=a?7:0,d=2*h+1;if(this.nextRow+d>this.height)return c.w("LineAtlas out of space"),null;let m=0;for(let T=0;T<t.length;T++)m+=t[T];if(m!==0){const T=this.width/m,E=this.getDashRanges(t,this.width,T);a?this.addRoundDash(E,T,h):this.addRegularDash(E)}const b={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:m};return this.nextRow+=d,this.dirty=!0,b}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const At="maplibre_preloaded_worker_pool";class Yt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Yt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[At]}numActive(){return Object.keys(this.active).length}}const gr=Math.floor(R.hardwareConcurrency/2);let zt,Vr;function sn(){return zt||(zt=new Yt),zt}Yt.workerCount=c.C(globalThis)?Math.max(Math.min(gr,3),1):1;class _n{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const h=this.workerPool.acquire(a);for(let d=0;d<h.length;d++){const m=new c.F(h[d],a);m.name=`Worker ${d}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const h=[];for(const d of this.actors)h.push(d.sendAsync({type:t,data:a}));return Promise.all(h)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const h of this.actors)h.registerMessageHandler(t,a)}}function kn(){return Vr||(Vr=new _n(sn(),c.G),Vr.registerMessageHandler("GR",(g,t,a)=>c.m(t,a))),Vr}function on(g,t){const a=c.H();return c.J(a,a,[1,1,0]),c.K(a,a,[.5*g.width,.5*g.height,1]),c.L(a,a,g.calculatePosMatrix(t.toUnwrapped()))}function Xr(g,t,a,h,d,m){const b=function(D,V,H){if(D)for(const Y of D){const ne=V[Y];if(ne&&ne.source===H&&ne.type==="fill-extrusion")return!0}else for(const Y in V){const ne=V[Y];if(ne.source===H&&ne.type==="fill-extrusion")return!0}return!1}(d&&d.layers,t,g.id),T=m.maxPitchScaleFactor(),E=g.tilesIn(h,T,b);E.sort(Un);const I=[];for(const D of E)I.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(t,a,g._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,d,m,T,on(g.transform,D.tileID))});const z=function(D){const V={},H={};for(const Y of D){const ne=Y.queryResults,ae=Y.wrappedTileID,ce=H[ae]=H[ae]||{};for(const fe in ne){const te=ne[fe],ge=ce[fe]=ce[fe]||{},_e=V[fe]=V[fe]||[];for(const we of te)ge[we.featureIndex]||(ge[we.featureIndex]=!0,_e.push(we))}}return V}(I);for(const D in z)z[D].forEach(V=>{const H=V.feature,Y=g.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=Y});return z}function Un(g,t){const a=g.tileID,h=t.tileID;return a.overscaledZ-h.overscaledZ||a.canonical.y-h.canonical.y||a.wrap-h.wrap||a.canonical.x-h.canonical.x}function Yi(g,t,a){return c._(this,void 0,void 0,function*(){let h=g;if(g.url?h=(yield c.h(t.transformRequest(g.url,"Source"),a)).data:yield R.frameAsync(a),!h)return null;const d=c.M(c.e(h,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in h&&h.vector_layers&&(d.vectorLayerIds=h.vector_layers.map(m=>m.id)),d})}class Te{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}extend(t){const a=this._sw,h=this._ne;let d,m;if(t instanceof c.N)d=t,m=t;else{if(!(t instanceof Te))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Te.convert(t)):this.extend(c.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.N.convert(t)):this;if(d=t._sw,m=t._ne,!d||!m)return this}return a||h?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),h.lng=Math.max(m.lng,h.lng),h.lat=Math.max(m.lat,h.lat)):(this._sw=new c.N(d.lng,d.lat),this._ne=new c.N(m.lng,m.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:h}=c.N.convert(t);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&d}static convert(t){return t instanceof Te?t:t&&new Te(t)}static fromLngLat(t,a=0){const h=360*a/40075017,d=h/Math.cos(Math.PI/180*t.lat);return new Te(new c.N(t.lng-d,t.lat-h),new c.N(t.lng+d,t.lat+h))}adjustAntiMeridian(){const t=new c.N(this._sw.lng,this._sw.lat),a=new c.N(this._ne.lng,this._ne.lat);return new Te(t,t.lng>a.lng?new c.N(a.lng+360,a.lat):a)}}class Ci{constructor(t,a,h){this.bounds=Te.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=h||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),h=Math.floor(c.O(this.bounds.getWest())*a),d=Math.floor(c.Q(this.bounds.getNorth())*a),m=Math.ceil(c.O(this.bounds.getEast())*a),b=Math.ceil(c.Q(this.bounds.getSouth())*a);return t.x>=h&&t.x<m&&t.y>=d&&t.y<b}}class ki extends c.E{constructor(t,a,h,d){if(super(),this.id=t,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Yi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Ci(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};h.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((m,b)=>{t.reloadPromise={resolve:m,reject:b}})}else t.actor=this.dispatcher.getActor(),d="LT";t.abortController=new AbortController;try{const m=yield t.actor.sendAsync({type:d,data:h},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,m)}catch(m){if(delete t.abortController,t.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const h=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(h.resolve).catch(h.reject)}}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ot extends c.E{constructor(t,a,h,d){super(),this.id=t,this.dispatcher=h,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.M(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Yi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Ci(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const h=yield K.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(h&&h.data){this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&t.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const d=this.map.painter.context,m=d.gl,b=h.data;t.texture=this.map.painter.getTileTexture(b.width),t.texture?t.texture.update(b,{useMipmap:!0}):(t.texture=new qe(d,b,m.RGBA,{useMipmap:!0}),t.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(h){if(delete t.abortController,t.aborted)t.state="unloaded";else if(h)throw t.state="errored",h}})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class lr extends Ot{constructor(t,a,h,d){super(t,a,h,d),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const d=yield K.getImage(h,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){const m=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const b=c.b(m)&&c.U()?m:yield this.readImageNow(m),T={type:this.type,uid:t.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const E=yield t.actor.sendAsync({type:"LDT",data:T});t.dem=E,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}})}readImageNow(t){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const a=t.width+2,h=t.height+2;try{return new c.R({width:a,height:h},yield c.W(t,-1,-1,a,h))}catch{}}return R.getImageData(t,1)})}_getNeighboringTiles(t){const a=t.canonical,h=Math.pow(2,a.z),d=(a.x-1+h)%h,m=a.x===0?t.wrap-1:t.wrap,b=(a.x+1+h)%h,T=a.x+1===h?t.wrap+1:t.wrap,E={};return E[new c.S(t.overscaledZ,m,a.z,d,a.y).key]={backfilled:!1},E[new c.S(t.overscaledZ,T,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(E[new c.S(t.overscaledZ,m,a.z,d,a.y-1).key]={backfilled:!1},E[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},E[new c.S(t.overscaledZ,T,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<h&&(E[new c.S(t.overscaledZ,m,a.z,d,a.y+1).key]={backfilled:!1},E[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},E[new c.S(t.overscaledZ,T,a.z,b,a.y+1).key]={backfilled:!1}),E}unloadTile(t){return c._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Pi extends c.E{constructor(t,a,h,d){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=h.getActor(),this.setEventedParent(d),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const m=c.X/this.tileSize;a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*m,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*m,extent:c.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.X,radius:(a.clusterRadius||50)*m,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return c._(this,void 0,void 0,function*(){const t=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,h){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:h}})}_updateWorkerData(t){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);t?a.dataDiff=t:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(R.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const h=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||h.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let d=null;h.resourceTiming&&h.resourceTiming[this.id]&&(d=h.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&c.e(m,{resourceTiming:d}),this.fire(new c.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(h){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(h))}})}loaded(){return this._pendingLoads===0}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const h={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:h},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(d,this.map.painter,a==="RT")})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ii=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Kr extends c.E{constructor(t,a,h,d){super(),this.id=t,this.dispatcher=h,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(t){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield K.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(c.Z.fromLngLat);this.tileID=function(d){let m=1/0,b=1/0,T=-1/0,E=-1/0;for(const V of d)m=Math.min(m,V.x),b=Math.min(b,V.y),T=Math.max(T,V.x),E=Math.max(E,V.y);const I=Math.max(T-m,E-b),z=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),D=Math.pow(2,z);return new c.a1(z,Math.floor((m+T)/2*D),Math.floor((b+E)/2*D))}(a),this.minzoom=this.maxzoom=this.tileID.z;const h=a.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(h[0].x,h[0].y,0,0),this._boundsArray.emplaceBack(h[1].x,h[1].y,c.X,0),this._boundsArray.emplaceBack(h[3].x,h[3].y,0,c.X),this._boundsArray.emplaceBack(h[2].x,h[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ii.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new qe(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,h=!0)}h&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class zs extends Kr{constructor(t,a,h,d){super(t,a,h,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ii.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new qe(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,h=!0)}h&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Pn extends Kr{constructor(t,a,h,d){super(t,a,h,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(b=>typeof b!="number"))||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,h=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Ii.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new qe(a,this.canvas,h.RGBA,{premultiply:!0});let d=!1;for(const m in this.tiles){const b=this.tiles[m];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const $r={},ai=g=>{switch(g){case"geojson":return Pi;case"image":return Kr;case"raster":return Ot;case"raster-dem":return lr;case"vector":return ki;case"video":return zs;case"canvas":return Pn}return $r[g]},Ne="RTLPluginLoaded";class li extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=kn()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return c._(this,arguments,void 0,function*(a,h=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=R.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!h)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Ne))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let zr=null;function ui(){return zr||(zr=new li),zr}class Ai{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=c.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const a=t+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,m){const b={};if(!m)return b;for(const T of d){const E=T.layerIds.map(I=>m.getLayer(I)).filter(Boolean);if(E.length!==0){T.layers=E,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(I=>E.filter(z=>z.id===I)[0]));for(const I of E)b[I.id]=T}}return b}(t.buckets,a.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof c.a6){if(this.hasSymbolBuckets=!0,!h)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof c.a6&&m.hasRTLText){this.hasRTLText=!0,ui().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(m))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const h in this.buckets){const d=this.buckets[h];d.uploadPending()&&d.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qe(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qe(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,h,d,m,b,T,E,I,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:b,tileSize:this.tileSize,pixelPosMatrix:z,transform:E,params:T,queryPadding:this.queryPadding*I},t,a,h):{}}querySourceFeatures(t,a){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const d=h.loadVTLayers(),m=a&&a.sourceLayer?a.sourceLayer:"",b=d._geojsonTileLayer||d[m];if(!b)return;const T=c.a7(a&&a.filter),{z:E,x:I,y:z}=this.tileID.canonical,D={z:E,x:I,y:z};for(let V=0;V<b.length;V++){const H=b.feature(V);if(T.needGeometry){const ae=c.a8(H,!0);if(!T.filter(new c.z(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!T.filter(new c.z(this.tileID.overscaledZ),H))continue;const Y=h.getId(H,m),ne=new c.a9(H,E,I,z,Y);ne.tile=D,t.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const h=c.aa(t.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const h=Date.now();let d=!1;if(this.expirationTime>h)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const m=this.expirationTime-a;m?this.expirationTime=h+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const m=this.buckets[d],b=m.layers[0].sourceLayer||"_geojsonTileLayer",T=h[b],E=t[b];if(!T||!E||Object.keys(E).length===0)continue;m.update(E,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const I=a&&a.style&&a.style.getLayer(d);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<R.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=R.now()+t}setDependencies(t,a){const h={};for(const d of a)h[d]=!0;this.dependencies[t]=h}hasDependency(t,a){for(const h of t){const d=this.dependencies[h];if(d){for(const m of a)if(d[m])return!0}}return!1}}class je{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(const t in this.data)for(const a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,h){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:a,timeout:void 0};if(h!==void 0&&(m.timeout=setTimeout(()=>{this.remove(t,m)},h)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){const a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;const h=t.wrapped().key,d=a===void 0?0:this.data[h].indexOf(a),m=this.data[h][d];return this.data[h].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(m.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){const a=[];for(const h in this.data)for(const d of this.data[h])t(d.value)||a.push(d);for(const h of a)this.remove(h.value.tileID,h)}}class Ct{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,h){const d=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},c.e(this.stateChanges[t][d],h),this.deletedStates[t]===null){this.deletedStates[t]={};for(const m in this.state[t])m!==d&&(this.deletedStates[t][m]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const m in this.state[t][d])h[m]||(this.deletedStates[t][d][m]=null)}else for(const m in h)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][m]===null&&delete this.deletedStates[t][d][m]}removeFeatureState(t,a,h){if(this.deletedStates[t]===null)return;const d=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},h&&a!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][h]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(h in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][h]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,a){const h=String(a),d=c.e({},(this.state[t]||{})[h],(this.stateChanges[t]||{})[h]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const m=this.deletedStates[t][a];if(m===null)return{};for(const b in m)delete d[b]}return d}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const h={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const b in this.stateChanges[d])this.state[d][b]||(this.state[d][b]={}),c.e(this.state[d][b],this.stateChanges[d][b]),m[b]=this.state[d][b];h[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const b in this.state[d])m[b]={},this.state[d][b]={};else for(const b in this.deletedStates[d]){if(this.deletedStates[d][b]===null)this.state[d][b]={};else for(const T of Object.keys(this.deletedStates[d][b]))delete this.state[d][b][T];m[b]=this.state[d][b]}h[d]=h[d]||{},c.e(h[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const d in t)t[d].setFeatureState(h,a)}}class vt extends c.E{constructor(t,a,h){super(),this.id=t,this.dispatcher=h,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,m,b,T)=>{const E=new(ai(m.type))(d,m,b,T);if(E.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${E.id}`);return E})(t,a,h,this),this._tiles={},this._cache=new je(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ct,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,h){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,h)}catch(d){t.state="errored",d.status!==404?this._source.fire(new c.j(d,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const h=this._tiles[a];h.upload(t),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Cr).map(t=>t.key)}getRenderableIds(t){const a=[];for(const h in this._tiles)this._isIdRenderable(h,t)&&a.push(this._tiles[h]);return t?a.sort((h,d)=>{const m=h.tileID,b=d.tileID,T=new c.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),E=new c.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-b.overscaledZ||E.y-T.y||E.x-T.x}).map(h=>h.tileID.key):a.map(h=>h.tileID).sort(Cr).map(h=>h.key)}hasRenderableParent(t){const a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,a){return c._(this,void 0,void 0,function*(){const h=this._tiles[t];h&&(h.state!=="loading"&&(h.state=a),yield this._loadTile(h,t,a))})}_tileLoaded(t,a,h){t.timeAdded=R.now(),h==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const m=a[d];if(t.neighboringTiles&&t.neighboringTiles[m]){const b=this.getTileByID(m);h(t,b),h(b,t)}}function h(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let b=m.tileID.canonical.x-d.tileID.canonical.x;const T=m.tileID.canonical.y-d.tileID.canonical.y,E=Math.pow(2,d.tileID.canonical.z),I=m.tileID.key;b===0&&T===0||Math.abs(T)>1||(Math.abs(b)>1&&(Math.abs(b+E)===1?b+=E:Math.abs(b-E)===1&&(b-=E)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,b,T),d.neighboringTiles&&d.neighboringTiles[I]&&(d.neighboringTiles[I].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,h,d){for(const m in this._tiles){let b=this._tiles[m];if(d[m]||!b.hasData()||b.tileID.overscaledZ<=a||b.tileID.overscaledZ>h)continue;let T=b.tileID;for(;b&&b.tileID.overscaledZ>a+1;){const I=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[I.key],b&&b.hasData()&&(T=I)}let E=T;for(;E.overscaledZ>a;)if(E=E.scaledTo(E.overscaledZ-1),t[E.key]){d[T.key]=T;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){const h=this._loadedParentTiles[t.key];return h&&h.tileID.overscaledZ>=a?h:null}for(let h=t.overscaledZ-1;h>=a;h--){const d=t.scaledTo(h),m=this._getLoadedTile(d);if(m)return m}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,h=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(a*h*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){const h={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+a),h[m.tileID.key]=m}this._tiles=h;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(t,a,h,d,m,b){const T={},E={},I=Object.keys(t),z=R.now();for(const D of I){const V=t[D],H=this._tiles[D];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=z)continue;const Y=this.findLoadedParent(V,a),ne=this.findLoadedSibling(V),ae=Y||ne||null;ae&&(this._addTile(ae.tileID),T[ae.tileID.key]=ae.tileID),E[D]=V}this._retainLoadedChildren(E,d,h,t);for(const D in T)t[D]||(this._coveredTiles[D]=!0,t[D]=T[D]);if(b){const D={},V={};for(const H of m)this._tiles[H.key].hasData()?D[H.key]=H:V[H.key]=H;for(const H in V){const Y=V[H].children(this._source.maxzoom);this._tiles[Y[0].key]&&this._tiles[Y[1].key]&&this._tiles[Y[2].key]&&this._tiles[Y[3].key]&&(D[Y[0].key]=t[Y[0].key]=Y[0],D[Y[1].key]=t[Y[1].key]=Y[1],D[Y[2].key]=t[Y[2].key]=Y[2],D[Y[3].key]=t[Y[3].key]=Y[3],delete V[H])}for(const H in V){const Y=V[H],ne=this.findLoadedParent(Y,this._source.minzoom),ae=this.findLoadedSibling(Y),ce=ne||ae||null;if(ce){D[ce.tileID.key]=t[ce.tileID.key]=ce.tileID;for(const fe in D)D[fe].isChildOf(ce.tileID)&&delete D[fe]}}for(const H in this._tiles)D[H]||(this._coveredTiles[H]=!0)}}update(t,a){if(!this._sourceLoaded||this._paused)return;let h;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new c.S(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(h=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(h=h.filter(z=>this._source.hasTile(z)))):h=[];const d=t.coveringZoomLevel(this._source),m=Math.max(d-vt.maxOverzooming,this._source.minzoom),b=Math.max(d+vt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const D of h)if(D.canonical.z>this._source.minzoom){const V=D.scaledTo(D.canonical.z-1);z[V.key]=V;const H=D.scaledTo(Math.max(this._source.minzoom,Math.min(D.canonical.z,5)));z[H.key]=H}h=h.concat(Object.values(z))}const T=h.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(h,d);qn(this._source.type)&&this._updateCoveredAndRetainedTiles(E,m,b,d,h,a);for(const z in E)this._tiles[z].clearFadeHold();const I=c.ab(this._tiles,E);for(const z of I){const D=this._tiles[z];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var h;const d={},m={},b=Math.max(a-vt.maxOverzooming,this._source.minzoom),T=Math.max(a+vt.maxUnderzooming,this._source.minzoom),E={};for(const I of t){const z=this._addTile(I);d[I.key]=I,z.hasData()||a<this._source.maxzoom&&(E[I.key]=I)}this._retainLoadedChildren(E,a,T,d);for(const I of t){let z=this._tiles[I.key];if(z.hasData())continue;if(a+1>this._source.maxzoom){const V=I.children(this._source.maxzoom)[0],H=this.getTile(V);if(H&&H.hasData()){d[V.key]=V;continue}}else{const V=I.children(this._source.maxzoom);if(d[V[0].key]&&d[V[1].key]&&d[V[2].key]&&d[V[3].key])continue}let D=z.wasRequested();for(let V=I.overscaledZ-1;V>=b;--V){const H=I.scaledTo(V);if(m[H.key])break;if(m[H.key]=!0,z=this.getTile(H),!z&&D&&(z=this._addTile(H)),z){const Y=z.hasData();if((Y||!(!((h=this.map)===null||h===void 0)&&h.cancelPendingTileRequestsWhileZooming)||D)&&(d[H.key]=H),D=z.wasRequested(),Y)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const a=[];let h,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){h=this._loadedParentTiles[d.key];break}a.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(h=this._getLoadedTile(m),h)break;d=m}for(const m of a)this._loadedParentTiles[m]=h}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const a=this._tiles[t].tileID,h=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=h}}_addTile(t){let a=this._tiles[t.key];if(a)return a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));const h=a;return a||(a=new Ai(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._tiles[t.key]=a,h||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const h=a.getExpiryTimeout();h&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},h))}_removeTile(t){const a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){const a=t.sourceDataType;t.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,a,h){const d=[],m=this.transform;if(!m)return d;const b=h?m.getCameraQueryGeometry(t):t,T=t.map(Y=>m.pointCoordinate(Y,this.terrain)),E=b.map(Y=>m.pointCoordinate(Y,this.terrain)),I=this.getIds();let z=1/0,D=1/0,V=-1/0,H=-1/0;for(const Y of E)z=Math.min(z,Y.x),D=Math.min(D,Y.y),V=Math.max(V,Y.x),H=Math.max(H,Y.y);for(let Y=0;Y<I.length;Y++){const ne=this._tiles[I[Y]];if(ne.holdingForFade())continue;const ae=ne.tileID,ce=Math.pow(2,m.zoom-ne.tileID.overscaledZ),fe=a*ne.queryPadding*c.X/ne.tileSize/ce,te=[ae.getTilePoint(new c.Z(z,D)),ae.getTilePoint(new c.Z(V,H))];if(te[0].x-fe<c.X&&te[0].y-fe<c.X&&te[1].x+fe>=0&&te[1].y+fe>=0){const ge=T.map(we=>ae.getTilePoint(we)),_e=E.map(we=>ae.getTilePoint(we));d.push({tile:ne,tileID:ae,queryGeometry:ge,cameraQueryGeometry:_e,scale:ce})}}return d}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map(h=>this._tiles[h].tileID);for(const h of a)h.posMatrix=this.transform.calculatePosMatrix(h.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(qn(this._source.type)){const t=R.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=t)return!0}return!1}setFeatureState(t,a,h){this._state.updateState(t=t||"_geojsonTileLayer",a,h)}removeFeatureState(t,a,h){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,h)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,h){const d=this._tiles[t];d&&d.setDependencies(a,h)}reloadTilesForDependencies(t,a){for(const h in this._tiles)this._tiles[h].hasDependency(t,a)&&this._reloadTile(h,"reloading");this._cache.filter(h=>!h.hasDependency(t,a))}}function Cr(g,t){const a=Math.abs(2*g.wrap)-+(g.wrap<0),h=Math.abs(2*t.wrap)-+(t.wrap<0);return g.overscaledZ-t.overscaledZ||h-a||t.canonical.y-g.canonical.y||t.canonical.x-g.canonical.x}function qn(g){return g==="raster"||g==="image"||g==="video"}vt.maxOverzooming=10,vt.maxUnderzooming=3;class kt{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.ac(t,0,1);let a=1,h=this._distances[a];const d=t*this.paddedLength+this.padding;for(;h<d&&a<this._distances.length;)h=this._distances[++a];const m=a-1,b=this._distances[m],T=h-b,E=T>0?(d-b)/T:0;return this.points[m].mult(1-E).add(this.points[a].mult(E))}}function Zn(g,t){let a=!0;return g==="always"||g!=="never"&&t!=="never"||(a=!1),a}class ci{constructor(t,a,h){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(t/h),this.yCellCount=Math.ceil(a/h);for(let b=0;b<this.xCellCount*this.yCellCount;b++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,h,d,m){this._forEachCell(a,h,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(t,a,h,d){this._forEachCell(a-d,h-d,a+d,h+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(h),this.circles.push(d)}_insertBoxCell(t,a,h,d,m,b){this.boxCells[m].push(b)}_insertCircleCell(t,a,h,d,m,b){this.circleCells[m].push(b)}_query(t,a,h,d,m,b,T){if(h<0||t>this.width||d<0||a>this.height)return[];const E=[];if(t<=0&&a<=0&&this.width<=h&&this.height<=d){if(m)return[{key:null,x1:t,y1:a,x2:h,y2:d}];for(let I=0;I<this.boxKeys.length;I++)E.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const z=this.circles[3*I],D=this.circles[3*I+1],V=this.circles[3*I+2];E.push({key:this.circleKeys[I],x1:z-V,y1:D-V,x2:z+V,y2:D+V})}}else this._forEachCell(t,a,h,d,this._queryCell,E,{hitTest:m,overlapMode:b,seenUids:{box:{},circle:{}}},T);return E}query(t,a,h,d){return this._query(t,a,h,d,!1,null)}hitTest(t,a,h,d,m,b){return this._query(t,a,h,d,!0,m,b).length>0}hitTestCircle(t,a,h,d,m){const b=t-h,T=t+h,E=a-h,I=a+h;if(T<0||b>this.width||I<0||E>this.height)return!1;const z=[];return this._forEachCell(b,E,T,I,this._queryCellCircle,z,{hitTest:!0,overlapMode:d,circle:{x:t,y:a,radius:h},seenUids:{box:{},circle:{}}},m),z.length>0}_queryCell(t,a,h,d,m,b,T,E){const{seenUids:I,hitTest:z,overlapMode:D}=T,V=this.boxCells[m];if(V!==null){const Y=this.bboxes;for(const ne of V)if(!I.box[ne]){I.box[ne]=!0;const ae=4*ne,ce=this.boxKeys[ne];if(t<=Y[ae+2]&&a<=Y[ae+3]&&h>=Y[ae+0]&&d>=Y[ae+1]&&(!E||E(ce))&&(!z||!Zn(D,ce.overlapMode))&&(b.push({key:ce,x1:Y[ae],y1:Y[ae+1],x2:Y[ae+2],y2:Y[ae+3]}),z))return!0}}const H=this.circleCells[m];if(H!==null){const Y=this.circles;for(const ne of H)if(!I.circle[ne]){I.circle[ne]=!0;const ae=3*ne,ce=this.circleKeys[ne];if(this._circleAndRectCollide(Y[ae],Y[ae+1],Y[ae+2],t,a,h,d)&&(!E||E(ce))&&(!z||!Zn(D,ce.overlapMode))){const fe=Y[ae],te=Y[ae+1],ge=Y[ae+2];if(b.push({key:ce,x1:fe-ge,y1:te-ge,x2:fe+ge,y2:te+ge}),z)return!0}}}return!1}_queryCellCircle(t,a,h,d,m,b,T,E){const{circle:I,seenUids:z,overlapMode:D}=T,V=this.boxCells[m];if(V!==null){const Y=this.bboxes;for(const ne of V)if(!z.box[ne]){z.box[ne]=!0;const ae=4*ne,ce=this.boxKeys[ne];if(this._circleAndRectCollide(I.x,I.y,I.radius,Y[ae+0],Y[ae+1],Y[ae+2],Y[ae+3])&&(!E||E(ce))&&!Zn(D,ce.overlapMode))return b.push(!0),!0}}const H=this.circleCells[m];if(H!==null){const Y=this.circles;for(const ne of H)if(!z.circle[ne]){z.circle[ne]=!0;const ae=3*ne,ce=this.circleKeys[ne];if(this._circlesCollide(Y[ae],Y[ae+1],Y[ae+2],I.x,I.y,I.radius)&&(!E||E(ce))&&!Zn(D,ce.overlapMode))return b.push(!0),!0}}}_forEachCell(t,a,h,d,m,b,T,E){const I=this._convertToXCellCoord(t),z=this._convertToYCellCoord(a),D=this._convertToXCellCoord(h),V=this._convertToYCellCoord(d);for(let H=I;H<=D;H++)for(let Y=z;Y<=V;Y++)if(m.call(this,t,a,h,d,this.xCellCount*Y+H,b,T,E))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,h,d,m,b){const T=d-t,E=m-a,I=h+b;return I*I>T*T+E*E}_circleAndRectCollide(t,a,h,d,m,b,T){const E=(b-d)/2,I=Math.abs(t-(d+E));if(I>E+h)return!1;const z=(T-m)/2,D=Math.abs(a-(m+z));if(D>z+h)return!1;if(I<=E||D<=z)return!0;const V=I-E,H=D-z;return V*V+H*H<=h*h}}function Ji(g,t,a,h,d){const m=c.H();return t?(c.K(m,m,[1/d,1/d,1]),a||c.ad(m,m,h.angle)):c.L(m,h.labelPlaneMatrix,g),m}function In(g,t,a,h,d){if(t){const m=c.ae(g);return c.K(m,m,[d,d,1]),a||c.ad(m,m,-h.angle),m}return h.glCoordMatrix}function ie(g,t,a,h){let d;h?(d=[g,t,h(g,t),1],c.af(d,d,a)):(d=[g,t,0,1],Ut(d,d,a));const m=d[3];return{point:new c.P(d[0]/m,d[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function N(g,t){return .5+g/t*.5}function F(g,t){return g.x>=-t[0]&&g.x<=t[0]&&g.y>=-t[1]&&g.y<=t[1]}function q(g,t,a,h,d,m,b,T,E,I,z,D,V,H,Y){const ne=h?g.textSizeData:g.iconSizeData,ae=c.ag(ne,a.transform.zoom),ce=[256/a.width*2+1,256/a.height*2+1],fe=h?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;fe.clear();const te=g.lineVertexArray,ge=h?g.text.placedSymbolArray:g.icon.placedSymbolArray,_e=a.transform.width/a.transform.height;let we=!1;for(let Me=0;Me<ge.length;Me++){const Oe=ge.get(Me);if(Oe.hidden||Oe.writingMode===c.ah.vertical&&!we){mt(Oe.numGlyphs,fe);continue}we=!1;const Xe=ie(Oe.anchorX,Oe.anchorY,t,Y);if(!F(Xe.point,ce)){mt(Oe.numGlyphs,fe);continue}const tt=N(a.transform.cameraToCenterDistance,Xe.signedDistanceFromCamera),Ze=c.ai(ne,ae,Oe),Ue=b?Ze/tt:Ze*tt,lt={getElevation:Y,labelPlaneMatrix:d,lineVertexArray:te,pitchWithMap:b,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:I,tileAnchorPoint:new c.P(Oe.anchorX,Oe.anchorY),unwrappedTileID:z,width:D,height:V,translation:H},Et=me(lt,Oe,Ue,!1,T,t,m,g.glyphOffsetArray,fe,_e,E);we=Et.useVertical,(Et.notEnoughRoom||we||Et.needsFlipping&&me(lt,Oe,Ue,!0,T,t,m,g.glyphOffsetArray,fe,_e,E).notEnoughRoom)&&mt(Oe.numGlyphs,fe)}h?g.text.dynamicLayoutVertexBuffer.updateData(fe):g.icon.dynamicLayoutVertexBuffer.updateData(fe)}function J(g,t,a,h,d,m,b,T){const E=m.glyphStartIndex+m.numGlyphs,I=m.lineStartIndex,z=m.lineStartIndex+m.lineLength,D=t.getoffsetX(m.glyphStartIndex),V=t.getoffsetX(E-1),H=$e(g*D,a,h,d,m.segment,I,z,T,b);if(!H)return null;const Y=$e(g*V,a,h,d,m.segment,I,z,T,b);return Y?T.projectionCache.anyProjectionOccluded?null:{first:H,last:Y}:null}function de(g,t,a,h){return g===c.ah.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*h?{useVertical:!0}:(g===c.ah.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function me(g,t,a,h,d,m,b,T,E,I,z){const D=a/24,V=t.lineOffsetX*D,H=t.lineOffsetY*D;let Y;if(t.numGlyphs>1){const ne=t.glyphStartIndex+t.numGlyphs,ae=t.lineStartIndex,ce=t.lineStartIndex+t.lineLength,fe=J(D,T,V,H,h,t,z,g);if(!fe)return{notEnoughRoom:!0};const te=ie(fe.first.point.x,fe.first.point.y,b,g.getElevation).point,ge=ie(fe.last.point.x,fe.last.point.y,b,g.getElevation).point;if(d&&!h){const _e=de(t.writingMode,te,ge,I);if(_e)return _e}Y=[fe.first];for(let _e=t.glyphStartIndex+1;_e<ne-1;_e++)Y.push($e(D*T.getoffsetX(_e),V,H,h,t.segment,ae,ce,g,z));Y.push(fe.last)}else{if(d&&!h){const ae=ie(g.tileAnchorPoint.x,g.tileAnchorPoint.y,m,g.getElevation).point,ce=t.lineStartIndex+t.segment+1,fe=new c.P(g.lineVertexArray.getx(ce),g.lineVertexArray.gety(ce)),te=ie(fe.x,fe.y,m,g.getElevation),ge=te.signedDistanceFromCamera>0?te.point:function(we,Me,Oe,Xe,tt,Ze){return ye(we,Me,Oe,1,tt,Ze)}(g.tileAnchorPoint,fe,ae,0,m,g),_e=de(t.writingMode,ae,ge,I);if(_e)return _e}const ne=$e(D*T.getoffsetX(t.glyphStartIndex),V,H,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,g,z);if(!ne||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Y=[ne]}for(const ne of Y)c.aj(E,ne.point,ne.angle);return{}}function ye(g,t,a,h,d,m){const b=g.add(g.sub(t)._unit()),T=d!==void 0?ie(b.x,b.y,d,m.getElevation).point:Se(b.x,b.y,m).point,E=a.sub(T);return a.add(E._mult(h/E.mag()))}function ue(g,t,a){const h=t.projectionCache;if(h.projections[g])return h.projections[g];const d=new c.P(t.lineVertexArray.getx(g),t.lineVertexArray.gety(g)),m=Se(d.x,d.y,t);if(m.signedDistanceFromCamera>0)return h.projections[g]=m.point,h.anyProjectionOccluded=h.anyProjectionOccluded||m.isOccluded,m.point;const b=g-a.direction;return function(T,E,I,z,D){return ye(T,E,I,z,void 0,D)}(a.distanceFromAnchor===0?t.tileAnchorPoint:new c.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),d,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function Se(g,t,a){const h=g+a.translation[0],d=t+a.translation[1];let m;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(m=a.projection.projectTileCoordinates(h,d,a.unwrappedTileID,a.getElevation),m.point.x=(.5*m.point.x+.5)*a.width,m.point.y=(.5*-m.point.y+.5)*a.height):(m=ie(h,d,a.labelPlaneMatrix,a.getElevation),m.isOccluded=!1),m}function Ae(g,t,a){return g._unit()._perp()._mult(t*a)}function Ee(g,t,a,h,d,m,b,T,E){if(T.projectionCache.offsets[g])return T.projectionCache.offsets[g];const I=a.add(t);if(g+E.direction<h||g+E.direction>=d)return T.projectionCache.offsets[g]=I,I;const z=ue(g+E.direction,T,E),D=Ae(z.sub(a),b,E.direction),V=a.add(D),H=z.add(D);return T.projectionCache.offsets[g]=c.ak(m,I,V,H)||I,T.projectionCache.offsets[g]}function $e(g,t,a,h,d,m,b,T,E){const I=h?g-t:g+t;let z=I>0?1:-1,D=0;h&&(z*=-1,D=Math.PI),z<0&&(D+=Math.PI);let V,H=z>0?m+d:m+d+1;T.projectionCache.cachedAnchorPoint?V=T.projectionCache.cachedAnchorPoint:(V=Se(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=V);let Y,ne,ae=V,ce=V,fe=0,te=0;const ge=Math.abs(I),_e=[];let we;for(;fe+te<=ge;){if(H+=z,H<m||H>=b)return null;fe+=te,ce=ae,ne=Y;const Xe={absOffsetX:ge,direction:z,distanceFromAnchor:fe,previousVertex:ce};if(ae=ue(H,T,Xe),a===0)_e.push(ce),we=ae.sub(ce);else{let tt;const Ze=ae.sub(ce);tt=Ze.mag()===0?Ae(ue(H+z,T,Xe).sub(ae),a,z):Ae(Ze,a,z),ne||(ne=ce.add(tt)),Y=Ee(H,tt,ae,m,b,ne,a,T,Xe),_e.push(ne),we=Y.sub(ne)}te=we.mag()}const Me=we._mult((ge-fe)/te)._add(ne||ce),Oe=D+Math.atan2(ae.y-ce.y,ae.x-ce.x);return _e.push(Me),{point:Me,angle:E?Oe:0,path:_e}}const ft=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mt(g,t){for(let a=0;a<g;a++){const h=t.length;t.resize(h+4),t.float32.set(ft,3*h)}}function Ut(g,t,a){const h=t[0],d=t[1];return g[0]=a[0]*h+a[4]*d+a[12],g[1]=a[1]*h+a[5]*d+a[13],g[3]=a[3]*h+a[7]*d+a[15],g}const Pt=100;class qt{constructor(t,a,h=new ci(t.width+200,t.height+200,25),d=new ci(t.width+200,t.height+200,25)){this.transform=t,this.mapProjection=a,this.grid=h,this.ignoredGrid=d,this.pitchFactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Pt,this.screenBottomBoundary=t.height+Pt,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,h,d,m,b,T,E,I,z,D){const V=t.anchorPointX+E[0],H=t.anchorPointY+E[1],Y=this.projectAndGetPerspectiveRatio(d,V,H,m,z),ne=h*Y.perspectiveRatio;let ae;if(b||T)ae=this._projectCollisionBox(t,ne,d,m,b,T,E,Y,z,D);else{const _e=Y.point.x+(D?D.x*ne:0),we=Y.point.y+(D?D.y*ne:0);ae={allPointsOccluded:!1,box:[_e+t.x1*ne,we+t.y1*ne,_e+t.x2*ne,we+t.y2*ne]}}const[ce,fe,te,ge]=ae.box;return this.mapProjection.useSpecialProjectionForSymbols&&(b?ae.allPointsOccluded:this.mapProjection.isOccluded(V,H,m))||Y.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ce,fe,te,ge)||a!=="always"&&this.grid.hitTest(ce,fe,te,ge,a,I)?{box:[ce,fe,te,ge],placeable:!1,offscreen:!1}:{box:[ce,fe,te,ge],placeable:!0,offscreen:this.isOffscreen(ce,fe,te,ge)}}placeCollisionCircles(t,a,h,d,m,b,T,E,I,z,D,V,H,Y,ne,ae){const ce=[],fe=new c.P(a.anchorX,a.anchorY),te=this.getPerspectiveRatio(b,fe.x,fe.y,T,ae),ge=(D?m/te:m*te)/c.ap,_e={getElevation:ae,labelPlaneMatrix:E,lineVertexArray:h,pitchWithMap:D,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:fe,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:ne},we=J(ge,d,a.lineOffsetX*ge,a.lineOffsetY*ge,!1,a,!1,_e);let Me=!1,Oe=!1,Xe=!0;if(we){const tt=.5*H*te+Y,Ze=new c.P(-100,-100),Ue=new c.P(this.screenRightBoundary,this.screenBottomBoundary),lt=new kt,Et=we.first,Ge=we.last;let Je=[];for(let Dt=Et.path.length-1;Dt>=1;Dt--)Je.push(Et.path[Dt]);for(let Dt=1;Dt<Ge.path.length;Dt++)Je.push(Ge.path[Dt]);const St=2.5*tt;if(I){const Dt=this.projectPathToScreenSpace(Je,_e,I);Je=Dt.some(Nt=>Nt.signedDistanceFromCamera<=0)?[]:Dt.map(Nt=>Nt.point)}let cr=[];if(Je.length>0){const Dt=Je[0].clone(),Nt=Je[0].clone();for(let hr=1;hr<Je.length;hr++)Dt.x=Math.min(Dt.x,Je[hr].x),Dt.y=Math.min(Dt.y,Je[hr].y),Nt.x=Math.max(Nt.x,Je[hr].x),Nt.y=Math.max(Nt.y,Je[hr].y);cr=Dt.x>=Ze.x&&Nt.x<=Ue.x&&Dt.y>=Ze.y&&Nt.y<=Ue.y?[Je]:Nt.x<Ze.x||Dt.x>Ue.x||Nt.y<Ze.y||Dt.y>Ue.y?[]:c.al([Je],Ze.x,Ze.y,Ue.x,Ue.y)}for(const Dt of cr){lt.reset(Dt,.25*tt);let Nt=0;Nt=lt.length<=.5*tt?1:Math.ceil(lt.paddedLength/St)+1;for(let hr=0;hr<Nt;hr++){const ln=hr/Math.max(Nt-1,1),Fi=lt.lerp(ln),dr=Fi.x+Pt,zn=Fi.y+Pt;ce.push(dr,zn,tt,0);const xn=dr-tt,un=zn-tt,wn=dr+tt,rs=zn+tt;if(Xe=Xe&&this.isOffscreen(xn,un,wn,rs),Oe=Oe||this.isInsideGrid(xn,un,wn,rs),t!=="always"&&this.grid.hitTestCircle(dr,zn,tt,t,V)&&(Me=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Me}}}}return{circles:!z&&Me||!Oe||te<this.perspectiveRatioCutoff?[]:ce,offscreen:Xe,collisionDetected:Me}}projectPathToScreenSpace(t,a,h){return t.map(d=>ie(d.x,d.y,h,a.getElevation))}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let h=1/0,d=1/0,m=-1/0,b=-1/0;for(const z of t){const D=new c.P(z.x+Pt,z.y+Pt);h=Math.min(h,D.x),d=Math.min(d,D.y),m=Math.max(m,D.x),b=Math.max(b,D.y),a.push(D)}const T=this.grid.query(h,d,m,b).concat(this.ignoredGrid.query(h,d,m,b)),E={},I={};for(const z of T){const D=z.key;if(E[D.bucketInstanceId]===void 0&&(E[D.bucketInstanceId]={}),E[D.bucketInstanceId][D.featureIndex])continue;const V=[new c.P(z.x1,z.y1),new c.P(z.x2,z.y1),new c.P(z.x2,z.y2),new c.P(z.x1,z.y2)];c.am(a,V)&&(E[D.bucketInstanceId][D.featureIndex]=!0,I[D.bucketInstanceId]===void 0&&(I[D.bucketInstanceId]=[]),I[D.bucketInstanceId].push(D.featureIndex))}return I}insertCollisionBox(t,a,h,d,m,b){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:b,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,h,d,m,b){const T=h?this.ignoredGrid:this.grid,E={bucketInstanceId:d,featureIndex:m,collisionGroupID:b,overlapMode:a};for(let I=0;I<t.length;I+=4)T.insertCircle(E,t[I],t[I+1],t[I+2])}projectAndGetPerspectiveRatio(t,a,h,d,m){let b;m?(b=[a,h,m(a,h),1],c.af(b,b,t)):(b=[a,h,0,1],Ut(b,b,t));const T=b[3];return{point:new c.P((b[0]/T+1)/2*this.transform.width+Pt,(-b[1]/T+1)/2*this.transform.height+Pt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}getPerspectiveRatio(t,a,h,d,m){const b=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,h,d,m):ie(a,h,t,m);return .5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(t,a,h,d){return h<Pt||t>=this.screenRightBoundary||d<Pt||a>this.screenBottomBoundary}isInsideGrid(t,a,h,d){return h>=0&&t<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=c.an([]);return c.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,h,d,m,b,T,E,I,z){let D=new c.P(1,0),V=new c.P(0,1);const H=new c.P(t.anchorPointX+T[0],t.anchorPointY+T[1]);if(b&&!m){const Xe=this.projectAndGetPerspectiveRatio(h,H.x+1,H.y,d,I).point.sub(E.point).unit(),tt=Math.atan(Xe.y/Xe.x)+(Xe.x<0?Math.PI:0),Ze=Math.sin(tt),Ue=Math.cos(tt);D=new c.P(Ue,Ze),V=new c.P(-Ze,Ue)}else if(!b&&m){const Xe=-this.transform.angle,tt=Math.sin(Xe),Ze=Math.cos(Xe);D=new c.P(Ze,tt),V=new c.P(-tt,Ze)}let Y=E.point,ne=a;if(m){Y=H;const Xe=this.transform.zoom-Math.floor(this.transform.zoom);ne=Math.pow(2,-Xe),ne*=this.mapProjection.getPitchedTextCorrection(this.transform,H,d),z||(ne*=c.ac(.5+E.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}z&&(Y=Y.add(D.mult(z.x*ne)).add(V.mult(z.y*ne)));const ae=t.x1*ne,ce=t.x2*ne,fe=(ae+ce)/2,te=t.y1*ne,ge=t.y2*ne,_e=(te+ge)/2,we=[{offsetX:ae,offsetY:te},{offsetX:fe,offsetY:te},{offsetX:ce,offsetY:te},{offsetX:ce,offsetY:_e},{offsetX:ce,offsetY:ge},{offsetX:fe,offsetY:ge},{offsetX:ae,offsetY:ge},{offsetX:ae,offsetY:_e}];let Me=[];for(const{offsetX:Xe,offsetY:tt}of we)Me.push(new c.P(Y.x+D.x*Xe+V.x*tt,Y.y+D.y*Xe+V.y*tt));let Oe=!1;if(m){const Xe=Me.map(tt=>this.projectAndGetPerspectiveRatio(h,tt.x,tt.y,d,I));Oe=Xe.some(tt=>!tt.isOccluded),Me=Xe.map(tt=>tt.point)}else Oe=!0;return{box:c.ao(Me),allPointsOccluded:!Oe}}}function Bt(g,t,a){return t*(c.X/(g.tileSize*Math.pow(2,a-g.tileID.overscaledZ)))}class Dr{constructor(t,a,h,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):d&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class yr{constructor(t,a,h,d,m){this.text=new Dr(t?t.text:null,a,h,m),this.icon=new Dr(t?t.icon:null,a,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Lt{constructor(t,a,h){this.text=t,this.icon=a,this.skipFade=h}}class Qt{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class pr{constructor(t,a,h,d,m){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=h,this.bucketIndex=d,this.tileID=m}}class Ur{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:h=>h.collisionGroupID===a}}return this.collisionGroups[t]}}function Yr(g,t,a,h,d){const{horizontalAlign:m,verticalAlign:b}=c.au(g);return new c.P(-(m-.5)*t+h[0]*d,-(b-.5)*a+h[1]*d)}class vn{constructor(t,a,h,d,m,b){this.transform=t.clone(),this.terrain=h,this.collisionIndex=new qt(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Ur(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(h,d)=>a.getElevation(t,h,d):null}getBucketParts(t,a,h,d){const m=h.getBucket(a),b=h.latestFeatureIndex;if(!m||!b||a.id!==m.layerIds[0])return;const T=h.collisionBoxArray,E=m.layers[0].layout,I=m.layers[0].paint,z=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),D=h.tileSize/c.X,V=h.tileID.toUnwrapped(),H=this.transform.calculatePosMatrix(V),Y=E.get("text-pitch-alignment")==="map",ne=E.get("text-rotation-alignment")==="map",ae=Bt(h,1,this.transform.zoom),ce=this.collisionIndex.mapProjection.translatePosition(this.transform,h,I.get("text-translate"),I.get("text-translate-anchor")),fe=this.collisionIndex.mapProjection.translatePosition(this.transform,h,I.get("icon-translate"),I.get("icon-translate-anchor")),te=Ji(H,Y,ne,this.transform,ae);let ge=null;if(Y){const we=In(H,Y,ne,this.transform,ae);ge=c.L([],this.transform.labelPlaneMatrix,we)}this.retainedQueryData[m.bucketInstanceId]=new pr(m.bucketInstanceId,b,m.sourceLayerIndex,m.index,h.tileID);const _e={bucket:m,layout:E,translationText:ce,translationIcon:fe,posMatrix:H,unwrappedTileID:V,textLabelPlaneMatrix:te,labelToScreenMatrix:ge,scale:z,textPixelRatio:D,holdingForFade:h.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:c.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const we of m.sortKeyRanges){const{sortKey:Me,symbolInstanceStart:Oe,symbolInstanceEnd:Xe}=we;t.push({sortKey:Me,symbolInstanceStart:Oe,symbolInstanceEnd:Xe,parameters:_e})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:_e})}attemptAnchorPlacement(t,a,h,d,m,b,T,E,I,z,D,V,H,Y,ne,ae,ce,fe,te){const ge=c.aq[t.textAnchor],_e=[t.textOffset0,t.textOffset1],we=Yr(ge,h,d,_e,m),Me=this.collisionIndex.placeCollisionBox(a,V,E,I,z,T,b,ae,D.predicate,te,we);if((!fe||this.collisionIndex.placeCollisionBox(fe,V,E,I,z,T,b,ce,D.predicate,te,we).placeable)&&Me.placeable){let Oe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Oe=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:_e,width:h,height:d,anchor:ge,textBoxScale:m,prevAnchor:Oe},this.markUsedJustification(Y,ge,H,ne),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,ne,H),this.placedOrientations[H.crossTileID]=ne),{shift:we,placedGlyphBoxes:Me}}}placeLayerBucketPart(t,a,h){const{bucket:d,layout:m,translationText:b,translationIcon:T,posMatrix:E,unwrappedTileID:I,textLabelPlaneMatrix:z,labelToScreenMatrix:D,textPixelRatio:V,holdingForFade:H,collisionBoxArray:Y,partiallyEvaluatedTextSize:ne,collisionGroup:ae}=t.parameters,ce=m.get("text-optional"),fe=m.get("icon-optional"),te=c.ar(m,"text-overlap","text-allow-overlap"),ge=te==="always",_e=c.ar(m,"icon-overlap","icon-allow-overlap"),we=_e==="always",Me=m.get("text-rotation-alignment")==="map",Oe=m.get("text-pitch-alignment")==="map",Xe=m.get("icon-text-fit")!=="none",tt=m.get("symbol-z-order")==="viewport-y",Ze=ge&&(we||!d.hasIconData()||fe),Ue=we&&(ge||!d.hasTextData()||ce);!d.collisionArrays&&Y&&d.deserializeCollisionBoxes(Y);const lt=this._getTerrainElevationFunc(this.retainedQueryData[d.bucketInstanceId].tileID),Et=(Ge,Je,St)=>{var cr,Dt;if(a[Ge.crossTileID])return;if(H)return void(this.placements[Ge.crossTileID]=new Lt(!1,!1,!1));let Nt=!1,hr=!1,ln=!0,Fi=null,dr={box:null,placeable:!1,offscreen:null},zn={placeable:!1},xn=null,un=null,wn=null,rs=0,Qo=0,wu=0;Je.textFeatureIndex?rs=Je.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(rs=Ge.featureIndex),Je.verticalTextFeatureIndex&&(Qo=Je.verticalTextFeatureIndex);const ea=Je.textBox;if(ea){const gi=Jr=>{let cn=c.ah.horizontal;if(d.allowVerticalPlacement&&!Jr&&this.prevPlacement){const Yn=this.prevPlacement.placedOrientations[Ge.crossTileID];Yn&&(this.placedOrientations[Ge.crossTileID]=Yn,cn=Yn,this.markUsedOrientation(d,cn,Ge))}return cn},yi=(Jr,cn)=>{if(d.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&Je.verticalTextBox){for(const Yn of d.writingModes)if(Yn===c.ah.vertical?(dr=cn(),zn=dr):dr=Jr(),dr&&dr.placeable)break}else dr=Jr()},Ls=Ge.textAnchorOffsetStartIndex,Oi=Ge.textAnchorOffsetEndIndex;if(Oi===Ls){const Jr=(cn,Yn)=>{const $t=this.collisionIndex.placeCollisionBox(cn,te,V,E,I,Oe,Me,b,ae.predicate,lt);return $t&&$t.placeable&&(this.markUsedOrientation(d,Yn,Ge),this.placedOrientations[Ge.crossTileID]=Yn),$t};yi(()=>Jr(ea,c.ah.horizontal),()=>{const cn=Je.verticalTextBox;return d.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&cn?Jr(cn,c.ah.vertical):{box:null,offscreen:null}}),gi(dr&&dr.placeable)}else{let Jr=c.aq[(Dt=(cr=this.prevPlacement)===null||cr===void 0?void 0:cr.variableOffsets[Ge.crossTileID])===null||Dt===void 0?void 0:Dt.anchor];const cn=($t,ho,ta)=>{const ra=$t.x2-$t.x1,Ef=$t.y2-$t.y1,pg=Ge.textBoxScale,Cf=Xe&&_e==="never"?ho:null;let Fs=null,kf=te==="never"?1:2,Su="never";Jr&&kf++;for(let hl=0;hl<kf;hl++){for(let Tu=Ls;Tu<Oi;Tu++){const Eu=d.textAnchorOffsets.get(Tu);if(Jr&&Eu.textAnchor!==Jr)continue;const na=this.attemptAnchorPlacement(Eu,$t,ra,Ef,pg,Me,Oe,V,E,I,ae,Su,Ge,d,ta,b,T,Cf,lt);if(na&&(Fs=na.placedGlyphBoxes,Fs&&Fs.placeable))return Nt=!0,Fi=na.shift,Fs}Jr?Jr=null:Su=te}return h&&!Fs&&(Fs={box:this.collisionIndex.placeCollisionBox(ea,"always",V,E,I,Oe,Me,b,ae.predicate,lt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),Fs};yi(()=>cn(ea,Je.iconBox,c.ah.horizontal),()=>{const $t=Je.verticalTextBox;return d.allowVerticalPlacement&&(!dr||!dr.placeable)&&Ge.numVerticalGlyphVertices>0&&$t?cn($t,Je.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),dr&&(Nt=dr.placeable,ln=dr.offscreen);const Yn=gi(dr&&dr.placeable);if(!Nt&&this.prevPlacement){const $t=this.prevPlacement.variableOffsets[Ge.crossTileID];$t&&(this.variableOffsets[Ge.crossTileID]=$t,this.markUsedJustification(d,$t.anchor,Ge,Yn))}}}if(xn=dr,Nt=xn&&xn.placeable,ln=xn&&xn.offscreen,Ge.useRuntimeCollisionCircles){const gi=d.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex),yi=c.ai(d.textSizeData,ne,gi),Ls=m.get("text-padding");un=this.collisionIndex.placeCollisionCircles(te,gi,d.lineVertexArray,d.glyphOffsetArray,yi,E,I,z,D,h,Oe,ae.predicate,Ge.collisionCircleDiameter,Ls,b,lt),un.circles.length&&un.collisionDetected&&!h&&c.w("Collisions detected, but collision boxes are not shown"),Nt=ge||un.circles.length>0&&!un.collisionDetected,ln=ln&&un.offscreen}if(Je.iconFeatureIndex&&(wu=Je.iconFeatureIndex),Je.iconBox){const gi=yi=>this.collisionIndex.placeCollisionBox(yi,_e,V,E,I,Oe,Me,T,ae.predicate,lt,Xe&&Fi?Fi:void 0);zn&&zn.placeable&&Je.verticalIconBox?(wn=gi(Je.verticalIconBox),hr=wn.placeable):(wn=gi(Je.iconBox),hr=wn.placeable),ln=ln&&wn.offscreen}const mi=ce||Ge.numHorizontalGlyphVertices===0&&Ge.numVerticalGlyphVertices===0,bu=fe||Ge.numIconVertices===0;mi||bu?bu?mi||(hr=hr&&Nt):Nt=hr&&Nt:hr=Nt=hr&&Nt;const vh=hr&&wn.placeable;if(Nt&&xn.placeable&&this.collisionIndex.insertCollisionBox(xn.box,te,m.get("text-ignore-placement"),d.bucketInstanceId,zn&&zn.placeable&&Qo?Qo:rs,ae.ID),vh&&this.collisionIndex.insertCollisionBox(wn.box,_e,m.get("icon-ignore-placement"),d.bucketInstanceId,wu,ae.ID),un&&Nt&&this.collisionIndex.insertCollisionCircles(un.circles,te,m.get("text-ignore-placement"),d.bucketInstanceId,rs,ae.ID),h&&this.storeCollisionData(d.bucketInstanceId,St,Je,xn,wn,un),Ge.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ge.crossTileID]=new Lt(Nt||Ze,hr||Ue,ln||d.justReloaded),a[Ge.crossTileID]=!0};if(tt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ge=d.getSortedSymbolIndexes(this.transform.angle);for(let Je=Ge.length-1;Je>=0;--Je){const St=Ge[Je];Et(d.symbolInstances.get(St),d.collisionArrays[St],St)}}else for(let Ge=t.symbolInstanceStart;Ge<t.symbolInstanceEnd;Ge++)Et(d.symbolInstances.get(Ge),d.collisionArrays[Ge],Ge);if(h&&d.bucketInstanceId in this.collisionCircleArrays){const Ge=this.collisionCircleArrays[d.bucketInstanceId];c.as(Ge.invProjMatrix,E),Ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}storeCollisionData(t,a,h,d,m,b){if(h.textBox||h.iconBox){let T,E;this.collisionBoxArrays.has(t)?T=this.collisionBoxArrays.get(t):(T=new Map,this.collisionBoxArrays.set(t,T)),T.has(a)?E=T.get(a):(E={text:null,icon:null},T.set(a,E)),h.textBox&&(E.text=d.box),h.iconBox&&(E.icon=m.box)}if(b){let T=this.collisionCircleArrays[t];T===void 0&&(T=this.collisionCircleArrays[t]=new Qt);for(let E=0;E<b.circles.length;E+=4)T.circles.push(b.circles[E+0]),T.circles.push(b.circles[E+1]),T.circles.push(b.circles[E+2]),T.circles.push(b.collisionDetected?1:0)}}markUsedJustification(t,a,h,d){let m;m=d===c.ah.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[c.at(a)];const b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const T of b)T>=0&&(t.text.placedSymbolArray.get(T).crossTileID=m>=0&&T!==m?0:h.crossTileID)}markUsedOrientation(t,a,h){const d=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,m=a===c.ah.vertical?a:0,b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const T of b)t.text.placedSymbolArray.get(T).placedOrientation=d;h.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let h=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(t):1,m=a?a.opacities:{},b=a?a.variableOffsets:{},T=a?a.placedOrientations:{};for(const E in this.placements){const I=this.placements[E],z=m[E];z?(this.opacities[E]=new yr(z,d,I.text,I.icon),h=h||I.text!==z.text.placed||I.icon!==z.icon.placed):(this.opacities[E]=new yr(null,d,I.text,I.icon,I.skipFade),h=h||I.text||I.icon)}for(const E in m){const I=m[E];if(!this.opacities[E]){const z=new yr(I,d,!1,!1);z.isHidden()||(this.opacities[E]=z,h=h||I.text.placed||I.icon.placed)}}for(const E in b)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=b[E]);for(const E in T)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=T[E]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const h={};for(const d of a){const m=d.getBucket(t);m&&d.latestFeatureIndex&&t.id===m.layerIds[0]&&this.updateBucketOpacities(m,d.tileID,h,d.collisionBoxArray)}}updateBucketOpacities(t,a,h,d){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const m=t.layers[0],b=m.layout,T=new yr(null,0,!1,!1,!0),E=b.get("text-allow-overlap"),I=b.get("icon-allow-overlap"),z=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=b.get("text-rotation-alignment")==="map",V=b.get("text-pitch-alignment")==="map",H=b.get("icon-text-fit")!=="none",Y=new yr(null,0,E&&(I||!t.hasIconData()||b.get("icon-optional")),I&&(E||!t.hasTextData()||b.get("text-optional")),!0);!t.collisionArrays&&d&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(d);const ne=(ce,fe,te)=>{for(let ge=0;ge<fe/4;ge++)ce.opacityVertexArray.emplaceBack(te);ce.hasVisibleVertices=ce.hasVisibleVertices||te!==Do},ae=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ce=0;ce<t.symbolInstances.length;ce++){const fe=t.symbolInstances.get(ce),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:ge,crossTileID:_e}=fe;let we=this.opacities[_e];h[_e]?we=T:we||(we=Y,this.opacities[_e]=we),h[_e]=!0;const Me=fe.numIconVertices>0,Oe=this.placedOrientations[fe.crossTileID],Xe=Oe===c.ah.vertical,tt=Oe===c.ah.horizontal||Oe===c.ah.horizontalOnly;if(te>0||ge>0){const Ue=Wn(we.text);ne(t.text,te,Xe?Do:Ue),ne(t.text,ge,tt?Do:Ue);const lt=we.text.isHidden();[fe.rightJustifiedTextSymbolIndex,fe.centerJustifiedTextSymbolIndex,fe.leftJustifiedTextSymbolIndex].forEach(Je=>{Je>=0&&(t.text.placedSymbolArray.get(Je).hidden=lt||Xe?1:0)}),fe.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(fe.verticalPlacedTextSymbolIndex).hidden=lt||tt?1:0);const Et=this.variableOffsets[fe.crossTileID];Et&&this.markUsedJustification(t,Et.anchor,fe,Oe);const Ge=this.placedOrientations[fe.crossTileID];Ge&&(this.markUsedJustification(t,"left",fe,Ge),this.markUsedOrientation(t,Ge,fe))}if(Me){const Ue=Wn(we.icon),lt=!(H&&fe.verticalPlacedIconSymbolIndex&&Xe);fe.placedIconSymbolIndex>=0&&(ne(t.icon,fe.numIconVertices,lt?Ue:Do),t.icon.placedSymbolArray.get(fe.placedIconSymbolIndex).hidden=we.icon.isHidden()),fe.verticalPlacedIconSymbolIndex>=0&&(ne(t.icon,fe.numVerticalIconVertices,lt?Do:Ue),t.icon.placedSymbolArray.get(fe.verticalPlacedIconSymbolIndex).hidden=we.icon.isHidden())}const Ze=ae&&ae.has(ce)?ae.get(ce):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ue=t.collisionArrays[ce];if(Ue){let lt=new c.P(0,0);if(Ue.textBox||Ue.verticalTextBox){let Et=!0;if(z){const Ge=this.variableOffsets[_e];Ge?(lt=Yr(Ge.anchor,Ge.width,Ge.height,Ge.textOffset,Ge.textBoxScale),D&&lt._rotate(V?this.transform.angle:-this.transform.angle)):Et=!1}if(Ue.textBox||Ue.verticalTextBox){let Ge;Ue.textBox&&(Ge=Xe),Ue.verticalTextBox&&(Ge=tt),zo(t.textCollisionBox.collisionVertexArray,we.text.placed,!Et||Ge,Ze.text,lt.x,lt.y)}}if(Ue.iconBox||Ue.verticalIconBox){const Et=!!(!tt&&Ue.verticalIconBox);let Ge;Ue.iconBox&&(Ge=Et),Ue.verticalIconBox&&(Ge=!Et),zo(t.iconCollisionBox.collisionVertexArray,we.icon.placed,Ge,Ze.icon,H?lt.x:0,H?lt.y:0)}}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ce.invProjMatrix,t.placementViewportMatrix=ce.viewportMatrix,t.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const h=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*h>t}setStale(){this.stale=!0}}function zo(g,t,a,h,d,m){h&&h.length!==0||(h=[0,0,0,0]);const b=h[0]-Pt,T=h[1]-Pt,E=h[2]-Pt,I=h[3]-Pt;g.emplaceBack(t?1:0,a?1:0,d||0,m||0,b,T),g.emplaceBack(t?1:0,a?1:0,d||0,m||0,E,T),g.emplaceBack(t?1:0,a?1:0,d||0,m||0,E,I),g.emplaceBack(t?1:0,a?1:0,d||0,m||0,b,I)}const er=Math.pow(2,25),Ac=Math.pow(2,24),Mc=Math.pow(2,17),Hn=Math.pow(2,16),Gn=Math.pow(2,9),$m=Math.pow(2,8),hi=Math.pow(2,1);function Wn(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const t=g.placed?1:0,a=Math.floor(127*g.opacity);return a*er+t*Ac+a*Mc+t*Hn+a*Gn+t*$m+a*hi+t}const Do=0;function Qs(){return{isOccluded:(g,t,a)=>!1,getPitchedTextCorrection:(g,t,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,t,a,h){throw new Error("Not implemented.")},translatePosition:(g,t,a,h)=>function(d,m,b,T,E=!1){if(!b[0]&&!b[1])return[0,0];const I=E?T==="map"?d.angle:0:T==="viewport"?-d.angle:0;if(I){const z=Math.sin(I),D=Math.cos(I);b=[b[0]*D-b[1]*z,b[0]*z+b[1]*D]}return[E?b[0]:Bt(m,b[0],d.zoom),E?b[1]:Bt(m,b[1],d.zoom)]}(g,t,a,h),getCircleRadiusCorrection:g=>1}}class Rr{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,h,d,m){const b=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(b,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((T,E)=>T.sortKey-E.sortKey));this._currentPartIndex<b.length;)if(a.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,m())return!0;return!1}}class Ha{constructor(t,a,h,d,m,b,T,E){this.placement=new vn(t,Qs(),a,b,T,E),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(t,a,h){const d=R.now(),m=()=>!this._forceFullPlacement&&R.now()-d>2;for(;this._currentPlacementIndex>=0;){const b=a[t[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=T)&&(!b.maxzoom||b.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Rr(b)),this._inProgressLayer.continuePlacement(h[b.source],this.placement,this._showCollisionBoxes,b,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Mi=512/c.X/2;class kr{constructor(t,a,h){this.tileID=t,this.bucketInstanceId=h,this._symbolsByKey={};const d=new Map;for(let m=0;m<a.length;m++){const b=a.get(m),T=b.key,E=d.get(T);E?E.push(b):d.set(T,[b])}for(const[m,b]of d){const T={positions:b.map(E=>({x:Math.floor(E.anchorX*Mi),y:Math.floor(E.anchorY*Mi)})),crossTileIDs:b.map(E=>E.crossTileID)};if(T.positions.length>128){const E=new c.av(T.positions.length,16,Uint16Array);for(const{x:I,y:z}of T.positions)E.add(I,z);E.finish(),delete T.positions,T.index=E}this._symbolsByKey[m]=T}}getScaledCoordinates(t,a){const{x:h,y:d,z:m}=this.tileID.canonical,{x:b,y:T,z:E}=a.canonical,I=Mi/Math.pow(2,E-m),z=(T*c.X+t.anchorY)*I,D=d*c.X*Mi;return{x:Math.floor((b*c.X+t.anchorX)*I-h*c.X*Mi),y:Math.floor(z-D)}}findMatches(t,a,h){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let m=0;m<t.length;m++){const b=t.get(m);if(b.crossTileID)continue;const T=this._symbolsByKey[b.key];if(!T)continue;const E=this.getScaledCoordinates(b,a);if(T.index){const I=T.index.range(E.x-d,E.y-d,E.x+d,E.y+d).sort();for(const z of I){const D=T.crossTileIDs[z];if(!h[D]){h[D]=!0,b.crossTileID=D;break}}}else if(T.positions)for(let I=0;I<T.positions.length;I++){const z=T.positions[I],D=T.crossTileIDs[I];if(Math.abs(z.x-E.x)<=d&&Math.abs(z.y-E.y)<=d&&!h[D]){h[D]=!0,b.crossTileID=D;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class ql{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class zi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const h in this.indexes){const d=this.indexes[h],m={};for(const b in d){const T=d[b];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+a),m[T.tileID.key]=T}this.indexes[h]=m}this.lng=t}addBucket(t,a,h){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let m=0;m<a.symbolInstances.length;m++)a.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const m in this.indexes){const b=this.indexes[m];if(Number(m)>t.overscaledZ)for(const T in b){const E=b[T];E.tileID.isChildOf(t)&&E.findMatches(a.symbolInstances,t,d)}else{const T=b[t.scaledTo(Number(m)).key];T&&T.findMatches(a.symbolInstances,t,d)}}for(let m=0;m<a.symbolInstances.length;m++){const b=a.symbolInstances.get(m);b.crossTileID||(b.crossTileID=h.generate(),d[b.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new kr(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const h of a.getCrossTileIDsLists())for(const d of h)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let a=!1;for(const h in this.indexes){const d=this.indexes[h];for(const m in d)t[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,d[m]),delete d[m],a=!0)}return a}}class zc{constructor(){this.layerIndexes={},this.crossTileIDs=new ql,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,h){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new zi);let m=!1;const b={};d.handleWrapJump(h);for(const T of a){const E=T.getBucket(t);E&&t.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(T.tileID,E,this.crossTileIDs)&&(m=!0),b[E.bucketInstanceId]=!0)}return d.removeStaleBuckets(b)&&(m=!0),m}pruneUnusedLayers(t){const a={};t.forEach(h=>{a[h]=!0});for(const h in this.layerIndexes)a[h]||delete this.layerIndexes[h]}}const Di=(g,t)=>c.t(g,t&&t.filter(a=>a.identifier!=="source.canvas")),Um=c.aw();class Zl extends c.E{constructor(t,a={}){super(),this._rtlPluginLoaded=()=>{for(const h in this.sourceCaches){const d=this.sourceCaches[h].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[h].reload()}},this.map=t,this.dispatcher=new _n(sn(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(h,d)=>this.getGlyphs(h,d)),this.dispatcher.registerMessageHandler("GI",(h,d)=>this.getImages(h,d)),this.imageManager=new xt,this.imageManager.setEventedParent(this),this.glyphManager=new wt(t._requestManager,a.localIdeographFontFamily),this.lineAtlas=new Mt(256,512),this.crossTileSymbolIndex=new zc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),ui().on(Ne,this._rtlPluginLoaded),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const m=d.getSource();if(m&&m.vectorLayerIds)for(const b in this._layers){const T=this._layers[b];T.source===m.id&&this._validateLayer(T)}})}loadURL(t,a={},h){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;c.h(d,this._loadStyleRequest).then(b=>{this._loadStyleRequest=null,this._load(b.data,a,h)}).catch(b=>{this._loadStyleRequest=null,b&&!m.signal.aborted&&this.fire(new c.j(b))})}loadJSON(t,a={},h){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,R.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,h)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Um,{validate:!1})}_load(t,a,h){var d;const m=a.transformStyle?a.transformStyle(h,t):t;if(!a.validate||!Di(this,c.u(m))){this._loaded=!0,this.stylesheet=m;for(const b in m.sources)this.addSource(b,m.sources[b],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new et(this.stylesheet.light),this.sky=new dt(this.stylesheet.sky),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const t=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of t){const h=c.aA(a);h.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=h}}_loadSprite(t,a=!1,h=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,b,T,E){return c._(this,void 0,void 0,function*(){const I=st(m),z=T>1?"@2x":"",D={},V={};for(const{id:H,url:Y}of I){const ne=b.transformRequest(Be(Y,z,".json"),"SpriteJSON");D[H]=c.h(ne,E);const ae=b.transformRequest(Be(Y,z,".png"),"SpriteImage");V[H]=K.getImage(ae,E)}return yield Promise.all([...Object.values(D),...Object.values(V)]),function(H,Y){return c._(this,void 0,void 0,function*(){const ne={};for(const ae in H){ne[ae]={};const ce=R.getImageCanvasContext((yield Y[ae]).data),fe=(yield H[ae]).data;for(const te in fe){const{width:ge,height:_e,x:we,y:Me,sdf:Oe,pixelRatio:Xe,stretchX:tt,stretchY:Ze,content:Ue,textFitWidth:lt,textFitHeight:Et}=fe[te];ne[ae][te]={data:null,pixelRatio:Xe,sdf:Oe,stretchX:tt,stretchY:Ze,content:Ue,textFitWidth:lt,textFitHeight:Et,spriteData:{width:ge,height:_e,x:we,y:Me,context:ce}}}}return ne})}(D,V)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const b in m){this._spritesImagesIds[b]=[];const T=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(E=>!(E in m)):[];for(const E of T)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in m[b]){const I=b==="default"?E:`${b}:${E}`;this._spritesImagesIds[b].push(I),I in this.imageManager.images?this.imageManager.updateImage(I,m[b][E],!1):this.imageManager.addImage(I,m[b][E]),a&&(this._changedImages[I]=!0)}}}).catch(m=>{this._spriteRequest=null,d=m,this.fire(new c.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),h&&h(d)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(t){const a=this.sourceCaches[t.source];if(!a)return;const h=t.sourceLayer;if(!h)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(h)===-1)&&this.fire(new c.j(new Error(`Source layer "${h}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const h=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?c.aB(h):h);const d=[];for(const m of t)if(h[m]){const b=a?c.aB(h[m]):h[m];d.push(b)}return d}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const h of a){const d=this._layers[h];d.type!=="custom"&&(t[h]=d.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const b in this._updatedSources){const T=this._updatedSources[b];if(T==="reload")this._reloadSource(b);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const h={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];h[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in h){const m=this.sourceCaches[d];!!h[d]!=!!m.used&&m.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.sky.recalculate(t),this.z=t.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var h;this._checkLoaded();const d=this.serialize();if(t=a.transformStyle?a.transformStyle(d,t):t,((h=a.validate)===null||h===void 0||h)&&Di(this,c.u(t)))return!1;(t=c.aB(t)).layers=c.az(t.layers);const m=c.aC(d,t),b=this._getOperationsToPerform(m);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const T of b.operations)T();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const a=[],h=[];for(const d of t)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":a.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":a.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,d.args));break;case"setSky":a.push(()=>this.setSky.apply(this,d.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setTransition":a.push(()=>{});break;default:h.push(d.command)}return{operations:a,unimplemented:h}}addImage(t,a){if(this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,h={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.u.source,`sources.${t}`,a,null,h))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.sourceCaches[t]=new vt(t,a,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t})),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===t)return this.fire(new c.j(new Error(`Source "${t}" cannot be removed while layer "${h}" is using it.`)));const a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const h=this.sourceCaches[t].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(a),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,a,h={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new c.j(new Error(`Layer "${d}" already exists on this map.`)));let m;if(t.type==="custom"){if(Di(this,c.aD(t)))return;m=c.aA(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=c.aB(t),t=c.e(t,{source:d})),this._validate(c.u.layer,`layers.${d}`,t,{arrayIndex:-1},h))return;m=c.aA(t),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const b=a?this._order.indexOf(a):this._order.length;if(a&&b===-1)this.fire(new c.j(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(b,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const T=this._removedLayers[d];delete this._removedLayers[d],T.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const h=this._order.indexOf(t);this._order.splice(h,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new c.j(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const h=this._order.indexOf(t);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,h){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===a&&d.maxzoom===h||(a!=null&&(d.minzoom=a),h!=null&&(d.maxzoom=h),this._updateLayer(d)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,h={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!c.aE(d.filter,a))return a==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(c.u.filter,`layers.${d.id}.filter`,a,null,h)||(d.filter=c.aB(a),this._updateLayer(d)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.aB(this.getLayer(t).filter)}setLayoutProperty(t,a,h,d={}){this._checkLoaded();const m=this.getLayer(t);m?c.aE(m.getLayoutProperty(a),h)||(m.setLayoutProperty(a,h,d),this._updateLayer(m)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const h=this.getLayer(t);if(h)return h.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,h,d={}){this._checkLoaded();const m=this.getLayer(t);m?c.aE(m.getPaintProperty(a),h)||(m.setPaintProperty(a,h,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const h=t.source,d=t.sourceLayer,m=this.sourceCaches[h];if(m===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const b=m.getSource().type;b==="geojson"&&d?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||d?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,t.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const h=t.source,d=this.sourceCaches[h];if(d===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const m=d.getSource().type,b=m==="vector"?t.sourceLayer:void 0;m!=="vector"||b?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(b,t.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,h=t.sourceLayer,d=this.sourceCaches[a];if(d!==void 0)return d.getSource().type!=="vector"||h?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(h,t.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.aF(this.sourceCaches,m=>m.serialize()),a=this._serializeByIds(this._order,!0),h=this.map.getTerrain()||void 0,d=this.stylesheet;return c.aG({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:t,layers:a,terrain:h},m=>m!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=b=>this._layers[b].type==="fill-extrusion",h={},d=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(a(T)){h[T]=b;for(const E of t){const I=E[T];if(I)for(const z of I)d.push(z)}}}d.sort((b,T)=>T.intersectionZ-b.intersectionZ);const m=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(a(T))for(let E=d.length-1;E>=0;E--){const I=d[E].feature;if(h[I.layer.id]<b)break;m.push(I),d.pop()}else for(const E of t){const I=E[T];if(I)for(const z of I)m.push(z.feature)}}return m}queryRenderedFeatures(t,a,h){a&&a.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const T of a.layers){const E=this._layers[T];if(!E)return this.fire(new c.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];d[E.source]=!0}}const m=[];a.availableImages=this._availableImages;const b=this._serializedAllLayers();for(const T in this.sourceCaches)a.layers&&!d[T]||m.push(Xr(this.sourceCaches[T],this._layers,b,t,a,h));return this.placement&&m.push(function(T,E,I,z,D,V,H){const Y={},ne=V.queryRenderedSymbols(z),ae=[];for(const ce of Object.keys(ne).map(Number))ae.push(H[ce]);ae.sort(Un);for(const ce of ae){const fe=ce.featureIndex.lookupSymbolFeatures(ne[ce.bucketInstanceId],E,ce.bucketIndex,ce.sourceLayerIndex,D.filter,D.layers,D.availableImages,T);for(const te in fe){const ge=Y[te]=Y[te]||[],_e=fe[te];_e.sort((we,Me)=>{const Oe=ce.featureSortOrder;if(Oe){const Xe=Oe.indexOf(we.featureIndex);return Oe.indexOf(Me.featureIndex)-Xe}return Me.featureIndex-we.featureIndex});for(const we of _e)ge.push(we)}}for(const ce in Y)Y[ce].forEach(fe=>{const te=fe.feature,ge=I[T[ce].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=ge});return Y}(this._layers,b,this.sourceCaches,t,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(t,a){a&&a.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",a.filter,null,a);const h=this.sourceCaches[t];return h?function(d,m){const b=d.getRenderableIds().map(I=>d.getTileByID(I)),T=[],E={};for(let I=0;I<b.length;I++){const z=b[I],D=z.tileID.canonical.key;E[D]||(E[D]=!0,z.querySourceFeatures(T,m))}return T}(h,a):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const h=this.light.getLight();let d=!1;for(const b in t)if(!c.aE(t[b],h[b])){d=!0;break}if(!d)return;const m={now:R.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(m)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){const h=this.getSky();let d=!1;if(!t&&!h)return;if(t&&!h)d=!0;else if(!t&&h)d=!0;else for(const b in t)if(!c.aE(t[b],h[b])){d=!0;break}if(!d)return;const m={now:R.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(m)}_validate(t,a,h,d,m={}){return(!m||m.validate!==!1)&&Di(this,t.call(c.u,c.e({key:a,style:this.serialize(),value:h,styleSpec:c.v},d)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ui().off(Ne,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const h=this.sourceCaches[a];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const a in this.sourceCaches)this.sourceCaches[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,a,h,d,m=!1){let b=!1,T=!1;const E={};for(const I of this._order){const z=this._layers[I];if(z.type!=="symbol")continue;if(!E[z.source]){const V=this.sourceCaches[z.source];E[z.source]=V.getRenderableIds(!0).map(H=>V.getTileByID(H)).sort((H,Y)=>Y.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(Y.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(z,E[z.source],t.center.lng);b=b||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(R.now(),t.zoom))&&(this.pauseablePlacement=new Ha(t,this.map.terrain,this._order,m,a,h,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(R.now()),T=!0),b&&this.pauseablePlacement.placement.setStale()),T||b)for(const I of this._order){const z=this._layers[I];z.type==="symbol"&&this.placement.updateLayerOpacities(z,E[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(R.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,a){return c._(this,void 0,void 0,function*(){const h=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),h})}getGlyphs(t,a){return c._(this,void 0,void 0,function*(){const h=yield this.glyphManager.getGlyphs(a.stacks),d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),h})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(c.u.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,a,h={},d){this._checkLoaded();const m=[{id:t,url:a}],b=[...st(this.stylesheet.sprite),...m];this._validate(c.u.sprite,"sprite",b,null,h)||(this.stylesheet.sprite=b,this._loadSprite(m,!0,d))}removeSprite(t){this._checkLoaded();const a=st(this.stylesheet.sprite);if(a.find(h=>h.id===t)){if(this._spritesImagesIds[t])for(const h of this._spritesImagesIds[t])this.imageManager.removeImage(h),this._changedImages[h]=!0;a.splice(a.findIndex(h=>h.id===t),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return st(this.stylesheet.sprite)}setSprite(t,a={},h){this._checkLoaded(),t&&this._validate(c.u.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,h):(this._unloadSprite(),h&&h(null)))}}var eo=c.Y([{name:"a_pos",type:"Int16",components:2}]);const Ds={prelude:Wt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Wt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Wt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Wt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Wt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Wt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Wt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Wt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Wt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Wt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Wt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Wt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Wt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Wt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Wt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Wt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Wt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Wt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Wt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Wt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Wt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Wt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Wt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Wt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Wt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Wt(g,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=t.match(/attribute ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=m?m.concat(d):d,T={};return{fragmentSource:g=g.replace(a,(E,I,z,D,V)=>(T[V]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${V}
varying ${z} ${D} ${V};
#else
uniform ${z} ${D} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${z} ${D} ${V} = u_${V};
#endif
`)),vertexSource:t=t.replace(a,(E,I,z,D,V)=>{const H=D==="float"?"vec2":"vec4",Y=V.match(/color/)?"color":H;return T[V]?I==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${z} ${H} a_${V};
varying ${z} ${D} ${V};
#else
uniform ${z} ${D} u_${V};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${z} ${D} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${Y}(a_${V}, u_${V}_t);
#else
    ${z} ${D} ${V} = u_${V};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${z} ${H} a_${V};
#else
uniform ${z} ${D} u_${V};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${z} ${D} ${V} = a_${V};
#else
    ${z} ${D} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${z} ${D} ${V} = unpack_mix_${Y}(a_${V}, u_${V}_t);
#else
    ${z} ${D} ${V} = u_${V};
#endif
`}),staticAttributes:h,staticUniforms:b}}class Dc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,h,d,m,b,T,E,I){this.context=t;let z=this.boundPaintVertexBuffers.length!==d.length;for(let D=0;!z&&D<d.length;D++)this.boundPaintVertexBuffers[D]!==d[D]&&(z=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==h||z||this.boundIndexBuffer!==m||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==I?this.freshBind(a,h,d,m,b,T,E,I):(t.bindVertexArray.set(this.vao),T&&T.bind(),m&&m.dynamicDraw&&m.bind(),E&&E.bind(),I&&I.bind())}freshBind(t,a,h,d,m,b,T,E){const I=t.numAttributes,z=this.context,D=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=E,a.enableAttributes(D,t);for(const V of h)V.enableAttributes(D,t);b&&b.enableAttributes(D,t),T&&T.enableAttributes(D,t),E&&E.enableAttributes(D,t),a.bind(),a.setVertexAttribPointers(D,t,m);for(const V of h)V.bind(),V.setVertexAttribPointers(D,t,m);b&&(b.bind(),b.setVertexAttribPointers(D,t,m)),d&&d.bind(),T&&(T.bind(),T.setVertexAttribPointers(D,t,m)),E&&(E.bind(),E.setVertexAttribPointers(D,t,m)),z.currentNumAttributes=I}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Rc=(g,t,a,h,d)=>({u_matrix:g,u_texture:0,u_ele_delta:t,u_fog_matrix:a,u_fog_color:h?h.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:h?h.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?h.calculateFogBlendOpacity(d):0,u_horizon_color:h?h.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:h?h.properties.get("horizon-fog-blend"):1});function Ro(g){const t=[];for(let a=0;a<g.length;a++){if(g[a]===null)continue;const h=g[a].split(" ");t.push(h.pop())}return t}class Lc{constructor(t,a,h,d,m,b){const T=t.gl;this.program=T.createProgram();const E=Ro(a.staticAttributes),I=h?h.getBinderAttributes():[],z=E.concat(I),D=Ds.prelude.staticUniforms?Ro(Ds.prelude.staticUniforms):[],V=a.staticUniforms?Ro(a.staticUniforms):[],H=h?h.getBinderUniforms():[],Y=D.concat(V).concat(H),ne=[];for(const we of Y)ne.indexOf(we)<0&&ne.push(we);const ae=h?h.defines():[];m&&ae.push("#define OVERDRAW_INSPECTOR;"),b&&ae.push("#define TERRAIN3D;");const ce=ae.concat(Ds.prelude.fragmentSource,a.fragmentSource).join(`
`),fe=ae.concat(Ds.prelude.vertexSource,a.vertexSource).join(`
`),te=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(te,ce),T.compileShader(te),!T.getShaderParameter(te,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(te)}`);T.attachShader(this.program,te);const ge=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ge,fe),T.compileShader(ge),!T.getShaderParameter(ge,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(ge)}`);T.attachShader(this.program,ge),this.attributes={};const _e={};this.numAttributes=z.length;for(let we=0;we<this.numAttributes;we++)z[we]&&(T.bindAttribLocation(this.program,we,z[we]),this.attributes[z[we]]=we);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(ge),T.deleteShader(te);for(let we=0;we<ne.length;we++){const Me=ne[we];if(Me&&!_e[Me]){const Oe=T.getUniformLocation(this.program,Me);Oe&&(_e[Me]=Oe)}}this.fixedUniforms=d(t,_e),this.terrainUniforms=((we,Me)=>({u_depth:new c.aH(we,Me.u_depth),u_terrain:new c.aH(we,Me.u_terrain),u_terrain_dim:new c.aI(we,Me.u_terrain_dim),u_terrain_matrix:new c.aJ(we,Me.u_terrain_matrix),u_terrain_unpack:new c.aK(we,Me.u_terrain_unpack),u_terrain_exaggeration:new c.aI(we,Me.u_terrain_exaggeration)}))(t,_e),this.binderUniforms=h?h.getUniforms(t,_e):[]}draw(t,a,h,d,m,b,T,E,I,z,D,V,H,Y,ne,ae,ce,fe){const te=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(h),t.setStencilMode(d),t.setColorMode(m),t.setCullFace(b),E){t.activeTexture.set(te.TEXTURE2),te.bindTexture(te.TEXTURE_2D,E.depthTexture),t.activeTexture.set(te.TEXTURE3),te.bindTexture(te.TEXTURE_2D,E.texture);for(const _e in this.terrainUniforms)this.terrainUniforms[_e].set(E[_e])}for(const _e in this.fixedUniforms)this.fixedUniforms[_e].set(T[_e]);ne&&ne.setUniforms(t,this.binderUniforms,H,{zoom:Y});let ge=0;switch(a){case te.LINES:ge=2;break;case te.TRIANGLES:ge=3;break;case te.LINE_STRIP:ge=1}for(const _e of V.get()){const we=_e.vaos||(_e.vaos={});(we[I]||(we[I]=new Dc)).bind(t,this,z,ne?ne.getPaintVertexBuffers():[],D,_e.vertexOffset,ae,ce,fe),te.drawElements(a,_e.primitiveLength*ge,te.UNSIGNED_SHORT,_e.primitiveOffset*ge*2)}}}function Hl(g,t,a){const h=1/Bt(a,1,t.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),m=a.tileSize*Math.pow(2,t.transform.tileZoom)/d,b=m*(a.tileID.canonical.x+a.tileID.wrap*d),T=m*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[h,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[b>>16,T>>16],u_pixel_coord_lower:[65535&b,65535&T]}}const Ga=(g,t,a,h)=>{const d=t.style.light,m=d.properties.get("position"),b=[m.x,m.y,m.z],T=function(){var I=new c.A(9);return c.A!=Float32Array&&(I[1]=0,I[2]=0,I[3]=0,I[5]=0,I[6]=0,I[7]=0),I[0]=1,I[4]=1,I[8]=1,I}();d.properties.get("anchor")==="viewport"&&function(I,z){var D=Math.sin(z),V=Math.cos(z);I[0]=V,I[1]=D,I[2]=0,I[3]=-D,I[4]=V,I[5]=0,I[6]=0,I[7]=0,I[8]=1}(T,-t.transform.angle),function(I,z,D){var V=z[0],H=z[1],Y=z[2];I[0]=V*D[0]+H*D[3]+Y*D[6],I[1]=V*D[1]+H*D[4]+Y*D[7],I[2]=V*D[2]+H*D[5]+Y*D[8]}(b,b,T);const E=d.properties.get("color");return{u_matrix:g,u_lightpos:b,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+a,u_opacity:h}},Gl=(g,t,a,h,d,m,b)=>c.e(Ga(g,t,a,h),Hl(m,t,b),{u_height_factor:-Math.pow(2,d.overscaledZ)/b.tileSize/8}),Lo=g=>({u_matrix:g}),Zd=(g,t,a,h)=>c.e(Lo(g),Hl(a,t,h)),qm=(g,t)=>({u_matrix:g,u_world:t}),Hd=(g,t,a,h,d)=>c.e(Zd(g,t,a,h),{u_world:d}),Zm=(g,t,a,h)=>{const d=g.transform;let m,b;if(h.paint.get("circle-pitch-alignment")==="map"){const T=Bt(a,1,d.zoom);m=!0,b=[T,T]}else m=!1,b=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(h.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(t.posMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:b}},to=(g,t,a)=>({u_matrix:g,u_inv_matrix:t,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),Wa=(g,t,a=1)=>({u_matrix:g,u_color:t,u_overlay:0,u_overlay_scale:a}),An=g=>({u_matrix:g}),Mn=(g,t,a,h)=>({u_matrix:g,u_extrude_scale:Bt(t,1,a),u_intensity:h}),Wl=(g,t,a,h)=>{const d=c.H();c.aP(d,0,g.width,g.height,0,0,1);const m=g.context.gl;return{u_matrix:d,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:a,u_color_ramp:h,u_opacity:t.paint.get("heatmap-opacity")}};function Xl(g,t){const a=Math.pow(2,t.canonical.z),h=t.canonical.y;return[new c.Z(0,h/a).toLngLat().lat,new c.Z(0,(h+1)/a).toLngLat().lat]}const Kl=(g,t,a,h)=>{const d=g.transform;return{u_matrix:Xd(g,t,a,h),u_ratio:1/Bt(t,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Gd=(g,t,a,h,d)=>c.e(Kl(g,t,a,d),{u_image:0,u_image_height:h}),Fo=(g,t,a,h,d)=>{const m=g.transform,b=Wd(t,m);return{u_matrix:Xd(g,t,a,d),u_texsize:t.imageAtlasTexture.size,u_ratio:1/Bt(t,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[b,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Hm=(g,t,a,h,d,m)=>{const b=g.lineAtlas,T=Wd(t,g.transform),E=a.layout.get("line-cap")==="round",I=b.getDash(h.from,E),z=b.getDash(h.to,E),D=I.width*d.fromScale,V=z.width*d.toScale;return c.e(Kl(g,t,a,m),{u_patternscale_a:[T/D,-I.height/2],u_patternscale_b:[T/V,-z.height/2],u_sdfgamma:b.width/(256*Math.min(D,V)*g.pixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:z.y,u_mix:d.t})};function Wd(g,t){return 1/Bt(g,1,t.tileZoom)}function Xd(g,t,a,h){return g.translatePosMatrix(h?h.posMatrix:t.tileID.posMatrix,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Gm=(g,t,a,h,d)=>{return{u_matrix:g,u_tl_parent:t,u_scale_parent:a,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(b=d.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Wm(d.paint.get("raster-hue-rotate"))};var m,b};function Wm(g){g*=Math.PI/180;const t=Math.sin(g),a=Math.cos(g);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const Kd=(g,t,a,h,d,m,b,T,E,I,z,D,V,H)=>{const Y=b.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Y.width/Y.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:E,u_coord_matrix:I,u_is_text:+D,u_pitch_with_map:+h,u_is_along_line:d,u_is_variable_anchor:m,u_texsize:V,u_texture:0,u_translation:z,u_pitched_scale:H}},Xa=(g,t,a,h,d,m,b,T,E,I,z,D,V,H,Y)=>{const ne=b.transform;return c.e(Kd(g,t,a,h,d,m,b,T,E,I,z,D,V,Y),{u_gamma_scale:h?Math.cos(ne._pitch)*ne.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},Fc=(g,t,a,h,d,m,b,T,E,I,z,D,V,H)=>c.e(Xa(g,t,a,h,d,m,b,T,E,I,z,!0,D,!0,H),{u_texsize_icon:V,u_texture_icon:1}),Yl=(g,t,a)=>({u_matrix:g,u_opacity:t,u_color:a}),Oc=(g,t,a,h,d,m)=>c.e(function(b,T,E,I){const z=E.imageManager.getPattern(b.from.toString()),D=E.imageManager.getPattern(b.to.toString()),{width:V,height:H}=E.imageManager.getPixelSize(),Y=Math.pow(2,I.tileID.overscaledZ),ne=I.tileSize*Math.pow(2,E.transform.tileZoom)/Y,ae=ne*(I.tileID.canonical.x+I.tileID.wrap*Y),ce=ne*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:D.tl,u_pattern_br_b:D.br,u_texsize:[V,H],u_mix:T.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:D.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/Bt(I,1,E.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ce>>16],u_pixel_coord_lower:[65535&ae,65535&ce]}}(h,m,a,d),{u_matrix:g,u_opacity:t}),Bc={fillExtrusion:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_lightpos:new c.aN(g,t.u_lightpos),u_lightintensity:new c.aI(g,t.u_lightintensity),u_lightcolor:new c.aN(g,t.u_lightcolor),u_vertical_gradient:new c.aI(g,t.u_vertical_gradient),u_opacity:new c.aI(g,t.u_opacity)}),fillExtrusionPattern:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_lightpos:new c.aN(g,t.u_lightpos),u_lightintensity:new c.aI(g,t.u_lightintensity),u_lightcolor:new c.aN(g,t.u_lightcolor),u_vertical_gradient:new c.aI(g,t.u_vertical_gradient),u_height_factor:new c.aI(g,t.u_height_factor),u_image:new c.aH(g,t.u_image),u_texsize:new c.aO(g,t.u_texsize),u_pixel_coord_upper:new c.aO(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,t.u_pixel_coord_lower),u_scale:new c.aN(g,t.u_scale),u_fade:new c.aI(g,t.u_fade),u_opacity:new c.aI(g,t.u_opacity)}),fill:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix)}),fillPattern:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_image:new c.aH(g,t.u_image),u_texsize:new c.aO(g,t.u_texsize),u_pixel_coord_upper:new c.aO(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,t.u_pixel_coord_lower),u_scale:new c.aN(g,t.u_scale),u_fade:new c.aI(g,t.u_fade)}),fillOutline:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_world:new c.aO(g,t.u_world)}),fillOutlinePattern:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_world:new c.aO(g,t.u_world),u_image:new c.aH(g,t.u_image),u_texsize:new c.aO(g,t.u_texsize),u_pixel_coord_upper:new c.aO(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,t.u_pixel_coord_lower),u_scale:new c.aN(g,t.u_scale),u_fade:new c.aI(g,t.u_fade)}),circle:(g,t)=>({u_camera_to_center_distance:new c.aI(g,t.u_camera_to_center_distance),u_scale_with_map:new c.aH(g,t.u_scale_with_map),u_pitch_with_map:new c.aH(g,t.u_pitch_with_map),u_extrude_scale:new c.aO(g,t.u_extrude_scale),u_device_pixel_ratio:new c.aI(g,t.u_device_pixel_ratio),u_matrix:new c.aJ(g,t.u_matrix)}),collisionBox:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_pixel_extrude_scale:new c.aO(g,t.u_pixel_extrude_scale)}),collisionCircle:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_inv_matrix:new c.aJ(g,t.u_inv_matrix),u_camera_to_center_distance:new c.aI(g,t.u_camera_to_center_distance),u_viewport_size:new c.aO(g,t.u_viewport_size)}),debug:(g,t)=>({u_color:new c.aL(g,t.u_color),u_matrix:new c.aJ(g,t.u_matrix),u_overlay:new c.aH(g,t.u_overlay),u_overlay_scale:new c.aI(g,t.u_overlay_scale)}),clippingMask:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix)}),heatmap:(g,t)=>({u_extrude_scale:new c.aI(g,t.u_extrude_scale),u_intensity:new c.aI(g,t.u_intensity),u_matrix:new c.aJ(g,t.u_matrix)}),heatmapTexture:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_world:new c.aO(g,t.u_world),u_image:new c.aH(g,t.u_image),u_color_ramp:new c.aH(g,t.u_color_ramp),u_opacity:new c.aI(g,t.u_opacity)}),hillshade:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_image:new c.aH(g,t.u_image),u_latrange:new c.aO(g,t.u_latrange),u_light:new c.aO(g,t.u_light),u_shadow:new c.aL(g,t.u_shadow),u_highlight:new c.aL(g,t.u_highlight),u_accent:new c.aL(g,t.u_accent)}),hillshadePrepare:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_image:new c.aH(g,t.u_image),u_dimension:new c.aO(g,t.u_dimension),u_zoom:new c.aI(g,t.u_zoom),u_unpack:new c.aK(g,t.u_unpack)}),line:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_ratio:new c.aI(g,t.u_ratio),u_device_pixel_ratio:new c.aI(g,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,t.u_units_to_pixels)}),lineGradient:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_ratio:new c.aI(g,t.u_ratio),u_device_pixel_ratio:new c.aI(g,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,t.u_units_to_pixels),u_image:new c.aH(g,t.u_image),u_image_height:new c.aI(g,t.u_image_height)}),linePattern:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_texsize:new c.aO(g,t.u_texsize),u_ratio:new c.aI(g,t.u_ratio),u_device_pixel_ratio:new c.aI(g,t.u_device_pixel_ratio),u_image:new c.aH(g,t.u_image),u_units_to_pixels:new c.aO(g,t.u_units_to_pixels),u_scale:new c.aN(g,t.u_scale),u_fade:new c.aI(g,t.u_fade)}),lineSDF:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_ratio:new c.aI(g,t.u_ratio),u_device_pixel_ratio:new c.aI(g,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,t.u_units_to_pixels),u_patternscale_a:new c.aO(g,t.u_patternscale_a),u_patternscale_b:new c.aO(g,t.u_patternscale_b),u_sdfgamma:new c.aI(g,t.u_sdfgamma),u_image:new c.aH(g,t.u_image),u_tex_y_a:new c.aI(g,t.u_tex_y_a),u_tex_y_b:new c.aI(g,t.u_tex_y_b),u_mix:new c.aI(g,t.u_mix)}),raster:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_tl_parent:new c.aO(g,t.u_tl_parent),u_scale_parent:new c.aI(g,t.u_scale_parent),u_buffer_scale:new c.aI(g,t.u_buffer_scale),u_fade_t:new c.aI(g,t.u_fade_t),u_opacity:new c.aI(g,t.u_opacity),u_image0:new c.aH(g,t.u_image0),u_image1:new c.aH(g,t.u_image1),u_brightness_low:new c.aI(g,t.u_brightness_low),u_brightness_high:new c.aI(g,t.u_brightness_high),u_saturation_factor:new c.aI(g,t.u_saturation_factor),u_contrast_factor:new c.aI(g,t.u_contrast_factor),u_spin_weights:new c.aN(g,t.u_spin_weights)}),symbolIcon:(g,t)=>({u_is_size_zoom_constant:new c.aH(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,t.u_is_size_feature_constant),u_size_t:new c.aI(g,t.u_size_t),u_size:new c.aI(g,t.u_size),u_camera_to_center_distance:new c.aI(g,t.u_camera_to_center_distance),u_pitch:new c.aI(g,t.u_pitch),u_rotate_symbol:new c.aH(g,t.u_rotate_symbol),u_aspect_ratio:new c.aI(g,t.u_aspect_ratio),u_fade_change:new c.aI(g,t.u_fade_change),u_matrix:new c.aJ(g,t.u_matrix),u_label_plane_matrix:new c.aJ(g,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,t.u_coord_matrix),u_is_text:new c.aH(g,t.u_is_text),u_pitch_with_map:new c.aH(g,t.u_pitch_with_map),u_is_along_line:new c.aH(g,t.u_is_along_line),u_is_variable_anchor:new c.aH(g,t.u_is_variable_anchor),u_texsize:new c.aO(g,t.u_texsize),u_texture:new c.aH(g,t.u_texture),u_translation:new c.aO(g,t.u_translation),u_pitched_scale:new c.aI(g,t.u_pitched_scale)}),symbolSDF:(g,t)=>({u_is_size_zoom_constant:new c.aH(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,t.u_is_size_feature_constant),u_size_t:new c.aI(g,t.u_size_t),u_size:new c.aI(g,t.u_size),u_camera_to_center_distance:new c.aI(g,t.u_camera_to_center_distance),u_pitch:new c.aI(g,t.u_pitch),u_rotate_symbol:new c.aH(g,t.u_rotate_symbol),u_aspect_ratio:new c.aI(g,t.u_aspect_ratio),u_fade_change:new c.aI(g,t.u_fade_change),u_matrix:new c.aJ(g,t.u_matrix),u_label_plane_matrix:new c.aJ(g,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,t.u_coord_matrix),u_is_text:new c.aH(g,t.u_is_text),u_pitch_with_map:new c.aH(g,t.u_pitch_with_map),u_is_along_line:new c.aH(g,t.u_is_along_line),u_is_variable_anchor:new c.aH(g,t.u_is_variable_anchor),u_texsize:new c.aO(g,t.u_texsize),u_texture:new c.aH(g,t.u_texture),u_gamma_scale:new c.aI(g,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,t.u_device_pixel_ratio),u_is_halo:new c.aH(g,t.u_is_halo),u_translation:new c.aO(g,t.u_translation),u_pitched_scale:new c.aI(g,t.u_pitched_scale)}),symbolTextAndIcon:(g,t)=>({u_is_size_zoom_constant:new c.aH(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,t.u_is_size_feature_constant),u_size_t:new c.aI(g,t.u_size_t),u_size:new c.aI(g,t.u_size),u_camera_to_center_distance:new c.aI(g,t.u_camera_to_center_distance),u_pitch:new c.aI(g,t.u_pitch),u_rotate_symbol:new c.aH(g,t.u_rotate_symbol),u_aspect_ratio:new c.aI(g,t.u_aspect_ratio),u_fade_change:new c.aI(g,t.u_fade_change),u_matrix:new c.aJ(g,t.u_matrix),u_label_plane_matrix:new c.aJ(g,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,t.u_coord_matrix),u_is_text:new c.aH(g,t.u_is_text),u_pitch_with_map:new c.aH(g,t.u_pitch_with_map),u_is_along_line:new c.aH(g,t.u_is_along_line),u_is_variable_anchor:new c.aH(g,t.u_is_variable_anchor),u_texsize:new c.aO(g,t.u_texsize),u_texsize_icon:new c.aO(g,t.u_texsize_icon),u_texture:new c.aH(g,t.u_texture),u_texture_icon:new c.aH(g,t.u_texture_icon),u_gamma_scale:new c.aI(g,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,t.u_device_pixel_ratio),u_is_halo:new c.aH(g,t.u_is_halo),u_translation:new c.aO(g,t.u_translation),u_pitched_scale:new c.aI(g,t.u_pitched_scale)}),background:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_opacity:new c.aI(g,t.u_opacity),u_color:new c.aL(g,t.u_color)}),backgroundPattern:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_opacity:new c.aI(g,t.u_opacity),u_image:new c.aH(g,t.u_image),u_pattern_tl_a:new c.aO(g,t.u_pattern_tl_a),u_pattern_br_a:new c.aO(g,t.u_pattern_br_a),u_pattern_tl_b:new c.aO(g,t.u_pattern_tl_b),u_pattern_br_b:new c.aO(g,t.u_pattern_br_b),u_texsize:new c.aO(g,t.u_texsize),u_mix:new c.aI(g,t.u_mix),u_pattern_size_a:new c.aO(g,t.u_pattern_size_a),u_pattern_size_b:new c.aO(g,t.u_pattern_size_b),u_scale_a:new c.aI(g,t.u_scale_a),u_scale_b:new c.aI(g,t.u_scale_b),u_pixel_coord_upper:new c.aO(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(g,t.u_tile_units_to_pixels)}),terrain:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_texture:new c.aH(g,t.u_texture),u_ele_delta:new c.aI(g,t.u_ele_delta),u_fog_matrix:new c.aJ(g,t.u_fog_matrix),u_fog_color:new c.aL(g,t.u_fog_color),u_fog_ground_blend:new c.aI(g,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(g,t.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(g,t.u_horizon_color),u_horizon_fog_blend:new c.aI(g,t.u_horizon_fog_blend)}),terrainDepth:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_ele_delta:new c.aI(g,t.u_ele_delta)}),terrainCoords:(g,t)=>({u_matrix:new c.aJ(g,t.u_matrix),u_texture:new c.aH(g,t.u_texture),u_terrain_coords_id:new c.aI(g,t.u_terrain_coords_id),u_ele_delta:new c.aI(g,t.u_ele_delta)}),sky:(g,t)=>({u_sky_color:new c.aL(g,t.u_sky_color),u_horizon_color:new c.aL(g,t.u_horizon_color),u_horizon:new c.aI(g,t.u_horizon),u_sky_horizon_blend:new c.aI(g,t.u_sky_horizon_blend)})};class Qi{constructor(t,a,h){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xm={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Nc{constructor(t,a,h,d){this.length=a.length,this.attributes=h,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=t;const m=t.gl;this.buffer=m.createBuffer(),t.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let h=0;h<this.attributes.length;h++){const d=a.attributes[this.attributes[h].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,a,h){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],b=a.attributes[m.name];b!==void 0&&t.vertexAttribPointer(b,m.components,t[Xm[m.type]],!1,this.itemSize,m.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ro=new WeakMap;function Rs(g){var t;if(ro.has(g))return ro.get(g);{const a=(t=g.getParameter(g.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return ro.set(g,a),a}}class Kt{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Jl extends Kt{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Km extends Kt{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Oo extends Kt{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ym extends Kt{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Yd extends Kt{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Jm extends Kt{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Jd extends Kt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class jc extends Kt{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Qd extends Kt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class ef extends Kt{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class tf extends Kt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class rf extends Kt{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class no extends Kt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class nf extends Kt{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Qm extends Kt{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class sf extends Kt{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Ka extends Kt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class eg extends Kt{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Ql extends Kt{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class tg extends Kt{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class rg extends Kt{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class of extends Kt{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class af extends Kt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class lf extends Kt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Vc extends Kt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class uf extends Kt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class eu extends Kt{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ds extends Kt{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const h=this.gl;Rs(h)?h.bindVertexArray(t):(a=h.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class $c extends Kt{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Uc extends Kt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class qc extends Kt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class tu extends Kt{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class Zc extends tu{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class io extends tu{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Hc extends tu{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ng{constructor(t,a,h,d,m){this.context=t,this.width=a,this.height=h;const b=t.gl,T=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new Zc(t,T),d)this.depthAttachment=m?new Hc(t,T):new io(t,T);else if(m)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const h=this.depthAttachment.get();h&&t.deleteRenderbuffer(h)}t.deleteFramebuffer(this.framebuffer)}}class br{constructor(t,a,h){this.blendFunction=t,this.blendColor=a,this.mask=h}}br.Replace=[1,0],br.disabled=new br(br.Replace,c.aM.transparent,[!1,!1,!1,!1]),br.unblended=new br(br.Replace,c.aM.transparent,[!0,!0,!0,!0]),br.alphaBlended=new br([1,771],c.aM.transparent,[!0,!0,!0,!0]);class ig{constructor(t){var a,h;if(this.gl=t,this.clearColor=new Jl(this),this.clearDepth=new Km(this),this.clearStencil=new Oo(this),this.colorMask=new Ym(this),this.depthMask=new Yd(this),this.stencilMask=new Jm(this),this.stencilFunc=new Jd(this),this.stencilOp=new jc(this),this.stencilTest=new Qd(this),this.depthRange=new ef(this),this.depthTest=new tf(this),this.depthFunc=new rf(this),this.blend=new no(this),this.blendFunc=new nf(this),this.blendColor=new Qm(this),this.blendEquation=new sf(this),this.cullFace=new Ka(this),this.cullFaceSide=new eg(this),this.frontFace=new Ql(this),this.program=new tg(this),this.activeTexture=new rg(this),this.viewport=new of(this),this.bindFramebuffer=new af(this),this.bindRenderbuffer=new lf(this),this.bindTexture=new Vc(this),this.bindVertexBuffer=new uf(this),this.bindElementBuffer=new eu(this),this.bindVertexArray=new ds(this),this.pixelStoreUnpack=new $c(this),this.pixelStoreUnpackPremultiplyAlpha=new Uc(this),this.pixelStoreUnpackFlipY=new qc(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Rs(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(h=t.RGB16F)!==null&&h!==void 0?h:d==null?void 0:d.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new Qi(this,t,a)}createVertexBuffer(t,a,h){return new Nc(this,t,a,h)}createRenderbuffer(t,a,h){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,t,a,h),this.bindRenderbuffer.set(null),m}createFramebuffer(t,a,h,d){return new ng(this,t,a,h,d)}clear({color:t,depth:a,stencil:h}){const d=this.gl;let m=0;t&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),h!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),d.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.aE(t.blendFunction,br.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Rs(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return Rs(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Ft{constructor(t,a,h){this.func=t,this.mask=a,this.range=h}}Ft.ReadOnly=!1,Ft.ReadWrite=!0,Ft.disabled=new Ft(519,Ft.ReadOnly,[0,1]);const ru=7680;class sr{constructor(t,a,h,d,m,b){this.test=t,this.ref=a,this.mask=h,this.fail=d,this.depthFail=m,this.pass=b}}sr.disabled=new sr({func:519,mask:0},0,0,ru,ru,ru);class tr{constructor(t,a,h){this.enable=t,this.mode=a,this.frontFace=h}}let so;function Ya(g,t,a,h,d){const m=g.context,b=m.gl,T=g.useProgram("collisionBox"),E=[];let I=0,z=0;for(let ce=0;ce<h.length;ce++){const fe=h[ce],te=t.getTile(fe).getBucket(a);if(!te)continue;const ge=d?te.textCollisionBox:te.iconCollisionBox,_e=te.collisionCircleArray;if(_e.length>0){const we=c.H();c.aQ(we,te.placementInvProjMatrix,g.transform.glCoordMatrix),c.aQ(we,we,te.placementViewportMatrix),E.push({circleArray:_e,circleOffset:z,transform:fe.posMatrix,invTransform:we,coord:fe}),I+=_e.length/4,z=I}ge&&T.draw(m,b.LINES,Ft.disabled,sr.disabled,g.colorModeForRenderPass(),tr.disabled,{u_matrix:fe.posMatrix,u_pixel_extrude_scale:[1/(D=g.transform).width,1/D.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(fe),a.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,g.transform.zoom,null,null,ge.collisionVertexBuffer)}var D;if(!d||!E.length)return;const V=g.useProgram("collisionCircle"),H=new c.aR;H.resize(4*I),H._trim();let Y=0;for(const ce of E)for(let fe=0;fe<ce.circleArray.length/4;fe++){const te=4*fe,ge=ce.circleArray[te+0],_e=ce.circleArray[te+1],we=ce.circleArray[te+2],Me=ce.circleArray[te+3];H.emplace(Y++,ge,_e,we,Me,0),H.emplace(Y++,ge,_e,we,Me,1),H.emplace(Y++,ge,_e,we,Me,2),H.emplace(Y++,ge,_e,we,Me,3)}(!so||so.length<2*I)&&(so=function(ce){const fe=2*ce,te=new c.aT;te.resize(fe),te._trim();for(let ge=0;ge<fe;ge++){const _e=6*ge;te.uint16[_e+0]=4*ge+0,te.uint16[_e+1]=4*ge+1,te.uint16[_e+2]=4*ge+2,te.uint16[_e+3]=4*ge+2,te.uint16[_e+4]=4*ge+3,te.uint16[_e+5]=4*ge+0}return te}(I));const ne=m.createIndexBuffer(so,!0),ae=m.createVertexBuffer(H,c.aS.members,!0);for(const ce of E){const fe=to(ce.transform,ce.invTransform,g.transform);V.draw(m,b.TRIANGLES,Ft.disabled,sr.disabled,g.colorModeForRenderPass(),tr.disabled,fe,g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce.coord),a.id,ae,ne,c.a0.simpleSegment(0,2*ce.circleOffset,ce.circleArray.length,ce.circleArray.length/2),null,g.transform.zoom,null,null,null)}ae.destroy(),ne.destroy()}tr.disabled=new tr(!1,1029,2305),tr.backCCW=new tr(!0,1029,2305);const Ja=c.an(new Float32Array(16));function Gc(g,t,a,h,d,m){const{horizontalAlign:b,verticalAlign:T}=c.au(g);return new c.P((-(b-.5)*t/d+h[0])*m,(-(T-.5)*a/d+h[1])*m)}function oo(g,t,a,h,d,m){const b=t.tileAnchorPoint.add(new c.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let T=h.mult(m);a||(T=T.rotate(-d));const E=b.add(T);return ie(E.x,E.y,t.labelPlaneMatrix,t.getElevation).point}if(a){const T=Se(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(g),E=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return g.add(h.rotate(E))}return g.add(h)}function Bo(g,t,a,h,d,m,b,T,E,I,z,D,V,H){const Y=g.text.placedSymbolArray,ne=g.text.dynamicLayoutVertexArray,ae=g.icon.dynamicLayoutVertexArray,ce={};ne.clear();for(let fe=0;fe<Y.length;fe++){const te=Y.get(fe),ge=te.hidden||!te.crossTileID||g.allowVerticalPlacement&&!te.placedOrientation?null:h[te.crossTileID];if(ge){const _e=new c.P(te.anchorX,te.anchorY),we={getElevation:H,width:d.width,height:d.height,labelPlaneMatrix:m,pitchWithMap:a,projection:z,tileAnchorPoint:_e,translation:D,unwrappedTileID:V},Me=a?ie(_e.x,_e.y,b,H):Se(_e.x,_e.y,we),Oe=N(d.cameraToCenterDistance,Me.signedDistanceFromCamera);let Xe=c.ai(g.textSizeData,E,te)*Oe/c.ap;a&&(Xe*=g.tilePixelRatio/T);const{width:tt,height:Ze,anchor:Ue,textOffset:lt,textBoxScale:Et}=ge,Ge=Gc(Ue,tt,Ze,lt,Et,Xe),Je=z.getPitchedTextCorrection(d,_e.add(new c.P(D[0],D[1])),V),St=oo(Me.point,we,t,Ge,d.angle,Je),cr=g.allowVerticalPlacement&&te.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let Dt=0;Dt<te.numGlyphs;Dt++)c.aj(ne,St,cr);I&&te.associatedIconIndex>=0&&(ce[te.associatedIconIndex]={shiftedAnchor:St,angle:cr})}else mt(te.numGlyphs,ne)}if(I){ae.clear();const fe=g.icon.placedSymbolArray;for(let te=0;te<fe.length;te++){const ge=fe.get(te);if(ge.hidden)mt(ge.numGlyphs,ae);else{const _e=ce[te];if(_e)for(let we=0;we<ge.numGlyphs;we++)c.aj(ae,_e.shiftedAnchor,_e.angle);else mt(ge.numGlyphs,ae)}}g.icon.dynamicLayoutVertexBuffer.updateData(ae)}g.text.dynamicLayoutVertexBuffer.updateData(ne)}function di(g,t,a){return a.iconsInText&&t?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Wc(g,t,a,h,d,m,b,T,E,I,z,D){const V=g.context,H=V.gl,Y=g.transform,ne=Qs(),ae=T==="map",ce=E==="map",fe=T!=="viewport"&&a.layout.get("symbol-placement")!=="point",te=ae&&!ce&&!fe,ge=!ce&&fe,_e=!a.layout.get("symbol-sort-key").isConstant();let we=!1;const Me=g.depthModeForSublayer(0,Ft.ReadOnly),Oe=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Xe=[],tt=ne.getCircleRadiusCorrection(Y);for(const Ze of h){const Ue=t.getTile(Ze),lt=Ue.getBucket(a);if(!lt)continue;const Et=d?lt.text:lt.icon;if(!Et||!Et.segments.get().length||!Et.hasVisibleVertices)continue;const Ge=Et.programConfigurations.get(a.id),Je=d||lt.sdfIcons,St=d?lt.textSizeData:lt.iconSizeData,cr=ce||Y.pitch!==0,Dt=g.useProgram(di(Je,d,lt),Ge),Nt=c.ag(St,Y.zoom),hr=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ze);let ln,Fi,dr,zn,xn=[0,0],un=null;if(d)Fi=Ue.glyphAtlasTexture,dr=H.LINEAR,ln=Ue.glyphAtlasTexture.size,lt.iconsInText&&(xn=Ue.imageAtlasTexture.size,un=Ue.imageAtlasTexture,zn=cr||g.options.rotating||g.options.zooming||St.kind==="composite"||St.kind==="camera"?H.LINEAR:H.NEAREST);else{const $t=a.layout.get("icon-size").constantOr(0)!==1||lt.iconsNeedLinear;Fi=Ue.imageAtlasTexture,dr=Je||g.options.rotating||g.options.zooming||$t||cr?H.LINEAR:H.NEAREST,ln=Ue.imageAtlasTexture.size}const wn=Bt(Ue,1,g.transform.zoom),rs=ge?Ze.posMatrix:Ja,Qo=Ji(rs,ce,ae,g.transform,wn),wu=In(rs,ce,ae,g.transform,wn),ea=In(Ze.posMatrix,ce,ae,g.transform,wn),mi=ne.translatePosition(g.transform,Ue,m,b),bu=Oe&&lt.hasTextData(),vh=a.layout.get("icon-text-fit")!=="none"&&bu&&lt.hasIconData();if(fe){const $t=g.style.map.terrain?(ta,ra)=>g.style.map.terrain.getElevation(Ze,ta,ra):null,ho=a.layout.get("text-rotation-alignment")==="map";q(lt,Ze.posMatrix,g,d,Qo,ea,ce,I,ho,ne,Ze.toUnwrapped(),Y.width,Y.height,mi,$t)}const gi=Ze.posMatrix,yi=d&&Oe||vh,Ls=fe||yi?Ja:Qo,Oi=wu,Jr=Je&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let cn;cn=Je?lt.iconsInText?Fc(St.kind,Nt,te,ce,fe,yi,g,gi,Ls,Oi,mi,ln,xn,tt):Xa(St.kind,Nt,te,ce,fe,yi,g,gi,Ls,Oi,mi,d,ln,!0,tt):Kd(St.kind,Nt,te,ce,fe,yi,g,gi,Ls,Oi,mi,d,ln,tt);const Yn={program:Dt,buffers:Et,uniformValues:cn,atlasTexture:Fi,atlasTextureIcon:un,atlasInterpolation:dr,atlasInterpolationIcon:zn,isSDF:Je,hasHalo:Jr};if(_e&&lt.canOverlap){we=!0;const $t=Et.segments.get();for(const ho of $t)Xe.push({segments:new c.a0([ho]),sortKey:ho.sortKey,state:Yn,terrainData:hr})}else Xe.push({segments:Et.segments,sortKey:0,state:Yn,terrainData:hr})}we&&Xe.sort((Ze,Ue)=>Ze.sortKey-Ue.sortKey);for(const Ze of Xe){const Ue=Ze.state;if(V.activeTexture.set(H.TEXTURE0),Ue.atlasTexture.bind(Ue.atlasInterpolation,H.CLAMP_TO_EDGE),Ue.atlasTextureIcon&&(V.activeTexture.set(H.TEXTURE1),Ue.atlasTextureIcon&&Ue.atlasTextureIcon.bind(Ue.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),Ue.isSDF){const lt=Ue.uniformValues;Ue.hasHalo&&(lt.u_is_halo=1,Xc(Ue.buffers,Ze.segments,a,g,Ue.program,Me,z,D,lt,Ze.terrainData)),lt.u_is_halo=0}Xc(Ue.buffers,Ze.segments,a,g,Ue.program,Me,z,D,Ue.uniformValues,Ze.terrainData)}}function Xc(g,t,a,h,d,m,b,T,E,I){const z=h.context;d.draw(z,z.gl.TRIANGLES,m,b,T,tr.disabled,E,I,a.id,g.layoutVertexBuffer,g.indexBuffer,t,a.paint,h.transform.zoom,g.programConfigurations.get(a.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Kc(g,t,a,h){const d=g.context,m=d.gl,b=sr.disabled,T=new br([m.ONE,m.ONE],c.aM.transparent,[!0,!0,!0,!0]),E=t.getBucket(a);if(!E)return;const I=h.key;let z=a.heatmapFbos.get(I);z||(z=Qa(d,t.tileSize,t.tileSize),a.heatmapFbos.set(I,z)),d.bindFramebuffer.set(z.framebuffer),d.viewport.set([0,0,t.tileSize,t.tileSize]),d.clear({color:c.aM.transparent});const D=E.programConfigurations.get(a.id),V=g.useProgram("heatmap",D),H=g.style.map.terrain.getTerrainData(h);V.draw(d,m.TRIANGLES,Ft.disabled,b,T,tr.disabled,Mn(h.posMatrix,t,g.transform.zoom,a.paint.get("heatmap-intensity")),H,a.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,a.paint,g.transform.zoom,D)}function ao(g,t,a){const h=g.context,d=h.gl;h.setColorMode(g.colorModeForRenderPass());const m=el(h,t),b=a.key,T=t.heatmapFbos.get(b);T&&(h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,T.colorAttachment.get()),h.activeTexture.set(d.TEXTURE1),m.bind(d.LINEAR,d.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(h,d.TRIANGLES,Ft.disabled,sr.disabled,g.colorModeForRenderPass(),tr.disabled,Wl(g,t,0,1),null,t.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,t.paint,g.transform.zoom),T.destroy(),t.heatmapFbos.delete(b))}function Qa(g,t,a){var h,d;const m=g.gl,b=m.createTexture();m.bindTexture(m.TEXTURE_2D,b),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const T=(h=g.HALF_FLOAT)!==null&&h!==void 0?h:m.UNSIGNED_BYTE,E=(d=g.RGBA16F)!==null&&d!==void 0?d:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,E,t,a,0,m.RGBA,T,null);const I=g.createFramebuffer(t,a,!1,!1);return I.colorAttachment.set(b),I}function el(g,t){return t.colorRampTexture||(t.colorRampTexture=new qe(g,t.colorRamp,g.gl.RGBA)),t.colorRampTexture}function No(g,t,a,h,d){if(!a||!h||!h.imageAtlas)return;const m=h.imageAtlas.patternPositions;let b=m[a.to.toString()],T=m[a.from.toString()];if(!b&&T&&(b=T),!T&&b&&(T=b),!b||!T){const E=d.getPaintProperty(t);b=m[E],T=m[E]}b&&T&&g.setConstantPatternPositions(b,T)}function tl(g,t,a,h,d,m,b){const T=g.context.gl,E="fill-pattern",I=a.paint.get(E),z=I&&I.constantOr(1),D=a.getCrossfadeParameters();let V,H,Y,ne,ae;b?(H=z&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=T.LINES):(H=z?"fillPattern":"fill",V=T.TRIANGLES);const ce=I.constantOr(null);for(const fe of h){const te=t.getTile(fe);if(z&&!te.patternsLoaded())continue;const ge=te.getBucket(a);if(!ge)continue;const _e=ge.programConfigurations.get(a.id),we=g.useProgram(H,_e),Me=g.style.map.terrain&&g.style.map.terrain.getTerrainData(fe);z&&(g.context.activeTexture.set(T.TEXTURE0),te.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),_e.updatePaintBuffers(D)),No(_e,E,ce,te,a);const Oe=Me?fe:null,Xe=g.translatePosMatrix(Oe?Oe.posMatrix:fe.posMatrix,te,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(b){ne=ge.indexBuffer2,ae=ge.segments2;const tt=[T.drawingBufferWidth,T.drawingBufferHeight];Y=H==="fillOutlinePattern"&&z?Hd(Xe,g,D,te,tt):qm(Xe,tt)}else ne=ge.indexBuffer,ae=ge.segments,Y=z?Zd(Xe,g,D,te):Lo(Xe);we.draw(g.context,V,d,g.stencilModeForClipping(fe),m,tr.disabled,Y,Me,a.id,ge.layoutVertexBuffer,ne,ae,a.paint,g.transform.zoom,_e)}}function nu(g,t,a,h,d,m,b){const T=g.context,E=T.gl,I="fill-extrusion-pattern",z=a.paint.get(I),D=z.constantOr(1),V=a.getCrossfadeParameters(),H=a.paint.get("fill-extrusion-opacity"),Y=z.constantOr(null);for(const ne of h){const ae=t.getTile(ne),ce=ae.getBucket(a);if(!ce)continue;const fe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ne),te=ce.programConfigurations.get(a.id),ge=g.useProgram(D?"fillExtrusionPattern":"fillExtrusion",te);D&&(g.context.activeTexture.set(E.TEXTURE0),ae.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),te.updatePaintBuffers(V)),No(te,I,Y,ae,a);const _e=g.translatePosMatrix(ne.posMatrix,ae,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),we=a.paint.get("fill-extrusion-vertical-gradient"),Me=D?Gl(_e,g,we,H,ne,V,ae):Ga(_e,g,we,H);ge.draw(T,T.gl.TRIANGLES,d,m,b,tr.backCCW,Me,fe,a.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,a.paint,g.transform.zoom,te,g.style.map.terrain&&ce.centroidVertexBuffer)}}function jo(g,t,a,h,d,m,b){const T=g.context,E=T.gl,I=a.fbo;if(!I)return;const z=g.useProgram("hillshade"),D=g.style.map.terrain&&g.style.map.terrain.getTerrainData(t);T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,I.colorAttachment.get()),z.draw(T,E.TRIANGLES,d,m,b,tr.disabled,((V,H,Y,ne)=>{const ae=Y.paint.get("hillshade-shadow-color"),ce=Y.paint.get("hillshade-highlight-color"),fe=Y.paint.get("hillshade-accent-color");let te=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(te-=V.transform.angle);const ge=!V.options.moving;return{u_matrix:ne?ne.posMatrix:V.transform.calculatePosMatrix(H.tileID.toUnwrapped(),ge),u_image:0,u_latrange:Xl(0,H.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),te],u_shadow:ae,u_highlight:ce,u_accent:fe}})(g,a,h,D?t:null),D,h.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function Vo(g,t,a,h,d,m){const b=g.context,T=b.gl,E=t.dem;if(E&&E.data){const I=E.dim,z=E.stride,D=E.getPixels();if(b.activeTexture.set(T.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||g.getTileTexture(z),t.demTexture){const H=t.demTexture;H.update(D,{premultiply:!1}),H.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else t.demTexture=new qe(b,D,T.RGBA,{premultiply:!1}),t.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);b.activeTexture.set(T.TEXTURE0);let V=t.fbo;if(!V){const H=new qe(b,{width:I,height:I,data:null},T.RGBA);H.bind(T.LINEAR,T.CLAMP_TO_EDGE),V=t.fbo=b.createFramebuffer(I,I,!0,!1),V.colorAttachment.set(H.texture)}b.bindFramebuffer.set(V.framebuffer),b.viewport.set([0,0,I,I]),g.useProgram("hillshadePrepare").draw(b,T.TRIANGLES,h,d,m,tr.disabled,((H,Y)=>{const ne=Y.stride,ae=c.H();return c.aP(ae,0,c.X,-c.X,0,0,1),c.J(ae,ae,[0,-c.X,0]),{u_matrix:ae,u_image:1,u_dimension:[ne,ne],u_zoom:H.overscaledZ,u_unpack:Y.getUnpackVector()}})(t.tileID,E),null,a.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function cf(g,t,a,h,d,m){const b=h.paint.get("raster-fade-duration");if(!m&&b>0){const T=R.now(),E=(T-g.timeAdded)/b,I=t?(T-t.timeAdded)/b:-1,z=a.getSource(),D=d.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),V=!t||Math.abs(t.tileID.overscaledZ-D)>Math.abs(g.tileID.overscaledZ-D),H=V&&g.refreshedUponExpiration?1:c.ac(V?E:1-I,0,1);return g.refreshedUponExpiration&&E>=1&&(g.refreshedUponExpiration=!1),t?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const Yc=new c.aM(1,0,0,1),Ht=new c.aM(0,1,0,1),iu=new c.aM(0,0,1,1),sg=new c.aM(1,0,1,1),hf=new c.aM(0,1,1,1);function $o(g,t,a,h){su(g,0,t+a/2,g.transform.width,a,h)}function df(g,t,a,h){su(g,t-a/2,0,a,g.transform.height,h)}function su(g,t,a,h,d,m){const b=g.context,T=b.gl;T.enable(T.SCISSOR_TEST),T.scissor(t*g.pixelRatio,a*g.pixelRatio,h*g.pixelRatio,d*g.pixelRatio),b.clear({color:m}),T.disable(T.SCISSOR_TEST)}function ff(g,t,a){const h=g.context,d=h.gl,m=a.posMatrix,b=g.useProgram("debug"),T=Ft.disabled,E=sr.disabled,I=g.colorModeForRenderPass(),z="$debug",D=g.style.map.terrain&&g.style.map.terrain.getTerrainData(a);h.activeTexture.set(d.TEXTURE0);const V=t.getTileByID(a.key).latestRawTileData,H=Math.floor((V&&V.byteLength||0)/1024),Y=t.getTile(a).tileSize,ne=512/Math.min(Y,512)*(a.overscaledZ/g.transform.zoom)*.5;let ae=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ae+=` => ${a.overscaledZ}`),function(ce,fe){ce.initDebugOverlayCanvas();const te=ce.debugOverlayCanvas,ge=ce.context.gl,_e=ce.debugOverlayCanvas.getContext("2d");_e.clearRect(0,0,te.width,te.height),_e.shadowColor="white",_e.shadowBlur=2,_e.lineWidth=1.5,_e.strokeStyle="white",_e.textBaseline="top",_e.font="bold 36px Open Sans, sans-serif",_e.fillText(fe,5,5),_e.strokeText(fe,5,5),ce.debugOverlayTexture.update(te),ce.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(g,`${ae} ${H}kB`),b.draw(h,d.TRIANGLES,T,E,br.alphaBlended,tr.disabled,Wa(m,c.aM.transparent,ne),null,z,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),b.draw(h,d.LINE_STRIP,T,E,I,tr.disabled,Wa(m,c.aM.red),D,z,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function pf(g,t,a){const h=g.context,d=h.gl,m=g.colorModeForRenderPass(),b=new Ft(d.LEQUAL,Ft.ReadWrite,g.depthRangeFor3D),T=g.useProgram("terrain"),E=t.getTerrainMesh();h.bindFramebuffer.set(null),h.viewport.set([0,0,g.width,g.height]);for(const I of a){const z=g.renderToTexture.getTexture(I),D=t.getTerrainData(I.tileID);h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,z.texture);const V=g.transform.calculatePosMatrix(I.tileID.toUnwrapped()),H=t.getMeshFrameDelta(g.transform.zoom),Y=g.transform.calculateFogMatrix(I.tileID.toUnwrapped()),ne=Rc(V,H,Y,g.style.sky,g.transform.pitch);T.draw(h,d.TRIANGLES,b,sr.disabled,m,tr.backCCW,ne,D,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class ou{constructor(t,a,h){this.vertexBuffer=t,this.indexBuffer=a,this.segments=h}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class au{constructor(t,a){this.context=new ig(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=vt.maxUnderzooming+vt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zc}resize(t,a,h){if(this.width=Math.floor(t*h),this.height=Math.floor(a*h),this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,a=new c.aX;a.emplaceBack(0,0),a.emplaceBack(c.X,0),a.emplaceBack(0,c.X),a.emplaceBack(c.X,c.X),this.tileExtentBuffer=t.createVertexBuffer(a,eo.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const h=new c.aX;h.emplaceBack(0,0),h.emplaceBack(c.X,0),h.emplaceBack(0,c.X),h.emplaceBack(c.X,c.X),this.debugBuffer=t.createVertexBuffer(h,eo.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const d=new c.$;d.emplaceBack(0,0,0,0),d.emplaceBack(c.X,0,c.X,0),d.emplaceBack(0,c.X,0,c.X),d.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=t.createVertexBuffer(d,Ii.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const m=new c.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(m,eo.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const b=new c.aZ;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(b);const T=new c.aY;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(T);const E=this.context.gl;this.stencilClearMode=new sr({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=c.H();c.aP(h,0,this.width,this.height,0,0,1),c.K(h,h,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,a.TRIANGLES,Ft.disabled,this.stencilClearMode,br.disabled,tr.disabled,An(h),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source;const h=this.context,d=h.gl;this.nextStencilID+a.length>256&&this.clearStencil(),h.setColorMode(br.disabled),h.setDepthMode(Ft.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of a){const T=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(b);m.draw(h,d.TRIANGLES,Ft.disabled,new sr({func:d.ALWAYS,mask:0},T,255,d.KEEP,d.KEEP,d.REPLACE),br.disabled,tr.disabled,An(b.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new sr({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new sr({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,h=t.sort((b,T)=>T.overscaledZ-b.overscaledZ),d=h[h.length-1].overscaledZ,m=h[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const b={};for(let T=0;T<m;T++)b[T+d]=new sr({func:a.GEQUAL,mask:255},T+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=m,[b,h]}return[{[d]:sr.disabled},h]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new br([t.CONSTANT_COLOR,t.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?br.unblended:br.alphaBlended}depthModeForSublayer(t,a,h){if(!this.opaquePassEnabledForLayer())return Ft.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Ft(h||this.context.gl.LEQUAL,a,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(R.now()),this.imageManager.beginFrame();const h=this.style._order,d=this.style.sourceCaches,m={},b={},T={};for(const E in d){const I=d[E];I.used&&I.prepare(this.context),m[E]=I.getVisibleCoordinates(),b[E]=m[E].slice().reverse(),T[E]=I.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<h.length;E++)if(this.style._layers[h[E]].is3D()){this.opaquePassCutoff=E;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const E of h){const I=this.style._layers[E];if(!I.hasOffscreenPass()||I.isHidden(this.transform.zoom))continue;const z=b[I.source];(I.type==="custom"||z.length)&&this.renderLayer(this,d[I.source],I,z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(E,I){const z=E.context,D=z.gl,V=((ce,fe,te)=>({u_sky_color:ce.properties.get("sky-color"),u_horizon_color:ce.properties.get("horizon-color"),u_horizon:(fe.height/2+fe.getHorizon())*te,u_sky_horizon_blend:ce.properties.get("sky-horizon-blend")*fe.height/2*te}))(I,E.style.map.transform,E.pixelRatio),H=new Ft(D.LEQUAL,Ft.ReadWrite,[0,1]),Y=sr.disabled,ne=E.colorModeForRenderPass(),ae=E.useProgram("sky");if(!I.mesh){const ce=new c.aX;ce.emplaceBack(-1,-1),ce.emplaceBack(1,-1),ce.emplaceBack(1,1),ce.emplaceBack(-1,1);const fe=new c.aY;fe.emplaceBack(0,1,2),fe.emplaceBack(0,2,3),I.mesh=new ou(z.createVertexBuffer(ce,eo.members),z.createIndexBuffer(fe),c.a0.simpleSegment(0,0,ce.length,fe.length))}ae.draw(z,D.TRIANGLES,H,Y,ne,tr.disabled,V,void 0,"sky",I.mesh.vertexBuffer,I.mesh.indexBuffer,I.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[h[this.currentLayer]],I=d[E.source],z=m[E.source];this._renderTileClippingMasks(E,z),this.renderLayer(this,I,E,z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){const E=this.style._layers[h[this.currentLayer]],I=d[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const z=(E.type==="symbol"?T:b)[E.source];this._renderTileClippingMasks(E,m[E.source]),this.renderLayer(this,I,E,z)}if(this.options.showTileBoundaries){const E=function(I,z){let D=null;const V=Object.values(I._layers).flatMap(ae=>ae.source&&!ae.isHidden(z)?[I.sourceCaches[ae.source]]:[]),H=V.filter(ae=>ae.getSource().type==="vector"),Y=V.filter(ae=>ae.getSource().type!=="vector"),ne=ae=>{(!D||D.getSource().maxzoom<ae.getSource().maxzoom)&&(D=ae)};return H.forEach(ae=>ne(ae)),D||Y.forEach(ae=>ne(ae)),D}(this.style,this.transform.zoom);E&&function(I,z,D){for(let V=0;V<D.length;V++)ff(I,z,D[V])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const I=E.transform.padding;$o(E,E.transform.height-(I.top||0),3,Yc),$o(E,I.bottom||0,3,Ht),df(E,I.left||0,3,iu),df(E,E.transform.width-(I.right||0),3,sg);const z=E.transform.centerPoint;(function(D,V,H,Y){su(D,V-1,H-10,2,20,Y),su(D,V-10,H-1,20,2,Y)})(E,z.x,E.transform.height-z.y,hf)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,h=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=t?!c.a_(a,h):!c.a$(a,h)),d||(d=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),d&&(c.b0(a,h),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,b){const T=m.context,E=T.gl,I=br.unblended,z=new Ft(E.LEQUAL,Ft.ReadWrite,[0,1]),D=b.getTerrainMesh(),V=b.sourceCache.getRenderableTiles(),H=m.useProgram("terrainDepth");T.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:c.aM.transparent,depth:1});for(const Y of V){const ne=b.getTerrainData(Y.tileID),ae={u_matrix:m.transform.calculatePosMatrix(Y.tileID.toUnwrapped()),u_ele_delta:b.getMeshFrameDelta(m.transform.zoom)};H.draw(T,E.TRIANGLES,z,sr.disabled,I,tr.backCCW,ae,ne,"terrain",D.vertexBuffer,D.indexBuffer,D.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,b){const T=m.context,E=T.gl,I=br.unblended,z=new Ft(E.LEQUAL,Ft.ReadWrite,[0,1]),D=b.getTerrainMesh(),V=b.getCoordsTexture(),H=b.sourceCache.getRenderableTiles(),Y=m.useProgram("terrainCoords");T.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:c.aM.transparent,depth:1}),b.coordsIndex=[];for(const ne of H){const ae=b.getTerrainData(ne.tileID);T.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,V.texture);const ce={u_matrix:m.transform.calculatePosMatrix(ne.tileID.toUnwrapped()),u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(m.transform.zoom)};Y.draw(T,E.TRIANGLES,z,sr.disabled,I,tr.backCCW,ce,ae,"terrain",D.vertexBuffer,D.indexBuffer,D.segments),b.coordsIndex.push(ne.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(t,a,h,d){if(!h.isHidden(this.transform.zoom)&&(h.type==="background"||h.type==="custom"||(d||[]).length))switch(this.id=h.id,h.type){case"symbol":(function(m,b,T,E,I){if(m.renderPass!=="translucent")return;const z=sr.disabled,D=m.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(V,H,Y,ne,ae,ce,fe,te,ge){const _e=H.transform,we=Qs(),Me=ae==="map",Oe=ce==="map";for(const Xe of V){const tt=ne.getTile(Xe),Ze=tt.getBucket(Y);if(!Ze||!Ze.text||!Ze.text.segments.get().length)continue;const Ue=c.ag(Ze.textSizeData,_e.zoom),lt=Bt(tt,1,H.transform.zoom),Et=Ji(Xe.posMatrix,Oe,Me,H.transform,lt),Ge=Y.layout.get("icon-text-fit")!=="none"&&Ze.hasIconData();if(Ue){const Je=Math.pow(2,_e.zoom-tt.tileID.overscaledZ),St=H.style.map.terrain?(Dt,Nt)=>H.style.map.terrain.getElevation(Xe,Dt,Nt):null,cr=we.translatePosition(_e,tt,fe,te);Bo(Ze,Me,Oe,ge,_e,Et,Xe.posMatrix,Je,Ue,Ge,we,cr,Xe.toUnwrapped(),St)}}}(E,m,T,b,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),I),T.paint.get("icon-opacity").constantOr(1)!==0&&Wc(m,b,T,E,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),z,D),T.paint.get("text-opacity").constantOr(1)!==0&&Wc(m,b,T,E,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),z,D),b.map.showCollisionBoxes&&(Ya(m,b,T,E,!0),Ya(m,b,T,E,!1))})(t,a,h,d,this.style.placement.variableOffsets);break;case"circle":(function(m,b,T,E){if(m.renderPass!=="translucent")return;const I=T.paint.get("circle-opacity"),z=T.paint.get("circle-stroke-width"),D=T.paint.get("circle-stroke-opacity"),V=!T.layout.get("circle-sort-key").isConstant();if(I.constantOr(1)===0&&(z.constantOr(1)===0||D.constantOr(1)===0))return;const H=m.context,Y=H.gl,ne=m.depthModeForSublayer(0,Ft.ReadOnly),ae=sr.disabled,ce=m.colorModeForRenderPass(),fe=[];for(let te=0;te<E.length;te++){const ge=E[te],_e=b.getTile(ge),we=_e.getBucket(T);if(!we)continue;const Me=we.programConfigurations.get(T.id),Oe=m.useProgram("circle",Me),Xe=we.layoutVertexBuffer,tt=we.indexBuffer,Ze=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ge),Ue={programConfiguration:Me,program:Oe,layoutVertexBuffer:Xe,indexBuffer:tt,uniformValues:Zm(m,ge,_e,T),terrainData:Ze};if(V){const lt=we.segments.get();for(const Et of lt)fe.push({segments:new c.a0([Et]),sortKey:Et.sortKey,state:Ue})}else fe.push({segments:we.segments,sortKey:0,state:Ue})}V&&fe.sort((te,ge)=>te.sortKey-ge.sortKey);for(const te of fe){const{programConfiguration:ge,program:_e,layoutVertexBuffer:we,indexBuffer:Me,uniformValues:Oe,terrainData:Xe}=te.state;_e.draw(H,Y.TRIANGLES,ne,ae,ce,tr.disabled,Oe,Xe,T.id,we,Me,te.segments,T.paint,m.transform.zoom,ge)}})(t,a,h,d);break;case"heatmap":(function(m,b,T,E){if(T.paint.get("heatmap-opacity")===0)return;const I=m.context;if(m.style.map.terrain){for(const z of E){const D=b.getTile(z);b.hasRenderableParent(z)||(m.renderPass==="offscreen"?Kc(m,D,T,z):m.renderPass==="translucent"&&ao(m,T,z))}I.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?function(z,D,V,H){const Y=z.context,ne=Y.gl,ae=sr.disabled,ce=new br([ne.ONE,ne.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(fe,te,ge){const _e=fe.gl;fe.activeTexture.set(_e.TEXTURE1),fe.viewport.set([0,0,te.width/4,te.height/4]);let we=ge.heatmapFbos.get(c.aU);we?(_e.bindTexture(_e.TEXTURE_2D,we.colorAttachment.get()),fe.bindFramebuffer.set(we.framebuffer)):(we=Qa(fe,te.width/4,te.height/4),ge.heatmapFbos.set(c.aU,we))})(Y,z,V),Y.clear({color:c.aM.transparent});for(let fe=0;fe<H.length;fe++){const te=H[fe];if(D.hasRenderableParent(te))continue;const ge=D.getTile(te),_e=ge.getBucket(V);if(!_e)continue;const we=_e.programConfigurations.get(V.id),Me=z.useProgram("heatmap",we),{zoom:Oe}=z.transform;Me.draw(Y,ne.TRIANGLES,Ft.disabled,ae,ce,tr.disabled,Mn(te.posMatrix,ge,Oe,V.paint.get("heatmap-intensity")),null,V.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,V.paint,z.transform.zoom,we)}Y.viewport.set([0,0,z.width,z.height])}(m,b,T,E):m.renderPass==="translucent"&&function(z,D){const V=z.context,H=V.gl;V.setColorMode(z.colorModeForRenderPass());const Y=D.heatmapFbos.get(c.aU);Y&&(V.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Y.colorAttachment.get()),V.activeTexture.set(H.TEXTURE1),el(V,D).bind(H.LINEAR,H.CLAMP_TO_EDGE),z.useProgram("heatmapTexture").draw(V,H.TRIANGLES,Ft.disabled,sr.disabled,z.colorModeForRenderPass(),tr.disabled,Wl(z,D,0,1),null,D.id,z.viewportBuffer,z.quadTriangleIndexBuffer,z.viewportSegments,D.paint,z.transform.zoom))}(m,T)})(t,a,h,d);break;case"line":(function(m,b,T,E){if(m.renderPass!=="translucent")return;const I=T.paint.get("line-opacity"),z=T.paint.get("line-width");if(I.constantOr(1)===0||z.constantOr(1)===0)return;const D=m.depthModeForSublayer(0,Ft.ReadOnly),V=m.colorModeForRenderPass(),H=T.paint.get("line-dasharray"),Y=T.paint.get("line-pattern"),ne=Y.constantOr(1),ae=T.paint.get("line-gradient"),ce=T.getCrossfadeParameters(),fe=ne?"linePattern":H?"lineSDF":ae?"lineGradient":"line",te=m.context,ge=te.gl;let _e=!0;for(const we of E){const Me=b.getTile(we);if(ne&&!Me.patternsLoaded())continue;const Oe=Me.getBucket(T);if(!Oe)continue;const Xe=Oe.programConfigurations.get(T.id),tt=m.context.program.get(),Ze=m.useProgram(fe,Xe),Ue=_e||Ze.program!==tt,lt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(we),Et=Y.constantOr(null);if(Et&&Me.imageAtlas){const St=Me.imageAtlas,cr=St.patternPositions[Et.to.toString()],Dt=St.patternPositions[Et.from.toString()];cr&&Dt&&Xe.setConstantPatternPositions(cr,Dt)}const Ge=lt?we:null,Je=ne?Fo(m,Me,T,ce,Ge):H?Hm(m,Me,T,H,ce,Ge):ae?Gd(m,Me,T,Oe.lineClipsArray.length,Ge):Kl(m,Me,T,Ge);if(ne)te.activeTexture.set(ge.TEXTURE0),Me.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),Xe.updatePaintBuffers(ce);else if(H&&(Ue||m.lineAtlas.dirty))te.activeTexture.set(ge.TEXTURE0),m.lineAtlas.bind(te);else if(ae){const St=Oe.gradients[T.id];let cr=St.texture;if(T.gradientVersion!==St.version){let Dt=256;if(T.stepInterpolant){const Nt=b.getSource().maxzoom,hr=we.canonical.z===Nt?Math.ceil(1<<m.transform.maxZoom-we.canonical.z):1;Dt=c.ac(c.aV(Oe.maxLineLength/c.X*1024*hr),256,te.maxTextureSize)}St.gradient=c.aW({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:Dt,image:St.gradient||void 0,clips:Oe.lineClipsArray}),St.texture?St.texture.update(St.gradient):St.texture=new qe(te,St.gradient,ge.RGBA),St.version=T.gradientVersion,cr=St.texture}te.activeTexture.set(ge.TEXTURE0),cr.bind(T.stepInterpolant?ge.NEAREST:ge.LINEAR,ge.CLAMP_TO_EDGE)}Ze.draw(te,ge.TRIANGLES,D,m.stencilModeForClipping(we),V,tr.disabled,Je,lt,T.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,T.paint,m.transform.zoom,Xe,Oe.layoutVertexBuffer2),_e=!1}})(t,a,h,d);break;case"fill":(function(m,b,T,E){const I=T.paint.get("fill-color"),z=T.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const D=m.colorModeForRenderPass(),V=T.paint.get("fill-pattern"),H=m.opaquePassEnabledForLayer()&&!V.constantOr(1)&&I.constantOr(c.aM.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===H){const Y=m.depthModeForSublayer(1,m.renderPass==="opaque"?Ft.ReadWrite:Ft.ReadOnly);tl(m,b,T,E,Y,D,!1)}if(m.renderPass==="translucent"&&T.paint.get("fill-antialias")){const Y=m.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,Ft.ReadOnly);tl(m,b,T,E,Y,D,!0)}})(t,a,h,d);break;case"fill-extrusion":(function(m,b,T,E){const I=T.paint.get("fill-extrusion-opacity");if(I!==0&&m.renderPass==="translucent"){const z=new Ft(m.context.gl.LEQUAL,Ft.ReadWrite,m.depthRangeFor3D);if(I!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))nu(m,b,T,E,z,sr.disabled,br.disabled),nu(m,b,T,E,z,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const D=m.colorModeForRenderPass();nu(m,b,T,E,z,sr.disabled,D)}}})(t,a,h,d);break;case"hillshade":(function(m,b,T,E){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const I=m.context,z=m.depthModeForSublayer(0,Ft.ReadOnly),D=m.colorModeForRenderPass(),[V,H]=m.renderPass==="translucent"?m.stencilConfigForOverlap(E):[{},E];for(const Y of H){const ne=b.getTile(Y);ne.needsHillshadePrepare!==void 0&&ne.needsHillshadePrepare&&m.renderPass==="offscreen"?Vo(m,ne,T,z,sr.disabled,D):m.renderPass==="translucent"&&jo(m,Y,ne,T,z,V[Y.overscaledZ],D)}I.viewport.set([0,0,m.width,m.height])})(t,a,h,d);break;case"raster":(function(m,b,T,E){if(m.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!E.length)return;const I=m.context,z=I.gl,D=b.getSource(),V=m.useProgram("raster"),H=m.colorModeForRenderPass(),[Y,ne]=D instanceof Kr?[{},E]:m.stencilConfigForOverlap(E),ae=ne[ne.length-1].overscaledZ,ce=!m.options.moving;for(const fe of ne){const te=m.depthModeForSublayer(fe.overscaledZ-ae,T.paint.get("raster-opacity")===1?Ft.ReadWrite:Ft.ReadOnly,z.LESS),ge=b.getTile(fe);ge.registerFadeDuration(T.paint.get("raster-fade-duration"));const _e=b.findLoadedParent(fe,0),we=b.findLoadedSibling(fe),Me=cf(ge,_e||we||null,b,T,m.transform,m.style.map.terrain);let Oe,Xe;const tt=T.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;I.activeTexture.set(z.TEXTURE0),ge.texture.bind(tt,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),I.activeTexture.set(z.TEXTURE1),_e?(_e.texture.bind(tt,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),Oe=Math.pow(2,_e.tileID.overscaledZ-ge.tileID.overscaledZ),Xe=[ge.tileID.canonical.x*Oe%1,ge.tileID.canonical.y*Oe%1]):ge.texture.bind(tt,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),ge.texture.useMipmap&&I.extTextureFilterAnisotropic&&m.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const Ze=m.style.map.terrain&&m.style.map.terrain.getTerrainData(fe),Ue=Ze?fe:null,lt=Ue?Ue.posMatrix:m.transform.calculatePosMatrix(fe.toUnwrapped(),ce),Et=Gm(lt,Xe||[0,0],Oe||1,Me,T);D instanceof Kr?V.draw(I,z.TRIANGLES,te,sr.disabled,H,tr.disabled,Et,Ze,T.id,D.boundsBuffer,m.quadTriangleIndexBuffer,D.boundsSegments):V.draw(I,z.TRIANGLES,te,Y[fe.overscaledZ],H,tr.disabled,Et,Ze,T.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(t,a,h,d);break;case"background":(function(m,b,T,E){const I=T.paint.get("background-color"),z=T.paint.get("background-opacity");if(z===0)return;const D=m.context,V=D.gl,H=m.transform,Y=H.tileSize,ne=T.paint.get("background-pattern");if(m.isPatternMissing(ne))return;const ae=!ne&&I.a===1&&z===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ae)return;const ce=sr.disabled,fe=m.depthModeForSublayer(0,ae==="opaque"?Ft.ReadWrite:Ft.ReadOnly),te=m.colorModeForRenderPass(),ge=m.useProgram(ne?"backgroundPattern":"background"),_e=E||H.coveringTiles({tileSize:Y,terrain:m.style.map.terrain});ne&&(D.activeTexture.set(V.TEXTURE0),m.imageManager.bind(m.context));const we=T.getCrossfadeParameters();for(const Me of _e){const Oe=E?Me.posMatrix:m.transform.calculatePosMatrix(Me.toUnwrapped()),Xe=ne?Oc(Oe,z,m,ne,{tileID:Me,tileSize:Y},we):Yl(Oe,z,I),tt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Me);ge.draw(D,V.TRIANGLES,fe,ce,te,tr.disabled,Xe,tt,T.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(t,0,h,d);break;case"custom":(function(m,b,T){const E=m.context,I=T.implementation;if(m.renderPass==="offscreen"){const z=I.prerender;z&&(m.setCustomLayerDefaults(),E.setColorMode(m.colorModeForRenderPass()),z.call(I,E.gl,m.transform.customLayerMatrix()),E.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),E.setColorMode(m.colorModeForRenderPass()),E.setStencilMode(sr.disabled);const z=I.renderingMode==="3d"?new Ft(m.context.gl.LEQUAL,Ft.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Ft.ReadOnly);E.setDepthMode(z),I.render(E.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),E.setDirty(),m.setBaseState(),E.bindFramebuffer.set(null)}})(t,0,h)}}translatePosMatrix(t,a,h,d,m){if(!h[0]&&!h[1])return t;const b=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(b){const I=Math.sin(b),z=Math.cos(b);h=[h[0]*z-h[1]*I,h[0]*I+h[1]*z]}const T=[m?h[0]:Bt(a,h[0],this.transform.zoom),m?h[1]:Bt(a,h[1],this.transform.zoom),0],E=new Float32Array(16);return c.J(E,t,T),E}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),h=this.imageManager.getPattern(t.to.toString());return!a||!h}useProgram(t,a){this.cache=this.cache||{};const h=t+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[h]||(this.cache[h]=new Lc(this.context,Ds[t],a,Bc[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[h]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new qe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}class Uo{constructor(t,a){this.points=t,this.planes=a}static fromInvProjectionMatrix(t,a,h){const d=Math.pow(2,h),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const E=1/(T=c.af([],T,t))[3]/a*d;return c.b1(T,T,[E,E,1/T[3],E])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const E=function(V,H){var Y=H[0],ne=H[1],ae=H[2],ce=Y*Y+ne*ne+ae*ae;return ce>0&&(ce=1/Math.sqrt(ce)),V[0]=H[0]*ce,V[1]=H[1]*ce,V[2]=H[2]*ce,V}([],function(V,H,Y){var ne=H[0],ae=H[1],ce=H[2],fe=Y[0],te=Y[1],ge=Y[2];return V[0]=ae*ge-ce*te,V[1]=ce*fe-ne*ge,V[2]=ne*te-ae*fe,V}([],Pe([],m[T[0]],m[T[1]]),Pe([],m[T[2]],m[T[1]]))),I=-((z=E)[0]*(D=m[T[1]])[0]+z[1]*D[1]+z[2]*D[2]);var z,D;return E.concat(I)});return new Uo(m,b)}}class qo{constructor(t,a){this.min=t,this.max=a,this.center=function(h,d,m){return h[0]=.5*d[0],h[1]=.5*d[1],h[2]=.5*d[2],h}([],function(h,d,m){return h[0]=d[0]+m[0],h[1]=d[1]+m[1],h[2]=d[2]+m[2],h}([],this.min,this.max))}quadrant(t){const a=[t%2==0,t<2],h=be(this.min),d=be(this.max);for(let m=0;m<a.length;m++)h[m]=a[m]?this.min[m]:this.center[m],d[m]=a[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new qo(h,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let h=!0;for(let d=0;d<t.planes.length;d++){const m=t.planes[d];let b=0;for(let T=0;T<a.length;T++)c.b2(m,a[T])>=0&&b++;if(b===0)return 0;b!==a.length&&(h=!1)}if(h)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let T=0;T<t.points.length;T++){const E=t.points[T][d]-this.min[d];m=Math.min(m,E),b=Math.max(b,E)}if(b<0||m>this.max[d]-this.min[d])return 0}return 1}}class Zo{constructor(t=0,a=0,h=0,d=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(h)||h<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=h,this.right=d}interpolate(t,a,h){return a.top!=null&&t.top!=null&&(this.top=c.y.number(t.top,a.top,h)),a.bottom!=null&&t.bottom!=null&&(this.bottom=c.y.number(t.bottom,a.bottom,h)),a.left!=null&&t.left!=null&&(this.left=c.y.number(t.left,a.left,h)),a.right!=null&&t.right!=null&&(this.right=c.y.number(t.right,a.right,h)),this}getCenter(t,a){const h=c.ac((this.left+t-this.right)/2,0,t),d=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(h,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Zo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Jc=85.051129;class Ho{constructor(t,a,h,d,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=h??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Zo,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new Ho(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.lngRange=t.lngRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const a=-c.b3(t,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var h=new c.A(4);return c.A!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h}(),function(h,d,m){var b=d[0],T=d[1],E=d[2],I=d[3],z=Math.sin(m),D=Math.cos(m);h[0]=b*D+E*z,h[1]=T*D+I*z,h[2]=b*-z+E*D,h[3]=T*-z+I*D}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=c.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,h){this._unmodified=!1,this._edgeInsets.interpolate(t,a,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new c.b4(0,t)];if(this._renderWorldCopies){const h=this.pointCoordinate(new c.P(0,0)),d=this.pointCoordinate(new c.P(this.width,0)),m=this.pointCoordinate(new c.P(this.width,this.height)),b=this.pointCoordinate(new c.P(0,this.height)),T=Math.floor(Math.min(h.x,d.x,m.x,b.x)),E=Math.floor(Math.max(h.x,d.x,m.x,b.x)),I=1;for(let z=T-I;z<=E+I;z++)z!==0&&a.push(new c.b4(z,t))}return a}coveringTiles(t){var a,h;let d=this.coveringZoomLevel(t);const m=d;if(t.minzoom!==void 0&&d<t.minzoom)return[];t.maxzoom!==void 0&&d>t.maxzoom&&(d=t.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),T=c.Z.fromLngLat(this.center),E=Math.pow(2,d),I=[E*b.x,E*b.y,0],z=[E*T.x,E*T.y,0],D=Uo.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,d);let V=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(V=d);const H=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,Y=te=>({aabb:new qo([te*E,0,0],[(te+1)*E,E,0]),zoom:0,x:0,y:0,wrap:te,fullyVisible:!1}),ne=[],ae=[],ce=d,fe=t.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let te=1;te<=3;te++)ne.push(Y(-te)),ne.push(Y(te));for(ne.push(Y(0));ne.length>0;){const te=ne.pop(),ge=te.x,_e=te.y;let we=te.fullyVisible;if(!we){const Ze=te.aabb.intersects(D);if(Ze===0)continue;we=Ze===2}const Me=t.terrain?I:z,Oe=te.aabb.distanceX(Me),Xe=te.aabb.distanceY(Me),tt=Math.max(Math.abs(Oe),Math.abs(Xe));if(te.zoom===ce||tt>H+(1<<ce-te.zoom)-2&&te.zoom>=V){const Ze=ce-te.zoom,Ue=I[0]-.5-(ge<<Ze),lt=I[1]-.5-(_e<<Ze);ae.push({tileID:new c.S(te.zoom===ce?fe:te.zoom,te.wrap,te.zoom,ge,_e),distanceSq:Fe([z[0]-.5-ge,z[1]-.5-_e]),tileDistanceToCamera:Math.sqrt(Ue*Ue+lt*lt)})}else for(let Ze=0;Ze<4;Ze++){const Ue=(ge<<1)+Ze%2,lt=(_e<<1)+(Ze>>1),Et=te.zoom+1;let Ge=te.aabb.quadrant(Ze);if(t.terrain){const Je=new c.S(Et,te.wrap,Et,Ue,lt),St=t.terrain.getMinMaxElevation(Je),cr=(a=St.minElevation)!==null&&a!==void 0?a:this.elevation,Dt=(h=St.maxElevation)!==null&&h!==void 0?h:this.elevation;Ge=new qo([Ge.min[0],Ge.min[1],cr],[Ge.max[0],Ge.max[1],Dt])}ne.push({aabb:Ge,zoom:Et,x:Ue,y:lt,wrap:te.wrap,fullyVisible:we})}}return ae.sort((te,ge)=>te.distanceSq-ge.distanceSq).map(te=>te.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=c.ac(t.lat,-85.051129,Jc);return new c.P(c.O(t.lng)*this.worldSize,c.Q(a)*this.worldSize)}unproject(t){return new c.Z(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const a=this.elevation,h=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,d=this.pointLocation(this.centerPoint,t),m=t.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-m))return;const b=h+a-m,T=Math.cos(this._pitch)*this.cameraToCenterDistance/b/c.b5(1,d.lat),E=this.scaleZoom(T/this.tileSize);this._elevation=m,this._center=d,this.zoom=E}setLocationAtPoint(t,a){const h=this.pointCoordinate(a),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(t),b=new c.Z(m.x-(h.x-d.x),m.y-(h.y-d.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,a){return a?this.coordinatePoint(this.locationCoordinate(t),a.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,a){return this.coordinateLocation(this.pointCoordinate(t,a))}locationCoordinate(t){return c.Z.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,a){if(a){const V=a.pointCoordinate(t);if(V!=null)return V}const h=[t.x,t.y,0,1],d=[t.x,t.y,1,1];c.af(h,h,this.pixelMatrixInverse),c.af(d,d,this.pixelMatrixInverse);const m=h[3],b=d[3],T=h[1]/m,E=d[1]/b,I=h[2]/m,z=d[2]/b,D=I===z?0:(0-I)/(z-I);return new c.Z(c.y.number(h[0]/m,d[0]/b,D)/this.worldSize,c.y.number(T,E,D)/this.worldSize)}coordinatePoint(t,a=0,h=this.pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,a,1];return c.af(d,d,h),new c.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Te().extend(this.pointLocation(new c.P(0,t))).extend(this.pointLocation(new c.P(this.width,t))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Te([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Jc])}calculateTileMatrix(t){const a=t.canonical,h=this.worldSize/this.zoomScale(a.z),d=a.x+Math.pow(2,a.z)*t.wrap,m=c.an(new Float64Array(16));return c.J(m,m,[d*h,a.y*h,0]),c.K(m,m,[h/c.X,h/c.X,1]),m}calculatePosMatrix(t,a=!1){const h=t.key,d=a?this._alignedPosMatrixCache:this._posMatrixCache;if(d[h])return d[h];const m=this.calculateTileMatrix(t);return c.L(m,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),d[h]=new Float32Array(m),d[h]}calculateFogMatrix(t){const a=t.key,h=this._fogMatrixCache;if(h[a])return h[a];const d=this.calculateTileMatrix(t);return c.L(d,this.fogMatrix,d),h[a]=new Float32Array(d),h[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,a){a=c.ac(+a,this.minZoom,this.maxZoom);const h={center:new c.N(t.lng,t.lat),zoom:a};let d=this.lngRange;if(!this._renderWorldCopies&&d===null){const te=179.9999999999;d=[-te,te]}const m=this.tileSize*this.zoomScale(h.zoom);let b=0,T=m,E=0,I=m,z=0,D=0;const{x:V,y:H}=this.size;if(this.latRange){const te=this.latRange;b=c.Q(te[1])*m,T=c.Q(te[0])*m,T-b<H&&(z=H/(T-b))}d&&(E=c.b3(c.O(d[0])*m,0,m),I=c.b3(c.O(d[1])*m,0,m),I<E&&(I+=m),I-E<V&&(D=V/(I-E)));const{x:Y,y:ne}=this.project.call({worldSize:m},t);let ae,ce;const fe=Math.max(D||0,z||0);if(fe){const te=new c.P(D?(I+E)/2:Y,z?(T+b)/2:ne);return h.center=this.unproject.call({worldSize:m},te).wrap(),h.zoom+=this.scaleZoom(fe),h}if(this.latRange){const te=H/2;ne-te<b&&(ce=b+te),ne+te>T&&(ce=T-te)}if(d){const te=(E+I)/2;let ge=Y;this._renderWorldCopies&&(ge=c.b3(Y,te-m/2,te+m/2));const _e=V/2;ge-_e<E&&(ae=E+_e),ge+_e>I&&(ae=I-_e)}if(ae!==void 0||ce!==void 0){const te=new c.P(ae??Y,ce??ne);h.center=this.unproject.call({worldSize:m},te).wrap()}return h}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:h}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=h,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.point.x,h=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let d=c.an(new Float64Array(16));c.K(d,d,[this.width/2,-this.height/2,1]),c.J(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=c.an(new Float64Array(16)),c.K(d,d,[1,-1,1]),c.J(d,d,[-1,-1,0]),c.K(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),b=Math.min(this.elevation,this.minElevationForCurrentTile),T=m-b*this._pixelPerMeter/Math.cos(this._pitch),E=b<0?T:m,I=Math.PI/2+this._pitch,z=this._fov*(.5+t.y/this.height),D=Math.sin(z)*E/Math.sin(c.ac(Math.PI-I-z,.01,Math.PI-.01)),V=this.getHorizon(),H=2*Math.atan(V/this.cameraToCenterDistance)*(.5+t.y/(2*V)),Y=Math.sin(H)*E/Math.sin(c.ac(Math.PI-I-H,.01,Math.PI-.01)),ne=Math.min(D,Y);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ne+E),this.nearZ=this.height/50,d=new Float64Array(16),c.b6(d,this._fov,this.width/this.height,this.nearZ,this.farZ),d[8]=2*-t.x/this.width,d[9]=2*t.y/this.height,this.projectionMatrix=c.ae(d),c.K(d,d,[1,-1,1]),c.J(d,d,[0,0,-this.cameraToCenterDistance]),c.b7(d,d,this._pitch),c.ad(d,d,this.angle),c.J(d,d,[-a,-h,0]),this.mercatorMatrix=c.K([],d,[this.worldSize,this.worldSize,this.worldSize]),c.K(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,d),c.J(d,d,[0,0,-this.elevation]),this.modelViewProjectionMatrix=d,this.invModelViewProjectionMatrix=c.as([],d),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-t.x/this.width,this.fogMatrix[9]=2*t.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-a,-h,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,d);const ae=this.width%2/2,ce=this.height%2/2,fe=Math.cos(this.angle),te=Math.sin(this.angle),ge=a-Math.round(a)+fe*ae+te*ce,_e=h-Math.round(h)+fe*ce+te*ae,we=new Float64Array(d);if(c.J(we,we,[ge>.5?ge-1:ge,_e>.5?_e-1:_e,0]),this.alignedModelViewProjectionMatrix=we,d=c.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new c.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,t))}getCameraQueryGeometry(t){const a=this.getCameraPoint();if(t.length===1)return[t[0],a];{let h=a.x,d=a.y,m=a.x,b=a.y;for(const T of t)h=Math.min(h,T.x),d=Math.min(d,T.y),m=Math.max(m,T.x),b=Math.max(b,T.y);return[new c.P(h,d),new c.P(m,d),new c.P(m,b),new c.P(h,b),new c.P(h,d)]}}lngLatToCameraDepth(t,a){const h=this.locationCoordinate(t),d=[h.x*this.worldSize,h.y*this.worldSize,a,1];return c.af(d,d,this.modelViewProjectionMatrix),d[2]/d[3]}}function rl(g,t){let a,h=!1,d=null,m=null;const b=()=>{d=null,h&&(g.apply(m,a),d=setTimeout(b,t),h=!1)};return(...T)=>(h=!0,m=this,a=T,d||b(),d)}class lu{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let h;return a.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(h=d)}),(h&&h[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:h,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const h=a.join("/");let d=h;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${h}`);let m=window.location.hash.replace(d,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let b=window.location.href.replace(/(#.+)?$/,m);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=rl(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,d=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),b=Math.round(a.lng*m)/m,T=Math.round(a.lat*m)/m,E=this._map.getBearing(),I=this._map.getPitch();let z="";if(z+=t?`/${b}/${T}/${h}`:`${h}/${T}/${b}`,(E||I)&&(z+="/"+Math.round(10*E)/10),I&&(z+=`/${Math.round(I)}`),this._hashName){const D=this._hashName;let V=!1;const H=window.location.hash.slice(1).split("&").map(Y=>{const ne=Y.split("=")[0];return ne===D?(V=!0,`${ne}=${z}`):Y}).filter(Y=>Y);return V||H.push(`${D}=${z}`),`#${H.join("&")}`}return`#${z}`}}const uu={linearity:.3,easing:c.b8(0,0,.3,1)},Qc=c.e({deceleration:2500,maxSpeed:1400},uu),og=c.e({deceleration:20,maxSpeed:1400},uu),mf=c.e({deceleration:1e3,maxSpeed:360},uu),cu=c.e({deceleration:1e3,maxSpeed:90},uu);class eh{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:R.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=R.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)a.zoom+=m.zoomDelta||0,a.bearing+=m.bearingDelta||0,a.pitch+=m.pitchDelta||0,m.panDelta&&a.pan._add(m.panDelta),m.around&&(a.around=m.around),m.pinchAround&&(a.pinchAround=m.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const m=il(a.pan.mag(),h,c.e({},Qc,t||{}));d.offset=a.pan.mult(m.amount/a.pan.mag()),d.center=this._map.transform.center,nl(d,m)}if(a.zoom){const m=il(a.zoom,h,og);d.zoom=this._map.transform.zoom+m.amount,nl(d,m)}if(a.bearing){const m=il(a.bearing,h,mf);d.bearing=this._map.transform.bearing+c.ac(m.amount,-179,179),nl(d,m)}if(a.pitch){const m=il(a.pitch,h,cu);d.pitch=this._map.transform.pitch+m.amount,nl(d,m)}if(d.zoom||d.bearing){const m=a.pinchAround===void 0?a.around:a.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),c.e(d,{noMoveStart:!0})}}function nl(g,t){(!g.duration||g.duration<t.duration)&&(g.duration=t.duration,g.easing=t.easing)}function il(g,t,a){const{maxSpeed:h,linearity:d,deceleration:m}=a,b=c.ac(g*d/(t/1e3),-h,h),T=Math.abs(b)/(m*d);return{easing:a.easing,duration:1e3*T,amount:b*(T/2)}}class an extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,h,d={}){const m=L.mousePos(a.getCanvas(),h),b=a.unproject(m);super(t,c.e({point:m,lngLat:b,originalEvent:h},d)),this._defaultPrevented=!1,this.target=a}}class lo extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,h){const d=t==="touchend"?h.changedTouches:h.touches,m=L.touchPos(a.getCanvasContainer(),d),b=m.map(E=>a.unproject(E)),T=m.reduce((E,I,z,D)=>E.add(I.div(D.length)),new c.P(0,0));super(t,{points:m,point:T,lngLats:b,lngLat:a.unproject(T),originalEvent:h}),this._defaultPrevented=!1}}class gf extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,h){super(t,{originalEvent:h}),this._defaultPrevented=!1}}class yf{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new gf(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new an(t.type,this._map,t))}mouseup(t){this._map.fire(new an(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new an(t.type,this._map,t))}dblclick(t){return this._firePreventable(new an(t.type,this._map,t))}mouseover(t){this._map.fire(new an(t.type,this._map,t))}mouseout(t){this._map.fire(new an(t.type,this._map,t))}touchstart(t){return this._firePreventable(new lo(t.type,this._map,t))}touchmove(t){this._map.fire(new lo(t.type,this._map,t))}touchend(t){this._map.fire(new lo(t.type,this._map,t))}touchcancel(t){this._map.fire(new lo(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Sr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new an(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new an("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new an(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ri{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(c.P.convert(t),this._map.terrain)}}class Xn{constructor(t,a){this._map=t,this._tr=new Ri(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(L.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const h=a;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=h,this._box||(this._box=L.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(d.x,h.x),b=Math.max(d.x,h.x),T=Math.min(d.y,h.y),E=Math.max(d.y,h.y);L.setTransform(this._box,`translate(${m}px,${T}px)`),this._box.style.width=b-m+"px",this._box.style.height=E-T+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const h=this._startPos,d=a;if(this.reset(),L.suppressClick(),h.x!==d.x||h.y!==d.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:t})),{cameraAnimation:m=>m.fitScreenCoordinates(h,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new c.k(t,{originalEvent:a}))}}function sl(g,t){if(g.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${t.length}`);const a={};for(let h=0;h<g.length;h++)a[g[h].identifier]=t[h];return a}class th{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),h.length===this.numTouches&&(this.centroid=function(d){const m=new c.P(0,0);for(const b of d)m._add(b);return m.div(d.length)}(a),this.touches=sl(h,a)))}touchmove(t,a,h){if(this.aborted||!this.centroid)return;const d=sl(h,a);for(const m in this.touches){const b=d[m];(!b||b.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(t,a,h){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class hu{constructor(t){this.singleTap=new th(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,h){this.singleTap.touchstart(t,a,h)}touchmove(t,a,h){this.singleTap.touchmove(t,a,h)}touchend(t,a,h){const d=this.singleTap.touchend(t,a,h);if(d){const m=t.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(d)<30;if(m&&b||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Go{constructor(t){this._tr=new Ri(t),this._zoomIn=new hu({numTouches:1,numTaps:2}),this._zoomOut=new hu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,h){this._zoomIn.touchstart(t,a,h),this._zoomOut.touchstart(t,a,h)}touchmove(t,a,h){this._zoomIn.touchmove(t,a,h),this._zoomOut.touchmove(t,a,h)}touchend(t,a,h){const d=this._zoomIn.touchend(t,a,h),m=this._zoomOut.touchend(t,a,h),b=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(d)},{originalEvent:t})}):m?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(m)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fs{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const h=this._lastPoint;if(!h)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=a.length?a[0]:a;return!this._moved&&d.dist(h)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(h,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&L.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const rh={0:1,2:2};class du{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=L.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(a,h){const d=rh[h];return a.buttons===void 0||(a.buttons&d)!==d}(t,this._eventButton)}isValidEndEvent(t){return L.mouseButton(t)===this._eventButton}}class nh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const fu=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=t=>{t.preventDefault()}},ih=({enable:g,clickTolerance:t,bearingDegreesPerPixelMoved:a=.8})=>{const h=new du({checkCorrectEvent:d=>L.mouseButton(d)===0&&d.ctrlKey||L.mouseButton(d)===2});return new fs({clickTolerance:t,move:(d,m)=>({bearingDelta:(m.x-d.x)*a}),moveStateManager:h,enable:g,assignEvents:fu})},sh=({enable:g,clickTolerance:t,pitchDegreesPerPixelMoved:a=-.5})=>{const h=new du({checkCorrectEvent:d=>L.mouseButton(d)===0&&d.ctrlKey||L.mouseButton(d)===2});return new fs({clickTolerance:t,move:(d,m)=>({pitchDelta:(m.y-d.y)*a}),moveStateManager:h,enable:g,assignEvents:fu})};class uo{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,h){return this._calculateTransform(t,a,h)}touchmove(t,a,h){if(this._active){if(!this._shouldBePrevented(h.length))return t.preventDefault(),this._calculateTransform(t,a,h);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,h){this._calculateTransform(t,a,h),this._active&&this._shouldBePrevented(h.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,h){h.length>0&&(this._active=!0);const d=sl(h,a),m=new c.P(0,0),b=new c.P(0,0);let T=0;for(const I in d){const z=d[I],D=this._touches[I];D&&(m._add(z),b._add(z.sub(D)),T++,d[I]=z)}if(this._touches=d,this._shouldBePrevented(T)||!b.mag())return;const E=b.div(T);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(T),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,h){if(!this._firstTwoTouches)return;t.preventDefault();const[d,m]=this._firstTwoTouches,b=ol(h,a,d),T=ol(h,a,m);if(!b||!T)return;const E=this._aroundCenter?null:b.add(T).div(2);return this._move([b,T],E,t)}touchend(t,a,h){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,b=ol(h,a,d),T=ol(h,a,m);b&&T||(this._active&&L.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ol(g,t,a){for(let h=0;h<g.length;h++)if(g[h].identifier===a)return t[h]}function oh(g,t){return Math.log(g/t)/Math.LN2}class ah extends pu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const h=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(oh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oh(this._distance,h),pinchAround:a}}}function lh(g,t){return 180*g.angleWith(t)/Math.PI}class uh extends pu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,h){const d=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:lh(this._vector,d),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,h=lh(t,this._startVector);return Math.abs(h)<a}}function mu(g){return Math.abs(g.y)>Math.abs(g.x)}class al extends pu{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,h){super.touchstart(t,a,h),this._currentTouchCount=h.length}_start(t){this._lastPoints=t,mu(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,h){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),m=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,h.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,h){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,m=a.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const b=t.y>0==a.y>0;return mu(t)&&mu(a)&&b}}const _f={panStep:100,bearingStep:15,pitchStep:10};class fi{constructor(t){this._tr=new Ri(t);const a=_f;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,h=0,d=0,m=0,b=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?h=-1:(t.preventDefault(),m=-1);break;case 39:t.shiftKey?h=1:(t.preventDefault(),m=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),b=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(h=0,d=0),{cameraAnimation:T=>{const E=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:es,zoom:a?Math.round(E.zoom)+a*(t.shiftKey?2:1):E.zoom,bearing:E.bearing+h*this._bearingStep,pitch:E.pitch+d*this._pitchStep,offset:[-m*this._panStep,-b*this._panStep],center:E.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function es(g){return g*(2-g)}const ch=4.000244140625;class Li{constructor(t,a){this._onTimeout=h=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},this._map=t,this._tr=new Ri(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const h=R.now(),d=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,a!==0&&a%ch==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=L.mousePos(this._map.getCanvas(),t),h=this._tr;this._around=a.y>h.transform.height/2-h.transform.getHorizon()?c.N.convert(this._aroundCenter?h.center:h.unproject(a)):c.N.convert(h.center),this._aroundPoint=h.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>ch?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&I!==0&&(I=1/I);const z=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(z*I))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,h=this._startZoom,d=this._easing;let m,b=!1;const T=R.now()-this._lastWheelEventTime;if(this._type==="wheel"&&h&&d&&T){const E=Math.min(T/200,1),I=d(E);m=c.y.number(h,a,I),E<1?this._frameId||(this._frameId=!0):b=!0}else m=a,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:m-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=c.b9;if(this._prevEase){const h=this._prevEase,d=(R.now()-h.start)/h.duration,m=h.easing(d+.01)-h.easing(d),b=.27/Math.sqrt(m*m+1e-4)*.01,T=Math.sqrt(.0729-b*b);a=c.b8(b,T,.25,1)}return this._prevEase={start:R.now(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class co{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ag{constructor(t){this._tr=new Ri(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lg{constructor(){this._tap=new hu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,h){if(!this._swipePoint)if(this._tapTime){const d=a[0],m=t.timeStamp-this._tapTime<500,b=this._tapPoint.dist(d)<30;m&&b?h.length>0&&(this._swipePoint=d,this._swipeTouch=h[0].identifier):this.reset()}else this._tap.touchstart(t,a,h)}touchmove(t,a,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const d=a[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(t,a,h)}touchend(t,a,h){if(this._tapTime)this._swipePoint&&h.length===0&&this.reset();else{const d=this._tap.touchend(t,a,h);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vf{constructor(t,a,h){this._el=t,this._mousePan=a,this._touchPan=h}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xf{constructor(t,a,h){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class hh{constructor(t,a,h,d){this._el=t,this._touchZoom=a,this._touchRotate=h,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Wo{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=L.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const h=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=h,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(L.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const pi=g=>g.zoom||g.drag||g.pitch||g.rotate;class nt extends c.k{}function gu(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class dh{constructor(t,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=d.type==="renderFrame"?void 0:d,T={needsRenderFrame:!1},E={},I={},z=d.touches,D=z?this._getMapTouches(z):void 0,V=D?L.touchPos(this._map.getCanvas(),D):L.mousePos(this._map.getCanvas(),d);for(const{handlerName:ne,handler:ae,allowed:ce}of this._handlers){if(!ae.isEnabled())continue;let fe;this._blockedByActive(I,ce,ne)?ae.reset():ae[m||d.type]&&(fe=ae[m||d.type](d,V,D),this.mergeHandlerResult(T,E,fe,ne,b),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||ae.isActive())&&(I[ne]=ae)}const H={};for(const ne in this._previousActiveHandlers)I[ne]||(H[ne]=b);this._previousActiveHandlers=I,(Object.keys(H).length||gu(T))&&(this._changes.push([T,E,H]),this._triggerRenderFrame()),(Object.keys(I).length||gu(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=T;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new eh(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,b]of this._listeners)L.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[t,a,h]of this._listeners)L.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(t){const a=this._map,h=a.getCanvasContainer();this._add("mapEvent",new yf(a,t));const d=a.boxZoom=new Xn(a,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const m=a.cooperativeGestures=new Wo(a,t.cooperativeGestures);this._add("cooperativeGestures",m),t.cooperativeGestures&&m.enable();const b=new Go(a),T=new ag(a);a.doubleClickZoom=new co(T,b),this._add("tapZoom",b),this._add("clickZoom",T),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const E=new lg;this._add("tapDragZoom",E);const I=a.touchPitch=new al(a);this._add("touchPitch",I),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const z=ih(t),D=sh(t);a.dragRotate=new xf(t,z,D),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const V=(({enable:fe,clickTolerance:te})=>{const ge=new du({checkCorrectEvent:_e=>L.mouseButton(_e)===0&&!_e.ctrlKey});return new fs({clickTolerance:te,move:(_e,we)=>({around:we,panDelta:we.sub(_e)}),activateOnStart:!0,moveStateManager:ge,enable:fe,assignEvents:fu})})(t),H=new uo(t,a);a.dragPan=new vf(h,V,H),this._add("mousePan",V),this._add("touchPan",H,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const Y=new uh,ne=new ah;a.touchZoomRotate=new hh(h,ne,Y,E),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",ne,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate);const ae=a.scrollZoom=new Li(a,()=>this._triggerRenderFrame());this._add("scrollZoom",ae,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const ce=a.keyboard=new fi(a);this._add("keyboard",ce),t.interactive&&t.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new Sr(a))}_add(t,a,h){this._handlers.push({handlerName:t,handler:a,allowed:h}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pi(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,h){for(const d in t)if(d!==h&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const h of t)this._el.contains(h.target)&&a.push(h);return a}mergeHandlerResult(t,a,h,d,m){if(!h)return;c.e(t,h);const b={handlerName:d,originalEvent:h.originalEvent||m};h.zoomDelta!==void 0&&(a.zoom=b),h.panDelta!==void 0&&(a.drag=b),h.pitchDelta!==void 0&&(a.pitch=b),h.bearingDelta!==void 0&&(a.rotate=b)}_applyChanges(){const t={},a={},h={};for(const[d,m,b]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),c.e(a,m),c.e(h,b);this._updateMapTransform(t,a,h),this._changes=[]}_updateMapTransform(t,a,h){const d=this._map,m=d._getTransformForUpdate(),b=d.terrain;if(!(gu(t)||b&&this._terrainMovement))return this._fireEvents(a,h,!0);let{panDelta:T,zoomDelta:E,bearingDelta:I,pitchDelta:z,around:D,pinchAround:V}=t;V!==void 0&&(D=V),d._stop(!0),D=D||d.transform.centerPoint;const H=m.pointLocation(T?D.sub(T):D);I&&(m.bearing+=I),z&&(m.pitch+=z),E&&(m.zoom+=E),b?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(T)):m.setLocationAtPoint(H,D):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(H,D)):m.setLocationAtPoint(H,D),d._applyUpdatedTransform(m),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,h,!0)}_fireEvents(t,a,h){const d=pi(this._eventsInProgress),m=pi(t),b={};for(const D in t){const{originalEvent:V}=t[D];this._eventsInProgress[D]||(b[`${D}start`]=V),this._eventsInProgress[D]=t[D]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const D in b)this._fireEvent(D,b[D]);m&&this._fireEvent("move",m.originalEvent);for(const D in t){const{originalEvent:V}=t[D];this._fireEvent(D,V)}const T={};let E;for(const D in this._eventsInProgress){const{handlerName:V,originalEvent:H}=this._eventsInProgress[D];this._handlersById[V].isActive()||(delete this._eventsInProgress[D],E=a[V]||H,T[`${D}end`]=E)}for(const D in T)this._fireEvent(D,T[D]);const I=pi(this._eventsInProgress),z=(d||m)&&!I;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const D=this._map._getTransformForUpdate();D.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(D)}if(h&&z){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!D||!D.essential&&R.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:E})),V(this._map.getBearing())&&this._map.resetNorth()):(V(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new c.k(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new nt("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class wf extends c.E{constructor(t,a){super(),this._renderFrameCallback=()=>{const h=Math.min((R.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,h){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},a),h)}panTo(t,a,h){return this.easeTo(c.e({center:t},a),h)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,h){return this.easeTo(c.e({zoom:t},a),h)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,h){return this.easeTo(c.e({bearing:t},a),h)}resetNorth(t,a){return this.rotateTo(0,c.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){t=Te.convert(t).adjustAntiMeridian();const h=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),h,a)}_cameraForBoxAndBearing(t,a,h,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=c.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const Ze=d.padding;d.padding={top:Ze,bottom:Ze,right:Ze,left:Ze}}d.padding=c.e(m,d.padding);const b=this.transform,T=b.padding,E=new Te(t,a),I=b.project(E.getNorthWest()),z=b.project(E.getNorthEast()),D=b.project(E.getSouthEast()),V=b.project(E.getSouthWest()),H=c.ba(-h),Y=I.rotate(H),ne=z.rotate(H),ae=D.rotate(H),ce=V.rotate(H),fe=new c.P(Math.max(Y.x,ne.x,ce.x,ae.x),Math.max(Y.y,ne.y,ce.y,ae.y)),te=new c.P(Math.min(Y.x,ne.x,ce.x,ae.x),Math.min(Y.y,ne.y,ce.y,ae.y)),ge=fe.sub(te),_e=(b.width-(T.left+T.right+d.padding.left+d.padding.right))/ge.x,we=(b.height-(T.top+T.bottom+d.padding.top+d.padding.bottom))/ge.y;if(we<0||_e<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Me=Math.min(b.scaleZoom(b.scale*Math.min(_e,we)),d.maxZoom),Oe=c.P.convert(d.offset),Xe=new c.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c.ba(h)),tt=Oe.add(Xe).mult(b.scale/b.zoomScale(Me));return{center:b.unproject(I.add(D).div(2).sub(tt)),zoom:Me,bearing:h}}fitBounds(t,a,h){return this._fitInternal(this.cameraForBounds(t,a),a,h)}fitScreenCoordinates(t,a,h,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(t)),this.transform.pointLocation(c.P.convert(a)),h,d),d,m)}_fitInternal(t,a,h){return t?(delete(a=c.e(t,a)).padding,a.linear?this.easeTo(a,h):this.flyTo(a,h)):this}jumpTo(t,a){this.stop();const h=this._getTransformForUpdate();let d=!1,m=!1,b=!1;return"zoom"in t&&h.zoom!==+t.zoom&&(d=!0,h.zoom=+t.zoom),t.center!==void 0&&(h.center=c.N.convert(t.center)),"bearing"in t&&h.bearing!==+t.bearing&&(m=!0,h.bearing=+t.bearing),"pitch"in t&&h.pitch!==+t.pitch&&(b=!0,h.pitch=+t.pitch),t.padding==null||h.isPaddingEqual(t.padding)||(h.padding=t.padding),this._applyUpdatedTransform(h),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),d&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),m&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),b&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(t,a,h,d=0){const m=c.Z.fromLngLat(t,a),b=c.Z.fromLngLat(h,d),T=b.x-m.x,E=b.y-m.y,I=b.z-m.z,z=Math.hypot(T,E,I);if(z===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(T,E),V=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),H=180*Math.atan2(T,-E)/Math.PI;let Y=180*Math.acos(D/z)/Math.PI;return Y=I<0?90-Y:90+Y,{center:b.toLngLat(),zoom:V,pitch:Y,bearing:H}}easeTo(t,a){var h;this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.b9},t)).animate===!1||!t.essential&&R.prefersReducedMotion)&&(t.duration=0);const d=this._getTransformForUpdate(),m=d.zoom,b=d.bearing,T=d.pitch,E=d.padding,I="bearing"in t?this._normalizeBearing(t.bearing,b):b,z="pitch"in t?+t.pitch:T,D="padding"in t?t.padding:d.padding,V=c.P.convert(t.offset);let H=d.centerPoint.add(V);const Y=d.pointLocation(H),{center:ne,zoom:ae}=d.getConstrained(c.N.convert(t.center||Y),(h=t.zoom)!==null&&h!==void 0?h:m);this._normalizeCenter(ne,d);const ce=d.project(Y),fe=d.project(ne).sub(ce),te=d.zoomScale(ae-m);let ge,_e;t.around&&(ge=c.N.convert(t.around),_e=d.locationPoint(ge));const we={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ae!==m,this._rotating=this._rotating||b!==I,this._pitching=this._pitching||z!==T,this._padding=!d.isPaddingEqual(D),this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,we),this.terrain&&this._prepareElevation(ne),this._ease(Me=>{if(this._zooming&&(d.zoom=c.y.number(m,ae,Me)),this._rotating&&(d.bearing=c.y.number(b,I,Me)),this._pitching&&(d.pitch=c.y.number(T,z,Me)),this._padding&&(d.interpolatePadding(E,D,Me),H=d.centerPoint.add(V)),this.terrain&&!t.freezeElevation&&this._updateElevation(Me),ge)d.setLocationAtPoint(ge,_e);else{const Oe=d.zoomScale(d.zoom-m),Xe=ae>m?Math.min(2,te):Math.max(.5,te),tt=Math.pow(Xe,1-Me),Ze=d.unproject(ce.add(fe.mult(Me*tt)).mult(Oe));d.setLocationAtPoint(d.renderWorldCopies?Ze.wrap():Ze,H)}this._applyUpdatedTransform(d),this._fireMoveEvents(a)},Me=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,Me)},t),this}_prepareEase(t,a,h={}){this._moving=!0,a||h.moving||this.fire(new c.k("movestart",t)),this._zooming&&!h.zooming&&this.fire(new c.k("zoomstart",t)),this._rotating&&!h.rotating&&this.fire(new c.k("rotatestart",t)),this._pitching&&!h.pitching&&this.fire(new c.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const h=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(h-(a-(h*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){const a=t.getCameraPosition(),h=this.terrain.getElevationForLngLatZoom(a.lngLat,t.zoom);if(a.altitude<h){const d=this.calculateCameraOptionsFromTo(a.lngLat,h,t.center,t.elevation);return{pitch:d.pitch,zoom:d.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(this.terrain&&a.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&a.push(d=>this.transformCameraUpdate(d)),!a.length)return;const h=t.clone();for(const d of a){const m=h.clone(),{center:b,zoom:T,pitch:E,bearing:I,elevation:z}=d(m);b&&(m.center=b),T!==void 0&&(m.zoom=T),E!==void 0&&(m.pitch=E),I!==void 0&&(m.bearing=I),z!==void 0&&(m.elevation=z),h.apply(m)}this.transform.apply(h)}_fireMoveEvents(t){this.fire(new c.k("move",t)),this._zooming&&this.fire(new c.k("zoom",t)),this._rotating&&this.fire(new c.k("rotate",t)),this._pitching&&this.fire(new c.k("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const h=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new c.k("zoomend",t)),d&&this.fire(new c.k("rotateend",t)),m&&this.fire(new c.k("pitchend",t)),this.fire(new c.k("moveend",t))}flyTo(t,a){var h;if(!t.essential&&R.prefersReducedMotion){const Je=c.M(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Je,a)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},t);const d=this._getTransformForUpdate(),m=d.zoom,b=d.bearing,T=d.pitch,E=d.padding,I="bearing"in t?this._normalizeBearing(t.bearing,b):b,z="pitch"in t?+t.pitch:T,D="padding"in t?t.padding:d.padding,V=c.P.convert(t.offset);let H=d.centerPoint.add(V);const Y=d.pointLocation(H),{center:ne,zoom:ae}=d.getConstrained(c.N.convert(t.center||Y),(h=t.zoom)!==null&&h!==void 0?h:m);this._normalizeCenter(ne,d);const ce=d.zoomScale(ae-m),fe=d.project(Y),te=d.project(ne).sub(fe);let ge=t.curve;const _e=Math.max(d.width,d.height),we=_e/ce,Me=te.mag();if("minZoom"in t){const Je=c.ac(Math.min(t.minZoom,m,ae),d.minZoom,d.maxZoom),St=_e/d.zoomScale(Je-m);ge=Math.sqrt(St/Me*2)}const Oe=ge*ge;function Xe(Je){const St=(we*we-_e*_e+(Je?-1:1)*Oe*Oe*Me*Me)/(2*(Je?we:_e)*Oe*Me);return Math.log(Math.sqrt(St*St+1)-St)}function tt(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function Ze(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const Ue=Xe(!1);let lt=function(Je){return Ze(Ue)/Ze(Ue+ge*Je)},Et=function(Je){return _e*((Ze(Ue)*(tt(St=Ue+ge*Je)/Ze(St))-tt(Ue))/Oe)/Me;var St},Ge=(Xe(!0)-Ue)/ge;if(Math.abs(Me)<1e-6||!isFinite(Ge)){if(Math.abs(_e-we)<1e-6)return this.easeTo(t,a);const Je=we<_e?-1:1;Ge=Math.abs(Math.log(we/_e))/ge,Et=()=>0,lt=St=>Math.exp(Je*ge*St)}return t.duration="duration"in t?+t.duration:1e3*Ge/("screenSpeed"in t?+t.screenSpeed/ge:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=b!==I,this._pitching=z!==T,this._padding=!d.isPaddingEqual(D),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ne),this._ease(Je=>{const St=Je*Ge,cr=1/lt(St);d.zoom=Je===1?ae:m+d.scaleZoom(cr),this._rotating&&(d.bearing=c.y.number(b,I,Je)),this._pitching&&(d.pitch=c.y.number(T,z,Je)),this._padding&&(d.interpolatePadding(E,D,Je),H=d.centerPoint.add(V)),this.terrain&&!t.freezeElevation&&this._updateElevation(Je);const Dt=Je===1?ne:d.unproject(fe.add(te.mult(Et(St))).mult(cr));d.setLocationAtPoint(d.renderWorldCopies?Dt.wrap():Dt,H),this._applyUpdatedTransform(d),this._fireMoveEvents(a)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var h;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,a)}return t||(h=this.handlers)===null||h===void 0||h.stop(!1),this}_ease(t,a,h){h.animate===!1||h.duration===0?(t(1),a()):(this._easeStart=R.now(),this._easeOptions=h,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=c.b3(t,-180,180);const h=Math.abs(t-a);return Math.abs(t-360-a)<h&&(t-=360),Math.abs(t+360-a)<h&&(t+=360),t}_normalizeCenter(t,a){if(!a.renderWorldCopies||a.lngRange)return;const h=t.lng-a.center.lng;t.lng+=h>180?-360:h<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const Xo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ko{constructor(t=Xo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=L.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=L.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const h=this._map._getUIString(`AttributionControl.${a}`);t.title=h,t.setAttribute("aria-label",h)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.sourceCaches;for(const d in a){const m=a[d];if(m.used||m.usedForTerrain){const b=m.getSource();b.attribution&&t.indexOf(b.attribution)<0&&t.push(b.attribution)}}t=t.filter(d=>String(d).trim()),t.sort((d,m)=>d.length-m.length),t=t.filter((d,m)=>{for(let b=m+1;b<t.length;b++)if(t[b].indexOf(d)>=0)return!1;return!0});const h=t.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,t.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class fh{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const h=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact"):h.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=L.create("div","maplibregl-ctrl");const a=L.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){L.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Vt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,h=a?this._queue.concat(a):this._queue;for(const d of h)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const h of a)if(!h.cancelled&&(h.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ph=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class ug extends c.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,a){this.sourceCache.update(t,a),this._renderableTilesKeys=[];const h={};for(const d of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))h[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),c.aP(d.posMatrix,0,c.X,0,c.X,0,1),this._tiles[d.key]=new Ai(d,this.tileSize));for(const d in this._tiles)h[d]||delete this._tiles[d]}freeRtt(t){for(const a in this._tiles){const h=this._tiles[a];(!t||h.tileID.equals(t)||h.tileID.isChildOf(t)||t.isChildOf(h.tileID))&&(h.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const a={};for(const h of this._renderableTilesKeys){const d=this._tiles[h].tileID;if(d.canonical.equals(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16),c.aP(m.posMatrix,0,c.X,0,c.X,0,1),a[h]=m}else if(d.canonical.isChildOf(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const b=d.canonical.z-t.canonical.z,T=d.canonical.x-(d.canonical.x>>b<<b),E=d.canonical.y-(d.canonical.y>>b<<b),I=c.X>>b;c.aP(m.posMatrix,0,I,0,I,0,1),c.J(m.posMatrix,m.posMatrix,[-T*I,-E*I,0]),a[h]=m}else if(t.canonical.isChildOf(d.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const b=t.canonical.z-d.canonical.z,T=t.canonical.x-(t.canonical.x>>b<<b),E=t.canonical.y-(t.canonical.y>>b<<b),I=c.X>>b;c.aP(m.posMatrix,0,c.X,0,c.X,0,1),c.J(m.posMatrix,m.posMatrix,[T*I,E*I,0]),c.K(m.posMatrix,m.posMatrix,[1/2**b,1/2**b,0]),a[h]=m}}return a}getSourceTile(t,a){const h=this.sourceCache._source;let d=t.overscaledZ-this.deltaZoom;if(d>h.maxzoom&&(d=h.maxzoom),d<h.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!m||!m.dem)&&a)for(;d>=h.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(t.scaledTo(d--).key);return m}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=t)}}class mh{constructor(t,a,h){this.painter=t,this.sourceCache=new ug(a),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,h,d=c.X){var m;if(!(a>=0&&a<d&&h>=0&&h<d))return 0;const b=this.getTerrainData(t),T=(m=b.tile)===null||m===void 0?void 0:m.dem;if(!T)return 0;const E=function(Y,ne,ae){var ce=ne[0],fe=ne[1];return Y[0]=ae[0]*ce+ae[4]*fe+ae[12],Y[1]=ae[1]*ce+ae[5]*fe+ae[13],Y}([],[a/d*c.X,h/d*c.X],b.u_terrain_matrix),I=[E[0]*T.dim,E[1]*T.dim],z=Math.floor(I[0]),D=Math.floor(I[1]),V=I[0]-z,H=I[1]-D;return T.get(z,D)*(1-V)*(1-H)+T.get(z+1,D)*V*(1-H)+T.get(z,D+1)*(1-V)*H+T.get(z+1,D+1)*V*H}getElevationForLngLatZoom(t,a){if(!c.bb(a,t.wrap()))return 0;const{tileID:h,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(h,d%c.X,m%c.X,c.X)}getElevation(t,a,h,d=c.X){return this.getDEMElevation(t,a,h,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,m=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new qe(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new qe(d,new c.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new qe(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const h=a&&a+a.tileID.key+t.key;if(h&&!this._demMatrixCache[h]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?m=t.canonical.z-d:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=t.canonical.x-(t.canonical.x>>m<<m),T=t.canonical.y-(t.canonical.y>>m<<m),E=c.bc(new Float64Array(16),[1/(c.X<<m),1/(c.X<<m),0]);c.J(E,E,[b*c.X,T*c.X,0]),this._demMatrixCache[t.key]={matrix:E,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,h=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new qe(a.context,{width:h,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new qe(a.context,{width:h,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(h,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,h,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,b=0;m<this._coordsTextureSize;m++)for(let T=0;T<this._coordsTextureSize;T++,b+=4)a[b+0]=255&T,a[b+1]=255&m,a[b+2]=T>>8<<4|m>>8,a[b+3]=0;const h=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new qe(t,h,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),h=this.painter.context,d=h.gl,m=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(m,T-b-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),h.bindFramebuffer.set(null);const E=a[0]+(a[2]>>4<<8),I=a[1]+((15&a[2])<<8),z=this.coordsIndex[255-a[3]],D=z&&this.sourceCache.getTileByID(z);if(!D)return null;const V=this._coordsTextureSize,H=(1<<D.tileID.canonical.z)*V;return new c.Z((D.tileID.canonical.x*V+E)/H+D.tileID.wrap,(D.tileID.canonical.y*V+I)/H,this.getElevation(D.tileID,E,I,V))}depthAtPoint(t){const a=new Uint8Array(4),h=this.painter.context,d=h.gl;return h.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),h.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,a=new c.bd,h=new c.aY,d=this.meshSize,m=c.X/d,b=d*d;for(let D=0;D<=d;D++)for(let V=0;V<=d;V++)a.emplaceBack(V*m,D*m,0);for(let D=0;D<b;D+=d+1)for(let V=0;V<d;V++)h.emplaceBack(V+D,d+V+D+1,d+V+D+2),h.emplaceBack(V+D,d+V+D+2,V+D+1);const T=a.length,E=T+2*(d+1);for(const D of[0,1])for(let V=0;V<=d;V++)for(const H of[0,1])a.emplaceBack(V*m,D*c.X,H);for(let D=0;D<2*d;D+=2)h.emplaceBack(E+D,E+D+1,E+D+3),h.emplaceBack(E+D,E+D+3,E+D+2),h.emplaceBack(T+D,T+D+3,T+D+1),h.emplaceBack(T+D,T+D+2,T+D+3);const I=a.length,z=I+2*(d+1);for(const D of[0,1])for(let V=0;V<=d;V++)for(const H of[0,1])a.emplaceBack(D*c.X,V*m,H);for(let D=0;D<2*d;D+=2)h.emplaceBack(I+D,I+D+1,I+D+3),h.emplaceBack(I+D,I+D+3,I+D+2),h.emplaceBack(z+D,z+D+3,z+D+1),h.emplaceBack(z+D,z+D+2,z+D+3);return this._mesh=new ou(t.createVertexBuffer(a,ph.members),t.createIndexBuffer(h),c.a0.simpleSegment(0,0,a.length,h.length)),this._mesh}getMeshFrameDelta(t){return 2*Math.PI*c.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,a){var h;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(h=this.getMinMaxElevation(d).minElevation)!==null&&h!==void 0?h:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,h={minElevation:null,maxElevation:null};return a&&a.dem&&(h.minElevation=a.dem.min*this.exaggeration,h.maxElevation=a.dem.max*this.exaggeration),h}_getOverscaledTileIDFromLngLatZoom(t,a){const h=c.Z.fromLngLat(t.wrap()),d=(1<<a)*c.X,m=h.x*d,b=h.y*d,T=Math.floor(m/c.X),E=Math.floor(b/c.X);return{tileID:new c.S(a,0,a,T,E),mercatorX:m,mercatorY:b}}}class cg{constructor(t,a,h){this._context=t,this._size=a,this._tileSize=h,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),h=new qe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return h.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(h.texture),{id:t,fbo:a,texture:h,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>t.id!==a),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Yo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class bf{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new cg(t.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(h=>!t._layers[h].isHidden(a)),this._coordsDescendingInv={};for(const h in t.sourceCaches){this._coordsDescendingInv[h]={};const d=t.sourceCaches[h].getVisibleCoordinates();for(const m of d){const b=this.terrain.sourceCache.getTerrainCoords(m);for(const T in b)this._coordsDescendingInv[h][T]||(this._coordsDescendingInv[h][T]=[]),this._coordsDescendingInv[h][T].push(b[T])}}this._coordsDescendingInvStr={};for(const h of t._order){const d=t._layers[h],m=d.source;if(Yo[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const b in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][b]=this._coordsDescendingInv[m][b].map(T=>T.key).sort().join()}}for(const h of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][h.tileID.key];m&&m!==h.rttCoords[d]&&(h.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const a=t.type,h=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Yo[a]&&(this._prevType&&Yo[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(t.id),!d))return!0;if(Yo[this._prevType]||Yo[a]&&d){this._prevType=a;const m=this._stacks.length-1,b=this._stacks[m]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(pf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[m]){const I=this.pool.getObjectForId(T.rtt[m].id);if(I.stamp===T.rtt[m].stamp){this.pool.useObject(I);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),T.rtt[m]={id:E.id,stamp:E.stamp},h.context.bindFramebuffer.set(E.fbo.framebuffer),h.context.clear({color:c.aM.transparent,stencil:0}),h.currentStencilSource=void 0;for(let I=0;I<b.length;I++){const z=h.style._layers[b[I]],D=z.source?this._coordsDescendingInv[z.source][T.tileID.key]:[T.tileID];h.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),h._renderTileClippingMasks(z,D),h.renderLayer(h,h.style.sourceCaches[z.source],z,D),z.source&&(T.rttCoords[z.source]=this._coordsDescendingInvStr[z.source][T.tileID.key])}}return pf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Yo[a]}return!1}}const gh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Sf=k,hg={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Xo,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},yh=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},dg={showCompass:!0,showZoom:!0,visualizePitch:!1};class fg{constructor(t,a,h=!1){this.mousedown=b=>{this.startMouse(c.e({},b,{ctrlKey:!0,preventDefault:()=>b.preventDefault()}),L.mousePos(this.element,b)),L.addEventListener(window,"mousemove",this.mousemove),L.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.moveMouse(b,L.mousePos(this.element,b))},this.mouseup=b=>{this.mouseRotate.dragEnd(b),this.mousePitch&&this.mousePitch.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,b.targetTouches)[0],this.startTouch(b,this._startPos),L.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,b.targetTouches)[0],this.moveTouch(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=t.dragRotate._mouseRotate.getClickTolerance(),m=t.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=ih({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:b,clickTolerance:T,bearingDegreesPerPixelMoved:E=.8})=>{const I=new nh;return new fs({clickTolerance:T,move:(z,D)=>({bearingDelta:(D.x-z.x)*E}),moveStateManager:I,enable:b,assignEvents:yh})})({clickTolerance:d,enable:!0}),this.map=t,h&&(this.mousePitch=sh({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:b,clickTolerance:T,pitchDegreesPerPixelMoved:E=-.5})=>{const I=new nh;return new fs({clickTolerance:T,move:(z,D)=>({pitchDelta:(D.y-z.y)*E}),moveStateManager:I,enable:b,assignEvents:yh})})({clickTolerance:m,enable:!0})),L.addEventListener(a,"mousedown",this.mousedown),L.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(a,"touchcancel",this.reset)}startMouse(t,a){this.mouseRotate.dragStart(t,a),this.mousePitch&&this.mousePitch.dragStart(t,a),L.disableDrag()}startTouch(t,a){this.touchRotate.dragStart(t,a),this.touchPitch&&this.touchPitch.dragStart(t,a),L.disableDrag()}moveMouse(t,a){const h=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(t,a)||{};if(d&&h.setBearing(h.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(t,a)||{};m&&h.setPitch(h.getPitch()+m)}}moveTouch(t,a){const h=this.map,{bearingDelta:d}=this.touchRotate.dragMove(t,a)||{};if(d&&h.setBearing(h.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(t,a)||{};m&&h.setPitch(h.getPitch()+m)}}off(){const t=this.element;L.removeEventListener(t,"mousedown",this.mousedown),L.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend),L.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){L.enableDrag(),L.removeEventListener(window,"mousemove",this.mousemove),L.removeEventListener(window,"mouseup",this.mouseup),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend)}}let Kn;function ur(g,t,a){const h=new c.N(g.lng,g.lat);if(g=new c.N(g.lng,g.lat),t){const d=new c.N(g.lng-360,g.lat),m=new c.N(g.lng+360,g.lat),b=a.locationPoint(g).distSqr(t);a.locationPoint(d).distSqr(t)<b?g=d:a.locationPoint(m).distSqr(t)<b&&(g=m)}for(;Math.abs(g.lng-a.center.lng)>180;){const d=a.locationPoint(g);if(d.x>=0&&d.y>=0&&d.x<=a.width&&d.y<=a.height)break;g.lng>a.center.lng?g.lng-=360:g.lng+=360}return g.lng!==h.lng&&a.locationPoint(g).y>a.height/2-a.getHorizon()?g:h}const Jo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yu(g,t,a){const h=g.classList;for(const d in Jo)h.remove(`maplibregl-${a}-anchor-${d}`);h.add(`maplibregl-${a}-anchor-${t}`)}class _u extends c.E{constructor(t){if(super(),this._onKeyPress=a=>{const h=a.code,d=a.charCode||a.keyCode;h!=="Space"&&h!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const h=a.originalEvent.target,d=this._element;this._popup&&(h===d||d.contains(h))&&this.togglePopup()},this._update=a=>{var h;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ur(this._lngLat,this._flatPos,this._map.transform):(h=this._lngLat)===null||h===void 0?void 0:h.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,`${Jo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${m}`),R.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div");const a=L.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${h}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const m=L.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const b=L.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const T=L.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of E){const fe=L.createNS("http://www.w3.org/2000/svg","ellipse");fe.setAttributeNS(null,"opacity","0.04"),fe.setAttributeNS(null,"cx","10.5"),fe.setAttributeNS(null,"cy","5.80029008"),fe.setAttributeNS(null,"rx",ce.rx),fe.setAttributeNS(null,"ry",ce.ry),T.appendChild(fe)}const I=L.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill",this._color);const z=L.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),I.appendChild(z);const D=L.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"opacity","0.25"),D.setAttributeNS(null,"fill","#000000");const V=L.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),D.appendChild(V);const H=L.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const Y=L.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ne=L.createNS("http://www.w3.org/2000/svg","circle");ne.setAttributeNS(null,"fill","#000000"),ne.setAttributeNS(null,"opacity","0.25"),ne.setAttributeNS(null,"cx","5.5"),ne.setAttributeNS(null,"cy","5.5"),ne.setAttributeNS(null,"r","5.4999962");const ae=L.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),Y.appendChild(ne),Y.appendChild(ae),b.appendChild(T),b.appendChild(I),b.appendChild(D),b.appendChild(H),b.appendChild(Y),a.appendChild(b),a.setAttributeNS(null,"height",h*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),yu(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,h;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,m=d.terrain.depthAtPoint(this._pos),b=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,b)-m<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/d.transform._pixelPerMeter,E=Math.sin(d.getPitch()*Math.PI/180)*T,I=d.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),z=d.transform.lngLatToCameraDepth(this._lngLat,b+E)-I>.006;!((h=this._popup)===null||h===void 0)&&h.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return t===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Tf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ll=0,ul=!1;const ts={maxWidth:100,unit:"metric"};function cl(g,t,a){const h=a&&a.maxWidth||100,d=g._container.clientHeight/2,m=g.unproject([0,d]),b=g.unproject([h,d]),T=m.distanceTo(b);if(a&&a.unit==="imperial"){const E=3.2808*T;E>5280?at(t,h,E/5280,g._getUIString("ScaleControl.Miles")):at(t,h,E,g._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?at(t,h,T/1852,g._getUIString("ScaleControl.NauticalMiles")):T>=1e3?at(t,h,T/1e3,g._getUIString("ScaleControl.Kilometers")):at(t,h,T,g._getUIString("ScaleControl.Meters"))}function at(g,t,a,h){const d=function(m){const b=Math.pow(10,`${Math.floor(m)}`.length-1);let T=m/b;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(E){const I=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*I)/I}(T),b*T}(a);g.style.width=t*(d/a)+"px",g.innerHTML=`${d}&nbsp;${h}`}const _t={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},vu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xu(g){if(g){if(typeof g=="number"){const t=Math.round(Math.abs(g)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,g),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-g),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(g,0),right:new c.P(-g,0)}}if(g instanceof c.P||Array.isArray(g)){const t=c.P.convert(g);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(g.center||[0,0]),top:c.P.convert(g.top||[0,0]),"top-left":c.P.convert(g["top-left"]||[0,0]),"top-right":c.P.convert(g["top-right"]||[0,0]),bottom:c.P.convert(g.bottom||[0,0]),"bottom-left":c.P.convert(g["bottom-left"]||[0,0]),"bottom-right":c.P.convert(g["bottom-right"]||[0,0]),left:c.P.convert(g.left||[0,0]),right:c.P.convert(g.right||[0,0])}}return xu(new c.P(0,0))}const _h=k;v.AJAXError=c.bh,v.Evented=c.E,v.LngLat=c.N,v.MercatorCoordinate=c.Z,v.Point=c.P,v.addProtocol=c.bi,v.config=c.a,v.removeProtocol=c.bj,v.AttributionControl=Ko,v.BoxZoomHandler=Xn,v.CanvasSource=Pn,v.CooperativeGesturesHandler=Wo,v.DoubleClickZoomHandler=co,v.DragPanHandler=vf,v.DragRotateHandler=xf,v.EdgeInsets=Zo,v.FullscreenControl=class extends c.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a==null?void 0:a.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){L.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=L.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);L.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=Pi,v.GeolocateControl=class extends c.E{constructor(g){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new c.N(t.coords.longitude,t.coords.latitude),h=t.coords.accuracy,d=this._map.getBearing(),m=c.e({bearing:d},this.options.fitBoundsOptions),b=Te.fromLngLat(a,h);this._map.fitBounds(b,m,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new c.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&ul)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=L.create("button","maplibregl-ctrl-geolocate",this._container),L.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new _u({element:this._dotElement}),this._circleElement=L.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _u({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Tf,g)}onAdd(g){return this._map=g,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(t=!1){if(Kn!==void 0&&!t)return Kn;if(window.navigator.permissions===void 0)return Kn=!!window.navigator.geolocation,Kn;try{Kn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Kn=!!window.navigator.geolocation}return Kn})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ll=0,ul=!1}_isOutOfMapMaxBounds(g){const t=this._map.getMaxBounds(),a=g.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),t=g.getSouthEast(),a=g.getNorthEast(),h=t.distanceTo(a),d=Math.ceil(this._accuracy/(h/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ll--,ul=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ll++,ll>1?(g={maximumAge:6e5,timeout:0},ul=!0):(g=this.options.positionOptions,ul=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.Hash=lu,v.ImageSource=Kr,v.KeyboardHandler=fi,v.LngLatBounds=Te,v.LogoControl=fh,v.Map=class extends wf{constructor(g){c.bf.mark(c.bg.create);const t=Object.assign(Object.assign({},hg),g);if(t.minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(t.minPitch!=null&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(t.maxPitch!=null&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ho(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Vt,this._controls=[],this._mapId=c.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=t.preserveDrawingBuffer===!0,this._antialias=t.antialias===!0,this._trackResize=t.trackResize===!0,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles===!0,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions===!0,this._collectResourceTiming=t.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},gh),t.locale),this._clickTolerance=t.clickTolerance,this._overridePixelRatio=t.pixelRatio,this._maxCanvasSize=t.maxCanvasSize,this.transformCameraUpdate=t.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=t.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=K.addThrottleControl(()=>this.isMoving()),this._requestManager=new he(t.transformRequest),typeof t.container=="string"){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const h=rl(d=>{this._trackResize&&!this._removed&&(this.resize(d),this.redraw())},50);this._resizeObserver=new ResizeObserver(d=>{a?h(d):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new dh(this,t),this._hash=t.hash&&new lu(typeof t.hash=="string"&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,c.e({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new Ko(typeof t.attributionControl=="boolean"?void 0:t.attributionControl)),t.maplibreLogo&&this.addControl(new fh,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(g,t){if(t===void 0&&(t=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=g.onAdd(this);this._controls.push(g);const h=this._controlPositions[t];return t.indexOf("bottom")!==-1?h.insertBefore(a,h.firstChild):h.appendChild(a),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(g);return t>-1&&this._controls.splice(t,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,t,a,h){return h==null&&this.terrain&&(h=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,t,a,h)}resize(g){var t;const a=this._containerDimensions(),h=a[0],d=a[1],m=this._getClampedPixelRatio(h,d);if(this._resizeCanvas(h,d,m),this.painter.resize(h,d,m),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const E=this._getClampedPixelRatio(h,d);this._resizeCanvas(h,d,E),this.painter.resize(h,d,E)}this.transform.resize(h,d),(t=this._requestedCameraState)===null||t===void 0||t.resize(h,d);const b=!this._moving;return b&&(this.stop(),this.fire(new c.k("movestart",g)).fire(new c.k("move",g))),this.fire(new c.k("resize",g)),b&&this.fire(new c.k("moveend",g)),this}_getClampedPixelRatio(g,t){const{0:a,1:h}=this._maxCanvasSize,d=this.getPixelRatio(),m=g*d,b=t*d;return Math.min(m>a?a/m:1,b>h?h/b:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Te.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(c.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(c.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,t,a){if(g==="mouseenter"||g==="mouseover"){let h=!1;return{layers:t,listener:a,delegates:{mousemove:m=>{const b=t.filter(E=>this.getLayer(E)),T=b.length!==0?this.queryRenderedFeatures(m.point,{layers:b}):[];T.length?h||(h=!0,a.call(this,new an(g,this,m.originalEvent,{features:T}))):h=!1},mouseout:()=>{h=!1}}}}if(g==="mouseleave"||g==="mouseout"){let h=!1;return{layers:t,listener:a,delegates:{mousemove:b=>{const T=t.filter(E=>this.getLayer(E));(T.length!==0?this.queryRenderedFeatures(b.point,{layers:T}):[]).length?h=!0:h&&(h=!1,a.call(this,new an(g,this,b.originalEvent)))},mouseout:b=>{h&&(h=!1,a.call(this,new an(g,this,b.originalEvent)))}}}}{const h=d=>{const m=t.filter(T=>this.getLayer(T)),b=m.length!==0?this.queryRenderedFeatures(d.point,{layers:m}):[];b.length&&(d.features=b,a.call(this,d),delete d.features)};return{layers:t,listener:a,delegates:{[g]:h}}}}_saveDelegatedListener(g,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(t)}_removeDelegatedListener(g,t,a){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const h=this._delegatedListeners[g];for(let d=0;d<h.length;d++){const m=h[d];if(m.listener===a&&m.layers.length===t.length&&m.layers.every(b=>t.includes(b))){for(const b in m.delegates)this.off(b,m.delegates[b]);return void h.splice(d,1)}}}on(g,t,a){if(a===void 0)return super.on(g,t);const h=this._createDelegatedListener(g,typeof t=="string"?[t]:t,a);this._saveDelegatedListener(g,h);for(const d in h.delegates)this.on(d,h.delegates[d]);return this}once(g,t,a){if(a===void 0)return super.once(g,t);const h=typeof t=="string"?[t]:t,d=this._createDelegatedListener(g,h,a);for(const m in d.delegates){const b=d.delegates[m];d.delegates[m]=(...T)=>{this._removeDelegatedListener(g,h,a),b(...T)}}this._saveDelegatedListener(g,d);for(const m in d.delegates)this.once(m,d.delegates[m]);return this}off(g,t,a){return a===void 0?super.off(g,t):(this._removeDelegatedListener(g,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(g,t){if(!this.style)return[];let a;const h=g instanceof c.P||Array.isArray(g),d=h?g:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(h?{}:g)||{},d instanceof c.P||typeof d[0]=="number")a=[c.P.convert(d)];else{const m=c.P.convert(d[0]),b=c.P.convert(d[1]);a=[m,new c.P(b.x,m.y),b,new c.P(m.x,b.y),m]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(g,t){return this.style.querySourceFeatures(g,t)}setStyle(g,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(g,t))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const t=this._locale[g];if(t==null)throw new Error(`Missing UI string '${g}'`);return t}_updateStyle(g,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,t));const a=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new Zl(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,t,a):this.style.loadJSON(g,t,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,t){if(typeof g=="string"){const a=this._requestManager.transformRequest(g,"Style");c.h(a,new AbortController).then(h=>{this._updateDiff(h.data,t)}).catch(h=>{h&&this.fire(new c.j(h))})}else typeof g=="object"&&this._updateDiff(g,t)}_updateDiff(g,t){try{this.style.setState(g,t)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(g,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(g,t){return this._lazyInitEmptyStyle(),this.style.addSource(g,t),this._update(!0)}isSourceLoaded(g){const t=this.style&&this.style.sourceCaches[g];if(t!==void 0)return t.loaded();this.fire(new c.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const t=this.style.sourceCaches[g.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const h=this.style._layers[a];h.type==="hillshade"&&h.source===g.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new mh(this.painter,t,g),this.painter.renderToTexture=new bf(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:g})),this}getTerrain(){var g,t;return(t=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const t in g){const a=g[t]._tiles;for(const h in a){const d=a[h];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,t,a={}){const{pixelRatio:h=1,sdf:d=!1,stretchX:m,stretchY:b,content:T,textFitWidth:E,textFitHeight:I}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:D,data:V}=t,H=t;return this.style.addImage(g,{data:new c.R({width:z,height:D},new Uint8Array(V)),pixelRatio:h,stretchX:m,stretchY:b,content:T,textFitWidth:E,textFitHeight:I,sdf:d,version:0,userImage:H}),H.onAdd&&H.onAdd(this,g),this}}{const{width:z,height:D,data:V}=R.getImageData(t);this.style.addImage(g,{data:new c.R({width:z,height:D},V),pixelRatio:h,stretchX:m,stretchY:b,content:T,textFitWidth:E,textFitHeight:I,sdf:d,version:0})}}updateImage(g,t){const a=this.style.getImage(g);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=t instanceof HTMLImageElement||c.b(t)?R.getImageData(t):t,{width:d,height:m,data:b}=h;if(d===void 0||m===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||m!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(t instanceof HTMLImageElement||c.b(t));return a.data.replace(b,T),this.style.updateImage(g,a),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return K.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,t){return this._lazyInitEmptyStyle(),this.style.addLayer(g,t),this._update(!0)}moveLayer(g,t){return this.style.moveLayer(g,t),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,t,a){return this.style.setLayerZoomRange(g,t,a),this._update(!0)}setFilter(g,t,a={}){return this.style.setFilter(g,t,a),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,t,a,h={}){return this.style.setPaintProperty(g,t,a,h),this._update(!0)}getPaintProperty(g,t){return this.style.getPaintProperty(g,t)}setLayoutProperty(g,t,a,h={}){return this.style.setLayoutProperty(g,t,a,h),this._update(!0)}getLayoutProperty(g,t){return this.style.getLayoutProperty(g,t)}setGlyphs(g,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,t,a,h=>{h||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,t,a=>{a||this._update(!0)}),this}setLight(g,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(g){return this._lazyInitEmptyStyle(),this.style.setSky(g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,t){return this.style.setFeatureState(g,t),this._update()}removeFeatureState(g,t){return this.style.removeFeatureState(g,t),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,t=0;return this._container&&(g=this._container.clientWidth||400,t=this._container.clientHeight||300),[g,t]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const t=this._canvasContainer=L.create("div","maplibregl-canvas-container",g);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=L.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),h=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],h);const d=this._controlContainer=L.create("div","maplibregl-control-container",g),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{m[b]=L.create("div",`maplibregl-ctrl-${b} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,t,a){this._canvas.width=Math.floor(a*g),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",h=>{t={requestedAttributes:g},h&&(t.statusMessage=h.statusMessage,t.type=h.type)},{once:!0});const a=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!a){const h="Failed to initialize WebGL";throw t?(t.message=h,new Error(JSON.stringify(t))):new Error(h)}this.painter=new au(a,this.transform),$.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=R.now();this.style.zoomHistory.update(d,m);const b=new c.z(d,{now:m,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=b.crossFadingFactor();T===1&&T===this._crossFadingFactor||(a=!0,this._crossFadingFactor=T),this.style.update(b)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),K.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),L.remove(this._canvasContainer),L.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,R.frameAsync(this._frameRequest).then(g=>{c.bf.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Sf}getCameraTargetElevation(){return this.transform.elevation}},v.MapMouseEvent=an,v.MapTouchEvent=lo,v.MapWheelEvent=gf,v.Marker=_u,v.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),h=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,a)=>{const h=this._map._getUIString(`NavigationControl.${a}`);t.title=h,t.setAttribute("aria-label",h)},this.options=c.e({},dg,g),this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),L.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),L.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=L.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fg(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,t){const a=L.create("button",g,this._container);return a.type="button",a.addEventListener("click",t),a}},v.Popup=class extends c.E{constructor(g){super(),this.remove=()=>(this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=L.create("div","maplibregl-popup",this._map.getContainer()),this._tip=L.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ur(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!t)return;const h=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let d=this.options.anchor;const m=xu(this.options.offset);if(!d){const T=this._container.offsetWidth,E=this._container.offsetHeight;let I;I=h.y+m.bottom.y<E?["top"]:h.y>this._map.transform.height-E?["bottom"]:[],h.x<T/2?I.push("left"):h.x>this._map.transform.width-T/2&&I.push("right"),d=I.length===0?"bottom":I.join("-")}let b=h.add(m[d]);this.options.subpixelPositioning||(b=b.round()),L.setTransform(this._container,`${Jo[d]} translate(${b.x}px,${b.y}px)`),yu(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(_t),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=c.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const t=document.createDocumentFragment(),a=document.createElement("body");let h;for(a.innerHTML=g;h=a.firstChild,h;)t.appendChild(h);return this.setDOMContent(t)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=L.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(vu);g&&g.focus()}},v.RasterDEMTileSource=lr,v.RasterTileSource=Ot,v.ScaleControl=class{constructor(g){this._onMove=()=>{cl(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,cl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ts),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=Li,v.Style=Zl,v.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=L.create("button","maplibregl-ctrl-terrain",this._container),L.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){L.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=al,v.TwoFingersTouchRotateHandler=uh,v.TwoFingersTouchZoomHandler=ah,v.TwoFingersTouchZoomRotateHandler=hh,v.VectorTileSource=ki,v.VideoSource=zs,v.addSourceType=(g,t)=>c._(void 0,void 0,void 0,function*(){if(ai(g))throw new Error(`A source type called "${g}" already exists.`);((a,h)=>{$r[a]=h})(g,t)}),v.clearPrewarmedResources=function(){const g=zt;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(At),zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return ui().getRTLTextPluginStatus()},v.getVersion=function(){return _h},v.getWorkerCount=function(){return Yt.workerCount},v.getWorkerUrl=function(){return c.a.WORKER_URL},v.importScriptInWorkers=function(g){return kn().broadcast("IS",g)},v.prewarm=function(){sn().acquire(At)},v.setMaxParallelImageRequests=function(g){c.a.MAX_PARALLEL_IMAGE_REQUESTS=g},v.setRTLTextPlugin=function(g,t){return ui().setRTLTextPlugin(g,t)},v.setWorkerCount=function(g){Yt.workerCount=g},v.setWorkerUrl=function(g){c.a.WORKER_URL=g}});var x=o;return x})})(uE);var NL=uE.exports;const Nu=Q_(NL);function jL({geoJsonData:e}){const n=X.useRef(null),o=X.useRef(null),[u,p]=X.useState(!0);return X.useEffect(()=>{if(!(!n.current||o.current))return o.current=new Nu.Map({container:n.current,style:{version:8,sources:{"carto-tiles":{type:"raster",tiles:["https://a.basemaps.cartocdn.com/rastertiles/dark_all/{z}/{x}/{y}.png","https://b.basemaps.cartocdn.com/rastertiles/dark_all/{z}/{x}/{y}.png","https://c.basemaps.cartocdn.com/rastertiles/dark_all/{z}/{x}/{y}.png","https://d.basemaps.cartocdn.com/rastertiles/dark_all/{z}/{x}/{y}.png"],tileSize:256,attribution:" OpenStreetMap contributors  CARTO"}},layers:[{id:"carto-tiles",type:"raster",source:"carto-tiles",minzoom:0,maxzoom:19}],glyphs:"https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf"},center:[-8.673,37.1028],zoom:10,pitch:0}),o.current.addControl(new Nu.NavigationControl({visualizePitch:!0}),"top-right"),o.current.addControl(new Nu.ScaleControl,"bottom-left"),o.current.on("load",()=>{p(!1)}),()=>{var x;(x=o.current)==null||x.remove(),o.current=null}},[]),X.useEffect(()=>{if(!o.current||!e)return;let x=null,v=null,c=null;const k=()=>{if(!o.current)return;if(o.current.getLayer("geojson-layer"))try{o.current.removeLayer("geojson-layer")}catch{}if(o.current.getLayer("geojson-layer-highlight"))try{o.current.removeLayer("geojson-layer-highlight")}catch{}if(o.current.getLayer("geojson-points"))try{o.current.removeLayer("geojson-points")}catch{}if(o.current.getSource("geojson-data"))try{o.current.removeSource("geojson-data")}catch{}o.current.addSource("geojson-data",{type:"geojson",data:e}),o.current.addLayer({id:"geojson-layer",type:"line",source:"geojson-data",paint:{"line-color":"hsl(173, 80%, 40%)","line-width":3,"line-opacity":.8}}),o.current.addLayer({id:"geojson-layer-highlight",type:"line",source:"geojson-data",paint:{"line-color":"hsl(48, 95%, 50%)","line-width":5,"line-opacity":.9},filter:["==",["get","id"],"___no_match___"]}),o.current.addLayer({id:"geojson-points",type:"circle",source:"geojson-data",paint:{"circle-radius":8,"circle-color":"hsl(173, 80%, 40%)","circle-stroke-color":"hsl(222, 47%, 6%)","circle-stroke-width":2},filter:["==","$type","Point"]});const A=new Nu.LngLatBounds;e.features.forEach(R=>{const L=R.geometry.type;L==="Point"?A.extend(R.geometry.coordinates):L==="LineString"?R.geometry.coordinates.forEach($=>A.extend($)):L==="MultiLineString"?R.geometry.coordinates.forEach($=>$.forEach(le=>A.extend(le))):L==="Polygon"&&(R.geometry.coordinates[0]||[]).forEach($=>A.extend($))});const B=e.features.find(R=>R.geometry.type==="LineString"||R.geometry.type==="MultiLineString");if(B){const R=new Nu.LngLatBounds;B.geometry.type==="LineString"?B.geometry.coordinates.forEach(L=>R.extend(L)):B.geometry.type==="MultiLineString"&&B.geometry.coordinates.forEach(L=>L.forEach($=>R.extend($))),R.isEmpty()?A.isEmpty()||o.current.fitBounds(A,{padding:50}):o.current.fitBounds(R,{padding:80,maxZoom:15})}else A.isEmpty()||o.current.fitBounds(A,{padding:50});x=new Nu.Popup({closeButton:!0,closeOnClick:!0}),v=R=>{const L=o.current.queryRenderedFeatures(R.point,{layers:["geojson-layer"]});if(!L||L.length===0)return;const le=L[0].properties||{},Q=R.lngLat,se=`
          <div style="min-width:200px">
            <div style="font-size:14px;color:#666">Name: ${le.name??"Trail"}</div>
            <div style="font-size:12px;color:#666">Distance: ${le.distance??"-"} m</div>
            <div style="font-size:12px;color:#666">Duration: ${le.duration??"-"} s</div>
            <div style="font-size:12px;color:#666">Pace: ${le.pace??"-"}</div>
            <div style="margin-top:6px;font-size:12px;color:#666">${le.description??""}</div>
          </div>
        `;x.setLngLat([Q.lng,Q.lat]).setHTML(se).addTo(o.current)},c=R=>{var $;const L=o.current.queryRenderedFeatures(R.point,{layers:["geojson-layer"]});if(L&&L.length>0){o.current.getCanvas().style.cursor="pointer";const le=($=L[0].properties)==null?void 0:$.id;le&&o.current.setFilter("geojson-layer-highlight",["==",["get","id"],le])}else o.current.getCanvas().style.cursor="",o.current.setFilter("geojson-layer-highlight",["==",["get","id"],"___no_match___"])},o.current.on("click",v),o.current.on("mousemove",c)};return o.current.isStyleLoaded()?k():o.current.once("load",k),()=>{if(o.current){try{v&&o.current.off("click",v),c&&o.current.off("mousemove",c)}catch{}try{x==null||x.remove()}catch{}try{o.current.getLayer("geojson-layer")&&o.current.removeLayer("geojson-layer")}catch{}try{o.current.getLayer("geojson-layer-highlight")&&o.current.removeLayer("geojson-layer-highlight")}catch{}try{o.current.getLayer("geojson-points")&&o.current.removeLayer("geojson-points")}catch{}try{o.current.getSource("geojson-data")&&o.current.removeSource("geojson-data")}catch{}}}},[e]),ee.jsxs("div",{className:"relative w-full h-full rounded-lg overflow-hidden border border-border",children:[ee.jsx("div",{ref:n,className:"absolute inset-0"}),u&&ee.jsx("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center",children:ee.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[ee.jsx(Nl,{className:"w-5 h-5 animate-spin"}),ee.jsx("span",{children:"Loading map..."})]})}),!e&&!u&&ee.jsx("div",{className:"absolute inset-0 bg-background/60 flex items-center justify-center pointer-events-none",children:ee.jsxs("div",{className:"text-center text-muted-foreground",children:[ee.jsx(tx,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),ee.jsx("p",{className:"text-sm",children:"Load GeoJSON data from an endpoint"})]})})]})}function VL(){const{token:e}=Za(),[n,o]=X.useState(null),[u,p]=X.useState(!0),[x,v]=X.useState(0),c=async()=>{if(!e)return;p(!0);const k=await Dl("/admin/trails",e);if(k.data&&Array.isArray(k.data)){v(k.data.length);const A=k.data.map(B=>{if(B.geojson){if(B.geojson.type==="FeatureCollection"){const L=B.geojson.features[0];return L.properties={...L.properties||{},id:B.id,name:B.name,distance:B.distance,duration:B.duration},L}return B.geojson.properties={...B.geojson.properties,id:B.id,name:B.name,distance:B.distance,duration:B.duration},B.geojson}const R=B;return Array.isArray(R.path)&&R.path.length>0?{type:"Feature",properties:{id:B.id,name:B.name,distance:B.distance,duration:B.duration,pace:R.pace,description:R.description,startLatitude:R.startLatitude,startLongitude:R.startLongitude},geometry:{type:"LineString",coordinates:R.path.map(L=>[L[0],L[1]])}}:null}).filter(B=>B!==null);A.length>0?(o({type:"FeatureCollection",features:A}),Br.success(`Loaded ${A.length} trails on map`)):(o(null),Br.info("No trail geometry data available"))}else k.error&&Br.error(k.error);p(!1)};return X.useEffect(()=>{c()},[e]),ee.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col gap-4 animate-fade-in",children:[ee.jsxs("div",{className:"flex items-center justify-between",children:[ee.jsxs("div",{children:[ee.jsx("h2",{className:"text-lg font-semibold",children:"Trail Map"}),ee.jsxs("p",{className:"text-sm text-muted-foreground",children:[x," trails  ",(n==null?void 0:n.features.length)||0," with geometry"]})]}),ee.jsxs(Es,{variant:"secondary",size:"sm",onClick:c,disabled:u,children:[u?ee.jsx(Nl,{className:"w-4 h-4 mr-2 animate-spin"}):ee.jsx(Mm,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),ee.jsx("div",{className:"flex-1",children:ee.jsx(jL,{geoJsonData:n})})]})}const $L=()=>{const{isAuthenticated:e}=Za(),[n,o]=X.useState("overview");if(!e)return ee.jsx(fL,{to:"/login",replace:!0});const u=()=>{switch(n){case"overview":return ee.jsx(e1,{onViewChange:o});case"users":return ee.jsx(FL,{});case"dogs":return ee.jsx(OL,{});case"trails":return ee.jsx(BL,{});case"map":return ee.jsx(VL,{});default:return ee.jsx(e1,{})}},p=()=>{const c={overview:{title:"Dashboard",subtitle:"Overview of your data"},users:{title:"Users",subtitle:"Manage user accounts"},dogs:{title:"Dogs",subtitle:"View and edit dog profiles"},trails:{title:"Trails",subtitle:"Manage recorded trails"},map:{title:"Map",subtitle:"Visualize trail data"}};return c[n]||c.overview},{title:x,subtitle:v}=p();return ee.jsxs("div",{className:"flex min-h-screen bg-background",children:[ee.jsx(wL,{activeView:n,onViewChange:o}),ee.jsxs("main",{className:"flex-1 overflow-auto",children:[ee.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-lg border-b border-border px-6 py-4",children:[ee.jsx("h1",{className:"text-xl font-semibold",children:x}),ee.jsx("p",{className:"text-sm text-muted-foreground",children:v})]}),ee.jsx("div",{className:"p-6",children:u()})]})]})};var UL=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],qL=UL.reduce((e,n)=>{const o=lE(`Primitive.${n}`),u=X.forwardRef((p,x)=>{const{asChild:v,...c}=p,k=v?o:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),ee.jsx(k,{...c,ref:x})});return u.displayName=`Primitive.${n}`,{...e,[n]:u}},{}),ZL="Label",hE=X.forwardRef((e,n)=>ee.jsx(qL.label,{...e,ref:n,onMouseDown:o=>{var p;o.target.closest("button, input, select, textarea")||((p=e.onMouseDown)==null||p.call(e,o),!o.defaultPrevented&&o.detail>1&&o.preventDefault())}}));hE.displayName=ZL;var dE=hE;const HL=ex("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Y_=X.forwardRef(({className:e,...n},o)=>ee.jsx(dE,{ref:o,className:nn(HL(),e),...n}));Y_.displayName=dE.displayName;function GL(){const e=QT(),{login:n}=Za(),[o,u]=X.useState("email"),[p,x]=X.useState(""),[v,c]=X.useState(""),[k,A]=X.useState(!1),B=async L=>{if(L.preventDefault(),!p)return;A(!0);const $=await bL(p);A(!1),$.success?(Br.success("OTP sent to your email"),u("otp")):Br.error($.error||"Failed to send OTP")},R=async L=>{if(L.preventDefault(),!v)return;A(!0);const $=await SL(p,v);A(!1),$.success&&$.token?(n($.token,p),Br.success("Welcome back!"),e("/")):Br.error($.error||"Invalid OTP")};return ee.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:ee.jsxs("div",{className:"w-full max-w-md",children:[ee.jsxs("div",{className:"text-center mb-8",children:[ee.jsx("div",{className:"w-16 h-16 rounded-2xl bg-primary/20 flex items-center justify-center mx-auto mb-4",children:ee.jsx("span",{className:"text-primary font-bold text-2xl",children:"TT"})}),ee.jsx("h1",{className:"text-2xl font-bold",children:"TailTrails Admin"}),ee.jsx("p",{className:"text-muted-foreground mt-1",children:"Sign in to access the dashboard"})]}),ee.jsx("div",{className:"glass-panel rounded-xl p-6",children:o==="email"?ee.jsxs("form",{onSubmit:B,className:"space-y-4",children:[ee.jsxs("div",{className:"space-y-2",children:[ee.jsx(Y_,{htmlFor:"email",children:"Email Address"}),ee.jsxs("div",{className:"relative",children:[ee.jsx(qA,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),ee.jsx(cm,{id:"email",type:"email",placeholder:"admin@tailtrails.com",value:p,onChange:L=>x(L.target.value),className:"pl-10",required:!0})]})]}),ee.jsx(Es,{type:"submit",className:"w-full",disabled:k,children:k?ee.jsx(Nl,{className:"w-4 h-4 animate-spin"}):ee.jsxs(ee.Fragment,{children:["Send OTP",ee.jsx(NA,{className:"w-4 h-4"})]})})]}):ee.jsxs("form",{onSubmit:R,className:"space-y-4",children:[ee.jsxs("div",{className:"text-center mb-4",children:[ee.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the 6-digit code sent to"}),ee.jsx("p",{className:"font-medium text-primary",children:p})]}),ee.jsxs("div",{className:"space-y-2",children:[ee.jsx(Y_,{htmlFor:"otp",children:"Verification Code"}),ee.jsxs("div",{className:"relative",children:[ee.jsx($A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),ee.jsx(cm,{id:"otp",type:"text",placeholder:"000000",value:v,onChange:L=>c(L.target.value.replace(/\D/g,"").slice(0,6)),className:"pl-10 font-mono text-center text-lg tracking-widest",maxLength:6,required:!0})]})]}),ee.jsx(Es,{type:"submit",className:"w-full",disabled:k||v.length!==6,children:k?ee.jsx(Nl,{className:"w-4 h-4 animate-spin"}):"Verify & Sign In"}),ee.jsx("button",{type:"button",onClick:()=>u("email"),className:"w-full text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Use a different email"})]})})]})})}const WL=()=>{const e=Vm();return X.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),ee.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:ee.jsxs("div",{className:"text-center",children:[ee.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),ee.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),ee.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},XL=new wR,KL=()=>ee.jsx(SR,{client:XL,children:ee.jsx(vL,{children:ee.jsxs(GD,{children:[ee.jsx(PM,{}),ee.jsx(oz,{}),ee.jsx(_L,{children:ee.jsxs(mL,{children:[ee.jsx(Dp,{path:"/",element:ee.jsx($L,{})}),ee.jsx(Dp,{path:"/login",element:ee.jsx(GL,{})}),ee.jsx(Dp,{path:"*",element:ee.jsx(WL,{})})]})})]})})});SS(document.getElementById("root")).render(ee.jsx(KL,{}));
